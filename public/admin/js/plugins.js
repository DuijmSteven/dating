if("undefined"==typeof jQuery)throw new Error("AdminLTE requires jQuery");+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),o=r.data(n);if(!o){var a=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,o=new s(a))}if("string"==typeof e){if(void 0===o[e])throw new Error("No method named "+e);o[e]()}})}var n="lte.layout",i={slimscroll:!0,resetHeight:!0},r={wrapper:".wrapper",contentWrapper:".content-wrapper",layoutBoxed:".layout-boxed",mainFooter:".main-footer",mainHeader:".main-header",sidebar:".sidebar",controlSidebar:".control-sidebar",fixed:".fixed",sidebarMenu:".sidebar-menu",logo:".main-header .logo"},o={fixed:"fixed",holdTransition:"hold-transition"},s=function(t){this.options=t,this.bindedResize=!1,this.activate()};s.prototype.activate=function(){this.fix(),this.fixSidebar(),t("body").removeClass(o.holdTransition),this.options.resetHeight&&t("body, html, "+r.wrapper).css({height:"auto","min-height":"100%"}),this.bindedResize||(t(window).resize(function(){this.fix(),this.fixSidebar(),t(r.logo+", "+r.sidebar).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){this.fix(),this.fixSidebar()}.bind(this))}.bind(this)),this.bindedResize=!0),t(r.sidebarMenu).on("expanded.tree",function(){this.fix(),this.fixSidebar()}.bind(this)),t(r.sidebarMenu).on("collapsed.tree",function(){this.fix(),this.fixSidebar()}.bind(this))},s.prototype.fix=function(){t(r.layoutBoxed+" > "+r.wrapper).css("overflow","hidden");var e=t(r.mainFooter).outerHeight()||0,n=t(r.mainHeader).outerHeight()+e,i=t(window).height(),s=t(r.sidebar).height()||0;if(t("body").hasClass(o.fixed))t(r.contentWrapper).css("min-height",i-e);else{var a;i>=s?(t(r.contentWrapper).css("min-height",i-n),a=i-n):(t(r.contentWrapper).css("min-height",s),a=s);var l=t(r.controlSidebar);void 0!==l&&l.height()>a&&t(r.contentWrapper).css("min-height",l.height())}},s.prototype.fixSidebar=function(){if(!t("body").hasClass(o.fixed))return void(void 0!==t.fn.slimScroll&&t(r.sidebar).slimScroll({destroy:!0}).height("auto"));this.options.slimscroll&&void 0!==t.fn.slimScroll&&(t(r.sidebar).slimScroll({destroy:!0}).height("auto"),t(r.sidebar).slimScroll({height:t(window).height()-t(r.mainHeader).height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"}))};var a=t.fn.layout;t.fn.layout=e,t.fn.layout.Constuctor=s,t.fn.layout.noConflict=function(){return t.fn.layout=a,this},t(window).on("load",function(){e.call(t("body"))})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var r=t(this),o=r.data(n);if(!o){var s=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,o=new a(s))}"toggle"==e&&o.toggle()})}var n="lte.pushmenu",i={collapseScreenSize:767,expandOnHover:!1,expandTransitionDelay:200},r={collapsed:".sidebar-collapse",open:".sidebar-open",mainSidebar:".main-sidebar",contentWrapper:".content-wrapper",searchInput:".sidebar-form .form-control",button:'[data-toggle="push-menu"]',mini:".sidebar-mini",expanded:".sidebar-expanded-on-hover",layoutFixed:".fixed"},o={collapsed:"sidebar-collapse",open:"sidebar-open",mini:"sidebar-mini",expanded:"sidebar-expanded-on-hover",expandFeature:"sidebar-mini-expand-feature",layoutFixed:"fixed"},s={expanded:"expanded.pushMenu",collapsed:"collapsed.pushMenu"},a=function(t){this.options=t,this.init()};a.prototype.init=function(){(this.options.expandOnHover||t("body").is(r.mini+r.layoutFixed))&&(this.expandOnHover(),t("body").addClass(o.expandFeature)),t(r.contentWrapper).click(function(){t(window).width()<=this.options.collapseScreenSize&&t("body").hasClass(o.open)&&this.close()}.bind(this)),t(r.searchInput).click(function(t){t.stopPropagation()})},a.prototype.toggle=function(){var e=t(window).width(),n=!t("body").hasClass(o.collapsed);e<=this.options.collapseScreenSize&&(n=t("body").hasClass(o.open)),n?this.close():this.open()},a.prototype.open=function(){t(window).width()>this.options.collapseScreenSize?t("body").removeClass(o.collapsed).trigger(t.Event(s.expanded)):t("body").addClass(o.open).trigger(t.Event(s.expanded))},a.prototype.close=function(){t(window).width()>this.options.collapseScreenSize?t("body").addClass(o.collapsed).trigger(t.Event(s.collapsed)):t("body").removeClass(o.open+" "+o.collapsed).trigger(t.Event(s.collapsed))},a.prototype.expandOnHover=function(){t(r.mainSidebar).hover(function(){t("body").is(r.mini+r.collapsed)&&t(window).width()>this.options.collapseScreenSize&&this.expand()}.bind(this),function(){t("body").is(r.expanded)&&this.collapse()}.bind(this))},a.prototype.expand=function(){setTimeout(function(){t("body").removeClass(o.collapsed).addClass(o.expanded)},this.options.expandTransitionDelay)},a.prototype.collapse=function(){setTimeout(function(){t("body").removeClass(o.expanded).addClass(o.collapsed)},this.options.expandTransitionDelay)};var l=t.fn.pushMenu;t.fn.pushMenu=e,t.fn.pushMenu.Constructor=a,t.fn.pushMenu.noConflict=function(){return t.fn.pushMenu=l,this},t(document).on("click",r.button,function(n){n.preventDefault(),e.call(t(this),"toggle")}),t(window).on("load",function(){e.call(t(r.button))})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var r=t(this);if(!r.data(n)){var o=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,new a(r,o))}})}var n="lte.tree",i={animationSpeed:500,accordion:!0,followLink:!1,trigger:".treeview a"},r={tree:".tree",treeview:".treeview",treeviewMenu:".treeview-menu",open:".menu-open, .active",li:"li",data:'[data-widget="tree"]',active:".active"},o={open:"menu-open",tree:"tree"},s={collapsed:"collapsed.tree",expanded:"expanded.tree"},a=function(e,n){this.element=e,this.options=n,t(this.element).addClass(o.tree),t(r.treeview+r.active,this.element).addClass(o.open),this._setUpListeners()};a.prototype.toggle=function(t,e){var n=t.next(r.treeviewMenu),i=t.parent(),s=i.hasClass(o.open);i.is(r.treeview)&&(this.options.followLink&&"#"!=t.attr("href")||e.preventDefault(),s?this.collapse(n,i):this.expand(n,i))},a.prototype.expand=function(e,n){var i=t.Event(s.expanded);if(this.options.accordion){var a=n.siblings(r.open),l=a.children(r.treeviewMenu);this.collapse(l,a)}n.addClass(o.open),e.slideDown(this.options.animationSpeed,function(){t(this.element).trigger(i)}.bind(this))},a.prototype.collapse=function(e,n){var i=t.Event(s.collapsed);e.find(r.open).removeClass(o.open),n.removeClass(o.open),e.slideUp(this.options.animationSpeed,function(){e.find(r.open+" > "+r.treeview).slideUp(),t(this.element).trigger(i)}.bind(this))},a.prototype._setUpListeners=function(){var e=this;t(this.element).on("click",this.options.trigger,function(n){e.toggle(t(this),n)})};var l=t.fn.tree;t.fn.tree=e,t.fn.tree.Constructor=a,t.fn.tree.noConflict=function(){return t.fn.tree=l,this},t(window).on("load",function(){t(r.data).each(function(){e.call(t(this))})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var r=t(this),o=r.data(n);if(!o){var s=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,o=new a(r,s))}"string"==typeof e&&o.toggle()})}var n="lte.controlsidebar",i={slide:!0},r={sidebar:".control-sidebar",data:'[data-toggle="control-sidebar"]',open:".control-sidebar-open",bg:".control-sidebar-bg",wrapper:".wrapper",content:".content-wrapper",boxed:".layout-boxed"},o={open:"control-sidebar-open",fixed:"fixed"},s={collapsed:"collapsed.controlsidebar",expanded:"expanded.controlsidebar"},a=function(t,e){this.element=t,this.options=e,this.hasBindedResize=!1,this.init()};a.prototype.init=function(){t(this.element).is(r.data)||t(this).on("click",this.toggle),this.fix(),t(window).resize(function(){this.fix()}.bind(this))},a.prototype.toggle=function(e){e&&e.preventDefault(),this.fix(),t(r.sidebar).is(r.open)||t("body").is(r.open)?this.collapse():this.expand()},a.prototype.expand=function(){this.options.slide?t(r.sidebar).addClass(o.open):t("body").addClass(o.open),t(this.element).trigger(t.Event(s.expanded))},a.prototype.collapse=function(){t("body, "+r.sidebar).removeClass(o.open),t(this.element).trigger(t.Event(s.collapsed))},a.prototype.fix=function(){t("body").is(r.boxed)&&this._fixForBoxed(t(r.bg))},a.prototype._fixForBoxed=function(e){e.css({position:"absolute",height:t(r.wrapper).height()})};var l=t.fn.controlSidebar;t.fn.controlSidebar=e,t.fn.controlSidebar.Constructor=a,t.fn.controlSidebar.noConflict=function(){return t.fn.controlSidebar=l,this},t(document).on("click",r.data,function(n){n&&n.preventDefault(),e.call(t(this),"toggle")})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var r=t(this),o=r.data(n);if(!o){var s=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,o=new a(r,s))}if("string"==typeof e){if(void 0===o[e])throw new Error("No method named "+e);o[e]()}})}var n="lte.boxwidget",i={animationSpeed:500,collapseTrigger:'[data-widget="collapse"]',removeTrigger:'[data-widget="remove"]',collapseIcon:"fa-minus",expandIcon:"fa-plus",removeIcon:"fa-times"},r={data:".box",collapsed:".collapsed-box",body:".box-body",footer:".box-footer",tools:".box-tools"},o={collapsed:"collapsed-box"},s={collapsed:"collapsed.boxwidget",expanded:"expanded.boxwidget",removed:"removed.boxwidget"},a=function(t,e){this.element=t,this.options=e,this._setUpListeners()};a.prototype.toggle=function(){t(this.element).is(r.collapsed)?this.expand():this.collapse()},a.prototype.expand=function(){var e=t.Event(s.expanded),n=this.options.collapseIcon,i=this.options.expandIcon;t(this.element).removeClass(o.collapsed),t(this.element).find(r.tools).find("."+i).removeClass(i).addClass(n),t(this.element).find(r.body+", "+r.footer).slideDown(this.options.animationSpeed,function(){t(this.element).trigger(e)}.bind(this))},a.prototype.collapse=function(){var e=t.Event(s.collapsed),n=this.options.collapseIcon,i=this.options.expandIcon;t(this.element).find(r.tools).find("."+n).removeClass(n).addClass(i),t(this.element).find(r.body+", "+r.footer).slideUp(this.options.animationSpeed,function(){t(this.element).addClass(o.collapsed),t(this.element).trigger(e)}.bind(this))},a.prototype.remove=function(){var e=t.Event(s.removed);t(this.element).slideUp(this.options.animationSpeed,function(){t(this.element).trigger(e),t(this.element).remove()}.bind(this))},a.prototype._setUpListeners=function(){var e=this;t(this.element).on("click",this.options.collapseTrigger,function(t){t&&t.preventDefault(),e.toggle()}),t(this.element).on("click",this.options.removeTrigger,function(t){t&&t.preventDefault(),e.remove()})};var l=t.fn.boxWidget;t.fn.boxWidget=e,t.fn.boxWidget.Constructor=a,t.fn.boxWidget.noConflict=function(){return t.fn.boxWidget=l,this},t(window).on("load",function(){t(r.data).each(function(){e.call(t(this))})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var r=t(this),o=r.data(n);if(!o){var a=t.extend({},i,r.data(),"object"==typeof e&&e);r.data(n,o=new s(r,a))}if("string"==typeof o){if(void 0===o[e])throw new Error("No method named "+e);o[e]()}})}var n="lte.todolist",i={iCheck:!1,onCheck:function(){},onUnCheck:function(){}},r={data:'[data-widget="todo-list"]'},o={done:"done"},s=function(t,e){this.element=t,this.options=e,this._setUpListeners()};s.prototype.toggle=function(t){if(t.parents(r.li).first().toggleClass(o.done),!t.prop("checked"))return void this.unCheck(t);this.check(t)},s.prototype.check=function(t){this.options.onCheck.call(t)},s.prototype.unCheck=function(t){this.options.onUnCheck.call(t)},s.prototype._setUpListeners=function(){var e=this;t(this.element).on("change ifChanged","input:checkbox",function(){e.toggle(t(this))})};var a=t.fn.todoList;t.fn.todoList=e,t.fn.todoList.Constructor=s,t.fn.todoList.noConflict=function(){return t.fn.todoList=a,this},t(window).on("load",function(){t(r.data).each(function(){e.call(t(this))})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data(n);r||i.data(n,r=new o(i)),"string"==typeof e&&r.toggle(i)})}var n="lte.directchat",i={data:'[data-widget="chat-pane-toggle"]',box:".direct-chat"},r={open:"direct-chat-contacts-open"},o=function(t){this.element=t};o.prototype.toggle=function(t){t.parents(i.box).first().toggleClass(r.open)};var s=t.fn.directChat;t.fn.directChat=e,t.fn.directChat.Constructor=o,t.fn.directChat.noConflict=function(){return t.fn.directChat=s,this},t(document).on("click",i.data,function(n){n&&n.preventDefault(),e.call(t(this),"toggle")})}(jQuery),function(t,e,n,i,r,o,s){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,o=e.createElement(n),s=e.getElementsByTagName(n)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-46680343-1","auto"),ga("send","pageview");var toMarkdown=function(t){function e(t,e){var n="void"===e.type?"<"+e.tag+"\\b([^>]*)\\/?>":"<"+e.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+e.tag+">",i=new RegExp(n,"gi");return"string"==typeof e.replacement?t.replace(i,e.replacement):t.replace(i,function(t,n,i,r){return e.replacement.call(this,t,n,i,r)})}function n(t){return new RegExp(t+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}function i(t){return t=t.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(t,e,n){var i=n.split("</li>");for(i.splice(i.length-1,1),a=0,l=i.length;a<l;a++)if(i[a]){var r="ol"===e?a+1+".  ":"*   ";i[a]=i[a].replace(/\s*<li[^>]*>([\s\S]*)/i,function(t,e){return e=e.replace(/^\s+/,""),e=e.replace(/\n\n/g,"\n\n    "),e=e.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),r+e})}return i.join("\n")}),"\n\n"+t.replace(/[ \t]+\n|\s+$/g,"")}function r(t){return t=t.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(t,e){return e=e.replace(/^\s+|\s+$/g,""),e=o(e),e=e.replace(/^/gm,"> "),e=e.replace(/^(>([ \t]{2,}>)+)/gm,"> >")})}function o(t){return t=t.replace(/^[\t\r\n]+|[\t\r\n]+$/g,""),t=t.replace(/\n\s+\n/g,"\n\n"),t=t.replace(/\n{3,}/g,"\n\n")}for(var s=[{patterns:"p",replacement:function(t,e,n){return n?"\n\n"+n+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(t,e,n,i){for(var r="",o=0;o<e;o++)r+="#";return"\n\n"+r+" "+i+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(t,e,i){var r=e.match(n("href")),o=e.match(n("title"));return r?"["+i+"]("+r[1]+(o&&o[1]?' "'+o[1]+'"':"")+")":t}},{patterns:["b","strong"],replacement:function(t,e,n){return n?"**"+n+"**":""}},{patterns:["i","em"],replacement:function(t,e,n){return n?"_"+n+"_":""}},{patterns:"code",replacement:function(t,e,n){return n?"`"+n+"`":""}},{patterns:"img",type:"void",replacement:function(t,e,i){var r=e.match(n("src")),o=e.match(n("alt")),s=e.match(n("title"));return"!["+(o&&o[1]?o[1]:"")+"]("+r[1]+(s&&s[1]?' "'+s[1]+'"':"")+")"}}],a=0,l=s.length;a<l;a++)if("string"==typeof s[a].patterns)t=e(t,{tag:s[a].patterns,replacement:s[a].replacement,type:s[a].type});else for(var c=0,h=s[a].patterns.length;c<h;c++)t=e(t,{tag:s[a].patterns[c],replacement:s[a].replacement,type:s[a].type});t=t.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,function(t,e){return e=e.replace(/^\t+/g,"  "),"\n\n    "+(e=e.replace(/\n/g,"\n    "))+"\n"}),t=t.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");for(var u=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;t.match(u);)t=t.replace(u,function(t){return i(t)});for(var d=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;t.match(d);)t=t.replace(d,function(t){return r(t)});return o(t)};"object"==typeof exports&&(exports.toMarkdown=toMarkdown),function(t){function e(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function n(){var t=require("util");return"Markdown.mk_block( "+t.inspect(this.toString())+", "+t.inspect(this.trailing)+", "+t.inspect(this.lineNumber)+" )"}function i(t){for(var e=0,n=-1;-1!==(n=t.indexOf("\n",n+1));)e++;return e}function r(t,e){function n(t){this.len_after=t,this.name="close_"+e}var i=t+"_state",r="strong"==t?"em_state":"strong_state";return function(o,s){if(this[i][0]==e)return this[i].shift(),[o.length,new n(o.length-e.length)];var a=this[r].slice(),l=this[i].slice();this[i].unshift(e);var c=this.processInline(o.substr(e.length)),h=c[c.length-1];this[i].shift();if(h instanceof n){c.pop();return[o.length-h.len_after,[t].concat(c)]}return this[r]=a,this[i]=l,[e.length,e]}}function o(t){for(var e=t.split(""),n=[""],i=!1;e.length;){var r=e.shift();switch(r){case" ":i?n[n.length-1]+=r:n.push("");break;case"'":case'"':i=!i;break;case"\\":r=e.shift();default:n[n.length-1]+=r}}return n}function s(t){return g(t)&&t.length>1&&"object"==typeof t[1]&&!g(t[1])?t[1]:void 0}function l(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(t){if("string"==typeof t)return l(t);var e=t.shift(),n={},i=[];for(!t.length||"object"!=typeof t[0]||t[0]instanceof Array||(n=t.shift());t.length;)i.push(arguments.callee(t.shift()));var r="";for(var o in n)r+=" "+o+'="'+l(n[o])+'"';return"img"==e||"br"==e||"hr"==e?"<"+e+r+"/>":"<"+e+r+">"+i.join("")+"</"+e+">"}function h(t,e,n){var i;n=n||{};var r=t.slice(0);"function"==typeof n.preprocessTreeNode&&(r=n.preprocessTreeNode(r,e));var o=s(r);if(o){r[1]={};for(i in o)r[1][i]=o[i];o=r[1]}if("string"==typeof r)return r;switch(r[0]){case"header":r[0]="h"+r[1].level,delete r[1].level;break;case"bulletlist":r[0]="ul";break;case"numberlist":r[0]="ol";break;case"listitem":r[0]="li";break;case"para":r[0]="p";break;case"markdown":r[0]="html",o&&delete o.references;break;case"code_block":r[0]="pre",i=o?2:1;var a=["code"];a.push.apply(a,r.splice(i)),r[i]=a;break;case"inlinecode":r[0]="code";break;case"img":r[1].src=r[1].href,delete r[1].href;break;case"linebreak":r[0]="br";break;case"link":r[0]="a";break;case"link_ref":r[0]="a";var l=e[o.ref];if(!l)return o.original;delete o.ref,o.href=l.href,l.title&&(o.title=l.title),delete o.original;break;case"img_ref":r[0]="img";var l=e[o.ref];if(!l)return o.original;delete o.ref,o.src=l.href,l.title&&(o.title=l.title),delete o.original}if(i=1,o){for(var c in r[1])i=2;1===i&&r.splice(i,1)}for(;i<r.length;++i)r[i]=arguments.callee(r[i],e,n);return r}function u(t){for(var e=s(t)?2:1;e<t.length;)"string"==typeof t[e]?e+1<t.length&&"string"==typeof t[e+1]?t[e]+=t.splice(e+1,1)[0]:++e:(arguments.callee(t[e]),++e)}var d=t.Markdown=function t(e){switch(typeof e){case"undefined":this.dialect=t.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in t.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=t.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};t.parse=function(t,e){return new d(e).toTree(t)},t.toHTML=function(e,n,i){var r=t.toHTMLTree(e,n,i);return t.renderJsonML(r)},t.toHTMLTree=function(t,e,n){"string"==typeof t&&(t=this.parse(t,e));var i=s(t),r={};i&&i.references&&(r=i.references);var o=h(t,r,n);return u(o),o};var f=d.mk_block=function(t,i,r){1==arguments.length&&(i="\n\n");var o=new String(t);return o.trailing=i,o.inspect=n,o.toSource=e,void 0!=r&&(o.lineNumber=r),o};d.prototype.split_blocks=function(t,e){var n,r=/([\s\S]+?)($|\n(?:\s*\n|$)+)/g,o=[],s=1;for(null!=(n=/^(\s*\n)/.exec(t))&&(s+=i(n[0]),r.lastIndex=n[0].length);null!==(n=r.exec(t));)o.push(f(n[1],n[2],s)),s+=i(n[0]);return o},d.prototype.processBlock=function(t,e){var n=this.dialect.block,i=n.__order__;if("__call__"in n)return n.__call__.call(this,t,e);for(var r=0;r<i.length;r++){var o=n[i[r]].call(this,t,e);if(o)return(!g(o)||o.length>0&&!g(o[0]))&&this.debug(i[r],"didn't return a proper array"),o}return[]},d.prototype.processInline=function(t){return this.dialect.inline.__call__.call(this,String(t))},d.prototype.toTree=function(t,e){var n=t instanceof Array?t:this.split_blocks(t),i=this.tree;try{for(this.tree=e||this.tree||["markdown"];n.length;){var r=this.processBlock(n.shift(),n);r.length&&this.tree.push.apply(this.tree,r)}return this.tree}finally{e&&(this.tree=i)}},d.prototype.debug=function(){var t=Array.prototype.slice.call(arguments);t.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,t),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,t)},d.prototype.loop_re_over_block=function(t,e,n){for(var i,r=e.valueOf();r.length&&null!=(i=t.exec(r));)r=r.substr(i[0].length),n.call(this,i);return r},d.dialects={},d.dialects.Gruber={block:{atxHeader:function(t,e){var n=t.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var i=["header",{level:n[1].length}];return Array.prototype.push.apply(i,this.processInline(n[2])),n[0].length<t.length&&e.unshift(f(t.substr(n[0].length),t.trailing,t.lineNumber+2)),[i]}},setextHeader:function(t,e){var n=t.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var i="="===n[2]?1:2,r=["header",{level:i},n[1]];return n[0].length<t.length&&e.unshift(f(t.substr(n[0].length),t.trailing,t.lineNumber+2)),[r]}},code:function(t,e){var n=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(t.match(i)){t:for(;;){var r=this.loop_re_over_block(i,t.valueOf(),function(t){n.push(t[1])});if(r.length){e.unshift(f(r,t.trailing));break t}if(!e.length)break t;if(!e[0].match(i))break t;n.push(t.trailing.replace(/[^\n]/g,"").substring(2)),t=e.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(t,e){var n=t.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var i=[["hr"]];return n[1]&&i.unshift.apply(i,this.processBlock(n[1],[])),n[3]&&e.unshift(f(n[3])),i}},lists:function(){function t(t){return new RegExp("(?:^("+l+"{0,"+t+"} {0,3})("+o+")\\s+)|(^"+l+"{0,"+(t-1)+"}[ ]{0,4})")}function e(t){return t.replace(/ {0,3}\t/g,"    ")}function n(t,e,n,i){if(e)return void t.push(["para"].concat(n));var r=t[t.length-1]instanceof Array&&"para"==t[t.length-1][0]?t[t.length-1]:t;i&&t.length>1&&n.unshift(i);for(var o=0;o<n.length;o++){var s=n[o];"string"==typeof s&&r.length>1&&"string"==typeof r[r.length-1]?r[r.length-1]+=s:r.push(s)}}function i(t,e){for(var n=new RegExp("^("+l+"{"+t+"}.*?\\n?)*$"),i=new RegExp("^"+l+"{"+t+"}","gm"),r=[];e.length>0;){if(n.exec(e[0])){var o=e.shift(),s=o.replace(i,"");r.push(f(s,o.trailing,o.lineNumber))}break}return r}function r(t,e,n){var i=t.list,r=i[i.length-1];if(!(r[1]instanceof Array&&"para"==r[1][0]))if(e+1==n.length)r.push(["para"].concat(r.splice(1)));else{var o=r.pop();r.push(["para"].concat(r.splice(1)),o)}}var o="[*+-]|\\d+\\.",s=/[*+-]/,a=new RegExp("^( {0,3})("+o+")[ \t]+"),l="(?: {0,3}\\t| {4})";return function(o,l){function c(t){var e=s.exec(t[2])?["bulletlist"]:["numberlist"];return f.push({list:e,indent:t[1]}),e}var h=o.match(a);if(h){for(var u,d,f=[],p=c(h),g=!1,y=[f[0].list];;){for(var v=o.split(/(?=\n)/),b="",w=0;w<v.length;w++){var x="",C=v[w].replace(/^\n/,function(t){return x=t,""}),_=t(f.length);if(h=C.match(_),void 0!==h[1]){b.length&&(n(u,g,this.processInline(b),x),g=!1,b=""),h[1]=e(h[1]);var S=Math.floor(h[1].length/4)+1;if(S>f.length)p=c(h),u.push(p),u=p[1]=["listitem"];else{var N=!1;for(d=0;d<f.length;d++)if(f[d].indent==h[1]){p=f[d].list,f.splice(d+1),N=!0;break}N||(S++,S<=f.length?(f.splice(S),p=f[S-1].list):(p=c(h),u.push(p))),u=["listitem"],p.push(u)}x=""}C.length>h[0].length&&(b+=x+C.substr(h[0].length))}b.length&&(n(u,g,this.processInline(b),x),g=!1,b="");var E=i(f.length,l);E.length>0&&(m(f,r,this),u.push.apply(u,this.toTree(E,[])));var T=l[0]&&l[0].valueOf()||"";if(!T.match(a)&&!T.match(/^ /))break;o=l.shift();var R=this.dialect.block.horizRule(o,l);if(R){y.push.apply(y,R);break}m(f,r,this),g=!0}return y}}}(),blockquote:function(t,e){if(t.match(/^>/m)){var n=[];if(">"!=t[0]){for(var i=t.split(/\n/),r=[];i.length&&">"!=i[0][0];)r.push(i.shift());t=i.join("\n"),n.push.apply(n,this.processBlock(r.join("\n"),[]))}for(;e.length&&">"==e[0][0];){var o=e.shift();t=new String(t+t.trailing+o),t.trailing=o.trailing}var s=t.replace(/^> ?/gm,"");this.tree;return n.push(this.toTree(s,["blockquote"])),n}},referenceDefn:function(t,e){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(t.match(n)){s(this.tree)||this.tree.splice(1,0,{});var i=s(this.tree);void 0===i.references&&(i.references={});var r=this.loop_re_over_block(n,t,function(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1));var e=i.references[t[1].toLowerCase()]={href:t[2]};void 0!==t[4]?e.title=t[4]:void 0!==t[5]&&(e.title=t[5])});return r.length&&e.unshift(f(r,t.trailing)),[]}},para:function(t,e){return[["para"].concat(this.processInline(t))]}}},d.dialects.Gruber.inline={__oneElement__:function(t,e,n){var i,r;if(e=e||this.dialect.inline.__patterns__,!(i=new RegExp("([\\s\\S]*?)("+(e.source||e)+")").exec(t)))return[t.length,t];if(i[1])return[i[1].length,i[1]];var r;return i[2]in this.dialect.inline&&(r=this.dialect.inline[i[2]].call(this,t.substr(i.index),i,n||[])),r=r||[i[2].length,i[2]]},__call__:function(t,e){function n(t){"string"==typeof t&&"string"==typeof r[r.length-1]?r[r.length-1]+=t:r.push(t)}for(var i,r=[];t.length>0;)i=this.dialect.inline.__oneElement__.call(this,t,e,r),t=t.substr(i.shift()),m(i,n);return r},"]":function(){},"}":function(){},"\\":function(t){return t.match(/^\\[\\`\*_{}\[\]()#\+.!\-]/)?[2,t[1]]:[1,"\\"]},"![":function(t){var e=t.match(/^!\[(.*?)\][ \t]*\([ \t]*(\S*)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1)),e[2]=this.dialect.inline.__call__.call(this,e[2],/\\/)[0];var n={alt:e[1],href:e[2]||""};return void 0!==e[4]&&(n.title=e[4]),[e[0].length,["img",n]]}return e=t.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),e?[e[0].length,["img_ref",{alt:e[1],ref:e[2].toLowerCase(),original:e[0]}]]:[2,"!["]},"[":function(t){var e=String(t),n=d.DialectHelpers.inline_until_char.call(this,t.substr(1),"]");if(!n)return[1,"["];var i,r,o=1+n[0],s=n[1];t=t.substr(o);var a=t.match(/^\s*\([ \t]*(\S+)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var l=a[1];if(o+=a[0].length,l&&"<"==l[0]&&">"==l[l.length-1]&&(l=l.substring(1,l.length-1)),!a[3])for(var c=1,h=0;h<l.length;h++)switch(l[h]){case"(":c++;break;case")":0==--c&&(o-=l.length-h,l=l.substring(0,h))}return l=this.dialect.inline.__call__.call(this,l,/\\/)[0],r={href:l||""},void 0!==a[3]&&(r.title=a[3]),i=["link",r].concat(s),[o,i]}return a=t.match(/^\s*\[(.*?)\]/),a?(o+=a[0].length,r={ref:(a[1]||String(s)).toLowerCase(),original:e.substr(0,o)},i=["link_ref",r].concat(s),[o,i]):1==s.length&&"string"==typeof s[0]?(r={ref:s[0].toLowerCase(),original:e.substr(0,o)},i=["link_ref",r,s[0]],[o,i]):[1,"["]},"<":function(t){var e;return null!=(e=t.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?e[3]?[e[0].length,["link",{href:"mailto:"+e[3]},e[3]]]:"mailto"==e[2]?[e[0].length,["link",{href:e[1]},e[1].substr("mailto:".length)]]:[e[0].length,["link",{href:e[1]},e[1]]]:[1,"<"]},"`":function(t){var e=t.match(/(`+)(([\s\S]*?)\1)/);return e&&e[2]?[e[1].length+e[2].length,["inlinecode",e[3]]]:[1,"`"]},"  \n":function(t){return[3,["linebreak"]]}},d.dialects.Gruber.inline["**"]=r("strong","**"),d.dialects.Gruber.inline.__=r("strong","__"),d.dialects.Gruber.inline["*"]=r("em","*"),d.dialects.Gruber.inline._=r("em","_"),d.buildBlockOrder=function(t){var e=[];for(var n in t)"__order__"!=n&&"__call__"!=n&&e.push(n);t.__order__=e},d.buildInlinePatterns=function(t){var e=[];for(var n in t)if(!n.match(/^__.*__$/)){var i=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");e.push(1==n.length?i:"(?:"+i+")")}e=e.join("|"),t.__patterns__=e;var r=t.__call__;t.__call__=function(t,n){return void 0!=n?r.call(this,t,n):r.call(this,t,e)}},d.DialectHelpers={},d.DialectHelpers.inline_until_char=function(t,e){for(var n=0,i=[];;){if(t[n]==e)return n++,[n,i];if(n>=t.length)return null;var r=this.dialect.inline.__oneElement__.call(this,t.substr(n));n+=r[0],i.push.apply(i,r.slice(1))}},d.subclassDialect=function(t){function e(){}function n(){}return e.prototype=t.block,n.prototype=t.inline,{block:new e,inline:new n}},d.buildBlockOrder(d.dialects.Gruber.block),d.buildInlinePatterns(d.dialects.Gruber.inline),d.dialects.Maruku=d.subclassDialect(d.dialects.Gruber),d.dialects.Maruku.processMetaHash=function(t){for(var e=o(t),n={},i=0;i<e.length;++i)if(/^#/.test(e[i]))n.id=e[i].substring(1);else if(/^\./.test(e[i]))n.class?n.class=n.class+e[i].replace(/./," "):n.class=e[i].substring(1);else if(/\=/.test(e[i])){var r=e[i].split(/\=/);n[r[0]]=r[1]}return n},d.dialects.Maruku.block.document_meta=function(t,e){if(!(t.lineNumber>1)&&t.match(/^(?:\w+:.*\n)*\w+:.*$/)){s(this.tree)||this.tree.splice(1,0,{});var n=t.split(/\n/);for(p in n){var i=n[p].match(/(\w+):\s*(.*)$/),r=i[1].toLowerCase(),o=i[2];this.tree[1][r]=o}return[]}},d.dialects.Maruku.block.block_meta=function(t,e){var n=t.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(n){var i,r=this.dialect.processMetaHash(n[2]);if(""===n[1]){var o=this.tree[this.tree.length-1];if(i=s(o),"string"==typeof o)return;i||(i={},o.splice(1,0,i));for(a in r)i[a]=r[a];return[]}var l=t.replace(/\n.*$/,""),c=this.processBlock(l,[]);i=s(c[0]),i||(i={},c[0].splice(1,0,i));for(a in r)i[a]=r[a];return c}},d.dialects.Maruku.block.definition_list=function(t,e){var n,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,r=["dl"];if(a=t.match(i)){for(var o=[t];e.length&&i.exec(e[0]);)o.push(e.shift());for(var s=0;s<o.length;++s){var a=o[s].match(i),l=a[1].replace(/\n$/,"").split(/\n/),c=a[2].split(/\n:\s+/);for(n=0;n<l.length;++n)r.push(["dt",l[n]]);for(n=0;n<c.length;++n)r.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[r]}},d.dialects.Maruku.inline["{:"]=function(t,e,n){if(!n.length)return[2,"{:"];var i=n[n.length-1];if("string"==typeof i)return[2,"{:"];var r=t.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!r)return[2,"{:"];var o=this.dialect.processMetaHash(r[1]),a=s(i);a||(a={},i.splice(1,0,a));for(var l in o)a[l]=o[l];return[r[0].length,""]},d.buildBlockOrder(d.dialects.Maruku.block),d.buildInlinePatterns(d.dialects.Maruku.inline);var m,g=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)};m=Array.prototype.forEach?function(t,e,n){return t.forEach(e,n)}:function(t,e,n){for(var i=0;i<t.length;i++)e.call(n||t,t[i],i,t)},t.renderJsonML=function(t,e){e=e||{},e.root=e.root||!1;var n=[];if(e.root)n.push(c(t));else for(t.shift(),!t.length||"object"!=typeof t[0]||t[0]instanceof Array||t.shift();t.length;)n.push(c(t.shift()));return n.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";var e=function(e,n){var i=["autofocus","savable","hideable","width","height","resize","iconlibrary","language","footer","fullscreen","hiddenButtons","disabledButtons"];t.each(i,function(i,r){void 0!==t(e).data(r)&&(n="object"==typeof n?n:{},n[r]=t(e).data(r))}),this.$ns="bootstrap-markdown",this.$element=t(e),this.$editable={el:null,type:null,attrKeys:[],attrValues:[],content:null},this.$options=t.extend(!0,{},t.fn.markdown.defaults,n,this.$element.data("options")),this.$oldContent=null,this.$isPreview=!1,this.$isFullscreen=!1,this.$editor=null,this.$textarea=null,this.$handler=[],this.$callback=[],this.$nextTab=[],this.showEditor()};e.prototype={constructor:e,__alterButtons:function(e,n){var i=this.$handler,r="all"==e,o=this;t.each(i,function(t,i){var s=!0;!1===(s=!r&&i.indexOf(e)<0)&&n(o.$editor.find('button[data-handler="'+i+'"]'))})},__buildButtons:function(e,n){var i,r=this.$ns,o=this.$handler,s=this.$callback;for(i=0;i<e.length;i++){var a,l=e[i];for(a=0;a<l.length;a++){var c,h=l[a].data,u=t("<div/>",{class:"btn-group"});for(c=0;c<h.length;c++){var d,f,p=h[c],m=r+"-"+p.name,g=this.__getIcon(p.icon),y=p.btnText?p.btnText:"",v=p.btnClass?p.btnClass:"btn",b=p.tabIndex?p.tabIndex:"-1",w=void 0!==p.hotkey?p.hotkey:"",x=void 0!==jQuery.hotkeys&&""!==w?" ("+w+")":"";d=t("<button></button>"),d.text(" "+this.__localize(y)).addClass("btn-default btn-sm").addClass(v),
v.match(/btn\-(primary|success|info|warning|danger|link)/)&&d.removeClass("btn-default"),d.attr({type:"button",title:this.__localize(p.title)+x,tabindex:b,"data-provider":r,"data-handler":m,"data-hotkey":w}),!0===p.toggle&&d.attr("data-toggle","button"),f=t("<span/>"),f.addClass(g),f.prependTo(d),u.append(d),o.push(m),s.push(p.callback)}n.append(u)}}return n},__setListener:function(){var e=void 0!==this.$textarea.attr("rows"),n=this.$textarea.val().split("\n").length>5?this.$textarea.val().split("\n").length:"5",i=e?this.$textarea.attr("rows"):n;this.$textarea.attr("rows",i),this.$options.resize&&this.$textarea.css("resize",this.$options.resize),this.$textarea.on({focus:t.proxy(this.focus,this),keyup:t.proxy(this.keyup,this),change:t.proxy(this.change,this),select:t.proxy(this.select,this)}),this.eventSupported("keydown")&&this.$textarea.on("keydown",t.proxy(this.keydown,this)),this.eventSupported("keypress")&&this.$textarea.on("keypress",t.proxy(this.keypress,this)),this.$textarea.data("markdown",this)},__handle:function(e){var n=t(e.currentTarget),i=this.$handler,r=this.$callback,o=n.attr("data-handler"),s=i.indexOf(o),a=r[s];t(e.currentTarget).focus(),a(this),this.change(this),o.indexOf("cmdSave")<0&&this.$textarea.focus(),e.preventDefault()},__localize:function(e){var n=t.fn.markdown.messages,i=this.$options.language;return void 0!==n&&void 0!==n[i]&&void 0!==n[i][e]?n[i][e]:e},__getIcon:function(t){return"object"==typeof t?t[this.$options.iconlibrary]:t},setFullscreen:function(e){var n=this.$editor,i=this.$textarea;!0===e?(n.addClass("md-fullscreen-mode"),t("body").addClass("md-nooverflow"),this.$options.onFullscreen(this)):(n.removeClass("md-fullscreen-mode"),t("body").removeClass("md-nooverflow"),1==this.$isPreview&&this.hidePreview().showPreview()),this.$isFullscreen=e,i.focus()},showEditor:function(){var e,n=this,i=this.$ns,r=this.$element,o=(r.css("height"),r.css("width"),this.$editable),s=this.$handler,a=this.$callback,l=this.$options,c=t("<div/>",{class:"md-editor",click:function(){n.focus()}});if(null===this.$editor){var h=t("<div/>",{class:"md-header btn-toolbar"}),u=[];if(l.buttons.length>0&&(u=u.concat(l.buttons[0])),l.additionalButtons.length>0&&t.each(l.additionalButtons[0],function(e,n){var i=t.grep(u,function(t,e){return t.name===n.name});i.length>0?i[0].data=i[0].data.concat(n.data):u.push(l.additionalButtons[0][e])}),l.reorderButtonGroups.length>0&&(u=u.filter(function(t){return l.reorderButtonGroups.indexOf(t.name)>-1}).sort(function(t,e){return l.reorderButtonGroups.indexOf(t.name)<l.reorderButtonGroups.indexOf(e.name)?-1:l.reorderButtonGroups.indexOf(t.name)>l.reorderButtonGroups.indexOf(e.name)?1:0})),u.length>0&&(h=this.__buildButtons([u],h)),l.fullscreen.enable&&h.append('<div class="md-controls"><a class="md-control md-control-fullscreen" href="#"><span class="'+this.__getIcon(l.fullscreen.icons.fullscreenOn)+'"></span></a></div>').on("click",".md-control-fullscreen",function(t){t.preventDefault(),n.setFullscreen(!0)}),c.append(h),r.is("textarea"))r.before(c),e=r,e.addClass("md-input"),c.append(e);else{var d="function"==typeof toMarkdown?toMarkdown(r.html()):r.html(),f=t.trim(d);e=t("<textarea/>",{class:"md-input",val:f}),c.append(e),o.el=r,o.type=r.prop("tagName").toLowerCase(),o.content=r.html(),t(r[0].attributes).each(function(){o.attrKeys.push(this.nodeName),o.attrValues.push(this.nodeValue)}),r.replaceWith(c)}var p=t("<div/>",{class:"md-footer"}),m=!1,g="";if(l.savable){m=!0;s.push("cmdSave"),a.push(l.onSave),p.append('<button class="btn btn-success" data-provider="'+i+'" data-handler="cmdSave"><i class="icon icon-white icon-ok"></i> '+this.__localize("Save")+"</button>")}if(g="function"==typeof l.footer?l.footer(this):l.footer,""!==t.trim(g)&&(m=!0,p.append(g)),m&&c.append(p),l.width&&"inherit"!==l.width&&(jQuery.isNumeric(l.width)?(c.css("display","table"),e.css("width",l.width+"px")):c.addClass(l.width)),l.height&&"inherit"!==l.height)if(jQuery.isNumeric(l.height)){var y=l.height;h&&(y=Math.max(0,y-h.outerHeight())),p&&(y=Math.max(0,y-p.outerHeight())),e.css("height",y+"px")}else c.addClass(l.height);this.$editor=c,this.$textarea=e,this.$editable=o,this.$oldContent=this.getContent(),this.__setListener(),this.$editor.attr("id",(new Date).getTime()),this.$editor.on("click",'[data-provider="bootstrap-markdown"]',t.proxy(this.__handle,this)),(this.$element.is(":disabled")||this.$element.is("[readonly]"))&&(this.$editor.addClass("md-editor-disabled"),this.disableButtons("all")),this.eventSupported("keydown")&&"object"==typeof jQuery.hotkeys&&h.find('[data-provider="bootstrap-markdown"]').each(function(){var n=t(this),i=n.attr("data-hotkey");""!==i.toLowerCase()&&e.bind("keydown",i,function(){return n.trigger("click"),!1})}),"preview"===l.initialstate?this.showPreview():"fullscreen"===l.initialstate&&l.fullscreen.enable&&this.setFullscreen(!0)}else this.$editor.show();return l.autofocus&&(this.$textarea.focus(),this.$editor.addClass("active")),l.fullscreen.enable&&!1!==l.fullscreen&&(this.$editor.append('<div class="md-fullscreen-controls"><a href="#" class="exit-fullscreen" title="Exit fullscreen"><span class="'+this.__getIcon(l.fullscreen.icons.fullscreenOff)+'"></span></a></div>'),this.$editor.on("click",".exit-fullscreen",function(t){t.preventDefault(),n.setFullscreen(!1)})),this.hideButtons(l.hiddenButtons),this.disableButtons(l.disabledButtons),l.onShow(this),this},parseContent:function(t){var t=t||this.$textarea.val();return this.$options.parser?this.$options.parser(t):"object"==typeof markdown?markdown.toHTML(t):"function"==typeof marked?marked(t):t},showPreview:function(){var e,n,i=this.$options,r=this.$textarea,o=r.next(),s=t("<div/>",{class:"md-preview","data-provider":"markdown-preview"});return 1==this.$isPreview?this:(this.$isPreview=!0,this.disableButtons("all").enableButtons("cmdPreview"),n=i.onPreview(this),e="string"==typeof n?n:this.parseContent(),s.html(e),o&&"md-footer"==o.attr("class")?s.insertBefore(o):r.parent().append(s),s.css({width:r.outerWidth()+"px",height:r.outerHeight()+"px"}),this.$options.resize&&s.css("resize",this.$options.resize),r.hide(),s.data("markdown",this),(this.$element.is(":disabled")||this.$element.is("[readonly]"))&&(this.$editor.addClass("md-editor-disabled"),this.disableButtons("all")),this)},hidePreview:function(){return this.$isPreview=!1,this.$editor.find('div[data-provider="markdown-preview"]').remove(),this.enableButtons("all"),this.disableButtons(this.$options.disabledButtons),this.$textarea.show(),this.__setListener(),this},isDirty:function(){return this.$oldContent!=this.getContent()},getContent:function(){return this.$textarea.val()},setContent:function(t){return this.$textarea.val(t),this},findSelection:function(t){var e,n=this.getContent();if((e=n.indexOf(t))>=0&&t.length>0){var i,r=this.getSelection();return this.setSelection(e,e+t.length),i=this.getSelection(),this.setSelection(r.start,r.end),i}return null},getSelection:function(){var t=this.$textarea[0];return("selectionStart"in t&&function(){var e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}}||function(){return null})()},setSelection:function(t,e){var n=this.$textarea[0];return("selectionStart"in n&&function(){n.selectionStart=t,n.selectionEnd=e}||function(){return null})()},replaceSelection:function(t){var e=this.$textarea[0];return("selectionStart"in e&&function(){return e.value=e.value.substr(0,e.selectionStart)+t+e.value.substr(e.selectionEnd,e.value.length),e.selectionStart=e.value.length,this}||function(){return e.value+=t,jQuery(e)})()},getNextTab:function(){if(0===this.$nextTab.length)return null;var t,e=this.$nextTab.shift();return"function"==typeof e?t=e():"object"==typeof e&&e.length>0&&(t=e),t},setNextTab:function(t,e){if("string"==typeof t){var n=this;this.$nextTab.push(function(){return n.findSelection(t)})}else if("number"==typeof t&&"number"==typeof e){var i=this.getSelection();this.setSelection(t,e),this.$nextTab.push(this.getSelection()),this.setSelection(i.start,i.end)}},__parseButtonNameParam:function(t){return"string"==typeof t?t.split(" "):t},enableButtons:function(e){var n=this.__parseButtonNameParam(e),i=this;return t.each(n,function(t,e){i.__alterButtons(n[t],function(t){t.removeAttr("disabled")})}),this},disableButtons:function(e){var n=this.__parseButtonNameParam(e),i=this;return t.each(n,function(t,e){i.__alterButtons(n[t],function(t){t.attr("disabled","disabled")})}),this},hideButtons:function(e){var n=this.__parseButtonNameParam(e),i=this;return t.each(n,function(t,e){i.__alterButtons(n[t],function(t){t.addClass("hidden")})}),this},showButtons:function(e){var n=this.__parseButtonNameParam(e),i=this;return t.each(n,function(t,e){i.__alterButtons(n[t],function(t){t.removeClass("hidden")})}),this},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},keyup:function(t){var e=!1;switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:var n;if(null!==(n=this.getNextTab())){var i=this;setTimeout(function(){i.setSelection(n.start,n.end)},500),e=!0}else{var r=this.getSelection();r.start==r.end&&r.end==this.getContent().length?e=!1:(this.setSelection(this.getContent().length,this.getContent().length),e=!0)}break;case 13:e=!1;break;case 27:this.$isFullscreen&&this.setFullscreen(!1),e=!1;break;default:e=!1}e&&(t.stopPropagation(),t.preventDefault()),this.$options.onChange(this)},change:function(t){return this.$options.onChange(this),this},select:function(t){return this.$options.onSelect(this),this},focus:function(e){var n=this.$options,i=(n.hideable,this.$editor);return i.addClass("active"),t(document).find(".md-editor").each(function(){if(t(this).attr("id")!==i.attr("id")){var e;null===(e=t(this).find("textarea").data("markdown"))&&(e=t(this).find('div[data-provider="markdown-preview"]').data("markdown")),e&&e.blur()}}),n.onFocus(this),this},blur:function(e){var n=this.$options,i=n.hideable,r=this.$editor,o=this.$editable;if(r.hasClass("active")||0===this.$element.parent().length){if(r.removeClass("active"),i)if(null!==o.el){var s=t("<"+o.type+"/>"),a=this.getContent(),l=this.parseContent(a);t(o.attrKeys).each(function(t,e){s.attr(o.attrKeys[t],o.attrValues[t])}),s.html(l),r.replaceWith(s)}else r.hide();n.onBlur(this)}return this}};var n=t.fn.markdown;t.fn.markdown=function(n){return this.each(function(){var i=t(this),r=i.data("markdown"),o="object"==typeof n&&n;r||i.data("markdown",r=new e(this,o))})},t.fn.markdown.messages={},t.fn.markdown.defaults={autofocus:!1,hideable:!1,savable:!1,width:"inherit",height:"inherit",resize:"none",iconlibrary:"glyph",language:"en",initialstate:"editor",parser:null,buttons:[[{name:"groupFont",data:[{name:"cmdBold",hotkey:"Ctrl+B",title:"Bold",icon:{glyph:"glyphicon glyphicon-bold",fa:"fa fa-bold","fa-3":"icon-bold"},callback:function(t){var e,n,i=t.getSelection(),r=t.getContent();e=0===i.length?t.__localize("strong text"):i.text,"**"===r.substr(i.start-2,2)&&"**"===r.substr(i.end,2)?(t.setSelection(i.start-2,i.end+2),t.replaceSelection(e),n=i.start-2):(t.replaceSelection("**"+e+"**"),n=i.start+2),t.setSelection(n,n+e.length)}},{name:"cmdItalic",title:"Italic",hotkey:"Ctrl+I",icon:{glyph:"glyphicon glyphicon-italic",fa:"fa fa-italic","fa-3":"icon-italic"},callback:function(t){var e,n,i=t.getSelection(),r=t.getContent();e=0===i.length?t.__localize("emphasized text"):i.text,"_"===r.substr(i.start-1,1)&&"_"===r.substr(i.end,1)?(t.setSelection(i.start-1,i.end+1),t.replaceSelection(e),n=i.start-1):(t.replaceSelection("_"+e+"_"),n=i.start+1),t.setSelection(n,n+e.length)}},{name:"cmdHeading",title:"Heading",hotkey:"Ctrl+H",icon:{glyph:"glyphicon glyphicon-header",fa:"fa fa-header","fa-3":"icon-font"},callback:function(t){var e,n,i,r,o=t.getSelection(),s=t.getContent();e=0===o.length?t.__localize("heading text"):o.text+"\n",i=4,"### "===s.substr(o.start-i,i)||(i=3,"###"===s.substr(o.start-i,i))?(t.setSelection(o.start-i,o.end),t.replaceSelection(e),n=o.start-i):o.start>0&&!!(r=s.substr(o.start-1,1))&&"\n"!=r?(t.replaceSelection("\n\n### "+e),n=o.start+6):(t.replaceSelection("### "+e),n=o.start+4),t.setSelection(n,n+e.length)}}]},{name:"groupLink",data:[{name:"cmdUrl",title:"URL/Link",hotkey:"Ctrl+L",icon:{glyph:"glyphicon glyphicon-link",fa:"fa fa-link","fa-3":"icon-link"},callback:function(e){var n,i,r,o=e.getSelection();e.getContent();n=0===o.length?e.__localize("enter link description here"):o.text,r=prompt(e.__localize("Insert Hyperlink"),"http://");var s=new RegExp("^((http|https)://|(mailto:)|(//))[a-z0-9]","i");if(null!==r&&""!==r&&"http://"!==r&&s.test(r)){var a=t("<div>"+r+"</div>").text();e.replaceSelection("["+n+"]("+a+")"),i=o.start+1,e.setSelection(i,i+n.length)}}},{name:"cmdImage",title:"Image",hotkey:"Ctrl+G",icon:{glyph:"glyphicon glyphicon-picture",fa:"fa fa-picture-o","fa-3":"icon-picture"},callback:function(e){var n,i,r,o=e.getSelection();e.getContent();n=0===o.length?e.__localize("enter image description here"):o.text,r=prompt(e.__localize("Insert Image Hyperlink"),"http://");var s=new RegExp("^((http|https)://|(//))[a-z0-9]","i");if(null!==r&&""!==r&&"http://"!==r&&s.test(r)){var a=t("<div>"+r+"</div>").text();e.replaceSelection("!["+n+"]("+a+' "'+e.__localize("enter image title here")+'")'),i=o.start+2,e.setNextTab(e.__localize("enter image title here")),e.setSelection(i,i+n.length)}}}]},{name:"groupMisc",data:[{name:"cmdList",hotkey:"Ctrl+U",title:"Unordered List",icon:{glyph:"glyphicon glyphicon-list",fa:"fa fa-list","fa-3":"icon-list-ul"},callback:function(e){var n,i,r=e.getSelection();e.getContent();if(0===r.length)n=e.__localize("list text here"),e.replaceSelection("- "+n),i=r.start+2;else if(r.text.indexOf("\n")<0)n=r.text,e.replaceSelection("- "+n),i=r.start+2;else{var o=[];o=r.text.split("\n"),n=o[0],t.each(o,function(t,e){o[t]="- "+e}),e.replaceSelection("\n\n"+o.join("\n")),i=r.start+4}e.setSelection(i,i+n.length)}},{name:"cmdListO",hotkey:"Ctrl+O",title:"Ordered List",icon:{glyph:"glyphicon glyphicon-th-list",fa:"fa fa-list-ol","fa-3":"icon-list-ol"},callback:function(e){var n,i,r=e.getSelection();e.getContent();if(0===r.length)n=e.__localize("list text here"),e.replaceSelection("1. "+n),i=r.start+3;else if(r.text.indexOf("\n")<0)n=r.text,e.replaceSelection("1. "+n),i=r.start+3;else{var o=[];o=r.text.split("\n"),n=o[0],t.each(o,function(t,e){o[t]="1. "+e}),e.replaceSelection("\n\n"+o.join("\n")),i=r.start+5}e.setSelection(i,i+n.length)}},{name:"cmdCode",hotkey:"Ctrl+K",title:"Code",icon:{glyph:"glyphicon glyphicon-asterisk",fa:"fa fa-code","fa-3":"icon-code"},callback:function(t){var e,n,i=t.getSelection(),r=t.getContent();e=0===i.length?t.__localize("code text here"):i.text,"```\n"===r.substr(i.start-4,4)&&"\n```"===r.substr(i.end,4)?(t.setSelection(i.start-4,i.end+4),t.replaceSelection(e),n=i.start-4):"`"===r.substr(i.start-1,1)&&"`"===r.substr(i.end,1)?(t.setSelection(i.start-1,i.end+1),t.replaceSelection(e),n=i.start-1):r.indexOf("\n")>-1?(t.replaceSelection("```\n"+e+"\n```"),n=i.start+4):(t.replaceSelection("`"+e+"`"),n=i.start+1),t.setSelection(n,n+e.length)}},{name:"cmdQuote",hotkey:"Ctrl+Q",title:"Quote",icon:{glyph:"glyphicon glyphicon-comment",fa:"fa fa-quote-left","fa-3":"icon-quote-left"},callback:function(e){var n,i,r=e.getSelection();e.getContent();if(0===r.length)n=e.__localize("quote here"),e.replaceSelection("> "+n),i=r.start+2;else if(r.text.indexOf("\n")<0)n=r.text,e.replaceSelection("> "+n),i=r.start+2;else{var o=[];o=r.text.split("\n"),n=o[0],t.each(o,function(t,e){o[t]="> "+e}),e.replaceSelection("\n\n"+o.join("\n")),i=r.start+4}e.setSelection(i,i+n.length)}}]},{name:"groupUtil",data:[{name:"cmdPreview",toggle:!0,hotkey:"Ctrl+P",title:"Preview",btnText:"Preview",btnClass:"btn btn-primary btn-sm",icon:{glyph:"glyphicon glyphicon-search",fa:"fa fa-search","fa-3":"icon-search"},callback:function(t){var e=t.$isPreview;!1===e?t.showPreview():t.hidePreview()}}]}]],additionalButtons:[],reorderButtonGroups:[],hiddenButtons:[],disabledButtons:[],footer:"",fullscreen:{enable:!0,icons:{fullscreenOn:{fa:"fa fa-expand",glyph:"glyphicon glyphicon-fullscreen","fa-3":"icon-resize-full"},fullscreenOff:{fa:"fa fa-compress",glyph:"glyphicon glyphicon-fullscreen","fa-3":"icon-resize-small"}}},onShow:function(t){},onPreview:function(t){},onSave:function(t){},onBlur:function(t){},onFocus:function(t){},onChange:function(t){},onFullscreen:function(t){},onSelect:function(t){}},t.fn.markdown.Constructor=e,t.fn.markdown.noConflict=function(){return t.fn.markdown=n,this};var i=function(t){var e=t;if(e.data("markdown"))return void e.data("markdown").showEditor();e.markdown()},r=function(e){var n=t(document.activeElement);t(document).find(".md-editor").each(function(){var e=t(this),i=n.closest(".md-editor")[0]===this,r=e.find("textarea").data("markdown")||e.find('div[data-provider="markdown-preview"]').data("markdown");r&&!i&&r.blur()})};t(document).on("click.markdown.data-api",'[data-provide="markdown-editable"]',function(e){i(t(this)),e.preventDefault()}).on("click focusin",function(t){r()}).ready(function(){t('textarea[data-provide="markdown"]').each(function(){i(t(this))})})});var wysihtml5,Base,Handlebars;Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&function(){var t=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return t.get.call(this)},set:function(e){return t.set.call(this,e)}})}(),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),wysihtml5={version:"0.4.15",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46},function(t,e){"function"==typeof define&&define.amd?define(t):e.rangy=t()}(function(){function t(t,e){var n=typeof t[e];return n==_||!(n!=C||!t[e])||"unknown"==n}function e(t,e){return!(typeof t[e]!=C||!t[e])}function n(t,e){return typeof t[e]!=S}function i(t){return function(e,n){for(var i=n.length;i--;)if(!t(e,n[i]))return!1;return!0}}function r(t){return t&&k(t,R)&&O(t,T)}function o(t){return e(t,"body")?t.body:t.getElementsByTagName("body")[0]}function s(n){e(window,"console")&&t(window.console,"log")&&window.console.log(n)}function a(t,e){e?window.alert(t):s(t)}function l(t){I.initialized=!0,I.supported=!1,a("Rangy is not supported on this page in your browser. Reason: "+t,I.config.alertOnFail)}function c(t){a("Rangy warning: "+t,I.config.alertOnWarn)}function h(t){return t.message||t.description||t+""}function u(){var e,n,i,a,c,u,d,p,m;if(!I.initialized){if(n=!1,i=!1,t(document,"createRange")&&(e=document.createRange(),k(e,E)&&O(e,N)&&(n=!0)),!(a=o(document))||"body"!=a.nodeName.toLowerCase())return void l("No body element found");if(a&&t(a,"createTextRange")&&(e=a.createTextRange(),r(e)&&(i=!0)),!n&&!i)return void l("Neither Range nor TextRange are available");I.initialized=!0,I.features={implementsDomRange:n,implementsTextRange:i};for(d in D)(c=D[d])instanceof f&&c.init(c,I);for(p=0,m=v.length;m>p;++p)try{v[p](I)}catch(t){u="Rangy init listener threw an exception. Continuing. Detail: "+h(t),s(u)}}}function d(t){t=t||window,u();for(var e=0,n=b.length;n>e;++e)b[e](t)}function f(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function p(t,e,n,i){var r=new f(e,n,function(t){if(!t.initialized){t.initialized=!0;try{i(I,t),t.supported=!0}catch(t){var n="Module '"+e+"' failed to load: "+h(t);s(n)}}});D[e]=r}function m(){}function g(){}var y,v,b,w,x,C="object",_="function",S="undefined",N=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],E=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],T=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],R=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],k=i(t),A=i(e),O=i(n),D={},I={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:t,isHostObject:e,isHostProperty:n,areHostMethods:k,areHostObjects:A,areHostProperties:O,isTextRange:r,getBody:o},features:{},modules:D,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==S||rangyAutoInitialize}};return I.fail=l,I.warn=c,{}.hasOwnProperty?I.util.extend=function(t,e,n){var i,r,o;for(o in e)e.hasOwnProperty(o)&&(i=t[o],r=e[o],n&&null!==i&&"object"==typeof i&&null!==r&&"object"==typeof r&&I.util.extend(i,r,!0),t[o]=r);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t}:l("hasOwnProperty not supported"),function(){var t,e,n=document.createElement("div");n.appendChild(document.createElement("span")),t=[].slice;try{1==t.call(n.childNodes,0)[0].nodeType&&(e=function(e){return t.call(e,0)})}catch(t){}e||(e=function(t){var e,n,i=[];for(e=0,n=t.length;n>e;++e)i[e]=t[e];return i}),I.util.toArray=e}(),t(document,"addEventListener")?y=function(t,e,n){t.addEventListener(e,n,!1)}:t(document,"attachEvent")?y=function(t,e,n){t.attachEvent("on"+e,n)}:l("Document does not have required addEventListener or attachEvent method"),I.util.addListener=y,v=[],I.init=u,I.addInitListener=function(t){I.initialized?t(I):v.push(t)},b=[],I.addShimListener=function(t){b.push(t)},I.shim=I.createMissingNativeApi=d,f.prototype={init:function(){var t,e,n,i,r=this.dependencies||[];for(t=0,e=r.length;e>t;++t){if(i=r[t],!((n=D[i])&&n instanceof f))throw Error("required module '"+i+"' not found");if(n.init(),!n.supported)throw Error("required module '"+i+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+t)},warn:function(t){I.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){I.warn("DEPRECATED: "+t+" in module "+this.name+"is deprecated. Please use "+e+" instead")},createError:function(t){return Error("Error in Rangy "+this.name+" module: "+t)}},I.createModule=function(t){var e,n,i;2==arguments.length?(e=arguments[1],n=[]):(e=arguments[2],n=arguments[1]),i=p(!1,t,n,e),I.initialized&&i.init()},I.createCoreModule=function(t,e,n){p(!0,t,e,n)},I.RangePrototype=m,I.rangePrototype=new m,I.selectionPrototype=new g,w=!1,x=function(){w||(w=!0,!I.initialized&&I.config.autoInitialize&&u())},typeof window==S?void l("No window found"):typeof document==S?void l("No document found"):(t(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",x,!1),y(window,"load",x),I.createCoreModule("DomUtil",[],function(t,e){function n(t){var e;return typeof t.namespaceURI==M||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e}function i(t){var e=t.parentNode;return 1==e.nodeType?e:null}function r(t){for(var e=0;t=t.previousSibling;)++e;return e}function o(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}}function s(t,e){var n,i=[];for(n=t;n;n=n.parentNode)i.push(n);for(n=e;n;n=n.parentNode)if(O(i,n))return n;return null}function a(t,e,n){for(var i=n?e:e.parentNode;i;){if(i===t)return!0;i=i.parentNode}return!1}function l(t,e){return a(t,e,!0)}function c(t,e,n){for(var i,r=n?t:t.parentNode;r;){if((i=r.parentNode)===e)return r;r=i}return null}function h(t){var e=t.nodeType;return 3==e||4==e||8==e}function u(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e}function d(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t}function f(t,e,n){var i,o,s=t.cloneNode(!1);if(s.deleteData(0,e),t.deleteData(e,t.length-e),d(s,t),n)for(i=0;o=n[i++];)o.node==t&&o.offset>e?(o.node=s,o.offset-=e):o.node==t.parentNode&&o.offset>r(t)&&++o.offset;return s}function p(t){if(9==t.nodeType)return t;if(typeof t.ownerDocument!=M)return t.ownerDocument;if(typeof t.document!=M)return t.document;if(t.parentNode)return p(t.parentNode);throw e.createError("getDocument: no document found for node")}function m(t){var n=p(t);if(typeof n.defaultView!=M)return n.defaultView;if(typeof n.parentWindow!=M)return n.parentWindow;throw e.createError("Cannot get a window object for node")}function g(t){if(typeof t.contentDocument!=M)return t.contentDocument;if(typeof t.contentWindow!=M)return t.contentWindow.document;throw e.createError("getIframeDocument: No Document object found for iframe element")}function y(t){if(typeof t.contentWindow!=M)return t.contentWindow;if(typeof t.contentDocument!=M)return t.contentDocument.defaultView;throw e.createError("getIframeWindow: No Window object found for iframe element")}function v(t){return t&&L.isHostMethod(t,"setTimeout")&&L.isHostObject(t,"document")}function b(t,e,n){var i;if(t?L.isHostProperty(t,"nodeType")?i=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?g(t):p(t):v(t)&&(i=t.document):i=document,!i)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return i}function w(t){for(var e;e=t.parentNode;)t=e;return t}function x(t,n,i,o){var a,l,h,u,d;if(t==i)return n===o?0:o>n?-1:1;if(a=c(i,t,!0))return n<=r(a)?-1:1;if(a=c(t,i,!0))return r(a)<o?-1:1;if(!(l=s(t,i)))throw Error("comparePoints error: nodes have no common ancestor");if(h=t===l?l:c(t,l,!0),u=i===l?l:c(i,l,!0),h===u)throw e.createError("comparePoints got to case 4 and childA and childB are the same!");for(d=l.firstChild;d;){if(d===h)return-1;if(d===u)return 1;d=d.nextSibling}}function C(t){try{return t.parentNode,!1}catch(t){return!0}}function _(t){if(!t)return"[No node]";if(D&&C(t))return"[Broken node]";if(h(t))return'"'+t.data+'"';if(1==t.nodeType){var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+r(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return t.nodeName}function S(t){for(var e,n=p(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}function N(t){this.root=t,this._next=t}function E(t){return new N(t)}function T(t,e){this.node=t,this.offset=e}function R(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}var k,A,O,D,I,M="undefined",L=t.util;L.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||e.fail("document missing a Node creation method"),L.isHostMethod(document,"getElementsByTagName")||e.fail("document missing getElementsByTagName method"),k=document.createElement("div"),L.areHostMethods(k,["insertBefore","appendChild","cloneNode"]||!L.areHostObjects(k,["previousSibling","nextSibling","childNodes","parentNode"]))||e.fail("Incomplete Element implementation"),L.isHostProperty(k,"innerHTML")||e.fail("Element is missing innerHTML property"),A=document.createTextNode("test"),L.areHostMethods(A,["splitText","deleteData","insertData","appendData","cloneNode"]||!L.areHostObjects(k,["previousSibling","nextSibling","childNodes","parentNode"])||!L.areHostProperties(A,["data"]))||e.fail("Incomplete Text Node implementation"),O=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},D=!1,function(){var e,n=document.createElement("b");n.innerHTML="1",e=n.firstChild,n.innerHTML="<br>",D=C(e),t.features.crashyTextNodes=D}(),typeof window.getComputedStyle!=M?I=function(t,e){return m(t).getComputedStyle(t,null)[e]}:typeof document.documentElement.currentStyle!=M?I=function(t,e){return t.currentStyle[e]}:e.fail("No means of obtaining computed style properties found"),N.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},T.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+_(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},R.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},R.prototype.toString=function(){return this.message},t.dom={arrayContains:O,isHtmlNamespace:n,parentElement:i,getNodeIndex:r,getNodeLength:o,getCommonAncestor:s,isAncestorOf:a,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:h,isTextOrCommentNode:u,insertAfter:d,splitDataNode:f,getDocument:p,getWindow:m,getIframeWindow:y,getIframeDocument:g,getBody:L.getBody,isWindow:v,getContentDocument:b,getRootContainer:w,comparePoints:x,isBrokenNode:C,inspectNode:_,getComputedStyleProperty:I,fragmentFromNodeChildren:S,createIterator:E,DomPosition:T},t.DOMException=R}),I.createCoreModule("DomRange",["DomUtil"],function(t){function e(t,e){return 3!=t.nodeType&&(st(t,e.startContainer)||st(t,e.endContainer))}function n(t){return t.document||at(t.startContainer)}function i(t){return new nt(t.parentNode,ot(t))}function r(t){return new nt(t.parentNode,ot(t)+1)}function o(t,e,n){var i=11==t.nodeType?t.firstChild:t;return rt(e)?n==e.length?tt.insertAfter(t,e):e.parentNode.insertBefore(t,0==n?e:ct(e,n)):n>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n]),i}function s(t,e,i){if(S(t),S(e),n(e)!=n(t))throw new it("WRONG_DOCUMENT_ERR");var r=lt(t.startContainer,t.startOffset,e.endContainer,e.endOffset),o=lt(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return i?0>=r&&o>=0:0>r&&o>0}function a(t){var e,i,r,o;for(r=n(t.range).createDocumentFragment();i=t.next();){if(e=t.isPartiallySelectedSubtree(),i=i.cloneNode(!e),e&&(o=t.getSubtreeIterator(),i.appendChild(a(o)),o.detach()),10==i.nodeType)throw new it("HIERARCHY_REQUEST_ERR");r.appendChild(i)}return r}function l(t,e,n){var i,r,o,s;for(n=n||{stop:!1};o=t.next();)if(t.isPartiallySelectedSubtree()){if(!1===e(o))return void(n.stop=!0);if(s=t.getSubtreeIterator(),l(s,e,n),s.detach(),n.stop)return}else for(i=tt.createIterator(o);r=i.next();)if(!1===e(r))return void(n.stop=!0)}function c(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(e=t.getSubtreeIterator(),c(e),e.detach()):t.remove()}function h(t){for(var e,i,r=n(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),i=t.getSubtreeIterator(),e.appendChild(h(i)),i.detach()):t.remove(),10==e.nodeType)throw new it("HIERARCHY_REQUEST_ERR");r.appendChild(e)}return r}function u(t,e,n){var i,r,o=!(!e||!e.length),s=!!n;return o&&(i=RegExp("^("+e.join("|")+")$")),r=[],l(new f(t,!1),function(e){var a,l;(!o||i.test(e.nodeType))&&(!s||n(e))&&(a=t.startContainer,e==a&&rt(a)&&t.startOffset==a.length||(l=t.endContainer,e==l&&rt(l)&&0==t.endOffset||r.push(e)))}),r}function d(t){return"["+(void 0===t.getName?"Range":t.getName())+"("+tt.inspectNode(t.startContainer)+":"+t.startOffset+", "+tt.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function f(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&rt(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||rt(this.sc)?ht(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||rt(this.ec)?ht(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function p(t){return function(e,n){for(var i,r=n?e:e.parentNode;r;){if(i=r.nodeType,dt(t,i))return r;r=r.parentNode}return null}}function m(t,e){if(j(t,e))throw new it("INVALID_NODE_TYPE_ERR")}
function g(t,e){if(!dt(e,t.nodeType))throw new it("INVALID_NODE_TYPE_ERR")}function y(t,e){if(0>e||e>(rt(t)?t.length:t.childNodes.length))throw new it("INDEX_SIZE_ERR")}function v(t,e){if(z(t,!0)!==z(e,!0))throw new it("WRONG_DOCUMENT_ERR")}function b(t){if(W(t,!0))throw new it("NO_MODIFICATION_ALLOWED_ERR")}function w(t,e){if(!t)throw new it(e)}function x(t){return pt&&tt.isBrokenNode(t)||!dt(L,t.nodeType)&&!z(t,!0)}function C(t,e){return e<=(rt(t)?t.length:t.childNodes.length)}function _(t){return!!t.startContainer&&!!t.endContainer&&!x(t.startContainer)&&!x(t.endContainer)&&C(t.startContainer,t.startOffset)&&C(t.endContainer,t.endOffset)}function S(t){if(!_(t))throw Error("Range error: Range is no longer valid after DOM mutation ("+t.inspect()+")")}function N(t,e){var n,i,r,o,s;S(t),n=t.startContainer,i=t.startOffset,r=t.endContainer,o=t.endOffset,s=n===r,rt(r)&&o>0&&o<r.length&&ct(r,o,e),rt(n)&&i>0&&i<n.length&&(n=ct(n,i,e),s?(o-=i,r=n):r==n.parentNode&&o>=ot(n)&&o++,i=0),t.setStartAndEnd(n,i,r,o)}function E(t){S(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}function T(t){t.START_TO_START=U,t.START_TO_END=Y,t.END_TO_END=G,t.END_TO_START=X,t.NODE_BEFORE=K,t.NODE_AFTER=Q,t.NODE_BEFORE_AND_AFTER=Z,t.NODE_INSIDE=J}function R(t){T(t),T(t.prototype)}function k(t,e){return function(){var n,i,o,s,a,c,h;return S(this),n=this.startContainer,i=this.startOffset,o=this.commonAncestorContainer,s=new f(this,!0),n!==o&&(a=ht(n,o,!0),c=r(a),n=c.node,i=c.offset),l(s,b),s.reset(),h=t(s),s.detach(),e(this,n,i,n,i),h}}function A(n,o){function s(t,e){return function(n){g(n,M),g(ft(n),L);var o=(t?i:r)(n);(e?a:l)(this,o.node,o.offset)}}function a(t,e,n){var i=t.endContainer,r=t.endOffset;(e!==t.startContainer||n!==t.startOffset)&&((ft(e)!=ft(i)||1==lt(e,n,i,r))&&(i=e,r=n),o(t,e,n,i,r))}function l(t,e,n){var i=t.startContainer,r=t.startOffset;(e!==t.endContainer||n!==t.endOffset)&&((ft(e)!=ft(i)||-1==lt(e,n,i,r))&&(i=e,r=n),o(t,i,r,e,n))}var u=function(){};u.prototype=t.rangePrototype,n.prototype=new u,et.extend(n.prototype,{setStart:function(t,e){m(t,!0),y(t,e),a(this,t,e)},setEnd:function(t,e){m(t,!0),y(t,e),l(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],n=t[1],i=e,r=n;switch(t.length){case 3:r=t[2];break;case 4:i=t[2],r=t[3]}o(this,e,n,i,r)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(t){S(this),t?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){m(t,!0),o(this,t,0,t,ut(t))},selectNode:function(t){m(t,!1),g(t,M);var e=i(t),n=r(t);o(this,e.node,e.offset,n.node,n.offset)},extractContents:k(h,o),deleteContents:k(c,o),canSurroundContents:function(){var t,n;return S(this),b(this.startContainer),b(this.endContainer),t=new f(this,!0),n=t._first&&e(t._first,this)||t._last&&e(t._last,this),t.detach(),!n},splitBoundaries:function(){N(this)},splitBoundariesPreservingPositions:function(t){N(this,t)},normalizeBoundaries:function(){var t,e,n,i,r,s,a,l,c;S(this),t=this.startContainer,e=this.startOffset,n=this.endContainer,i=this.endOffset,r=function(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(n=t,i=t.length,t.appendData(e.data),e.parentNode.removeChild(e))},s=function(r){var o,s,a=r.previousSibling;a&&a.nodeType==r.nodeType&&(t=r,o=r.length,e=a.length,r.insertData(0,a.data),a.parentNode.removeChild(a),t==n?(i+=e,n=t):n==r.parentNode&&(s=ot(r),i==s?(n=r,i=o):i>s&&i--))},a=!0,rt(n)?n.length==i&&r(n):(i>0&&(l=n.childNodes[i-1])&&rt(l)&&r(l),a=!this.collapsed),a?rt(t)?0==e&&s(t):e<t.childNodes.length&&(c=t.childNodes[e])&&rt(c)&&s(c):(t=n,e=i),o(this,t,e,n,i)},collapseToPoint:function(t,e){m(t,!0),y(t,e),this.setStartAndEnd(t,e)}}),R(n)}function O(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:tt.getCommonAncestor(t.startContainer,t.endContainer)}function D(t,e,n,i,r){t.startContainer=e,t.startOffset=n,t.endContainer=i,t.endOffset=r,t.document=tt.getDocument(e),O(t)}function I(t){this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=0,this.document=t,O(this)}var M,L,B,P,H,z,W,j,F,q,V,$,U,Y,G,X,K,Q,Z,J,tt=t.dom,et=t.util,nt=tt.DomPosition,it=t.DOMException,rt=tt.isCharacterDataNode,ot=tt.getNodeIndex,st=tt.isOrIsAncestorOf,at=tt.getDocument,lt=tt.comparePoints,ct=tt.splitDataNode,ht=tt.getClosestAncestorIn,ut=tt.getNodeLength,dt=tt.arrayContains,ft=tt.getRootContainer,pt=t.features.crashyTextNodes;f.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,rt(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!rt(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(t=n===this.sc?this.so:0,e=n===this.ec?this.eo:n.length,t!=e&&n.deleteData(t,e-t))},isPartiallySelectedSubtree:function(){return e(this._current,this.range)},getSubtreeIterator:function(){var t,e,i,r,o,s;return this.isSingleCharacterDataNode?(t=this.range.cloneRange(),t.collapse(!1)):(t=new I(n(this.range)),e=this._current,i=e,r=0,o=e,s=ut(e),st(e,this.sc)&&(i=this.sc,r=this.so),st(e,this.ec)&&(o=this.ec,s=this.eo),D(t,i,r,o,s)),new f(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},M=[1,3,4,5,7,8,10],L=[2,9,11],B=[5,6,10,12],P=[1,3,4,5,7,8,10,11],H=[1,3,4,5,7,8],z=p([9,11]),W=p(B),j=p([6,10,12]),F=document.createElement("style"),q=!1;try{F.innerHTML="<b>x</b>",q=3==F.firstChild.nodeType}catch(t){}t.features.htmlParsingConforms=q,V=q?function(t){var e,n=this.startContainer,i=at(n);if(!n)throw new it("INVALID_STATE_ERR");return e=null,1==n.nodeType?e=n:rt(n)&&(e=tt.parentElement(n)),e=null===e||"HTML"==e.nodeName&&tt.isHtmlNamespace(at(e).documentElement)&&tt.isHtmlNamespace(e)?i.createElement("body"):e.cloneNode(!1),e.innerHTML=t,tt.fragmentFromNodeChildren(e)}:function(t){var e=n(this),i=e.createElement("body");return i.innerHTML=t,tt.fragmentFromNodeChildren(i)},$=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],U=0,Y=1,G=2,X=3,K=0,Q=1,Z=2,J=3,et.extend(t.rangePrototype,{compareBoundaryPoints:function(t,e){var n,i,r,o,s,a;return S(this),v(this.startContainer,e.startContainer),s=t==X||t==U?"start":"end",a=t==Y||t==U?"start":"end",n=this[s+"Container"],i=this[s+"Offset"],r=e[a+"Container"],o=e[a+"Offset"],lt(n,i,r,o)},insertNode:function(t){if(S(this),g(t,P),b(this.startContainer),st(t,this.startContainer))throw new it("HIERARCHY_REQUEST_ERR");var e=o(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){var t,e,i;return S(this),this.collapsed?n(this).createDocumentFragment():this.startContainer===this.endContainer&&rt(this.startContainer)?(t=this.startContainer.cloneNode(!0),t.data=t.data.slice(this.startOffset,this.endOffset),e=n(this).createDocumentFragment(),e.appendChild(t),e):(i=new f(this,!0),t=a(i),i.detach(),t)},canSurroundContents:function(){var t,n;return S(this),b(this.startContainer),b(this.endContainer),t=new f(this,!0),n=t._first&&e(t._first,this)||t._last&&e(t._last,this),t.detach(),!n},surroundContents:function(t){if(g(t,H),!this.canSurroundContents())throw new it("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);o(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){var t,e,i;for(S(this),t=new I(n(this)),e=$.length;e--;)i=$[e],t[i]=this[i];return t},toString:function(){var t,e,n;return S(this),t=this.startContainer,t===this.endContainer&&rt(t)?3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"":(e=[],n=new f(this,!0),l(n,function(t){(3==t.nodeType||4==t.nodeType)&&e.push(t.data)}),n.detach(),e.join(""))},compareNode:function(t){var e,n,i,r;if(S(this),e=t.parentNode,n=ot(t),!e)throw new it("NOT_FOUND_ERR");return i=this.comparePoint(e,n),r=this.comparePoint(e,n+1),0>i?r>0?Z:K:r>0?Q:J},comparePoint:function(t,e){return S(this),w(t,"HIERARCHY_REQUEST_ERR"),v(t,this.startContainer),lt(t,e,this.startContainer,this.startOffset)<0?-1:lt(t,e,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:V,toHtml:function(){return E(this)},intersectsNode:function(t,e){var i,r,o,s;return S(this),w(t,"NOT_FOUND_ERR"),at(t)===n(this)&&(i=t.parentNode,r=ot(t),w(i,"NOT_FOUND_ERR"),o=lt(i,r,this.endContainer,this.endOffset),s=lt(i,r+1,this.startContainer,this.startOffset),e?0>=o&&s>=0:0>o&&s>0)},isPointInRange:function(t,e){return S(this),w(t,"HIERARCHY_REQUEST_ERR"),v(t,this.startContainer),lt(t,e,this.startContainer,this.startOffset)>=0&&lt(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return s(this,t,!1)},intersectsOrTouchesRange:function(t){return s(this,t,!0)},intersection:function(t){var e,n,i;return this.intersectsRange(t)?(e=lt(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=lt(this.endContainer,this.endOffset,t.endContainer,t.endOffset),i=this.cloneRange(),-1==e&&i.setStart(t.startContainer,t.startOffset),1==n&&i.setEnd(t.endContainer,t.endOffset),i):null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return-1==lt(t.startContainer,t.startOffset,this.startContainer,this.startOffset)&&e.setStart(t.startContainer,t.startOffset),1==lt(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new it("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==J},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,ut(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e,n,i=this.cloneRange();return i.selectNode(t),e=i.getNodes([3]),e.length>0?(i.setStart(e[0],0),n=e.pop(),i.setEnd(n,n.length),this.containsRange(i)):this.containsNodeContents(t)},getNodes:function(t,e){return S(this),u(this,t,e)},getDocument:function(){return n(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(e){var i,r,o,s=n(this),a=t.createRange(s);return e=e||tt.getBody(s),a.selectNodeContents(e),i=this.intersection(a),r=0,o=0,i&&(a.setEnd(i.startContainer,i.startOffset),r=(""+a).length,o=r+(""+i).length),{start:r,end:o,containerNode:e}},moveToBookmark:function(t){var e,n,i,r,o,s,a,l=t.containerNode,c=0;for(this.setStart(l,0),this.collapse(!0),e=[l],i=!1,r=!1;!r&&(n=e.pop());)if(3==n.nodeType)o=c+n.length,!i&&t.start>=c&&t.start<=o&&(this.setStart(n,t.start-c),i=!0),i&&t.end>=c&&t.end<=o&&(this.setEnd(n,t.end-c),r=!0),c=o;else for(a=n.childNodes,s=a.length;s--;)e.push(a[s])},getName:function(){return"DomRange"},equals:function(t){return I.rangesEqual(this,t)},isValid:function(){return _(this)},inspect:function(){return d(this)},detach:function(){}}),A(I,D),et.extend(I,{rangeProperties:$,RangeIterator:f,copyComparisonConstants:R,createPrototypeRange:A,inspect:d,toHtml:E,getRangeDocument:n,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),t.DomRange=I}),I.createCoreModule("WrappedRange",["DomRange"],function(t,e){var n,i,r,o,s,a,l,c,h=t.dom,u=t.util,d=h.DomPosition,f=t.DomRange,p=h.getBody,m=h.getContentDocument,g=h.isCharacterDataNode;t.features.implementsDomRange&&function(){function i(t){for(var e,n=v.length;n--;)e=v[n],t[e]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}function r(t,e,n,i,r){var o=t.startContainer!==e||t.startOffset!=n,s=t.endContainer!==i||t.endOffset!=r,a=!t.equals(t.nativeRange);(o||s||a)&&(t.setEnd(i,r),t.setStart(e,n))}var o,s,a,l,c,d,g,y,v=f.rangeProperties;n=function(t){if(!t)throw e.createError("WrappedRange: Range must be specified");this.nativeRange=t,i(this)},f.createPrototypeRange(n,r),o=n.prototype,o.selectNode=function(t){this.nativeRange.selectNode(t),i(this)},o.cloneContents=function(){return this.nativeRange.cloneContents()},o.surroundContents=function(t){this.nativeRange.surroundContents(t),i(this)},o.collapse=function(t){this.nativeRange.collapse(t),i(this)},o.cloneRange=function(){return new n(this.nativeRange.cloneRange())},o.refresh=function(){i(this)},o.toString=function(){return""+this.nativeRange},a=document.createTextNode("test"),p(document).appendChild(a),l=document.createRange(),l.setStart(a,0),l.setEnd(a,0);try{l.setStart(a,1),o.setStart=function(t,e){this.nativeRange.setStart(t,e),i(this)},o.setEnd=function(t,e){this.nativeRange.setEnd(t,e),i(this)},s=function(t){return function(e){this.nativeRange[t](e),i(this)}}}catch(t){o.setStart=function(t,e){try{this.nativeRange.setStart(t,e)}catch(n){this.nativeRange.setEnd(t,e),this.nativeRange.setStart(t,e)}i(this)},o.setEnd=function(t,e){try{this.nativeRange.setEnd(t,e)}catch(n){this.nativeRange.setStart(t,e),this.nativeRange.setEnd(t,e)}i(this)},s=function(t,e){return function(n){try{this.nativeRange[t](n)}catch(i){this.nativeRange[e](n),this.nativeRange[t](n)}i(this)}}}o.setStartBefore=s("setStartBefore","setEndBefore"),o.setStartAfter=s("setStartAfter","setEndAfter"),o.setEndBefore=s("setEndBefore","setStartBefore"),o.setEndAfter=s("setEndAfter","setStartAfter"),o.selectNodeContents=function(t){this.setStartAndEnd(t,0,h.getNodeLength(t))},l.selectNodeContents(a),l.setEnd(a,3),c=document.createRange(),c.selectNodeContents(a),c.setEnd(a,4),c.setStart(a,2),o.compareBoundaryPoints=-1==l.compareBoundaryPoints(l.START_TO_END,c)&&1==l.compareBoundaryPoints(l.END_TO_START,c)?function(t,e){return e=e.nativeRange||e,t==e.START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)},d=document.createElement("div"),d.innerHTML="123",g=d.firstChild,y=p(document),y.appendChild(d),l.setStart(g,1),l.setEnd(g,2),l.deleteContents(),"13"==g.data&&(o.deleteContents=function(){this.nativeRange.deleteContents(),i(this)},o.extractContents=function(){var t=this.nativeRange.extractContents();return i(this),t}),y.removeChild(d),y=null,u.isHostMethod(l,"createContextualFragment")&&(o.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),p(document).removeChild(a),o.getName=function(){return"WrappedRange"},t.WrappedRange=n,t.createNativeRange=function(t){return t=m(t,e,"createNativeRange"),t.createRange()}}(),t.features.implementsTextRange&&(r=function(t){var e,n,i,r=t.parentElement(),o=t.duplicate();return o.collapse(!0),e=o.parentElement(),o=t.duplicate(),o.collapse(!1),n=o.parentElement(),i=e==n?e:h.getCommonAncestor(e,n),i==r?i:h.getCommonAncestor(r,i)},o=function(t){return 0==t.compareEndPoints("StartToEnd",t)},s=function(t,e,n,i,r){var o,s,a,l,c,u,f,p,m,y,v,b,w,x,C,_,S=t.duplicate();if(S.collapse(n),o=S.parentElement(),h.isOrIsAncestorOf(e,o)||(o=e),!o.canHaveHTML)return s=new d(o.parentNode,h.getNodeIndex(o)),{boundaryPosition:s,nodeInfo:{nodeIndex:s.offset,containerElement:s.node}};for(a=h.getDocument(o).createElement("span"),a.parentNode&&a.parentNode.removeChild(a),c=n?"StartToStart":"StartToEnd",y=r&&r.containerElement==o?r.nodeIndex:0,v=o.childNodes.length,b=v,w=b;w==v?o.appendChild(a):o.insertBefore(a,o.childNodes[w]),S.moveToElementText(a),0!=(l=S.compareEndPoints(c,t))&&y!=b;){if(-1==l){if(b==y+1)break;y=w}else b=b==y+1?y:w;w=Math.floor((y+b)/2),o.removeChild(a)}if(m=a.nextSibling,-1==l&&m&&g(m)){if(S.setEndPoint(n?"EndToStart":"EndToEnd",t),/[\r\n]/.test(m.data))for(C=S.duplicate(),_=C.text.replace(/\r\n/g,"\r").length,x=C.moveStart("character",_);-1==(l=C.compareEndPoints("StartToEnd",C));)x++,C.moveStart("character",1);else x=S.text.length;p=new d(m,x)}else u=(i||!n)&&a.previousSibling,f=(i||n)&&a.nextSibling,p=f&&g(f)?new d(f,0):u&&g(u)?new d(u,u.data.length):new d(o,h.getNodeIndex(a));return a.parentNode.removeChild(a),{boundaryPosition:p,nodeInfo:{nodeIndex:w,containerElement:o}}},a=function(t,e){var n,i,r,o,s=t.offset,a=h.getDocument(t.node),l=p(a).createTextRange(),c=g(t.node);return c?(n=t.node,i=n.parentNode):(o=t.node.childNodes,n=s<o.length?o[s]:null,i=t.node),r=a.createElement("span"),r.innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),l.moveToElementText(r),l.collapse(!e),i.removeChild(r),c&&l[e?"moveStart":"moveEnd"]("character",s),l},i=function(t){this.textRange=t,this.refresh()},i.prototype=new f(document),i.prototype.refresh=function(){var t,e,n,i=r(this.textRange);o(this.textRange)?e=t=s(this.textRange,i,!0,!0).boundaryPosition:(n=s(this.textRange,i,!0,!1),t=n.boundaryPosition,e=s(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},i.prototype.getName=function(){return"WrappedTextRange"},f.copyComparisonConstants(i),l=function(t){var e,n,i;return t.collapsed?a(new d(t.startContainer,t.startOffset),!0):(e=a(new d(t.startContainer,t.startOffset),!0),n=a(new d(t.endContainer,t.endOffset),!1),i=p(f.getRangeDocument(t)).createTextRange(),i.setEndPoint("StartToStart",e),i.setEndPoint("EndToEnd",n),i)},i.rangeToTextRange=l,i.prototype.toTextRange=function(){return l(this)},t.WrappedTextRange=i,(!t.features.implementsDomRange||t.config.preferTextRange)&&(c=function(){return this}(),void 0===c.Range&&(c.Range=i),t.createNativeRange=function(t){return t=m(t,e,"createNativeRange"),p(t).createTextRange()},t.WrappedRange=i)),t.createRange=function(n){return n=m(n,e,"createRange"),new t.WrappedRange(t.createNativeRange(n))},t.createRangyRange=function(t){return t=m(t,e,"createRangyRange"),new f(t)},t.createIframeRange=function(n){return e.deprecationNotice("createIframeRange()","createRange(iframeEl)"),t.createRange(n)},t.createIframeRangyRange=function(n){return e.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),t.createRangyRange(n)},t.addShimListener(function(e){var n=e.document;void 0===n.createRange&&(n.createRange=function(){return t.createRange(n)}),n=e=null})}),I.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(t,e){function n(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function i(t,n){if(t){if(E.isWindow(t))return t;if(t instanceof y)return t.win;var i=E.getContentDocument(t,e,n);return E.getWindow(i)}return window}function r(t){return i(t,"getWinSelection").getSelection()}function o(t){return i(t,"getDocSelection").document.selection}function s(t){var e=!1;return t.anchorNode&&(e=1==E.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}function a(t,e,n){var i=n?"end":"start",r=n?"start":"end";t.anchorNode=e[i+"Container"],t.anchorOffset=e[i+"Offset"],t.focusNode=e[r+"Container"],t.focusOffset=e[r+"Offset"]}function l(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}function c(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0}function h(e){var n;return e instanceof k?(n=t.createNativeRange(e.getDocument()),n.setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)):e instanceof A?n=e.nativeRange:L.implementsDomRange&&e instanceof E.getWindow(e.startContainer).Range&&(n=e),n}function u(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;n>e;++e)if(!E.isAncestorOf(t[0],t[e]))return!1;return!0}function d(t){var n=t.getNodes();if(!u(n))throw e.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return n[0]}function f(t){return!!t&&void 0!==t.text}function p(t,e){var n=new A(e);t._ranges=[n],a(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed}function m(e){var n,i,r,o;if(e._ranges.length=0,"None"==e.docSelection.type)c(e);else if(n=e.docSelection.createRange(),f(n))p(e,n);else{for(e.rangeCount=n.length,r=P(n.item(0)),o=0;o<e.rangeCount;++o)i=t.createRange(r),i.selectNode(n.item(o)),e._ranges.push(i);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,a(e,e._ranges[e.rangeCount-1],!1)}}function g(t,n){var i,r,o=t.docSelection.createRange(),s=d(n),a=P(o.item(0)),l=H(a).createControlRange();for(i=0,r=o.length;r>i;++i)l.add(o.item(i));try{l.add(s)}catch(t){throw e.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}l.select(),m(t)}function y(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function v(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0}function b(t,e){for(var n,i,r=et.length;r--;)if(n=et[r],i=n.selection,"deleteAll"==e)v(i);else if(n.win==t)return"delete"==e?(et.splice(r,1),!0):i;return"deleteAll"==e&&(et.length=0),null}function w(t,n){var i,r,o,s=P(n[0].startContainer),a=H(s).createControlRange();for(i=0,o=n.length;o>i;++i){r=d(n[i]);try{a.add(r)}catch(t){throw e.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}a.select(),m(t)}function x(t,e){if(t.win.document!=P(e))throw new O("WRONG_DOCUMENT_ERR")}function C(e){return function(n,i){var r;this.rangeCount?(r=this.getRangeAt(0),r["set"+(e?"Start":"End")](n,i)):(r=t.createRange(this.win.document),r.setStartAndEnd(n,i)),this.setSingleRange(r,this.isBackward())}}function _(t){var e,n,i=[],r=new D(t.anchorNode,t.anchorOffset),o=new D(t.focusNode,t.focusOffset),s="function"==typeof t.getName?t.getName():"Selection";if(void 0!==t.rangeCount)for(e=0,n=t.rangeCount;n>e;++e)i[e]=k.inspect(t.getRangeAt(e));return"["+s+"(Ranges: "+i.join(", ")+")(anchor: "+r.inspect()+", focus: "+o.inspect()+"]"}var S,N,E,T,R,k,A,O,D,I,M,L,B,P,H,z,W,j,F,q,V,$,U,Y,G,X,K,Q,Z,J,tt,et,nt,it,rt,ot,st,at;if(t.config.checkSelectionRanges=!0,S="boolean",N="number",E=t.dom,T=t.util,R=T.isHostMethod,k=t.DomRange,A=t.WrappedRange,O=t.DOMException,D=E.DomPosition,L=t.features,B="Control",P=E.getDocument,H=E.getBody,z=k.rangesEqual,W=R(window,"getSelection"),j=T.isHostObject(document,"selection"),L.implementsWinGetSelection=W,L.implementsDocSelection=j,F=j&&(!W||t.config.preferTextRange),F?(I=o,t.isSelectionValid=function(t){var e=i(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||P(n.createRange().parentElement())==e}):W?(I=r,t.isSelectionValid=function(){return!0}):e.fail("Neither document.selection or window.getSelection() detected."),t.getNativeSelection=I,q=I(),V=t.createNativeRange(document),$=H(document),U=T.areHostProperties(q,["anchorNode","focusNode","anchorOffset","focusOffset"]),L.selectionHasAnchorAndFocus=U,Y=R(q,"extend"),L.selectionHasExtend=Y,G=typeof q.rangeCount==N,L.selectionHasRangeCount=G,X=!1,K=!0,Q=Y?function(e,n){var i=k.getRangeDocument(n),r=t.createRange(i);r.collapseToPoint(n.endContainer,n.endOffset),e.addRange(h(r)),e.extend(n.startContainer,n.startOffset)}:null,T.areHostMethods(q,["addRange","getRangeAt","removeAllRanges"])&&typeof q.rangeCount==N&&L.implementsDomRange&&function(){var e,n,i,r,o,a,l,c,h,u,d,f=window.getSelection();if(f){for(e=f.rangeCount,n=e>1,i=[],r=s(f),o=0;e>o;++o)i[o]=f.getRangeAt(o);for(a=H(document),l=a.appendChild(document.createElement("div")),l.contentEditable="false",c=l.appendChild(document.createTextNode("   ")),h=document.createRange(),h.setStart(c,1),h.collapse(!0),f.addRange(h),K=1==f.rangeCount,f.removeAllRanges(),n||(u=window.navigator.appVersion.match(/Chrome\/(.*?) /),u&&parseInt(u[1])>=36?X=!1:(d=h.cloneRange(),h.setStart(c,0),d.setEnd(c,3),d.setStart(c,2),f.addRange(h),f.addRange(d),X=2==f.rangeCount)),a.removeChild(l),f.removeAllRanges(),o=0;e>o;++o)0==o&&r?Q?Q(f,i[o]):(t.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),f.addRange(i[o])):f.addRange(i[o])}}(),L.selectionSupportsMultipleRanges=X,L.collapsedNonEditableSelectionsSupported=K,Z=!1,$&&R($,"createControlRange")&&(J=$.createControlRange(),T.areHostProperties(J,["item","add"])&&(Z=!0)),L.implementsControlRange=Z,M=U?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed},R(q,"getRangeAt")?tt=function(t,e){try{return t.getRangeAt(e)}catch(t){return null}}:U&&(tt=function(e){var n=P(e.anchorNode),i=t.createRange(n);return i.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),i.collapsed!==this.isCollapsed&&i.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),i}),y.prototype=t.selectionPrototype,et=[],nt=function(t){var e,n,r;return t&&t instanceof y?(t.refresh(),t):(t=i(t,"getNativeSelection"),e=b(t),n=I(t),r=j?o(t):null,e?(e.nativeSelection=n,e.docSelection=r,e.refresh()):(e=new y(n,r,t),et.push({win:t,selection:e})),e)},t.getSelection=nt,t.getIframeSelection=function(n){return e.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),t.getSelection(E.getIframeWindow(n))},it=y.prototype,!F&&U&&T.areHostMethods(q,["removeAllRanges","addRange"]))it.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)},rt=function(t,e){Q(t.nativeSelection,e),t.refresh()},it.addRange=G?function(e,i){var r,o;Z&&j&&this.docSelection.type==B?g(this,e):n(i)&&Y?rt(this,e):(X?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(h(e).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1?(t.config.checkSelectionRanges&&(o=tt(this.nativeSelection,this.rangeCount-1))&&!z(o,e)&&(e=new A(o)),this._ranges[this.rangeCount-1]=e,a(this,e,at(this.nativeSelection)),this.isCollapsed=M(this)):this.refresh())}:function(t,e){n(e)&&Y?rt(this,t):(this.nativeSelection.addRange(h(t)),this.refresh())},it.setRanges=function(t){if(Z&&j&&t.length>1)w(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;n>e;++e)this.addRange(t[e])}};else{if(!(R(q,"empty")&&R(V,"select")&&Z&&F))return e.fail("No means of selecting a Range or TextRange was found"),!1;it.removeAllRanges=function(){var t,e,n;try{this.docSelection.empty(),"None"!=this.docSelection.type&&(this.anchorNode?t=P(this.anchorNode):this.docSelection.type==B&&(e=this.docSelection.createRange(),e.length&&(t=P(e.item(0)))),t&&(n=H(t).createTextRange(),n.select(),this.docSelection.empty()))}catch(t){}c(this)},it.addRange=function(e){this.docSelection.type==B?g(this,e):(t.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,e,!1))},it.setRanges=function(t){this.removeAllRanges();var e=t.length;e>1?w(this,t):e&&this.addRange(t[0])}}if(it.getRangeAt=function(t){if(0>t||t>=this.rangeCount)throw new O("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()},F)ot=function(e){var n;t.isSelectionValid(e.win)?n=e.docSelection.createRange():(n=H(e.win.document).createTextRange(),n.collapse(!0)),e.docSelection.type==B?m(e):f(n)?p(e,n):c(e)};else if(R(q,"getRangeAt")&&typeof q.rangeCount==N)ot=function(e){if(Z&&j&&e.docSelection.type==B)m(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var n=0,i=e.rangeCount;i>n;++n)e._ranges[n]=new t.WrappedRange(e.nativeSelection.getRangeAt(n));a(e,e._ranges[e.rangeCount-1],at(e.nativeSelection)),e.isCollapsed=M(e)}else c(e)};else{if(!U||typeof q.isCollapsed!=S||typeof V.collapsed!=S||!L.implementsDomRange)return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;ot=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=tt(n,0),t._ranges=[e],t.rangeCount=1,l(t),t.isCollapsed=M(t)):c(t)}}it.refresh=function(t){var e,n=t?this._ranges.slice(0):null,i=this.anchorNode,r=this.anchorOffset;if(ot(this),t){if((e=n.length)!=this._ranges.length)return!0;if(this.anchorNode!=i||this.anchorOffset!=r)return!0;for(;e--;)if(!z(n[e],this._ranges[e]))return!0;return!1}},st=function(t,e){var n,i,r=t.getAllRanges();for(t.removeAllRanges(),n=0,i=r.length;i>n;++n)z(e,r[n])||t.addRange(r[n]);t.rangeCount||c(t)},it.removeRange=Z&&j?function(t){var e,n,i,r,o,s,a,l;if(this.docSelection.type==B){for(e=this.docSelection.createRange(),n=d(t),i=P(e.item(0)),r=H(i).createControlRange(),s=!1,a=0,l=e.length;l>a;++a)o=e.item(a),o!==n||s?r.add(e.item(a)):s=!0;r.select(),m(this)}else st(this,t)}:function(t){st(this,t)},!F&&U&&L.implementsDomRange?(at=s,it.isBackward=function(){return at(this)}):at=it.isBackward=function(){return!1},it.isBackwards=it.isBackward,it.toString=function(){var t,e,n=[];for(t=0,e=this.rangeCount;e>t;++t)n[t]=""+this._ranges[t];return n.join("")},it.collapse=function(e,n){x(this,e);var i=t.createRange(e);i.collapseToPoint(e,n),this.setSingleRange(i),this.isCollapsed=!0},it.collapseToStart=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},it.collapseToEnd=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},it.selectAllChildren=function(e){x(this,e);var n=t.createRange(e);n.selectNodeContents(e),this.setSingleRange(n)},it.deleteFromDocument=function(){var t,e,n,i,r;if(Z&&j&&this.docSelection.type==B){for(t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount&&(n=this.getAllRanges(),n.length)){for(this.removeAllRanges(),i=0,r=n.length;r>i;++i)n[i].deleteContents();this.addRange(n[r-1])}},it.eachRange=function(t,e){for(var n=0,i=this._ranges.length;i>n;++n)if(t(this.getRangeAt(n)))return e},it.getAllRanges=function(){var t=[];return this.eachRange(function(e){t.push(e)}),t},it.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},it.callMethodOnEachRange=function(t,e){var n=[];return this.eachRange(function(i){n.push(i[t].apply(i,e))}),n},it.setStart=C(!0),it.setEnd=C(!1),t.rangePrototype.select=function(t){nt(this.getDocument()).setSingleRange(this,t)},it.changeEachRange=function(t){var e=[],n=this.isBackward();this.eachRange(function(n){t(n),e.push(n)}),this.removeAllRanges(),n&&1==e.length?this.addRange(e[0],"backward"):this.setRanges(e)},it.containsNode=function(t,e){return this.eachRange(function(n){return n.containsNode(t,e)},!0)||!1},it.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},it.moveToBookmark=function(e){var n,i,r,o=[];for(n=0;i=e.rangeBookmarks[n++];)r=t.createRange(this.win),r.moveToBookmark(i),o.push(r);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},it.toHtml=function(){var t=[];return this.eachRange(function(e){t.push(k.toHtml(e))}),t.join("")},L.implementsTextRange&&(it.getNativeTextRange=function(){var n,i;if(n=this.docSelection){if(i=n.createRange(),f(i))return i;throw e.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return t.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw e.createError("getNativeTextRange: selection contains no range")}),it.getName=function(){return"WrappedSelection"},it.inspect=function(){return _(this)},it.detach=function(){b(this.win,"delete"),v(this)},y.detachAll=function(){b(null,"deleteAll")},y.inspect=_,y.isDirectionBackward=n,
t.Selection=y,t.selectionPrototype=it,t.addShimListener(function(t){void 0===t.getSelection&&(t.getSelection=function(){return nt(t)}),t=null})}),I)},this),function(t,e){"function"==typeof define&&define.amd?define(["rangy"],t):t(e.rangy)}(function(t){t.createModule("SaveRestore",["WrappedRange"],function(t,e){function n(t,e){return(e||document).getElementById(t)}function i(t,e){var n,i="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),r=p.getDocument(t.startContainer),o=t.cloneRange();return o.collapse(e),n=r.createElement("span"),n.id=i,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(r.createTextNode(m)),o.insertNode(n),n}function r(t,i,r,o){var s=n(r,t);s?(i[o?"setStartBefore":"setEndBefore"](s),s.parentNode.removeChild(s)):e.warn("Marker element has been removed. Cannot restore selection.")}function o(t,e){return e.compareBoundaryPoints(t.START_TO_START,t)}function s(e,n){var r,o,s=t.DomRange.getRangeDocument(e),a=""+e;return e.collapsed?(o=i(e,!1),{document:s,markerId:o.id,collapsed:!0}):(o=i(e,!1),r=i(e,!0),{document:s,startMarkerId:r.id,endMarkerId:o.id,collapsed:!1,backward:n,toString:function(){return"original text: '"+a+"', new text: '"+e+"'"}})}function a(i,o){var s,a,l,c=i.document;return void 0===o&&(o=!0),s=t.createRange(c),i.collapsed?(a=n(i.markerId,c),a?(a.style.display="inline",l=a.previousSibling,l&&3==l.nodeType?(a.parentNode.removeChild(a),s.collapseToPoint(l,l.length)):(s.collapseBefore(a),a.parentNode.removeChild(a))):e.warn("Marker element has been removed. Cannot restore selection.")):(r(c,s,i.startMarkerId,!0),r(c,s,i.endMarkerId,!1)),o&&s.normalizeBoundaries(),s}function l(e,i){var r,a,l,c,h=[];for(e=e.slice(0),e.sort(o),l=0,c=e.length;c>l;++l)h[l]=s(e[l],i);for(l=c-1;l>=0;--l)r=e[l],a=t.DomRange.getRangeDocument(r),r.collapsed?r.collapseAfter(n(h[l].markerId,a)):(r.setEndBefore(n(h[l].endMarkerId,a)),r.setStartAfter(n(h[l].startMarkerId,a)));return h}function c(n){var i,r,o,s;return t.isSelectionValid(n)?(i=t.getSelection(n),r=i.getAllRanges(),o=1==r.length&&i.isBackward(),s=l(r,o),o?i.setSingleRange(r[0],"backward"):i.setRanges(r),{win:n,rangeInfos:s,restored:!1}):(e.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null)}function h(t){var e,n=[],i=t.length;for(e=i-1;e>=0;e--)n[e]=a(t[e],!0);return n}function u(e,n){var i,r,o,s;e.restored||(i=e.rangeInfos,r=t.getSelection(e.win),o=h(i),s=i.length,1==s&&n&&t.features.selectionHasExtend&&i[0].backward?(r.removeAllRanges(),r.addRange(o[0],!0)):r.setRanges(o),e.restored=!0)}function d(t,e){var i=n(e,t);i&&i.parentNode.removeChild(i)}function f(t){var e,n,i,r=t.rangeInfos;for(e=0,n=r.length;n>e;++e)i=r[e],i.collapsed?d(t.doc,i.markerId):(d(t.doc,i.startMarkerId),d(t.doc,i.endMarkerId))}var p=t.dom,m="\ufeff";t.util.extend(t,{saveRange:s,restoreRange:a,saveRanges:l,restoreRanges:h,saveSelection:c,restoreSelection:u,removeMarkerElement:d,removeMarkers:f})})},this),Base=function(){},Base.extend=function(t,e){var n,i,r,o=Base.prototype.extend;return Base._prototyping=!0,n=new this,o.call(n,t),n.base=function(){},delete Base._prototyping,i=n.constructor,r=n.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==r)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||o).call(arguments[0],n)},r.ancestor=this,r.extend=this.extend,r.forEach=this.forEach,r.implement=this.implement,r.prototype=n,r.toString=this.toString,r.valueOf=function(t){return"object"==t?r:i.valueOf()},o.call(r,e),"function"==typeof r.init&&r.init(),r},Base.prototype={extend:function(t,e){var n,i,r,o,s,a,l;if(arguments.length>1)n=this[t],!n||"function"!=typeof e||n.valueOf&&n.valueOf()==e.valueOf()||!/\bbase\b/.test(e)||(i=e.valueOf(),e=function(){var t,e=this.base||Base.prototype.base;return this.base=n,t=i.apply(this,arguments),this.base=e,t},e.valueOf=function(t){return"object"==t?e:i},e.toString=Base.toString),this[t]=e;else if(t){for(r=Base.prototype.extend,Base._prototyping||"function"==typeof this||(r=this.extend||r),o={toSource:null},s=["constructor","toString","valueOf"],a=Base._prototyping?0:1;l=s[a++];)t[l]!=o[l]&&r.call(this,l,t[l]);for(l in t)o[l]||r.call(this,l,t[l])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(t,e,n){for(var i in t)void 0===this.prototype[i]&&e.call(n,t[i],i,t)},implement:function(){for(var t=0;t<arguments.length;t++)"function"==typeof arguments[t]?arguments[t](this.prototype):this.prototype.extend(arguments[t]);return this},toString:function(){return this.valueOf()+""}}),wysihtml5.browser=function(){function t(t){return+(/ipad|iphone|ipod/.test(t)&&t.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1]}function e(t){return+(t.match(/android (\d+)/)||[void 0,0])[1]}function n(t,e){var n,i=-1;return"Microsoft Internet Explorer"==navigator.appName?n=RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"):"Netscape"==navigator.appName&&(n=RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")),n&&null!=n.exec(navigator.userAgent)&&(i=parseFloat(RegExp.$1)),-1!==i&&(!t||(e?"<"===e?i>t:">"===e?t>i:"<="===e?i>=t:">="===e?t>=i:void 0:t===i))}var i=navigator.userAgent,r=document.createElement("div"),o=-1!==i.indexOf("Gecko")&&-1===i.indexOf("KHTML"),s=-1!==i.indexOf("AppleWebKit/"),a=-1!==i.indexOf("Chrome/"),l=-1!==i.indexOf("Opera/");return{USER_AGENT:i,supported:function(){var n=this.USER_AGENT.toLowerCase(),i="contentEditable"in r,o=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,s=document.querySelector&&document.querySelectorAll,a=this.isIos()&&t(n)<5||this.isAndroid()&&e(n)<4||-1!==n.indexOf("opera mobi")||-1!==n.indexOf("hpwos/");return i&&o&&s&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return n()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return n()},hasCurrentStyleProperty:function(){return"currentStyle"in r},hasHistoryIssue:function(){return o&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return o},supportsPlaceholderAttributeOn:function(t){return"placeholder"in t},supportsEvent:function(t){return"on"+t in r||function(){return r.setAttribute("on"+t,"return;"),"function"==typeof r["on"+t]}()},supportsEventsInIframeCorrectly:function(){return!l},supportsHTML5Tags:function(t){var e=t.createElement("div"),n="<article>foo</article>";return e.innerHTML=n,e.innerHTML.toLowerCase()===n},supportsCommand:function(){var t={formatBlock:n(10,"<="),insertUnorderedList:n(),insertOrderedList:n()},e={insertHTML:o};return function(n,i){if(!t[i]){try{return n.queryCommandSupported(i)}catch(t){}try{return n.queryCommandEnabled(i)}catch(t){return!!e[i]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return n()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return o||l||s},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return o||n()||l},autoScrollsToCaret:function(){return!s},autoClosesUnclosedTags:function(){var t,e,n=r.cloneNode(!1);return n.innerHTML="<p><div></div>",e=n.innerHTML.toLowerCase(),t="<p></p><div></div>"===e||"<p><div></div></p>"===e,this.autoClosesUnclosedTags=function(){return t},t},supportsNativeGetElementsByClassName:function(){return-1!==(document.getElementsByClassName+"").indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return l},supportsSpeechApiOn:function(t){return(i.match(/Chrome\/(\d+)/)||[void 0,0])[1]>=11&&("onwebkitspeechchange"in t||"speech"in t)},crashesWhenDefineProperty:function(t){return n(9)&&("XMLHttpRequest"===t||"XDomainRequest"===t)},doesAsyncFocus:function(){return n()},hasProblemsSettingCaretAfterImg:function(){return n()},hasUndoInContextMenu:function(){return o||a||l},hasInsertNodeIssue:function(){return l},hasIframeFocusIssue:function(){return n()},createsNestedInvalidMarkupAfterPaste:function(){return s},supportsMutationEvents:function(){return"MutationEvent"in window},supportsModenPaste:function(){return!("clipboardData"in window)}}}(),wysihtml5.lang.array=function(t){return{contains:function(e){if(Array.isArray(e)){for(var n=e.length;n--;)if(-1!==wysihtml5.lang.array(t).indexOf(e[n]))return!0;return!1}return-1!==wysihtml5.lang.array(t).indexOf(e)},indexOf:function(e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},without:function(e){e=wysihtml5.lang.array(e);for(var n=[],i=0,r=t.length;r>i;i++)e.contains(t[i])||n.push(t[i]);return n},get:function(){for(var e=0,n=t.length,i=[];n>e;e++)i.push(t[e]);return i},map:function(e,n){if(Array.prototype.map)return t.map(e,n);for(var i=t.length>>>0,r=Array(i),o=0;i>o;o++)r[o]=e.call(n,t[o],o,t);return r},unique:function(){for(var e=[],n=t.length,i=0;n>i;)wysihtml5.lang.array(e).contains(t[i])||e.push(t[i]),i++;return e}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(t,e){return this.events=this.events||{},this.events[t]=this.events[t]||[],this.events[t].push(e),this},off:function(t,e){this.events=this.events||{};var n,i,r=0;if(t){for(n=this.events[t]||[],i=[];r<n.length;r++)n[r]!==e&&e&&i.push(n[r]);this.events[t]=i}else this.events={};return this},fire:function(t,e){this.events=this.events||{};for(var n=this.events[t]||[],i=0;i<n.length;i++)n[i].call(this,e);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(t){return{merge:function(e){for(var n in e)t[n]=e[n];return this},get:function(){return t},clone:function(e){var n,i={};if(null===t||!wysihtml5.lang.object(t).isPlainObject())return t;for(n in t)t.hasOwnProperty(n)&&(i[n]=e?wysihtml5.lang.object(t[n]).clone(e):t[n]);return i},isArray:function(){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(){return"[object Function]"===Object.prototype.toString.call(t)},isPlainObject:function(){return"[object Object]"===Object.prototype.toString.call(t)}}},function(){var t=/^\s+/,e=/\s+$/,n=/[&<>\t"]/g,i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(r){return r+="",{trim:function(){return r.replace(t,"").replace(e,"")},interpolate:function(t){for(var e in t)r=this.replace("#{"+e+"}").by(t[e]);return r},replace:function(t){return{by:function(e){return r.split(t).join(e)}}},escapeHTML:function(t,e){var o=r.replace(n,function(t){return i[t]});return t&&(o=o.replace(/(?:\r\n|\r|\n)/g,"<br />")),e&&(o=o.replace(/  /gi,"&nbsp; ")),o}}}}(),function(t){function e(t,e){return o(t,e)?t:(t===t.ownerDocument.documentElement&&(t=t.ownerDocument.body),s(t,e))}function n(t){return t.replace(l,function(t,e){var n,i,r=(e.match(c)||[])[1]||"",o=u[r];return e=e.replace(c,""),e.split(o).length>e.split(r).length&&(e+=r,r=""),n=e,i=e,e.length>h&&(i=i.substr(0,h)+"..."),"www."===n.substr(0,4)&&(n="http://"+n),'<a href="'+n+'">'+i+"</a>"+r})}function i(t){var e=t._wysihtml5_tempElement;return e||(e=t._wysihtml5_tempElement=t.createElement("div")),e}function r(e){var r=e.parentNode,o=t.lang.string(e.data).escapeHTML(),s=i(r.ownerDocument);for(s.innerHTML="<span></span>"+n(o),s.removeChild(s.firstChild);s.firstChild;)r.insertBefore(s.firstChild,e);r.removeChild(e)}function o(e,n){for(var i;e.parentNode;){if(e=e.parentNode,i=e.nodeName,e.className&&t.lang.array(e.className.split(" ")).contains(n))return!0;if(a.contains(i))return!0;if("body"===i)return!1}return!1}function s(e,n){if(!(a.contains(e.nodeName)||e.className&&t.lang.array(e.className.split(" ")).contains(n))){if(e.nodeType===t.TEXT_NODE&&e.data.match(l))return void r(e);for(var i=t.lang.array(e.childNodes).get(),o=i.length,c=0;o>c;c++)s(i[c],n);return e}}var a=t.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,c=/([^\w\/\-](,?))$/i,h=100,u={")":"(","]":"[","}":"{"};t.dom.autoLink=e,t.dom.autoLink.URL_REG_EXP=l}(wysihtml5),function(t){var e=t.dom;e.addClass=function(t,n){var i=t.classList;return i?i.add(n):void(e.hasClass(t,n)||(t.className+=" "+n))},e.removeClass=function(t,e){var n=t.classList;return n?n.remove(e):void(t.className=t.className.replace(RegExp("(^|\\s+)"+e+"(\\s+|$)")," "))},e.hasClass=function(t,e){var n,i=t.classList;return i?i.contains(e):(n=t.className,n.length>0&&(n==e||RegExp("(^|\\s)"+e+"(\\s|$)").test(n)))}}(wysihtml5),wysihtml5.dom.contains=function(){var t=document.documentElement;return t.contains?function(t,e){return e.nodeType!==wysihtml5.ELEMENT_NODE&&(e=e.parentNode),t!==e&&t.contains(e)}:t.compareDocumentPosition?function(t,e){return!!(16&t.compareDocumentPosition(e))}:void 0}(),wysihtml5.dom.convertToList=function(){function t(t,e){var n=t.createElement("li");return e.appendChild(n),n}function e(t,e){return t.createElement(e)}function n(n,i,r){if("UL"===n.nodeName||"OL"===n.nodeName||"MENU"===n.nodeName)return n;var o,s,a,l,c,h,u,d,f,p=n.ownerDocument,m=e(p,i),g=n.querySelectorAll("br"),y=g.length;for(f=0;y>f;f++)for(l=g[f];(c=l.parentNode)&&c!==n&&c.lastChild===l;){if("block"===wysihtml5.dom.getStyle("display").from(c)){c.removeChild(l);break}wysihtml5.dom.insert(l).after(l.parentNode)}for(o=wysihtml5.lang.array(n.childNodes).get(),s=o.length,f=0;s>f;f++)d=d||t(p,m),a=o[f],h="block"===wysihtml5.dom.getStyle("display").from(a),u="BR"===a.nodeName,!h||r&&wysihtml5.dom.hasClass(a,r)?u?d=d.firstChild?null:d:d.appendChild(a):(d=d.firstChild?t(p,m):d,d.appendChild(a),d=null);return 0===o.length&&t(p,m),n.parentNode.replaceChild(m,n),m}return n}(),wysihtml5.dom.copyAttributes=function(t){return{from:function(e){return{to:function(n){for(var i,r=0,o=t.length;o>r;r++)i=t[r],void 0!==e[i]&&""!==e[i]&&(n[i]=e[i]);return{andTo:arguments.callee}}}}}},function(t){var e=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],n=function(e){return!!i(e)&&parseInt(t.getStyle("width").from(e),10)<e.offsetWidth},i=function(n){for(var i=0,r=e.length;r>i;i++)if("border-box"===t.getStyle(e[i]).from(n))return e[i]};t.copyStyles=function(i){return{from:function(r){n(r)&&(i=wysihtml5.lang.array(i).without(e));for(var o,s="",a=i.length,l=0;a>l;l++)o=i[l],s+=o+":"+t.getStyle(o).from(r)+";";return{to:function(e){return t.setStyles(s).on(e),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(t){t.dom.delegate=function(e,n,i,r){return t.dom.observe(e,i,function(i){for(var o=i.target,s=t.lang.array(e.querySelectorAll(n));o&&o!==e;){if(s.contains(o)){r.call(o,i);break}o=o.parentNode}})}}(wysihtml5),function(t){t.dom.domNode=function(e){var n=[t.ELEMENT_NODE,t.TEXT_NODE],i=function(e){return e.nodeType===t.TEXT_NODE&&/^\s*$/g.test(e.data)};return{prev:function(r){var o=e.previousSibling,s=r&&r.nodeTypes?r.nodeTypes:n;return o?!t.lang.array(s).contains(o.nodeType)||r&&r.ignoreBlankTexts&&i(o)?t.dom.domNode(o).prev(r):o:null},next:function(r){var o=e.nextSibling,s=r&&r.nodeTypes?r.nodeTypes:n;return o?!t.lang.array(s).contains(o.nodeType)||r&&r.ignoreBlankTexts&&i(o)?t.dom.domNode(o).next(r):o:null}}}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var t=function(t,e){var n=e.createElement("div");n.style.display="none",e.body.appendChild(n);try{n.innerHTML=t}catch(t){}return e.body.removeChild(n),n},e=function(t){if(!t._wysihtml5_supportsHTML5Tags){for(var e=0,i=n.length;i>e;e++)t.createElement(n[e]);t._wysihtml5_supportsHTML5Tags=!0}},n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,i){i=i||document;var r;return"object"==typeof n&&n.nodeType?(r=i.createElement("div"),r.appendChild(n)):wysihtml5.browser.supportsHTML5Tags(i)?(r=i.createElement("div"),r.innerHTML=n):(e(i),r=t(n,i)),r}}(),wysihtml5.dom.getParentElement=function(){function t(t,e){return!e||!e.length||("string"==typeof e?t===e:wysihtml5.lang.array(e).contains(t))}function e(t){return t.nodeType===wysihtml5.ELEMENT_NODE}function n(t,e,n){var i=(t.className||"").match(n)||[];return e?i[i.length-1]===e:!!i.length}function i(t,e,n){var i=(t.getAttribute("style")||"").match(n)||[];return e?i[i.length-1]===e:!!i.length}return function(r,o,s,a){var l=o.cssStyle||o.styleRegExp,c=o.className||o.classRegExp;for(s=s||50;s--&&r&&"BODY"!==r.nodeName&&(!a||r!==a);){if(e(r)&&t(r.nodeName,o.nodeName)&&(!l||i(r,o.cssStyle,o.styleRegExp))&&(!c||n(r,o.className,o.classRegExp)))return r;r=r.parentNode}return null}}(),wysihtml5.dom.getStyle=function(){function t(t){return t.replace(n,function(t){return t.charAt(1).toUpperCase()})}var e={float:"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},n=/\-[a-z]/g;return function(n){return{from:function(i){var r,o,s,a,l,c,h,u,d;if(i.nodeType===wysihtml5.ELEMENT_NODE){if(r=i.ownerDocument,o=e[n]||t(n),s=i.style,a=i.currentStyle,l=s[o])return l;if(a)try{return a[o]}catch(t){}return c=r.defaultView||r.parentWindow,h=("height"===n||"width"===n)&&"TEXTAREA"===i.nodeName,c.getComputedStyle?(h&&(u=s.overflow,s.overflow="hidden"),d=c.getComputedStyle(i,null).getPropertyValue(n),h&&(s.overflow=u||""),d):void 0}}}}}(),wysihtml5.dom.getTextNodes=function(t,e){var n=[];for(t=t.firstChild;t;t=t.nextSibling)3==t.nodeType?e&&/^\s*$/.test(t.innerText||t.textContent)||n.push(t):n=n.concat(wysihtml5.dom.getTextNodes(t,e));return n},wysihtml5.dom.hasElementWithTagName=function(){function t(t){return t._wysihtml5_identifier||(t._wysihtml5_identifier=n++)}var e={},n=1;return function(n,i){var r=t(n)+":"+i,o=e[r];return o||(o=e[r]=n.getElementsByTagName(i)),o.length>0}}(),function(t){function e(t){return t._wysihtml5_identifier||(t._wysihtml5_identifier=i++)}var n={},i=1;t.dom.hasElementWithClassName=function(i,r){if(!t.browser.supportsNativeGetElementsByClassName())return!!i.querySelector("."+r);var o=e(i)+":"+r,s=n[o];return s||(s=n[o]=i.getElementsByClassName(r)),s.length>0}}(wysihtml5),wysihtml5.dom.insert=function(t){return{after:function(e){e.parentNode.insertBefore(t,e.nextSibling)},before:function(e){e.parentNode.insertBefore(t,e)},into:function(e){e.appendChild(t)}}},wysihtml5.dom.insertCSS=function(t){return t=t.join("\n"),{into:function(e){var n,i,r=e.createElement("style");return r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),n=e.querySelector("head link"),n?void n.parentNode.insertBefore(r,n):void((i=e.querySelector("head"))&&i.appendChild(r))}}},function(t){t.dom.lineBreaks=function(e){function n(t){return"BR"===t.nodeName}function i(e){return!!n(e)||"block"===t.dom.getStyle("display").from(e)}return{add:function(){var n=e.ownerDocument,r=t.dom.domNode(e).next({ignoreBlankTexts:!0}),o=t.dom.domNode(e).prev({ignoreBlankTexts:!0});r&&!i(r)&&t.dom.insert(n.createElement("br")).after(e),o&&!i(o)&&t.dom.insert(n.createElement("br")).before(e)},remove:function(){var i=t.dom.domNode(e).next({ignoreBlankTexts:!0}),r=t.dom.domNode(e).prev({ignoreBlankTexts:!0});i&&n(i)&&i.parentNode.removeChild(i),r&&n(r)&&r.parentNode.removeChild(r)}}}}(wysihtml5),wysihtml5.dom.observe=function(t,e,n){e="string"==typeof e?[e]:e;for(var i,r,o=0,s=e.length;s>o;o++)r=e[o],t.addEventListener?t.addEventListener(r,n,!1):(i=function(e){"target"in e||(e.target=e.srcElement),e.preventDefault=e.preventDefault||function(){this.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=!0},n.call(t,e)},t.attachEvent("on"+r,i));return{stop:function(){for(var r,o=0,s=e.length;s>o;o++)r=e[o],t.removeEventListener?t.removeEventListener(r,n,!1):t.detachEvent("on"+r,i)}}},wysihtml5.dom.parse=function(t,e){function n(t,e,i,r){var o,s,a,l=t.nodeType,c=t.childNodes,h=c.length,u=p[l],d=0;if(r&&1===l&&wysihtml5.dom.hasClass(t,r))return t;if(!(s=u&&u(t,i))){if(!1===s){for(o=t.ownerDocument.createDocumentFragment(),d=h;d--;)c[d]&&(a=n(c[d],e,i,r))&&(c[d]===a&&d--,o.insertBefore(a,o.firstChild));return"block"===wysihtml5.dom.getStyle("display").from(t)&&o.appendChild(t.ownerDocument.createElement("br")),wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(t.nodeName.toLowerCase())&&t.parentNode.lastChild!==t&&(t.nextSibling&&3===t.nextSibling.nodeType&&/^\s/.test(t.nextSibling.nodeValue)||o.appendChild(t.ownerDocument.createTextNode(" "))),o.normalize&&o.normalize(),o}return null}for(d=0;h>d;d++)c[d]&&(a=n(c[d],e,i,r))&&(c[d]===a&&d--,s.appendChild(a));if(e&&s.nodeName.toLowerCase()===m&&(!s.childNodes.length||/^\s*$/gi.test(s.innerHTML)&&(i||"_wysihtml5-temp-placeholder"!==t.className&&"rangySelectionBoundary"!==t.className)||!s.attributes.length)){for(o=s.ownerDocument.createDocumentFragment();s.firstChild;)o.appendChild(s.firstChild);return o.normalize&&o.normalize(),o}return s.normalize&&s.normalize(),s}function i(t,e){var n,i,r,o;for(n in e)if(e.hasOwnProperty(n))for(wysihtml5.lang.object(e[n]).isFunction()?i=e[n]:"string"==typeof e[n]&&S[e[n]]&&(i=S[e[n]]),r=t.querySelectorAll(n),o=r.length;o--;)i(r[o])}function r(t,e){var n,i,r,s=v.tags,l=t.nodeName.toLowerCase(),c=t.scopeName;if(t._wysihtml5)return null;if(t._wysihtml5=1,"wysihtml5-temp"===t.className)return null;if(c&&"HTML"!=c&&(l=c+":"+l),"outerHTML"in t&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==t.nodeName||"</p>"===t.outerHTML.slice(-4).toLowerCase()||(l="div")),l in s){if(!(n=s[l])||n.remove)return null;if(n.unwrap)return!1;n="string"==typeof n?{rename_tag:n}:n}else{if(!t.firstChild)return null;n={rename_tag:m}}if(n.one_of_type&&!o(t,v,n.one_of_type,e)){if(!n.remove_action)return null;if("unwrap"===n.remove_action)return!1;if("rename"!==n.remove_action)return null;r=n.remove_action_rename_to||m}return i=t.ownerDocument.createElement(r||n.rename_tag||l),u(t,i,n,e),a(t,i,n),t=null,i.normalize&&i.normalize(),i}function o(t,e,n,i){var r,o;if("SPAN"===t.nodeName&&!i&&("_wysihtml5-temp-placeholder"===t.className||"rangySelectionBoundary"===t.className))return!0;for(o in n)if(n.hasOwnProperty(o)&&e.type_definitions&&e.type_definitions[o]&&(r=e.type_definitions[o],s(t,r)))return!0;return!1}function s(t,e){var n,i,r,o,s,a,l,c,h=t.getAttribute("class"),u=t.getAttribute("style");if(e.methods)for(a in e.methods)if(e.methods.hasOwnProperty(a)&&_[a]&&_[a](t))return!0;if(h&&e.classes)for(h=h.replace(/^\s+/g,"").replace(/\s+$/g,"").split(g),n=h.length,l=0;n>l;l++)if(e.classes[h[l]])return!0;if(u&&e.styles){u=u.split(";");for(i in e.styles)if(e.styles.hasOwnProperty(i))for(c=u.length;c--;)if(s=u[c].split(":"),s[0].replace(/\s/g,"").toLowerCase()===i&&(!0===e.styles[i]||1===e.styles[i]||wysihtml5.lang.array(e.styles[i]).contains(s[1].replace(/\s/g,"").toLowerCase())))return!0}if(e.attrs)for(r in e.attrs)if(e.attrs.hasOwnProperty(r)&&"string"==typeof(o=wysihtml5.dom.getAttribute(t,r))&&o.search(e.attrs[r])>-1)return!0;return!1}function a(t,e,n){var i,r;if(n&&n.keep_styles)for(i in n.keep_styles)if(n.keep_styles.hasOwnProperty(i)){if(r="float"===i?t.style.styleFloat||t.style.cssFloat:t.style[i],n.keep_styles[i]instanceof RegExp&&!n.keep_styles[i].test(r))continue;"float"===i?e.style[t.style.styleFloat?"styleFloat":"cssFloat"]=r:t.style[i]&&(e.style[i]=r)}}function l(t,e){var n,i=[];for(n in e)e.hasOwnProperty(n)&&0===n.indexOf(t)&&i.push(n);return i}function c(t,e,n,i){var r,o=w[n];return!(!o||!(e||"alt"===t&&"IMG"==i)||"string"!=typeof(r=o(e)))&&r}function h(t,e){var n,i,r,o,s,a=wysihtml5.lang.object(v.attributes||{}).clone(),h=wysihtml5.lang.object(a).merge(wysihtml5.lang.object(e||{}).clone()).get(),u={},d=wysihtml5.dom.getAttributes(t);for(n in h)if(/\*$/.test(n))for(r=l(n.slice(0,-1),d),o=0,s=r.length;s>o;o++)!1!==(i=c(r[o],d[r[o]],h[n],t.nodeName))&&(u[r[o]]=i);else!1!==(i=c(n,d[n],h[n],t.nodeName))&&(u[n]=i);return u}function u(t,e,n,i){var r,o,s,a,l,c={},u=n.set_class,d=n.add_class,f=n.add_style,p=n.set_attributes,m=v.classes,y=0,b=[],w=[],_=[],S=[];if(p&&(c=wysihtml5.lang.object(p).clone()),c=wysihtml5.lang.object(c).merge(h(t,n.check_attributes)).get(),u&&b.push(u),d)for(a in d)(l=C[d[a]])&&"string"==typeof(s=l(wysihtml5.dom.getAttribute(t,a)))&&b.push(s);if(f)for(a in f)(l=x[f[a]])&&(newStyle=l(wysihtml5.dom.getAttribute(t,a)),"string"==typeof newStyle&&w.push(newStyle));if("string"==typeof m&&"any"===m&&t.getAttribute("class"))if(v.classes_blacklist){for(S=t.getAttribute("class"),S&&(b=b.concat(S.split(g))),r=b.length;r>y;y++)o=b[y],v.classes_blacklist[o]||_.push(o);_.length&&(c.class=wysihtml5.lang.array(_).unique().join(" "))}else c.class=t.getAttribute("class");else{for(i||(m["_wysihtml5-temp-placeholder"]=1,m._rangySelectionBoundary=1,m["wysiwyg-tmp-selected-cell"]=1),S=t.getAttribute("class"),S&&(b=b.concat(S.split(g))),r=b.length;r>y;y++)o=b[y],m[o]&&_.push(o);_.length&&(c.class=wysihtml5.lang.array(_).unique().join(" "))}c.class&&i&&(c.class=c.class.replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(c.class)&&delete c.class),w.length&&(c.style=wysihtml5.lang.array(w).unique().join(" "));for(a in c)try{e.setAttribute(a,c[a])}catch(t){}c.src&&(void 0!==c.width&&e.setAttribute("width",c.width),void 0!==c.height&&e.setAttribute("height",c.height))}function d(t){var e,n=t.nextSibling;return n&&n.nodeType===wysihtml5.TEXT_NODE?void(n.data=t.data.replace(b,"")+n.data.replace(b,"")):(e=t.data.replace(b,""),t.ownerDocument.createTextNode(e))}function f(t){return v.comments?t.ownerDocument.createComment(t.nodeValue):void 0}var p={1:r,3:d,8:f},m="span",g=/\s+/,y={tags:{},classes:{}},v={},b=/\uFEFF/g,w={url:function(){var t=/^https?:\/\//i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),src:function(){var t=/^(\/|https?:\/\/)/i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),href:function(){var t=/^(#|\/|https?:\/\/|mailto:)/i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),alt:function(){var t=/[^ a-z0-9_\-]/gi;return function(e){return e?e.replace(t,""):""}}(),numbers:function(){var t=/\D/g;return function(e){return(e=(e||"").replace(t,""))||null}}(),any:function(){return function(t){return t}}()},x={align_text:function(){var t={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(e){return t[(e+"").toLowerCase()]}}()},C={align_img:function(){var t={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(e){return t[(e+"").toLowerCase()]}}(),align_text:function(){var t={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(e){return t[(e+"").toLowerCase()]}}(),clear_br:function(){var t={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(e){return t[(e+"").toLowerCase()]}}(),size_font:function(){var t={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(e){return t[(e+"").charAt(0)]}}()},_={has_visible_contet:function(){var t,e=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(n){if((t=(n.innerText||n.textContent).replace(/\s/g,""))&&t.length>0)return!0;for(var i=e.length;i--;)if(n.querySelector(e[i]))return!0;return!!(n.offsetWidth&&n.offsetWidth>0&&n.offsetHeight&&n.offsetHeight>0)}}()},S={unwrap:function(t){wysihtml5.dom.unwrap(t)},remove:function(t){t.parentNode.removeChild(t)}};return function(t,e){var r,o,s,a,l,c,h,u,d;for(wysihtml5.lang.object(v).merge(y).merge(e.rules).get(),r=e.context||t.ownerDocument||document,o=r.createDocumentFragment(),s="string"==typeof t,a=!1,!0===e.clearInternals&&(a=!0),l=s?wysihtml5.dom.getAsDom(t,r):t,v.selectors&&i(l,v.selectors);l.firstChild;)h=l.firstChild,c=n(h,e.cleanUp,a,e.uneditableClass),c&&o.appendChild(c),h!==c&&l.removeChild(h);if(e.unjoinNbsps)for(u=wysihtml5.dom.getTextNodes(o),d=u.length;d--;)u[d].nodeValue=u[d].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");return l.innerHTML="",l.appendChild(o),s?wysihtml5.quirks.getCorrectInnerHTML(l):l}(t,e)},wysihtml5.dom.removeEmptyTextNodes=function(t){for(var e,n=wysihtml5.lang.array(t.childNodes).get(),i=n.length,r=0;i>r;r++)e=n[r],e.nodeType===wysihtml5.TEXT_NODE&&""===e.data&&e.parentNode.removeChild(e)},wysihtml5.dom.renameElement=function(t,e){for(var n,i=t.ownerDocument.createElement(e);n=t.firstChild;)i.appendChild(n);return wysihtml5.dom.copyAttributes(["align","className"]).from(t).to(i),t.parentNode.replaceChild(i,t),i},wysihtml5.dom.replaceWithChildNodes=function(t){if(t.parentNode){if(!t.firstChild)return void t.parentNode.removeChild(t);for(var e=t.ownerDocument.createDocumentFragment();t.firstChild;)e.appendChild(t.firstChild);t.parentNode.replaceChild(e,t),t=e=null}},function(t){function e(e){return"block"===t.getStyle("display").from(e)}function n(t){return"BR"===t.nodeName}function i(t){var e=t.ownerDocument.createElement("br");t.appendChild(e)}function r(t,r){if(t.nodeName.match(/^(MENU|UL|OL)$/)){var o,s,a,l,c,h,u=t.ownerDocument,d=u.createDocumentFragment(),f=wysihtml5.dom.domNode(t).prev({ignoreBlankTexts:!0});if(r)for(!f||e(f)||n(f)||i(d);h=t.firstElementChild||t.firstChild;){for(s=h.lastChild;o=h.firstChild;)a=o===s,l=a&&!e(o)&&!n(o),d.appendChild(o),l&&i(d);h.parentNode.removeChild(h)}else for(;h=t.firstElementChild||t.firstChild;){if(h.querySelector&&h.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;o=h.firstChild;)d.appendChild(o);else{for(c=u.createElement("p");o=h.firstChild;)c.appendChild(o);d.appendChild(c)}h.parentNode.removeChild(h)}t.parentNode.replaceChild(d,t)}}t.resolveList=r}(wysihtml5.dom),function(t){var e=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],i=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],r=["referrer","write","open","close"];t.dom.Sandbox=Base.extend({constructor:function(e,n){this.callback=e||t.EMPTY_FUNCTION,this.config=t.lang.object({}).merge(n).get(),this.editableArea=this._createIframe()},insertInto:function(t){"string"==typeof t&&(t=e.getElementById(t)),t.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var t=this.getIframe();t.parentNode.removeChild(t)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,i=e.createElement("iframe");return i.className="wysihtml5-sandbox",t.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(i),t.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(i.src="javascript:'<html></html>'"),i.onload=function(){i.onreadystatechange=i.onload=null,n._onLoadIframe(i)},i.onreadystatechange=function(){/loaded|complete/.test(i.readyState)&&(i.onreadystatechange=i.onload=null,n._onLoadIframe(i))},i},_onLoadIframe:function(o){
var s,a,l,c,h,u,d;if(t.dom.contains(e.documentElement,o)){if(s=this,a=o.contentWindow,l=o.contentWindow.document,c=e.characterSet||e.charset||"utf-8",h=this._getHtml({charset:c,stylesheets:this.config.stylesheets}),l.open("text/html","replace"),l.write(h),l.close(),this.getWindow=function(){return o.contentWindow},this.getDocument=function(){return o.contentWindow.document},a.onerror=function(t,e,n){throw Error("wysihtml5.Sandbox: "+t,e,n)},!t.browser.supportsSandboxedIframes()){for(u=0,d=n.length;d>u;u++)this._unset(a,n[u]);for(u=0,d=i.length;d>u;u++)this._unset(a,i[u],t.EMPTY_FUNCTION);for(u=0,d=r.length;d>u;u++)this._unset(l,r[u]);this._unset(l,"cookie","",!0)}this.loaded=!0,setTimeout(function(){s.callback(s)},0)}},_getHtml:function(e){var n,i=e.stylesheets,r="",o=0;if(i="string"==typeof i?[i]:i)for(n=i.length;n>o;o++)r+='<link rel="stylesheet" href="'+i[o]+'">';return e.stylesheets=r,t.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(e)},_unset:function(e,n,i,r){try{e[n]=i}catch(t){}try{e.__defineGetter__(n,function(){return i})}catch(t){}if(r)try{e.__defineSetter__(n,function(){})}catch(t){}if(!t.browser.crashesWhenDefineProperty(n))try{var o={get:function(){return i}};r&&(o.set=function(){}),Object.defineProperty(e,n,o)}catch(t){}}})}(wysihtml5),function(t){var e=document;t.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(e,n,i){this.callback=e||t.EMPTY_FUNCTION,this.config=t.lang.object({}).merge(n).get(),this.element=i?this._bindElement(i):this._createElement()},_createElement:function(){var t=e.createElement("div");return t.className="wysihtml5-sandbox",this._loadElement(t),t},_bindElement:function(t){return t.className=t.className&&""!=t.className?t.className+" wysihtml5-sandbox":"wysihtml5-sandbox",this._loadElement(t,!0),t},_loadElement:function(t,e){var n,i=this;e||(n=this._getHtml(),t.innerHTML=n),this.getWindow=function(){return t.ownerDocument.defaultView},this.getDocument=function(){return t.ownerDocument},this.loaded=!0,setTimeout(function(){i.callback(i)},0)},_getHtml:function(){return""}})}(wysihtml5),function(){var t={className:"class"};wysihtml5.dom.setAttributes=function(e){return{on:function(n){for(var i in e)n.setAttribute(t[i]||i,e[i])}}}}(),wysihtml5.dom.setStyles=function(t){return{on:function(e){var n,i=e.style;if("string"==typeof t)return void(i.cssText+=";"+t);for(n in t)"float"===n?(i.cssFloat=t[n],i.styleFloat=t[n]):i[n]=t[n]}}},function(t){t.simulatePlaceholder=function(e,n,i){var r="placeholder",o=function(){var e=n.element.offsetWidth>0&&n.element.offsetHeight>0;n.hasPlaceholderSet()&&(n.clear(),n.element.focus(),e&&setTimeout(function(){var t=n.selection.getSelection();t.focusNode&&t.anchorNode||n.selection.selectNode(n.element.firstChild||n.element)},0)),n.placeholderSet=!1,t.removeClass(n.element,r)},s=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(i),t.addClass(n.element,r))};e.on("set_placeholder",s).on("unset_placeholder",o).on("focus:composer",o).on("paste:composer",o).on("blur:composer",s),s()}}(wysihtml5.dom),function(t){var e=document.documentElement;"textContent"in e?(t.setTextContent=function(t,e){t.textContent=e},t.getTextContent=function(t){return t.textContent}):"innerText"in e?(t.setTextContent=function(t,e){t.innerText=e},t.getTextContent=function(t){return t.innerText}):(t.setTextContent=function(t,e){t.nodeValue=e},t.getTextContent=function(t){return t.nodeValue})}(wysihtml5.dom),wysihtml5.dom.getAttribute=function(t,e){var n,i,r,o=!wysihtml5.browser.supportsGetAttributeCorrectly();return e=e.toLowerCase(),n=t.nodeName,"IMG"==n&&"src"==e&&!0===wysihtml5.dom.isLoadedImage(t)?t.src:o&&"outerHTML"in t?(i=t.outerHTML.toLowerCase(),r=-1!=i.indexOf(" "+e+"="),r?t.getAttribute(e):null):t.getAttribute(e)},wysihtml5.dom.getAttributes=function(t){var e,n=!wysihtml5.browser.supportsGetAttributeCorrectly(),i=t.nodeName,r=[];for(e in t.attributes)(t.attributes.hasOwnProperty&&t.attributes.hasOwnProperty(e)||!t.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t.attributes,e))&&t.attributes[e].specified&&("IMG"==i&&"src"==t.attributes[e].name.toLowerCase()&&!0===wysihtml5.dom.isLoadedImage(t)?r.src=t.src:wysihtml5.lang.array(["rowspan","colspan"]).contains(t.attributes[e].name.toLowerCase())&&n?1!==t.attributes[e].value&&(r[t.attributes[e].name]=t.attributes[e].value):r[t.attributes[e].name]=t.attributes[e].value);return r},wysihtml5.dom.isLoadedImage=function(t){try{return t.complete&&!t.mozMatchesSelector(":-moz-broken")}catch(e){if(t.complete&&"complete"===t.readyState)return!0}},function(t){function e(t,e){var n,i,r,o,s=[];for(i=0,r=t.length;r>i;i++)if(n=t[i].querySelectorAll(e))for(o=n.length;o--;s.unshift(n[o]));return s}function n(t){t.parentNode.removeChild(t)}function i(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function r(t,e){for(var n=t.nextSibling;1!=n.nodeType;)if(n=n.nextSibling,!e||e==n.tagName.toLowerCase())return n;return null}var o=t.dom,s=function(t){this.el=t,this.isColspan=!1,this.isRowspan=!1,this.firstCol=!0,this.lastCol=!0,this.firstRow=!0,this.lastRow=!0,this.isReal=!0,this.spanCollection=[],this.modified=!1},a=function(t,e){t?(this.cell=t,this.table=o.getParentElement(t,{nodeName:["TABLE"]})):e&&(this.table=e,this.cell=this.table.querySelectorAll("th, td")[0])};a.prototype={addSpannedCellToMap:function(t,e,n,i,r,o){var a,l,c=[],h=n+(o?parseInt(o,10)-1:0),u=i+(r?parseInt(r,10)-1:0);for(a=n;h>=a;a++)for(void 0===e[a]&&(e[a]=[]),l=i;u>=l;l++)e[a][l]=new s(t),e[a][l].isColspan=r&&parseInt(r,10)>1,e[a][l].isRowspan=o&&parseInt(o,10)>1,e[a][l].firstCol=l==i,e[a][l].lastCol=l==u,e[a][l].firstRow=a==n,e[a][l].lastRow=a==h,e[a][l].isReal=l==i&&a==n,e[a][l].spanCollection=c,c.push(e[a][l])},setCellAsModified:function(t){if(t.modified=!0,t.spanCollection.length>0)for(var e=0,n=t.spanCollection.length;n>e;e++)t.spanCollection[e].modified=!0},setTableMap:function(){var t,e,n,i,r,a,l,c,h=[],u=this.getTableRows();for(t=0;t<u.length;t++)for(e=u[t],n=this.getRowCells(e),a=0,void 0===h[t]&&(h[t]=[]),i=0;i<n.length;i++){for(r=n[i];void 0!==h[t][a];)a++;l=o.getAttribute(r,"colspan"),c=o.getAttribute(r,"rowspan"),l||c?(this.addSpannedCellToMap(r,h,t,a,l,c),a+=l?parseInt(l,10):1):(h[t][a]=new s(r),a++)}return this.map=h,h},getRowCells:function(n){var i=this.table.querySelectorAll("table"),r=i?e(i,"th, td"):[],o=n.querySelectorAll("th, td");return r.length>0?t.lang.array(o).without(r):o},getTableRows:function(){var n=this.table.querySelectorAll("table"),i=n?e(n,"tr"):[],r=this.table.querySelectorAll("tr");return i.length>0?t.lang.array(r).without(i):r},getMapIndex:function(t){var e,n,i=this.map.length,r=this.map&&this.map[0]?this.map[0].length:0;for(e=0;i>e;e++)for(n=0;r>n;n++)if(this.map[e][n].el===t)return{row:e,col:n};return!1},getElementAtIndex:function(t){return this.setTableMap(),this.map[t.row]&&this.map[t.row][t.col]&&this.map[t.row][t.col].el?this.map[t.row][t.col].el:null},getMapElsTo:function(t){var e,n,i,r,o,s,a=[];if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(t),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),null!=this.idx_start&&null!=this.idx_end)for(i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(o=this.idx_start.col,s=this.idx_end.col;s>=o;o++)a.push(this.map[i][o].el);return a},orderSelectionEnds:function(t){var e,n;return this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(t),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(t,e,n){var i,r,o,s=this.table.ownerDocument,a=s.createDocumentFragment();for(r=0;e>r;r++){if(i=s.createElement(t),n)for(o in n)n.hasOwnProperty(o)&&i.setAttribute(o,n[o]);i.appendChild(document.createTextNode(" ")),a.appendChild(i)}return a},correctColIndexForUnreals:function(t,e){var n,i=this.map[e],r=-1;for(n=0,t;t>n;n++)i[n].isReal&&r++;return r},getLastNewCellOnRow:function(t,e){var n,i,r,o,s=this.getRowCells(t);for(r=0,o=s.length;o>r;r++)if(n=s[r],!1===(i=this.getMapIndex(n))||void 0!==e&&i.row!=e)return n;return null},removeEmptyTable:function(){var t=this.table.querySelectorAll("td, th");return(!t||0==t.length)&&(n(this.table),!0)},splitRowToCells:function(t){var e,n,r;t.isColspan&&(e=parseInt(o.getAttribute(t.el,"colspan")||1,10),n=t.el.tagName.toLowerCase(),e>1&&(r=this.createCells(n,e-1),i(t.el,r)),t.el.removeAttribute("colspan"))},getRealRowEl:function(t,e){var n,i,r=null,s=null;for(e=e||this.idx,n=0,i=this.map[e.row].length;i>n;n++)if(s=this.map[e.row][n],s.isReal&&(r=o.getParentElement(s.el,{nodeName:["TR"]})))return r;return null===r&&t&&(r=o.getParentElement(this.map[e.row][e.col].el,{nodeName:["TR"]})||null),r},injectRowAt:function(t,e,n,r,s){var a,l,c=this.getRealRowEl(!1,{row:t,col:e}),h=this.createCells(r,n);c?(a=this.correctColIndexForUnreals(e,t),a>=0?i(this.getRowCells(c)[a],h):c.insertBefore(h,c.firstChild)):(l=this.table.ownerDocument.createElement("tr"),l.appendChild(h),i(o.getParentElement(s.el,{nodeName:["TR"]}),l))},canMerge:function(t){var e,n,i,r,o,s;for(this.to=t,this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(this.to),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(o=this.idx_start.col,s=this.idx_end.col;s>=o;o++)if(this.map[i][o].isColspan||this.map[i][o].isRowspan)return!1;return!0},decreaseCellSpan:function(t,e){var n=parseInt(o.getAttribute(t.el,e),10)-1;n>=1?t.el.setAttribute(e,n):(t.el.removeAttribute(e),"colspan"==e&&(t.isColspan=!1),"rowspan"==e&&(t.isRowspan=!1),t.firstCol=!0,t.lastCol=!0,t.firstRow=!0,t.lastRow=!0,t.isReal=!0)},removeSurplusLines:function(){var t,e,i,r,s,a,l,c;if(this.setTableMap(),this.map){for(i=0,r=this.map.length;r>i;i++){for(t=this.map[i],l=!0,s=0,a=t.length;a>s;s++)if(e=t[s],!(o.getAttribute(e.el,"rowspan")&&parseInt(o.getAttribute(e.el,"rowspan"),10)>1&&!0!==e.firstRow)){l=!1;break}if(l)for(s=0;a>s;s++)this.decreaseCellSpan(t[s],"rowspan")}for(c=this.getTableRows(),i=0,r=c.length;r>i;i++)t=c[i],0==t.childNodes.length&&/^\s*$/.test(t.textContent||t.innerText)&&n(t)}},fillMissingCells:function(){var t,e,n,r=0,o=0,a=null;if(this.setTableMap(),this.map){for(r=this.map.length,t=0;r>t;t++)this.map[t].length>o&&(o=this.map[t].length);for(e=0;r>e;e++)for(n=0;o>n;n++)this.map[e]&&!this.map[e][n]&&n>0&&(this.map[e][n]=new s(this.createCells("td",1)),(a=this.map[e][n-1])&&a.el&&a.el.parent&&i(this.map[e][n-1].el,this.map[e][n].el))}},rectify:function(){return!this.removeEmptyTable()&&(this.removeSurplusLines(),this.fillMissingCells(),!0)},unmerge:function(){var t,e,n,i,r,s;if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx)){if(t=this.map[this.idx.row][this.idx.col],e=o.getAttribute(t.el,"colspan")?parseInt(o.getAttribute(t.el,"colspan"),10):1,n=t.el.tagName.toLowerCase(),t.isRowspan){if((i=parseInt(o.getAttribute(t.el,"rowspan"),10))>1)for(r=1,s=i-1;s>=r;r++)this.injectRowAt(this.idx.row+r,this.idx.col,e,n,t);t.el.removeAttribute("rowspan")}this.splitRowToCells(t)}},merge:function(t){var e,i,r,o,s,a;if(this.rectify())if(this.canMerge(t)){for(e=this.idx_end.row-this.idx_start.row+1,i=this.idx_end.col-this.idx_start.col+1,r=this.idx_start.row,o=this.idx_end.row;o>=r;r++)for(s=this.idx_start.col,a=this.idx_end.col;a>=s;s++)r==this.idx_start.row&&s==this.idx_start.col?(e>1&&this.map[r][s].el.setAttribute("rowspan",e),i>1&&this.map[r][s].el.setAttribute("colspan",i)):(/^\s*<br\/?>\s*$/.test(this.map[r][s].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[r][s].el.innerHTML),n(this.map[r][s].el));this.rectify()}else window.console},collapseCellToNextRow:function(t){var e,n,r,s=this.getMapIndex(t.el),a=s.row+1,l={row:a,col:s.col};a<this.map.length&&null!==(e=this.getRealRowEl(!1,l))&&(n=this.correctColIndexForUnreals(l.col,l.row),n>=0?i(this.getRowCells(e)[n],t.el):(r=this.getLastNewCellOnRow(e,a),null!==r?i(r,t.el):e.insertBefore(t.el,e.firstChild)),parseInt(o.getAttribute(t.el,"rowspan"),10)>2?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)-1):t.el.removeAttribute("rowspan"))},removeRowCell:function(t){t.isReal?t.isRowspan?this.collapseCellToNextRow(t):n(t.el):parseInt(o.getAttribute(t.el,"rowspan"),10)>2?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)-1):t.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var t,e,n,i=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(t=this.map[this.idx.row],e=0,n=t.length;n>e;e++)t[e].isReal&&i.push(t[e].el);return i},getColumnElementsByCell:function(){var t,e,n=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(t=0,e=this.map.length;e>t;t++)this.map[t][this.idx.col]&&this.map[t][this.idx.col].isReal&&n.push(this.map[t][this.idx.col].el);return n},removeRow:function(){var t,e,i,r=o.getParentElement(this.cell,{nodeName:["TR"]});if(r){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(t=this.map[this.idx.row],e=0,i=t.length;i>e;e++)t[e].modified||(this.setCellAsModified(t[e]),this.removeRowCell(t[e]));n(r)}},removeColCell:function(t){t.isColspan?parseInt(o.getAttribute(t.el,"colspan"),10)>2?t.el.setAttribute("colspan",parseInt(o.getAttribute(t.el,"colspan"),10)-1):t.el.removeAttribute("colspan"):t.isReal&&n(t.el)},removeColumn:function(){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=0,e=this.map.length;e>t;t++)this.map[t][this.idx.col].modified||(this.setCellAsModified(this.map[t][this.idx.col]),this.removeColCell(this.map[t][this.idx.col]))},remove:function(t){if(this.rectify()){switch(t){case"row":this.removeRow();break;case"column":this.removeColumn()}this.rectify()}},addRow:function(t){var e,n,r,s,a,l=this.table.ownerDocument;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"below"==t&&o.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(o.getAttribute(this.cell,"rowspan"),10)-1),!1!==this.idx){for(e=this.map[this.idx.row],n=l.createElement("tr"),r=0,s=e.length;s>r;r++)e[r].modified||(this.setCellAsModified(e[r]),this.addRowCell(e[r],n,t));switch(t){case"below":i(this.getRealRowEl(!0),n);break;case"above":(a=o.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]}))&&a.parentNode.insertBefore(n,a)}}},addRowCell:function(t,e,n){var i=t.isColspan?{colspan:o.getAttribute(t.el,"colspan")}:null;t.isReal?"above"!=n&&t.isRowspan?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)+1):e.appendChild(this.createCells("td",1,i)):"above"!=n&&t.isRowspan&&t.lastRow?e.appendChild(this.createCells("td",1,i)):c.isRowspan&&t.el.attr("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)+1)},add:function(t){this.rectify()&&(("below"==t||"above"==t)&&this.addRow(t),("before"==t||"after"==t)&&this.addColumn(t))},addColCell:function(t,e,n){var r,s=t.el.tagName.toLowerCase();switch(n){case"before":r=!t.isColspan||t.firstCol;break;case"after":r=!t.isColspan||t.lastCol||t.isColspan&&c.el==this.cell}if(r){switch(n){case"before":t.el.parentNode.insertBefore(this.createCells(s,1),t.el);break;case"after":i(t.el,this.createCells(s,1))}t.isRowspan&&this.handleCellAddWithRowspan(t,e+1,n)}else t.el.setAttribute("colspan",parseInt(o.getAttribute(t.el,"colspan"),10)+1)},addColumn:function(t){var e,n,i,r;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"after"==t&&o.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(o.getAttribute(this.cell,"colspan"),10)-1),!1!==this.idx)for(i=0,r=this.map.length;r>i;i++)e=this.map[i],e[this.idx.col]&&(n=e[this.idx.col],n.modified||(this.setCellAsModified(n),this.addColCell(n,i,t)))},handleCellAddWithRowspan:function(t,e,n){var s,a,l,c,h=parseInt(o.getAttribute(this.cell,"rowspan"),10)-1,u=o.getParentElement(t.el,{nodeName:["TR"]}),d=t.el.tagName.toLowerCase(),f=this.table.ownerDocument;for(c=0;h>c;c++)if(s=this.correctColIndexForUnreals(this.idx.col,e+c),u=r(u,"tr"))if(s>0)switch(n){case"before":a=this.getRowCells(u),s>0&&this.map[e+c][this.idx.col].el!=a[s]&&s==a.length-1?i(a[s],this.createCells(d,1)):a[s].parentNode.insertBefore(this.createCells(d,1),a[s]);break;case"after":i(this.getRowCells(u)[s],this.createCells(d,1))}else u.insertBefore(this.createCells(d,1),u.firstChild);else l=f.createElement("tr"),l.appendChild(this.createCells(d,1)),this.table.appendChild(l)}},o.table={getCellsBetween:function(t,e){return new a(t).getMapElsTo(e)},addCells:function(t,e){new a(t).add(e)},removeCells:function(t,e){new a(t).remove(e)},mergeCellsBetween:function(t,e){new a(t).merge(e)},unmergeCell:function(t){new a(t).unmerge()},orderSelectionEnds:function(t,e){return new a(t).orderSelectionEnds(e)},indexOf:function(t){var e=new a(t);return e.setTableMap(),e.getMapIndex(t)},findCell:function(t,e){return new a(null,t).getElementAtIndex(e)},findRowByCell:function(t){return new a(t).getRowElementsByCell()},findColumnByCell:function(t){return new a(t).getColumnElementsByCell()},canMerge:function(t,e){return new a(t).canMerge(e)}}}(wysihtml5),wysihtml5.dom.query=function(t,e){var n,i,r,o,s=[];for(t.nodeType&&(t=[t]),i=0,r=t.length;r>i;i++)if(n=t[i].querySelectorAll(e))for(o=n.length;o--;s.unshift(n[o]));return s},wysihtml5.dom.compareDocumentPosition=function(){return document.documentElement.compareDocumentPosition?function(t,e){return t.compareDocumentPosition(e)}:function(t,e){var n,i,r,o,s,a,l,c,h;if(n=9===t.nodeType?t:t.ownerDocument,i=9===e.nodeType?e:e.ownerDocument,t===e)return 0;if(t===e.ownerDocument)return 20;if(t.ownerDocument===e)return 10;if(n!==i)return 1;if(2===t.nodeType&&t.childNodes&&-1!==wysihtml5.lang.array(t.childNodes).indexOf(e))return 20;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml5.lang.array(e.childNodes).indexOf(t))return 10;for(r=t,o=[],s=null;r;){if(r==e)return 10;o.push(r),r=r.parentNode}for(r=e,s=null;r;){if(r==t)return 20;if(-1!==(a=wysihtml5.lang.array(o).indexOf(r)))return l=o[a],c=wysihtml5.lang.array(l.childNodes).indexOf(o[a-1]),h=wysihtml5.lang.array(l.childNodes).indexOf(s),c>h?2:4;s=r,r=r.parentNode}return 1}}(),wysihtml5.dom.unwrap=function(t){if(t.parentNode){for(;t.lastChild;)wysihtml5.dom.insert(t.lastChild).after(t);t.parentNode.removeChild(t)}},wysihtml5.dom.getPastedHtml=function(t){var e;return t.clipboardData&&(wysihtml5.lang.array(t.clipboardData.types).contains("text/html")?e=t.clipboardData.getData("text/html"):wysihtml5.lang.array(t.clipboardData.types).contains("text/plain")&&(e=wysihtml5.lang.string(t.clipboardData.getData("text/plain")).escapeHTML(!0,!0))),e},wysihtml5.dom.getPastedHtmlWithDiv=function(t,e){var n=t.selection.getBookmark(),i=t.element.ownerDocument,r=i.createElement("DIV");i.body.appendChild(r),r.style.width="1px",r.style.height="1px",r.style.overflow="hidden",r.setAttribute("contenteditable","true"),r.focus(),setTimeout(function(){t.selection.setBookmark(n),e(r.innerHTML),r.parentNode.removeChild(r)},0)},wysihtml5.quirks.cleanPastedHTML=function(){var t=function(t){var e=wysihtml5.lang.string(t).trim(),n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return RegExp("^((?!^"+n+"$).)*$","i")},e=function(e,n){var i,r,o=wysihtml5.lang.object(e).clone(!0);for(i in o.tags)if(o.tags.hasOwnProperty(i)&&o.tags[i].keep_styles)for(r in o.tags[i].keep_styles)o.tags[i].keep_styles.hasOwnProperty(r)&&n[r]&&(o.tags[i].keep_styles[r]=t(n[r]));return o},n=function(t,e){var n,i,r;if(!t)return null;for(i=0,r=t.length;r>i;i++)if(t[i].condition||(n=t[i].set),t[i].condition&&t[i].condition.test(e))return t[i].set;return n};return function(t,i){var r={color:wysihtml5.dom.getStyle("color").from(i.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(i.referenceNode)},o=e(n(i.rules,t)||{},r);return wysihtml5.dom.parse(t,{rules:o,cleanUp:!0,context:i.referenceNode.ownerDocument,uneditableClass:i.uneditableClass,clearInternals:!0,unjoinNbsps:!0})}}(),wysihtml5.quirks.ensureProperClearing=function(){var t=function(){var t=this;setTimeout(function(){var e=t.innerHTML.toLowerCase();("<p>&nbsp;</p>"==e||"<p>&nbsp;</p><p>&nbsp;</p>"==e)&&(t.innerHTML="")},0)};return function(e){wysihtml5.dom.observe(e.element,["cut","keydown"],t)}}(),function(t){t.quirks.getCorrectInnerHTML=function(e){var n,i,r,o,s,a=e.innerHTML;if(-1===a.indexOf("%7E"))return a;for(n=e.querySelectorAll("[href*='~'], [src*='~']"),s=0,o=n.length;o>s;s++)i=n[s].href||n[s].src,r=t.lang.string(i).replace("~").by("%7E"),a=t.lang.string(a).replace(r).by(i);return a}}(wysihtml5),function(t){var e="wysihtml5-quirks-redraw";t.quirks.redraw=function(n){t.dom.addClass(n,e),t.dom.removeClass(n,e);try{var i=n.ownerDocument;i.execCommand("italic",!1,null),i.execCommand("italic",!1,null)}catch(t){}}}(wysihtml5),wysihtml5.quirks.tableCellsSelection=function(t,e){function n(n){h.start=n,h.end=n,h.cells=[n],h.table=c.getParentElement(h.start,{nodeName:["TABLE"]}),h.table&&(i(),c.addClass(n,u),d=c.observe(t,"mousemove",o),f=c.observe(t,"mouseup",s),e.fire("tableselectstart").fire("tableselectstart:composer"))}function i(){var e,n;if(t&&(e=t.querySelectorAll("."+u),e.length>0))for(n=0;n<e.length;n++)c.removeClass(e[n],u)}function r(t){for(var e=0;e<t.length;e++)c.addClass(t[e],u)}function o(t){var n,o=null,s=c.getParentElement(t.target,{nodeName:["TD","TH"]});s&&h.table&&h.start&&(o=c.getParentElement(s,{nodeName:["TABLE"]}))&&o===h.table&&(i(),n=h.end,h.end=s,h.cells=c.table.getCellsBetween(h.start,s),h.cells.length>1&&e.composer.selection.deselect(),r(h.cells),h.end!==n&&e.fire("tableselectchange").fire("tableselectchange:composer"))}function s(){d.stop(),f.stop(),e.fire("tableselect").fire("tableselect:composer"),setTimeout(function(){a()},0)}function a(){var n=c.observe(t.ownerDocument,"click",function(t){n.stop(),c.getParentElement(t.target,{nodeName:["TABLE"]})!=h.table&&(i(),h.table=null,h.start=null,h.end=null,e.fire("tableunselect").fire("tableunselect:composer"))})}function l(t,n){h.start=t,h.end=n,h.table=c.getParentElement(h.start,{nodeName:["TABLE"]}),selectedCells=c.table.getCellsBetween(h.start,h.end),r(selectedCells),a(),e.fire("tableselect").fire("tableselect:composer")}var c=wysihtml5.dom,h={table:null,start:null,end:null,cells:null,select:l},u="wysiwyg-tmp-selected-cell",d=null,f=null;return function(){return c.observe(t,"mousedown",function(t){var e=wysihtml5.dom.getParentElement(t.target,{nodeName:["TD","TH"]});e&&n(e)}),h}()},function(t){var e=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,n=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,i=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,o=function(t){return RegExp("(^|\\s|;)"+t+"\\s*:\\s*[^;$]+","gi")};t.quirks.styleParser={parseColor:function(s,a){var l,c,h,u=o(a),d=s.match(u),f=10;if(d){for(h=d.length;h--;)d[h]=t.lang.string(d[h].split(":")[1]).trim();if(l=d[d.length-1],e.test(l))c=l.match(e);else if(n.test(l))c=l.match(n);else if(i.test(l))c=l.match(i),f=16;else if(r.test(l))return c=l.match(r),c.shift(),c.push(1),t.lang.array(c).map(function(t,e){return 3>e?16*parseInt(t,16)+parseInt(t,16):parseFloat(t)});if(c)return c.shift(),c[3]||c.push(1),t.lang.array(c).map(function(t,e){return 3>e?parseInt(t,f):parseFloat(t)})}return!1},unparseColor:function(t,e){if(e){if("hex"==e)return t[0].toString(16).toUpperCase()+t[1].toString(16).toUpperCase()+t[2].toString(16).toUpperCase();if("hash"==e)return"#"+t[0].toString(16).toUpperCase()+t[1].toString(16).toUpperCase()+t[2].toString(16).toUpperCase();if("rgb"==e)return"rgb("+t[0]+","+t[1]+","+t[2]+")";if("rgba"==e)return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")";if("csv"==e)return t[0]+","+t[1]+","+t[2]+","+t[3]}return t[3]&&1!==t[3]?"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")":"rgb("+t[0]+","+t[1]+","+t[2]+")"},parseFontSize:function(e){var n=e.match(o("font-size"));return!!n&&t.lang.string(n[n.length-1].split(":")[1]).trim()}}}(wysihtml5),function(t){function e(t){var e=0;if(t.parentNode)do{e+=t.offsetTop||0,t=t.offsetParent}while(t);return e}function n(t,e){for(var n=0;e!==t;)if(n++,!(e=e.parentNode))throw Error("not a descendant of ancestor!");return n}function i(t){if(!t.canSurroundContents())for(var e=t.commonAncestorContainer,i=n(e,t.startContainer),r=n(e,t.endContainer);!t.canSurroundContents();)i>r?(t.setStartBefore(t.startContainer),i=n(e,t.startContainer)):(t.setEndAfter(t.endContainer),r=n(e,t.endContainer))}var r=t.dom;t.Selection=Base.extend({constructor:function(t,e,n){window.rangy.init(),this.editor=t,this.composer=t.composer,this.doc=this.composer.doc,this.contain=e,this.unselectableClass=n||!1},getBookmark:function(){var t=this.getRange();return t&&i(t),t&&t.cloneRange()},setBookmark:function(t){t&&this.setSelection(t)},setBefore:function(t){var e=rangy.createRange(this.doc);return e.setStartBefore(t),e.setEndBefore(t),this.setSelection(e)},setAfter:function(t){var e=rangy.createRange(this.doc);return e.setStartAfter(t),e.setEndAfter(t),this.setSelection(e)},selectNode:function(e,n){var i=rangy.createRange(this.doc),o=e.nodeType===t.ELEMENT_NODE,s="canHaveHTML"in e?e.canHaveHTML:"IMG"!==e.nodeName,a=o?e.innerHTML:e.data,l=""===a||a===t.INVISIBLE_SPACE,c=r.getStyle("display").from(e),h="block"===c||"list-item"===c;if(l&&o&&s&&!n)try{e.innerHTML=t.INVISIBLE_SPACE}catch(t){}s?i.selectNodeContents(e):i.selectNode(e),s&&l&&o?i.collapse(h):s&&l&&(i.setStartAfter(e),i.setEndAfter(e)),this.setSelection(i)},getSelectedNode:function(t){var e,n;return t&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange())&&n.length?n.item(0):(e=this.getSelection(this.doc),e.focusNode===e.anchorNode?e.focusNode:(n=this.getRange(this.doc),n?n.commonAncestorContainer:this.doc.body))},fixSelBorders:function(){var t=this.getRange();i(t),this.setSelection(t)},getSelectedOwnNodes:function(){var t,e,n=this.getOwnRanges(),i=[];for(t=0,e=n.length;e>t;t++)i.push(n[t].commonAncestorContainer||this.doc.body);return i},findNodesInSelection:function(e){var n,i,r,o=this.getOwnRanges(),s=[];for(i=0,r=o.length;r>i;i++)n=o[i].getNodes([1],function(n){return t.lang.array(e).contains(n.nodeName)}),s=s.concat(n);return s},containsUneditable:function(){var t,e,n=this.getOwnUneditables(),i=this.getSelection();for(t=0,e=n.length;e>t;t++)if(i.containsNode(n[t]))return!0;return!1},deleteContents:function(){var t,e=this.getOwnRanges();for(t=e.length;t--;)e[t].deleteContents();this.setSelection(e[0])},getPreviousNode:function(e,n){var i,r,o;return e||(i=this.getSelection(),e=i.anchorNode),e!==this.contain&&((r=e.previousSibling)!==this.contain&&(r&&3!==r.nodeType&&1!==r.nodeType?r=this.getPreviousNode(r,n):r&&3===r.nodeType&&/^\s*$/.test(r.textContent)?r=this.getPreviousNode(r,n):n&&r&&1===r.nodeType&&!t.lang.array(["BR","HR","IMG"]).contains(r.nodeName)&&/^[\s]*$/.test(r.innerHTML)?r=this.getPreviousNode(r,n):r||e===this.contain||(o=e.parentNode)!==this.contain&&(r=this.getPreviousNode(o,n)),r!==this.contain&&r))},getSelectionParentsByTag:function(){var e,n,i,r=this.getSelectedOwnNodes(),o=[];for(n=0,i=r.length;i>n;n++)(e=r[n].nodeName&&"LI"===r[n].nodeName?r[n]:t.dom.getParentElement(r[n],{nodeName:["LI"]},!1,this.contain))&&o.push(e);return o.length?o:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var t=this.getRange(),e=t.startContainer,n=t.startOffset,i=rangy.createRange(this.doc);return i.selectNodeContents(e),i.setStart(e,n),i}},caretIsLastInSelection:function(){return/^\s*$/.test((rangy.createRange(this.doc),this.getSelection(),this.getRangeToNodeEnd().cloneContents()).textContent)},caretIsFirstInSelection:function(){var e=rangy.createRange(this.doc),n=this.getSelection(),i=this.getRange(),r=i.startContainer;return r.nodeType===t.TEXT_NODE?this.isCollapsed()&&r.nodeType===t.TEXT_NODE&&/^\s*$/.test(r.data.substr(0,i.startOffset)):(e.selectNodeContents(this.getRange().commonAncestorContainer),e.collapse(!0),this.isCollapsed()&&(e.startContainer===n.anchorNode||e.endContainer===n.anchorNode)&&e.startOffset===n.anchorOffset)},caretIsInTheBeginnig:function(e){var n=this.getSelection(),i=n.anchorNode,r=n.anchorOffset;return e?0===r&&(i.nodeName&&i.nodeName===e.toUpperCase()||t.dom.getParentElement(i.parentNode,{nodeName:e},1)):0===r&&!this.getPreviousNode(i,!0)},caretIsBeforeUneditable:function(){var t,e,n,i,r=this.getSelection(),o=r.anchorNode;if(0===r.anchorOffset&&(t=this.getPreviousNode(o,!0)))for(e=this.getOwnUneditables(),n=0,i=e.length;i>n;n++)if(t===e[n])return e[n];return!1},executeAndRestoreRangy:function(t){var e=this.doc.defaultView||this.doc.parentWindow,n=rangy.saveSelection(e);if(n)try{t()}catch(t){setTimeout(function(){throw t},0)}else t();rangy.restoreSelection(n)},executeAndRestore:function(e,n){var i,o,s,a,l,c,h,u,d,f=this.doc.body,p=n&&f.scrollTop,m=n&&f.scrollLeft,g="_wysihtml5-temp-placeholder",y='<span class="'+g+'">'+t.INVISIBLE_SPACE+"</span>",v=this.getRange(!0);if(!v)return void e(f,f);v.collapsed||(h=v.cloneRange(),c=h.createContextualFragment(y),h.collapse(!1),h.insertNode(c),h.detach()),l=v.createContextualFragment(y),v.insertNode(l),c&&(i=this.contain.querySelectorAll("."+g),v.setStartBefore(i[0]),v.setEndAfter(i[i.length-1])),this.setSelection(v);try{e(v.startContainer,v.endContainer)}catch(t){setTimeout(function(){throw t},0)}if((i=this.contain.querySelectorAll("."+g))&&i.length)for(u=rangy.createRange(this.doc),s=i[0].nextSibling,i.length>1&&(a=i[i.length-1].previousSibling),a&&s?(u.setStartBefore(s),u.setEndAfter(a)):(o=this.doc.createTextNode(t.INVISIBLE_SPACE),r.insert(o).after(i[0]),u.setStartBefore(o),u.setEndAfter(o)),this.setSelection(u),d=i.length;d--;)i[d].parentNode.removeChild(i[d]);else this.contain.focus();n&&(f.scrollTop=p,f.scrollLeft=m);try{i.parentNode.removeChild(i)}catch(t){}},set:function(t,e){var n=rangy.createRange(this.doc);n.setStart(t,e||0),this.setSelection(n)},insertHTML:function(t){var e,n=(rangy.createRange(this.doc),this.doc.createElement("DIV")),i=this.doc.createDocumentFragment();for(n.innerHTML=t,e=n.lastChild;n.firstChild;)i.appendChild(n.firstChild);this.insertNode(i),e&&this.setAfter(e)},insertNode:function(t){var e=this.getRange();e&&e.insertNode(t)},surround:function(t){var e,n,i=this.getOwnRanges(),r=[];if(0==i.length)return r;for(n=i.length;n--;){e=this.doc.createElement(t.nodeName),r.push(e),t.className&&(e.className=t.className),t.cssStyle&&e.setAttribute("style",t.cssStyle);try{i[n].surroundContents(e),this.selectNode(e)}catch(t){e.appendChild(i[n].extractContents()),i[n].insertNode(e)}}return r},deblockAndSurround:function(e){var n,i,r,o=this.doc.createElement("div"),s=rangy.createRange(this.doc);if(o.className=e.className,this.composer.commands.exec("formatBlock",e.nodeName,e.className),n=this.contain.querySelectorAll("."+e.className),n[0])for(n[0].parentNode.insertBefore(o,n[0]),s.setStartBefore(n[0]),s.setEndAfter(n[n.length-1]),i=s.extractContents();i.firstChild;)if(r=i.firstChild,1==r.nodeType&&t.dom.hasClass(r,e.className)){
for(;r.firstChild;)o.appendChild(r.firstChild);"BR"!==r.nodeName&&o.appendChild(this.doc.createElement("br")),i.removeChild(r)}else o.appendChild(r);else o=null;return o},scrollIntoView:function(){var n,i=this.doc,r=i.documentElement.scrollHeight>i.documentElement.offsetHeight,o=i._wysihtml5ScrollIntoViewElement=i._wysihtml5ScrollIntoViewElement||function(){var e=i.createElement("span");return e.innerHTML=t.INVISIBLE_SPACE,e}();r&&(this.insertNode(o),n=e(o),o.parentNode.removeChild(o),n>=i.body.scrollTop+i.documentElement.offsetHeight-5&&(i.body.scrollTop=n))},selectLine:function(){t.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var t=this.doc.defaultView,e=t.getSelection();e.modify("move","left","lineboundary"),e.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var t,e,n,i,r,o=this.doc.selection.createRange(),s=o.boundingTop,a=this.doc.body.scrollWidth;if(o.moveToPoint){for(0===s&&(n=this.doc.createElement("span"),this.insertNode(n),s=n.offsetTop,n.parentNode.removeChild(n)),s+=1,i=-10;a>i;i+=2)try{o.moveToPoint(i,s);break}catch(t){}for(t=s,e=this.doc.selection.createRange(),r=a;r>=0;r--)try{e.moveToPoint(r,t);break}catch(t){}o.setEndPoint("EndToEnd",e),o.select()}},getText:function(){var t=this.getSelection();return t?""+t:""},getNodes:function(t,e){var n=this.getRange();return n?n.getNodes([t],e):[]},fixRangeOverflow:function(t){var e,n;this.contain&&this.contain.firstChild&&t&&(e=t.compareNode(this.contain),2!==e?(1===e&&t.setStartBefore(this.contain.firstChild),0===e&&t.setEndAfter(this.contain.lastChild),3===e&&(t.setStartBefore(this.contain.firstChild),t.setEndAfter(this.contain.lastChild))):this._detectInlineRangeProblems(t)&&(n=t.endContainer.previousElementSibling)&&t.setEnd(n,this._endOffsetForNode(n)))},_endOffsetForNode:function(t){var e=document.createRange();return e.selectNodeContents(t),e.endOffset},_detectInlineRangeProblems:function(t){var e=r.compareDocumentPosition(t.startContainer,t.endContainer);return 0==t.endOffset&&4&e},getRange:function(t){var e=this.getSelection(),n=e&&e.rangeCount&&e.getRangeAt(0);return!0!==t&&this.fixRangeOverflow(n),n},getOwnUneditables:function(){var e=r.query(this.contain,"."+this.unselectableClass),n=r.query(e,"."+this.unselectableClass);return t.lang.array(e).without(n)},getOwnRanges:function(){var t,e,n,i,r,o,s,a=[],l=this.getRange();if(l&&a.push(l),this.unselectableClass&&this.contain&&l&&(e=this.getOwnUneditables(),e.length>0))for(i=0,r=e.length;r>i;i++)for(t=[],o=0,s=a.length;s>o;o++){if(a[o])switch(a[o].compareNode(e[i])){case 2:break;case 3:n=a[o].cloneRange(),n.setEndBefore(e[i]),t.push(n),n=a[o].cloneRange(),n.setStartAfter(e[i]),t.push(n);break;default:t.push(a[o])}a=t}return a},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(t){var e=this.doc.defaultView||this.doc.parentWindow;return rangy.getSelection(e).setSingleRange(t)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},isEndToEndInNode:function(e){var n=this.getRange(),i=n.commonAncestorContainer,r=n.startContainer,o=n.endContainer;if(i.nodeType===t.TEXT_NODE&&(i=i.parentNode),r.nodeType===t.TEXT_NODE&&!/^\s*$/.test(r.data.substr(n.startOffset)))return!1;if(o.nodeType===t.TEXT_NODE&&!/^\s*$/.test(o.data.substr(n.endOffset)))return!1;for(;r&&r!==i;){if(r.nodeType!==t.TEXT_NODE&&!t.dom.contains(i,r))return!1;if(t.dom.domNode(r).prev({ignoreBlankTexts:!0}))return!1;r=r.parentNode}for(;o&&o!==i;){if(o.nodeType!==t.TEXT_NODE&&!t.dom.contains(i,o))return!1;if(t.dom.domNode(o).next({ignoreBlankTexts:!0}))return!1;o=o.parentNode}return!!t.lang.array(e).contains(i.nodeName)&&i},deselect:function(){var t=this.getSelection();t&&t.removeAllRanges()}})}(wysihtml5),function(t,e){function n(t,e,n){if(!t.className)return!1;var i=t.className.match(n)||[];return i[i.length-1]===e}function i(t,e){return!(!t.getAttribute||!t.getAttribute("style"))&&(t.getAttribute("style").match(e),!!t.getAttribute("style").match(e))}function r(t,e,n){t.getAttribute("style")?(a(t,n),t.getAttribute("style")&&!/^\s*$/.test(t.getAttribute("style"))?t.setAttribute("style",e+";"+t.getAttribute("style")):t.setAttribute("style",e)):t.setAttribute("style",e)}function o(t,e,n){t.className?(s(t,n),t.className+=" "+e):t.className=e}function s(t,e){t.className&&(t.className=t.className.replace(e,""))}function a(t,e){var n,i,r=[];if(t.getAttribute("style")){for(n=t.getAttribute("style").split(";"),i=n.length;i--;)n[i].match(e)||/^\s*$/.test(n[i])||r.push(n[i]);r.length?t.setAttribute("style",r.join(";")):t.removeAttribute("style")}}function l(t,e){var n,i,r,o=[],s=e.split(";"),a=t.getAttribute("style");if(a){for(a=a.replace(/\s/gi,"").toLowerCase(),o.push(RegExp("(^|\\s|;)"+e.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi")),n=s.length;n-- >0;)/^\s*$/.test(s[n])||o.push(RegExp("(^|\\s|;)"+s[n].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(i=0,r=o.length;r>i;i++)if(a.match(o[i]))return o[i]}return!1}function c(n,i,r,o){return r?l(n,r):o?t.dom.hasClass(n,o):e.dom.arrayContains(i,n.tagName.toLowerCase())}function h(t,e,n,i){for(var r=t.length;r--;)if(!c(t[r],e,n,i))return!1;return!!t.length}function u(t,e,n){var i=l(t,e);return i?(a(t,i),"remove"):(r(t,e,n),"change")}function d(t,e){return t.className.replace(w," ")==e.className.replace(w," ")}function f(t){for(var e=t.parentNode;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}function p(t,e){if(t.attributes.length!=e.attributes.length)return!1;for(var n,i,r,o=0,s=t.attributes.length;s>o;++o)if(n=t.attributes[o],"class"!=(r=n.name)){if(i=e.attributes.getNamedItem(r),n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function m(t,n){return e.dom.isCharacterDataNode(t)?0==n?!!t.previousSibling:n!=t.length||!!t.nextSibling:n>0&&n<t.childNodes.length}function g(t,n,i,r){var o,s;if(e.dom.isCharacterDataNode(n)&&(0==i?(i=e.dom.getNodeIndex(n),n=n.parentNode):i==n.length?(i=e.dom.getNodeIndex(n)+1,n=n.parentNode):o=e.dom.splitDataNode(n,i)),!(o||r&&n===r)){for(o=n.cloneNode(!1),o.id&&o.removeAttribute("id");s=n.childNodes[i];)o.appendChild(s);e.dom.insertAfter(o,n)}return n==t?o:g(t,o.parentNode,e.dom.getNodeIndex(o),r)}function y(e){this.isElementMerge=e.nodeType==t.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?e.lastChild:e,this.textNodes=[this.firstTextNode]}function v(t,e,n,i,r,o,s){this.tagNames=t||[b],this.cssClass=e||!1!==e&&"",this.similarClassRegExp=n,this.cssStyle=r||"",this.similarStyleRegExp=o,this.normalize=i,this.applyToAnyTagName=!1,this.container=s}var b="span",w=/\s+/g;y.prototype={doMerge:function(){var t,e,n,i,r,o=[];for(i=0,r=this.textNodes.length;r>i;++i)t=this.textNodes[i],e=t.parentNode,o[i]=t.data,i&&(e.removeChild(t),e.hasChildNodes()||e.parentNode.removeChild(e));return this.firstTextNode.data=n=o.join(""),n},getLength:function(){for(var t=this.textNodes.length,e=0;t--;)e+=this.textNodes[t].length;return e},toString:function(){var t,e,n=[];for(t=0,e=this.textNodes.length;e>t;++t)n[t]="'"+this.textNodes[t].data+"'";return"[Merge("+n.join(",")+")]"}},v.prototype={getAncestorWithClass:function(i){for(var r;i;){if(r=this.cssClass?n(i,this.cssClass,this.similarClassRegExp):""===this.cssStyle,i.nodeType==t.ELEMENT_NODE&&"false"!=i.getAttribute("contenteditable")&&e.dom.arrayContains(this.tagNames,i.tagName.toLowerCase())&&r)return i;i=i.parentNode}return!1},getAncestorWithStyle:function(n){for(var r;n;){if(r=!!this.cssStyle&&i(n,this.similarStyleRegExp),n.nodeType==t.ELEMENT_NODE&&"false"!=n.getAttribute("contenteditable")&&e.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&r)return n;n=n.parentNode}return!1},getMatchingAncestor:function(t){var e=this.getAncestorWithClass(t),n=!1;return e?this.cssStyle&&(n="class"):(e=this.getAncestorWithStyle(t))&&(n="style"),{element:e,type:n}},postApply:function(t,e){var n,i,r,o,s,a,l=t[0],c=t[t.length-1],h=[],u=l,d=c,f=0,p=c.length;for(o=0,s=t.length;s>o;++o)i=t[o],r=null,i&&i.parentNode&&(r=this.getAdjacentMergeableTextNode(i.parentNode,!1)),r?(n||(n=new y(r),h.push(n)),n.textNodes.push(i),i===l&&(u=n.firstTextNode,f=u.length),i===c&&(d=n.firstTextNode,p=n.getLength())):n=null;if(c&&c.parentNode&&(a=this.getAdjacentMergeableTextNode(c.parentNode,!0))&&(n||(n=new y(c),h.push(n)),n.textNodes.push(a)),h.length){for(o=0,s=h.length;s>o;++o)h[o].doMerge();e.setStart(u,f),e.setEnd(d,p)}},getAdjacentMergeableTextNode:function(e,n){var i,r=e.nodeType==t.TEXT_NODE,o=r?e.parentNode:e,s=n?"nextSibling":"previousSibling";if(r){if((i=e[s])&&i.nodeType==t.TEXT_NODE)return i}else if((i=o[s])&&this.areElementsMergeable(e,i))return i[n?"firstChild":"lastChild"];return null},areElementsMergeable:function(t,n){return e.dom.arrayContains(this.tagNames,(t.tagName||"").toLowerCase())&&e.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&d(t,n)&&p(t,n)},createContainer:function(t){var e=t.createElement(this.tagNames[0]);return this.cssClass&&(e.className=this.cssClass),this.cssStyle&&e.setAttribute("style",this.cssStyle),e},applyToTextNode:function(t){var n,i=t.parentNode;1==i.childNodes.length&&e.dom.arrayContains(this.tagNames,i.tagName.toLowerCase())?(this.cssClass&&o(i,this.cssClass,this.similarClassRegExp),this.cssStyle&&r(i,this.cssStyle,this.similarStyleRegExp)):(n=this.createContainer(e.dom.getDocument(t)),t.parentNode.insertBefore(n,t),n.appendChild(t))},isRemovable:function(n){return e.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&""===t.lang.string(n.className).trim()&&(!n.getAttribute("style")||""===t.lang.string(n.getAttribute("style")).trim())},undoToTextNode:function(t,e,n,i){var r,o=!n,a=n||i,l=!1;e.containsNode(a)||(r=e.cloneRange(),r.selectNode(a),r.isPointInRange(e.endContainer,e.endOffset)&&m(e.endContainer,e.endOffset)&&(g(a,e.endContainer,e.endOffset,this.container),e.setEndAfter(a)),r.isPointInRange(e.startContainer,e.startOffset)&&m(e.startContainer,e.startOffset)&&(a=g(a,e.startContainer,e.startOffset,this.container))),!o&&this.similarClassRegExp&&s(a,this.similarClassRegExp),o&&this.similarStyleRegExp&&(l="change"===u(a,this.cssStyle,this.similarStyleRegExp)),this.isRemovable(a)&&!l&&f(a)},applyToRange:function(e){var n,i,r,o,s,a;for(i=e.length;i--;){if(n=e[i].getNodes([t.TEXT_NODE]),!n.length)try{return r=this.createContainer(e[i].endContainer.ownerDocument),e[i].surroundContents(r),void this.selectNode(e[i],r)}catch(t){}if(e[i].splitBoundaries(),n=e[i].getNodes([t.TEXT_NODE]),n.length){for(s=0,a=n.length;a>s;++s)o=n[s],this.getMatchingAncestor(o).element||this.applyToTextNode(o);e[i].setStart(n[0],0),o=n[n.length-1],e[i].setEnd(o,o.length),this.normalize&&this.postApply(n,e[i])}}},undoToRange:function(e){var n,i,r,o,s,a,l,c;for(o=e.length;o--;){for(n=e[o].getNodes([t.TEXT_NODE]),n.length?(e[o].splitBoundaries(),n=e[o].getNodes([t.TEXT_NODE])):(s=e[o].endContainer.ownerDocument,a=s.createTextNode(t.INVISIBLE_SPACE),e[o].insertNode(a),e[o].selectNode(a),n=[a]),l=0,c=n.length;c>l;++l)e[o].isValid()&&(i=n[l],r=this.getMatchingAncestor(i),"style"===r.type?this.undoToTextNode(i,e[o],!1,r.element):r.element&&this.undoToTextNode(i,e[o],r.element));1==c?this.selectNode(e[o],n[0]):(e[o].setStart(n[0],0),i=n[n.length-1],e[o].setEnd(i,i.length),this.normalize&&this.postApply(n,e[o]))}},selectNode:function(e,n){var i=n.nodeType===t.ELEMENT_NODE,r=!("canHaveHTML"in n)||n.canHaveHTML,o=i?n.innerHTML:n.data,s=""===o||o===t.INVISIBLE_SPACE;if(s&&i&&r)try{n.innerHTML=t.INVISIBLE_SPACE}catch(t){}e.selectNodeContents(n),s&&i?e.collapse(!1):s&&(e.setStartAfter(n),e.setEndAfter(n))},getTextSelectedByRange:function(t,e){var n,i,r=e.cloneRange();return r.selectNodeContents(t),n=r.intersection(e),i=n?""+n:"",r.detach(),i},isAppliedToRange:function(e){var n,i,r,o,s,a,l=[],c="full";for(r=e.length;r--;){if(i=e[r].getNodes([t.TEXT_NODE]),!i.length)return!!(n=this.getMatchingAncestor(e[r].startContainer).element)&&{elements:[n],coverage:c};for(o=0,s=i.length;s>o;++o)a=this.getTextSelectedByRange(i[o],e[r]),n=this.getMatchingAncestor(i[o]).element,n&&""!=a?(l.push(n),1===t.dom.getTextNodes(n,!0).length?c="full":"full"===c&&(c="inline")):n||(c="partial")}return!!l.length&&{elements:l,coverage:c}},toggleRange:function(t){var e,n=this.isAppliedToRange(t);n?"full"===n.coverage?this.undoToRange(t):"inline"===n.coverage?(e=h(n.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(t),e||this.applyToRange(t)):(h(n.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(t),this.applyToRange(t)):this.applyToRange(t)}},t.selection.HTMLApplier=v}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(t){this.editor=t,this.composer=t.composer,this.doc=this.composer.doc},support:function(t){return wysihtml5.browser.supportsCommand(this.doc,t)},exec:function(t,e){var n=wysihtml5.commands[t],i=wysihtml5.lang.array(arguments).get(),r=n&&n.exec,o=null;if(this.editor.fire("beforecommand:composer"),r)i.unshift(this.composer),o=r.apply(n,i);else try{o=this.doc.execCommand(t,!1,e)}catch(t){}return this.editor.fire("aftercommand:composer"),o},state:function(t){var e=wysihtml5.commands[t],n=wysihtml5.lang.array(arguments).get(),i=e&&e.state;if(i)return n.unshift(this.composer),i.apply(e,n);try{return this.doc.queryCommandState(t)}catch(t){return!1}},stateValue:function(t){var e=wysihtml5.commands[t],n=wysihtml5.lang.array(arguments).get(),i=e&&e.stateValue;return!!i&&(n.unshift(this.composer),i.apply(e,n))}}),wysihtml5.commands.bold={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"b")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"b")}},function(t){function e(e,n){var s,a,l,c,h,u,d,f,p,m=e.doc,g="_wysihtml5-temp-"+ +new Date,y=/non-matching-class/g,v=0;for(t.commands.formatInline.exec(e,i,r,g,y,i,i,!0,!0),a=m.querySelectorAll(r+"."+g),s=a.length;s>v;v++){l=a[v],l.removeAttribute("class");for(p in n)"text"!==p&&l.setAttribute(p,n[p])}u=l,1===s&&(d=o.getTextContent(l),c=!!l.querySelector("*"),h=""===d||d===t.INVISIBLE_SPACE,!c&&h&&(o.setTextContent(l,n.text||l.href),f=m.createTextNode(" "),e.selection.setAfter(l),o.insert(f).after(l),u=f)),e.selection.setAfter(u)}function n(t,e,n){var i,r,o,s;for(r=e.length;r--;){for(i=e[r].attributes,o=i.length;o--;)e[r].removeAttribute(i.item(o).name);for(s in n)n.hasOwnProperty(s)&&e[r].setAttribute(s,n[s])}}var i,r="A",o=t.dom;t.commands.createLink={exec:function(t,i,r){var o=this.state(t,i);o?t.selection.executeAndRestore(function(){n(t,o,r)}):(r="object"==typeof r?r:{href:r},e(t,r))},state:function(e,n){return t.commands.formatInline.state(e,n,"A")}}}(wysihtml5),function(t){function e(t,e){for(var i,r,o,s=e.length,a=0;s>a;a++)i=e[a],r=n.getParentElement(i,{nodeName:"code"}),o=n.getTextContent(i),o.match(n.autoLink.URL_REG_EXP)&&!r?r=n.renameElement(i,"code"):n.replaceWithChildNodes(i)}var n=t.dom;t.commands.removeLink={exec:function(t,n){var i=this.state(t,n);i&&t.selection.executeAndRestore(function(){e(t,i)})},state:function(e,n){return t.commands.formatInline.state(e,n,"A")}}}(wysihtml5),function(t){var e=/wysiwyg-font-size-[0-9a-z\-]+/g;t.commands.fontSize={exec:function(n,i,r){t.commands.formatInline.execWithToggle(n,i,"span","wysiwyg-font-size-"+r,e)},state:function(n,i,r){return t.commands.formatInline.state(n,i,"span","wysiwyg-font-size-"+r,e)}}}(wysihtml5),function(t){var e=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;t.commands.fontSizeStyle={exec:function(n,i,r){r="object"==typeof r?r.size:r,/^\s*$/.test(r)||t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,"font-size:"+r,e)},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"font-size",e)},stateValue:function(e,n){var i,r=this.state(e,n);return r&&t.lang.object(r).isArray()&&(r=r[0]),!(!r||!(i=r.getAttribute("style")))&&t.quirks.styleParser.parseFontSize(i)}}}(wysihtml5),function(t){var e=/wysiwyg-color-[0-9a-z]+/g;t.commands.foreColor={exec:function(n,i,r){t.commands.formatInline.execWithToggle(n,i,"span","wysiwyg-color-"+r,e)},state:function(n,i,r){return t.commands.formatInline.state(n,i,"span","wysiwyg-color-"+r,e)}}}(wysihtml5),function(t){var e=/(\s|^)color\s*:\s*[^;\s]+;?/gi;t.commands.foreColorStyle={exec:function(n,i,r){var o,s=t.quirks.styleParser.parseColor("object"==typeof r?"color:"+r.color:"color:"+r,"color");s&&(o="color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(o+="color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,o,e))},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"color",e)},stateValue:function(e,n,i){var r,o=this.state(e,n);return o&&t.lang.object(o).isArray()&&(o=o[0]),!!(o&&(r=o.getAttribute("style"))&&r)&&(val=t.quirks.styleParser.parseColor(r,"color"),t.quirks.styleParser.unparseColor(val,i))}}}(wysihtml5),function(t){var e=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;t.commands.bgColorStyle={exec:function(n,i,r){var o,s=t.quirks.styleParser.parseColor("object"==typeof r?"background-color:"+r.color:"background-color:"+r,"background-color");s&&(o="background-color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(o+="background-color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,o,e))},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"background-color",e)},stateValue:function(e,n,i){var r,o=this.state(e,n),s=!1;return o&&t.lang.object(o).isArray()&&(o=o[0]),!(!o||!(r=o.getAttribute("style")))&&(s=t.quirks.styleParser.parseColor(r,"background-color"),t.quirks.styleParser.unparseColor(s,i))}}}(wysihtml5),function(t){function e(e,n,r){e.className?(i(e,r),e.className=t.lang.string(e.className+" "+n).trim()):e.className=n}function n(e,n,i){r(e,i),e.getAttribute("style")?e.setAttribute("style",t.lang.string(e.getAttribute("style")+" "+n).trim()):e.setAttribute("style",n)}function i(e,n){var i=n.test(e.className);return e.className=e.className.replace(n,""),""==t.lang.string(e.className).trim()&&e.removeAttribute("class"),i}function r(e,n){var i=n.test(e.getAttribute("style"));return e.setAttribute("style",(e.getAttribute("style")||"").replace(n,"")),""==t.lang.string(e.getAttribute("style")||"").trim()&&e.removeAttribute("style"),i}function o(t){var e=t.lastChild;e&&s(e)&&e.parentNode.removeChild(e)}function s(t){return"BR"===t.nodeName}function a(e,n){var i,r,s;for(e.selection.isCollapsed()&&e.selection.selectLine(),i=e.selection.surround(n),r=0,s=i.length;s>r;r++)t.dom.lineBreaks(i[r]).remove(),o(i[r])}function l(e){return!!t.lang.string(e.className).trim()}function c(e){return!!t.lang.string(e.getAttribute("style")||"").trim()}var h=t.dom,u=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];t.commands.formatBlock={exec:function(o,s,d,f,p,m,g){var y,v,b,w,x,C=(o.doc,this.state(o,s,d,f,p,m,g)),_=o.config.useLineBreaks,S=_?"DIV":"P";return d="string"==typeof d?d.toUpperCase():d,C.length?void o.selection.executeAndRestoreRangy(function(){var e,n,o;for(e=C.length;e--;){if(p&&(v=i(C[e],p)),g&&(w=r(C[e],g)),(w||v)&&null===d&&C[e].nodeName!=S)return;n=l(C[e]),o=c(C[e]),n||o||!_&&"P"!==d?h.renameElement(C[e],"P"===d?"DIV":S):(t.dom.lineBreaks(C[e]).add(),h.replaceWithChildNodes(C[e]))}}):void((null!==d&&!t.lang.array(u).contains(d)||(y=o.selection.findNodesInSelection(u).concat(o.selection.getSelectedOwnNodes()),o.selection.executeAndRestoreRangy(function(){for(var t=y.length;t--;)x=h.getParentElement(y[t],{nodeName:u}),x==o.element&&(x=null),x&&(d&&(x=h.renameElement(x,d)),f&&e(x,f,p),m&&n(x,m,g),b=!0)}),!b))&&a(o,{nodeName:d||S,className:f||null,cssStyle:m||null}))},state:function(e,n,i,r,o,s,a){var l,c,u,d=e.selection.getSelectedOwnNodes(),f=[];for(i="string"==typeof i?i.toUpperCase():i,c=0,u=d.length;u>c;c++)(l=h.getParentElement(d[c],{nodeName:i,className:r,classRegExp:o,cssStyle:s,styleRegExp:a}))&&-1==t.lang.array(f).indexOf(l)&&f.push(l);return 0!=f.length&&f}}}(wysihtml5),wysihtml5.commands.formatCode={exec:function(t,e,n){var i,r,o,s=this.state(t);s?t.selection.executeAndRestore(function(){i=s.querySelector("code"),wysihtml5.dom.replaceWithChildNodes(s),i&&wysihtml5.dom.replaceWithChildNodes(i)}):(r=t.selection.getRange(),o=r.extractContents(),s=t.doc.createElement("pre"),i=t.doc.createElement("code"),n&&(i.className=n),s.appendChild(i),i.appendChild(o),r.insertNode(s),t.selection.selectNode(s))},state:function(t){var e=t.selection.getSelectedNode();return e&&e.nodeName&&"PRE"==e.nodeName&&e.firstChild&&e.firstChild.nodeName&&"CODE"==e.firstChild.nodeName?e:wysihtml5.dom.getParentElement(e,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(e,{nodeName:"PRE"})}},function(t){function e(t){var e=i[t];return e?[t.toLowerCase(),e.toLowerCase()]:[t.toLowerCase()]}function n(n,i,o,s,a,l){var c=n;return i&&(c+=":"+i),s&&(c+=":"+s),r[c]||(r[c]=new t.selection.HTMLApplier(e(n),i,o,!0,s,a,l)),r[c]}var i={strong:"b",em:"i",b:"strong",i:"em"},r={};t.commands.formatInline={exec:function(t,e,i,r,o,s,a,l,c){var h=t.selection.createRange(),u=t.selection.getOwnRanges();return!(!u||0==u.length)&&(t.selection.getSelection().removeAllRanges(),n(i,r,o,s,a,t.element).toggleRange(u),void(l?c||t.cleanUp():(h.setStart(u[0].startContainer,u[0].startOffset),h.setEnd(u[u.length-1].endContainer,u[u.length-1].endOffset),t.selection.setSelection(h),t.selection.executeAndRestore(function(){c||t.cleanUp()},!0,!0))))},execWithToggle:function(e,n,i,r,o,s,a){var l,c=this;this.state(e,n,i,r,o,s,a)&&e.selection.isCollapsed()&&!e.selection.caretIsLastInSelection()&&!e.selection.caretIsFirstInSelection()?(l=c.state(e,n,i,r,o)[0],e.selection.executeAndRestoreRangy(function(){l.parentNode,e.selection.selectNode(l,!0),t.commands.formatInline.exec(e,n,i,r,o,s,a,!0,!0)})):this.state(e,n,i,r,o,s,a)&&!e.selection.isCollapsed()?e.selection.executeAndRestoreRangy(function(){t.commands.formatInline.exec(e,n,i,r,o,s,a,!0,!0)}):t.commands.formatInline.exec(e,n,i,r,o,s,a)},state:function(e,r,o,s,a,l,c){var h,u,d=e.doc,f=i[o]||o;return!(!t.dom.hasElementWithTagName(d,o)&&!t.dom.hasElementWithTagName(d,f))&&(!(s&&!t.dom.hasElementWithClassName(d,s))&&(!(!(h=e.selection.getOwnRanges())||0===h.length)&&(!(!(u=n(o,s,a,l,c,e.element).isAppliedToRange(h))||!u.elements)&&u.elements)))}}}(wysihtml5),function(t){t.commands.insertBlockQuote={exec:function(e,n){var i=this.state(e,n),r=e.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]);e.selection.executeAndRestore(function(){if(i)e.config.useLineBreaks&&t.dom.lineBreaks(i).add(),t.dom.unwrap(i);else if(e.selection.isCollapsed()&&e.selection.selectLine(),r){var n=r.ownerDocument.createElement("blockquote");t.dom.insert(n).after(r),n.appendChild(r)}else e.selection.surround({nodeName:"blockquote"})})},state:function(e){var n=e.selection.getSelectedNode(),i=t.dom.getParentElement(n,{nodeName:"BLOCKQUOTE"},!1,e.element);return i||!1}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(t,e,n){t.commands.support(e)?t.doc.execCommand(e,!1,n):t.selection.insertHTML(n)},state:function(){return!1}},function(t){var e="IMG";t.commands.insertImage={exec:function(n,i,r){var o,s,a,l,c;if(r="object"==typeof r?r:{src:r},o=n.doc,s=this.state(n))return n.selection.setBefore(s),l=s.parentNode,l.removeChild(s),t.dom.removeEmptyTextNodes(l),"A"!==l.nodeName||l.firstChild||(n.selection.setAfter(l),l.parentNode.removeChild(l)),void t.quirks.redraw(n.element);s=o.createElement(e);for(c in r)s.setAttribute("className"===c?"class":c,r[c]);n.selection.insertNode(s),t.browser.hasProblemsSettingCaretAfterImg()?(a=o.createTextNode(t.INVISIBLE_SPACE),n.selection.insertNode(a),n.selection.setAfter(a)):n.selection.setAfter(s)},state:function(n){var i,r,o,s=n.doc;return!!t.dom.hasElementWithTagName(s,e)&&(!!(i=n.selection.getSelectedNode())&&(i.nodeName===e?i:i.nodeType===t.ELEMENT_NODE&&(r=n.selection.getText(),!(r=t.lang.string(r).trim())&&(o=n.selection.getNodes(t.ELEMENT_NODE,function(t){return"IMG"===t.nodeName}),1===o.length&&o[0]))))}}}(wysihtml5),function(t){var e="<br>"+(t.browser.needsSpaceAfterLineBreak()?" ":"");t.commands.insertLineBreak={exec:function(n,i){n.commands.support(i)?(n.doc.execCommand(i,!1,null),t.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",e)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(t,e){wysihtml5.commands.insertList.exec(t,e,"OL")},state:function(t,e){return wysihtml5.commands.insertList.state(t,e,"OL")}},wysihtml5.commands.insertUnorderedList={exec:function(t,e){wysihtml5.commands.insertList.exec(t,e,"UL")},state:function(t,e){return wysihtml5.commands.insertList.state(t,e,"UL")}},wysihtml5.commands.insertList=function(t){var e=function(t,e){if(t&&t.nodeName){"string"==typeof e&&(e=[e]);for(var n=e.length;n--;)if(t.nodeName===e[n])return!0}return!1},n=function(n,i,r){var o,s,a={el:null,other:!1};return n&&(o=t.dom.getParentElement(n,{nodeName:"LI"}),s="UL"===i?"OL":"UL",e(n,i)?a.el=n:e(n,s)?a={el:n,other:!0}:o&&(e(o.parentNode,i)?a.el=o.parentNode:e(o.parentNode,s)&&(a={el:o.parentNode,other:!0}))),a.el&&!r.element.contains(a.el)&&(a.el=null),a},i=function(e,n,i){var r,s="UL"===n?"OL":"UL";i.selection.executeAndRestore(function(){var a,l,c=o(s,i);if(c.length)for(a=c.length;a--;)t.dom.renameElement(c[a],n.toLowerCase());else{for(r=o(["OL","UL"],i),l=r.length;l--;)t.dom.resolveList(r[l],i.config.useLineBreaks);t.dom.resolveList(e,i.config.useLineBreaks)}})},r=function(e,n,i){var r="UL"===n?"OL":"UL";i.selection.executeAndRestore(function(){var s,a=[e].concat(o(r,i));for(s=a.length;s--;)t.dom.renameElement(a[s],n.toLowerCase())})},o=function(t,n){var i,r=n.selection.getOwnRanges(),o=[];for(i=r.length;i--;)o=o.concat(r[i].getNodes([1],function(n){return e(n,t)}));return o},s=function(e,n){n.selection.executeAndRestoreRangy(function(){var i,r,o="_wysihtml5-temp-"+(new Date).getTime(),s=n.selection.deblockAndSurround({nodeName:"div",className:o}),a=/\uFEFF/g;s.innerHTML=s.innerHTML.replace(a,""),s&&(i=t.lang.array(["","<br>",t.INVISIBLE_SPACE]).contains(s.innerHTML),r=t.dom.convertToList(s,e.toLowerCase(),n.parent.config.uneditableContainerClassname),i&&n.selection.selectNode(r.querySelector("li"),!0))})};return{exec:function(t,e,o){var a=t.doc,l="OL"===o?"insertOrderedList":"insertUnorderedList",c=t.selection.getSelectedNode(),h=n(c,o,t);h.el?h.other?r(h.el,o,t):i(h.el,o,t):t.commands.support(l)?a.execCommand(l,!1,null):s(o,t)},state:function(t,e,i){var r=t.selection.getSelectedNode(),o=n(r,i,t);return!(!o.el||o.other)&&o.el}}}(wysihtml5),wysihtml5.commands.italic={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"i")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"i")}},function(t){var e="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyCenter={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyLeft={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyRight={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyFull={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="text-align: right;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignRightStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),function(t){var e="text-align: left;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignLeftStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),function(t){var e="text-align: center;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignCenterStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(t){return t.undoManager.redo()},state:function(){return!1}},wysihtml5.commands.underline={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"u")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"u")}},wysihtml5.commands.undo={exec:function(t){return t.undoManager.undo()},state:function(){return!1}},wysihtml5.commands.createTable={exec:function(t,e,n){var i,r,o;if(n&&n.cols&&n.rows&&parseInt(n.cols,10)>0&&parseInt(n.rows,10)>0){for(o=n.tableStyle?'<table style="'+n.tableStyle+'">':"<table>",o+="<tbody>",r=0;r<n.rows;r++){for(o+="<tr>",i=0;i<n.cols;i++)o+="<td>&nbsp;</td>";o+="</tr>"}o+="</tbody></table>",t.commands.exec("insertHTML",o)}},state:function(){return!1}},wysihtml5.commands.mergeTableCells={exec:function(t,e){t.tableSelection&&t.tableSelection.start&&t.tableSelection.end&&(this.state(t,e)?wysihtml5.dom.table.unmergeCell(t.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(t.tableSelection.start,t.tableSelection.end))},state:function(t){if(t.tableSelection){var e=t.tableSelection.start,n=t.tableSelection.end;if(e&&n&&e==n&&(wysihtml5.dom.getAttribute(e,"colspan")&&parseInt(wysihtml5.dom.getAttribute(e,"colspan"),10)>1||wysihtml5.dom.getAttribute(e,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(e,"rowspan"),10)>1))return[e]}return!1}},wysihtml5.commands.addTableCells={exec:function(t,e,n){if(t.tableSelection&&t.tableSelection.start&&t.tableSelection.end){var i=wysihtml5.dom.table.orderSelectionEnds(t.tableSelection.start,t.tableSelection.end);"before"==n||"above"==n?wysihtml5.dom.table.addCells(i.start,n):("after"==n||"below"==n)&&wysihtml5.dom.table.addCells(i.end,n),setTimeout(function(){t.tableSelection.select(i.start,i.end)},0)}},state:function(){return!1}},wysihtml5.commands.deleteTableCells={exec:function(t,e,n){if(t.tableSelection&&t.tableSelection.start&&t.tableSelection.end){var i,r=wysihtml5.dom.table.orderSelectionEnds(t.tableSelection.start,t.tableSelection.end),o=wysihtml5.dom.table.indexOf(r.start),s=t.tableSelection.table;wysihtml5.dom.table.removeCells(r.start,n),setTimeout(function(){i=wysihtml5.dom.table.findCell(s,o),i||("row"==n&&(i=wysihtml5.dom.table.findCell(s,{row:o.row-1,col:o.col})),"column"==n&&(i=wysihtml5.dom.table.findCell(s,{row:o.row,col:o.col-1}))),i&&t.tableSelection.select(i,i)},0)}},state:function(){return!1}},wysihtml5.commands.indentList={exec:function(t){var e=t.selection.getSelectionParentsByTag("LI");return!!e&&this.tryToPushLiLevel(e,t.selection)},state:function(){return!1},tryToPushLiLevel:function(t,e){var n,i,r,o,s,a=!1;return e.executeAndRestoreRangy(function(){for(var e=t.length;e--;)o=t[e],n="OL"===o.parentNode.nodeName?"OL":"UL",i=o.ownerDocument.createElement(n),r=wysihtml5.dom.domNode(o).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}),s=r?r.querySelector("ul, ol"):null,r&&(s?s.appendChild(o):(i.appendChild(o),r.appendChild(i)),a=!0)}),a}},
wysihtml5.commands.outdentList={exec:function(t){var e=t.selection.getSelectionParentsByTag("LI");return!!e&&this.tryToPullLiLevel(e,t)},state:function(){return!1},tryToPullLiLevel:function(t,e){var n,i,r,o,s,a=!1,l=this;return e.selection.executeAndRestoreRangy(function(){var c,h;for(c=t.length;c--;)if(o=t[c],o.parentNode&&(n=o.parentNode,"OL"===n.tagName||"UL"===n.tagName)){if(a=!0,i=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["OL","UL"]},!1,e.element),r=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["LI"]},!1,e.element),i&&r)o.nextSibling&&(s=l.getAfterList(n,o),o.appendChild(s)),i.insertBefore(o,r.nextSibling);else{for(o.nextSibling&&(s=l.getAfterList(n,o),o.appendChild(s)),h=o.childNodes.length;h--;)n.parentNode.insertBefore(o.childNodes[h],n.nextSibling);n.parentNode.insertBefore(document.createElement("br"),n.nextSibling),o.parentNode.removeChild(o)}0===n.childNodes.length&&n.parentNode.removeChild(n)}}),a},getAfterList:function(t,e){for(var n=t.nodeName,i=document.createElement(n);e.nextSibling;)i.appendChild(e.nextSibling);return i}},function(t){var e="data-wysihtml5-selection-node",n="data-wysihtml5-selection-offset",i=(t.INVISIBLE_SPACE,t.INVISIBLE_SPACE,t.dom);t.UndoManager=t.lang.Dispatcher.extend({constructor:function(t){this.editor=t,this.composer=t.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var t,e=this;this.composer.sandbox.getDocument(),i.observe(this.element,"keydown",function(t){if(!t.altKey&&(t.ctrlKey||t.metaKey)){var n=t.keyCode,i=90===n&&!t.shiftKey,r=90===n&&t.shiftKey||89===n;i?(e.undo(),t.preventDefault()):r&&(e.redo(),t.preventDefault())}}),i.observe(this.element,"keydown",function(n){var i=n.keyCode;i!==t&&(t=i,(8===i||46===i)&&e.transact())}),this.editor.on("newword:composer",function(){e.transact()}).on("beforecommand:composer",function(){e.transact()})},transact:function(){var i,r,o,s,a,l,c,h=this.historyStr[this.position-1],u=this.composer.getValue(!1,!1),d=this.element.offsetWidth>0&&this.element.offsetHeight>0;u!==h&&(l=this.historyStr.length=this.historyDom.length=this.position,l>25&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++,d&&(i=this.composer.selection.getRange(),r=i&&i.startContainer?i.startContainer:this.element,o=i&&i.startOffset?i.startOffset:0,r.nodeType===t.ELEMENT_NODE?s=r:(s=r.parentNode,a=this.getChildNodeIndex(s,r)),s.setAttribute(n,o),void 0!==a&&s.setAttribute(e,a)),c=this.element.cloneNode(!!u),this.historyDom.push(c),this.historyStr.push(u),s&&(s.removeAttribute(n),s.removeAttribute(e)))},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(t){var i,r,o,s,a,l;for(this.element.innerHTML="",i=0,r=t.childNodes,o=t.childNodes.length;o>i;i++)this.element.appendChild(r[i].cloneNode(!0));t.hasAttribute(n)?(s=t.getAttribute(n),l=t.getAttribute(e),a=this.element):(a=this.element.querySelector("["+n+"]")||this.element,s=a.getAttribute(n),l=a.getAttribute(e),a.removeAttribute(n),a.removeAttribute(e)),null!==l&&(a=this.getChildNodeByIndex(a,+l)),this.composer.selection.set(a,s)},getChildNodeIndex:function(t,e){for(var n=0,i=t.childNodes,r=i.length;r>n;n++)if(i[n]===e)return n},getChildNodeByIndex:function(t,e){return t.childNodes[e]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(t,e,n){this.parent=t,this.element=e,this.config=n,this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var t=this;this.parent.on("beforeload",function(){t.parent.on("change_view",function(e){e===t.name?(t.parent.currentView=t,t.show(),setTimeout(function(){t.focus()},0)):t.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(t){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(t){var e=t.dom,n=t.browser;t.views.Composer=t.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(t,e,n){this.base(t,e,n),this.config.noTextarea?this.editableArea=e:this.textarea=this.parent.textarea,this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(e,n){var i=this.isEmpty()?"":t.quirks.getCorrectInnerHTML(this.element);return!1!==e&&(i=this.parent.parse(i,!1!==n)),i},setValue:function(t,e){e&&(t=this.parent.parse(t));try{this.element.innerHTML=t}catch(e){this.element.innerText=t}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"",this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=e.getStyle("display").from(this.editableArea),"none"===this._displayStyle&&(this._displayStyle=null),this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(e){t.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;e&&n&&this.selection&&("BR"===n.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return e.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var t=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(t)||""===t||"<br>"===t||"<p></p>"===t||"<p><br></p>"===t||this.hasPlaceholderSet()},_initContentEditableArea:function(){var t=this;this.config.noTextarea?this.sandbox=new e.ContentEditableArea(function(){t._create()},{},this.editableArea):(this.sandbox=new e.ContentEditableArea(function(){t._create()}),this.editableArea=this.sandbox.getContentEditable(),e.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var t,n=this;this.sandbox=new e.Sandbox(function(){n._create()},{stylesheets:this.config.stylesheets}),this.editableArea=this.sandbox.getIframe(),t=this.textarea.element,e.insert(this.editableArea).after(t),this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var t=document.createElement("input");t.type="hidden",t.name="_wysihtml5_mode",t.value=1,e.insert(t).after(this.textarea.element)}},_create:function(){var i,r,o=this;this.doc=this.sandbox.getDocument(),this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body,this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1)),this.selection=new t.Selection(this.parent,this.element,this.config.uneditableContainerClassname),this.commands=new t.Commands(this.parent),this.config.noTextarea||e.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),e.addClass(this.element,this.config.composerClassName),this.config.style&&!this.config.contentEditableMode&&this.style(),this.observe(),i=this.config.name,i&&(e.addClass(this.element,i),this.config.contentEditableMode||e.addClass(this.editableArea,i)),this.enable(),!this.config.noTextarea&&this.textarea.element.disabled&&this.disable(),r="string"==typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"),r&&e.simulatePlaceholder(this.parent,this,r),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||n.isIos()||setTimeout(function(){o.focus(!0)},100),n.clearsContentEditableCorrectly()||t.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.config.noTextarea||this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var i,r,o,s=this,a=n.canDisableAutoLinking(),l=n.doesAutoLinkingInContentEditable();a&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink&&((!l||l&&a)&&(this.parent.on("newword:composer",function(){e.getTextContent(s.element).match(e.autoLink.URL_REG_EXP)&&s.selection.executeAndRestore(function(n,i){var r,o=s.element.querySelectorAll("."+s.config.uneditableContainerClassname),a=!1;for(r=o.length;r--;)t.dom.contains(o[r],i)&&(a=!0);a||e.autoLink(i.parentNode,[s.config.uneditableContainerClassname])})}),e.observe(this.element,"blur",function(){e.autoLink(s.element,[s.config.uneditableContainerClassname])})),i=this.sandbox.getDocument().getElementsByTagName("a"),r=e.autoLink.URL_REG_EXP,o=function(n){var i=t.lang.string(e.getTextContent(n)).trim();return"www."===i.substr(0,4)&&(i="http://"+i),i},e.observe(this.element,"keydown",function(t){if(i.length){var n,a=s.selection.getSelectedNode(t.target.ownerDocument),l=e.getParentElement(a,{nodeName:"A"},4);l&&(n=o(l),setTimeout(function(){var t=o(l);t!==n&&t.match(r)&&l.setAttribute("href",t)},0))}}))},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),n.supportsEvent("resizeend")){var i=["width","height"],r=i.length,o=this.element;e.observe(o,"resizeend",function(e){var n,s=e.target||e.srcElement,a=s.style,l=0;if("IMG"===s.nodeName){for(;r>l;l++)n=i[l],a[n]&&(s.setAttribute(n,parseInt(a[n],10)),a[n]="");t.quirks.redraw(o)}})}},_initUndoManager:function(){this.undoManager=new t.UndoManager(this.parent)},_initLineBreaking:function(){function i(t){var n=e.getParentElement(t,{nodeName:["P","DIV"]},2);n&&e.contains(r.element,n)&&r.selection.executeAndRestore(function(){r.config.useLineBreaks?e.replaceWithChildNodes(n):"P"!==n.nodeName&&e.renameElement(n,"p")})}var r=this,o=["LI","P","H1","H2","H3","H4","H5","H6"],s=["UL","OL","MENU"];this.config.useLineBreaks||e.observe(this.element,["focus","keydown"],function(){if(r.isEmpty()){var t=r.doc.createElement("P");r.element.innerHTML="",r.element.appendChild(t),n.displaysCaretInEmptyContentEditableCorrectly()?r.selection.selectNode(t,!0):(t.innerHTML="<br>",r.selection.setBefore(t.firstChild))}}),e.observe(this.element,"keydown",function(n){var a,l=n.keyCode;if(!n.shiftKey&&(l===t.ENTER_KEY||l===t.BACKSPACE_KEY))return a=e.getParentElement(r.selection.getSelectedNode(),{nodeName:o},4),a?void setTimeout(function(){var n=r.selection.getSelectedNode();if("LI"===a.nodeName){if(!n)return;e.getParentElement(n,{nodeName:s},2)||i(n)}l===t.ENTER_KEY&&a.nodeName.match(/^H[1-6]$/)&&i(n)},0):void(r.config.useLineBreaks&&l===t.ENTER_KEY&&!t.browser.insertsLineBreaksOnReturn()&&(n.preventDefault(),r.commands.exec("insertLineBreak")))})}})}(wysihtml5),function(t){var e=t.dom,n=document,i=window,r=n.createElement("div"),o=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],s=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],a=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",t.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(t){if(t.setActive)try{t.setActive()}catch(t){}else{var r=t.style,o=n.documentElement.scrollTop||n.body.scrollTop,s=n.documentElement.scrollLeft||n.body.scrollLeft,a={position:r.position,top:r.top,left:r.left,WebkitUserSelect:r.WebkitUserSelect};e.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(t),t.focus(),e.setStyles(a).on(t),i.scrollTo&&i.scrollTo(s,o)}};t.views.Composer.prototype.style=function(){var i,c,h=this,u=n.querySelector(":focus"),d=this.textarea.element,f=d.hasAttribute("placeholder"),p=f&&d.getAttribute("placeholder"),m=d.style.display,g=d.disabled;return this.focusStylesHost=r.cloneNode(!1),this.blurStylesHost=r.cloneNode(!1),this.disabledStylesHost=r.cloneNode(!1),f&&d.removeAttribute("placeholder"),d===u&&d.blur(),d.disabled=!1,d.style.display=i="none",(d.getAttribute("rows")&&"auto"===e.getStyle("height").from(d)||d.getAttribute("cols")&&"auto"===e.getStyle("width").from(d))&&(d.style.display=i=m),e.copyStyles(s).from(d).to(this.editableArea).andTo(this.blurStylesHost),e.copyStyles(o).from(d).to(this.element).andTo(this.blurStylesHost),e.insertCSS(a).into(this.element.ownerDocument),d.disabled=!0,e.copyStyles(s).from(d).to(this.disabledStylesHost),e.copyStyles(o).from(d).to(this.disabledStylesHost),d.disabled=g,d.style.display=m,l(d),d.style.display=i,e.copyStyles(s).from(d).to(this.focusStylesHost),e.copyStyles(o).from(d).to(this.focusStylesHost),d.style.display=m,e.copyStyles(["display"]).from(d).to(this.editableArea),c=t.lang.array(s).without(["display"]),u?u.focus():d.blur(),f&&d.setAttribute("placeholder",p),this.parent.on("focus:composer",function(){e.copyStyles(c).from(h.focusStylesHost).to(h.editableArea),e.copyStyles(o).from(h.focusStylesHost).to(h.element)}),this.parent.on("blur:composer",function(){e.copyStyles(c).from(h.blurStylesHost).to(h.editableArea),e.copyStyles(o).from(h.blurStylesHost).to(h.element)}),this.parent.observe("disable:composer",function(){e.copyStyles(c).from(h.disabledStylesHost).to(h.editableArea),e.copyStyles(o).from(h.disabledStylesHost).to(h.element)}),this.parent.observe("enable:composer",function(){e.copyStyles(c).from(h.blurStylesHost).to(h.editableArea),e.copyStyles(o).from(h.blurStylesHost).to(h.element)}),this}}(wysihtml5),function(t){var e=t.dom,n=t.browser,i={66:"bold",73:"italic",85:"underline"},r=function(t,e,n){var i,r=t.getPreviousNode(e,!0),o=t.getSelectedNode();if(1!==o.nodeType&&o.parentNode!==n&&(o=o.parentNode),r)if(1==o.nodeType){if(i=o.firstChild,1==r.nodeType)for(;o.firstChild;)r.appendChild(o.firstChild);else for(;o.firstChild;)e.parentNode.insertBefore(o.firstChild,e);o.parentNode&&o.parentNode.removeChild(o),t.setBefore(i)}else 1==r.nodeType?r.appendChild(o):e.parentNode.insertBefore(o,e),t.setBefore(o)},o=function(t,e,n,i){var o,s,a;e.isCollapsed()?e.caretIsInTheBeginnig("LI")?(t.preventDefault(),i.commands.exec("outdentList")):e.caretIsInTheBeginnig()?t.preventDefault():(e.caretIsFirstInSelection()&&e.getPreviousNode()&&e.getPreviousNode().nodeName&&/^H\d$/gi.test(e.getPreviousNode().nodeName)&&(o=e.getPreviousNode(),t.preventDefault(),/^\s*$/.test(o.textContent||o.innerText)?o.parentNode.removeChild(o):(s=o.ownerDocument.createRange(),s.selectNodeContents(o),s.collapse(!1),e.setSelection(s))),(a=e.caretIsBeforeUneditable())&&(t.preventDefault(),r(e,a,n))):e.containsUneditable()&&(t.preventDefault(),e.deleteContents())},s=function(t){if(t.selection.isCollapsed()){if(t.selection.caretIsInTheBeginnig("LI")&&t.commands.exec("indentList"))return}else t.selection.deleteContents();t.commands.exec("insertHTML","&emsp;")};t.views.Composer.prototype.observe=function(){var r,a,l=this,c=this.getValue(!1,!1),h=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),u=this.element,d=n.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?u:this.sandbox.getWindow(),f=["drop","paste","beforepaste"],p=["drop","paste","mouseup","focus","keyup"];e.observe(h,"DOMNodeRemoved",function(){clearInterval(r),l.parent.fire("destroy:composer")}),n.supportsMutationEvents()||(r=setInterval(function(){e.contains(document.documentElement,h)||(clearInterval(r),l.parent.fire("destroy:composer"))},250)),e.observe(d,p,function(){setTimeout(function(){l.parent.fire("interaction").fire("interaction:composer")},0)}),this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&t.browser.supportsCommand(this.doc,"enableObjectResizing")&&t.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=e.observe(h,["focus","mouseup","mouseover"],function(){l.doc.execCommand("enableObjectResizing",!1,"false"),l.doc.execCommand("enableInlineTableEditing",!1,"false"),l.tableClickHandle.stop()}):setTimeout(function(){l.doc.execCommand("enableObjectResizing",!1,"false"),l.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=t.quirks.tableCellsSelection(u,l.parent)),e.observe(d,"focus",function(t){l.parent.fire("focus",t).fire("focus:composer",t),setTimeout(function(){c=l.getValue(!1,!1)},0)}),e.observe(d,"blur",function(t){if(c!==l.getValue(!1,!1)){var e=t;"function"==typeof Object.create&&(e=Object.create(t,{type:{value:"change"}})),l.parent.fire("change",e).fire("change:composer",e)}l.parent.fire("blur",t).fire("blur:composer",t)}),e.observe(u,"dragenter",function(){l.parent.fire("unset_placeholder")}),e.observe(u,f,function(t){l.parent.fire(t.type,t).fire(t.type+":composer",t)}),this.config.copyedFromMarking&&e.observe(u,"copy",function(t){t.clipboardData&&(t.clipboardData.setData("text/html",l.config.copyedFromMarking+l.selection.getHtml()),t.preventDefault()),l.parent.fire(t.type,t).fire(t.type+":composer",t)}),e.observe(u,"keyup",function(e){var n=e.keyCode;(n===t.SPACE_KEY||n===t.ENTER_KEY)&&l.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){l.parent.fire("newword:composer")},0)}),n.canSelectImagesInContentEditable()||e.observe(u,"mousedown",function(e){var n=e.target,i=u.querySelectorAll("img"),r=u.querySelectorAll("."+l.config.uneditableContainerClassname+" img"),o=t.lang.array(i).without(r);"IMG"===n.nodeName&&t.lang.array(o).contains(n)&&l.selection.selectNode(n)}),n.canSelectImagesInContentEditable()||e.observe(u,"drop",function(){setTimeout(function(){l.selection.getSelection().removeAllRanges()},0)}),n.hasHistoryIssue()&&n.supportsSelectionModify()&&e.observe(u,"keydown",function(t){if(t.metaKey||t.ctrlKey){var e=t.keyCode,n=u.ownerDocument.defaultView,i=n.getSelection();(37===e||39===e)&&(37===e&&(i.modify("extend","left","lineboundary"),t.shiftKey||i.collapseToStart()),39===e&&(i.modify("extend","right","lineboundary"),t.shiftKey||i.collapseToEnd()),t.preventDefault())}}),e.observe(u,"keydown",function(t){var e=t.keyCode,n=i[e];(t.ctrlKey||t.metaKey)&&!t.altKey&&n&&(l.commands.exec(n),t.preventDefault()),8===e?o(t,l.selection,u,l):l.config.handleTabKey&&9===e&&(t.preventDefault(),s(l))}),e.observe(u,"keydown",function(e){var n,i=l.selection.getSelectedNode(!0),r=e.keyCode;!i||"IMG"!==i.nodeName||r!==t.BACKSPACE_KEY&&r!==t.DELETE_KEY||(n=i.parentNode,n.removeChild(i),"A"!==n.nodeName||n.firstChild||n.parentNode.removeChild(n),setTimeout(function(){t.quirks.redraw(u)},0),e.preventDefault())}),!this.config.contentEditableMode&&n.hasIframeFocusIssue()&&(e.observe(h,"focus",function(){setTimeout(function(){l.doc.querySelector(":focus")!==l.element&&l.focus()},0)}),e.observe(this.element,"blur",function(){setTimeout(function(){l.selection.getSelection().removeAllRanges()},0)})),a={IMG:"Image: ",A:"Link: "},e.observe(u,"mouseover",function(t){var e,n=t.target,i=n.nodeName;("A"===i||"IMG"===i)&&(n.hasAttribute("title")||(e=a[i]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",e)))})}}(wysihtml5),function(t){t.views.Synchronizer=Base.extend({constructor:function(t,e,n){this.editor=t,this.textarea=e,this.composer=n,this._observe()},fromComposerToTextarea:function(e){this.textarea.setValue(t.lang.string(this.composer.getValue(!1,!1)).trim(),e)},fromTextareaToComposer:function(t){var e=this.textarea.getValue(!1,!1);e?this.composer.setValue(e,t):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(t){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(t):this.fromComposerToTextarea(t)},_observe:function(){var e,n=this,i=this.textarea.element.form,r=function(){e=setInterval(function(){n.fromComposerToTextarea()},400)},o=function(){clearInterval(e),e=null};r(),i&&(t.dom.observe(i,"submit",function(){n.sync(!0)}),t.dom.observe(i,"reset",function(){setTimeout(function(){n.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(t){"composer"!==t||e?"textarea"===t&&(n.fromComposerToTextarea(!0),o()):(n.fromTextareaToComposer(!0),r())}),this.editor.on("destroy:composer",o)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(t,e,n){this.base(t,e,n),this._observe()},clear:function(){this.element.value=""},getValue:function(t){var e=this.isEmpty()?"":this.element.value;return!1!==t&&(e=this.parent.parse(e)),e},setValue:function(t,e){e&&(t=this.parent.parse(t)),this.element.value=t},cleanUp:function(){var t=this.parent.parse(this.element.value);this.element.value=t},hasPlaceholderSet:function(){var t=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),e=this.element.getAttribute("placeholder")||null,n=this.element.value,i=!n;return t&&i||n===e},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var t=this.element,e=this.parent,n={focusin:"focus",focusout:"blur"},i=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.on("beforeload",function(){wysihtml5.dom.observe(t,i,function(t){var i=n[t.type]||t.type;e.fire(i).fire(i+":textarea")}),wysihtml5.dom.observe(t,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}}),function(t){var e,n={name:e,style:!0,toolbar:e,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:t.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:e,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container",copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};t.Editor=t.lang.Dispatcher.extend({constructor:function(e,i){if(this.editableElement="string"==typeof e?document.getElementById(e):e,this.config=t.lang.object({}).merge(n).merge(i).get(),this._isCompatible=t.browser.supported(),"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0),this.config.noTextarea||(this.textarea=new t.views.Textarea(this,this.editableElement,this.config),this.currentView=this.textarea),!this._isCompatible||!this.config.supportTouchDevices&&t.browser.isTouchDevice()){var r=this;return void setTimeout(function(){r.fire("beforeload").fire("load")},0)}t.dom.addClass(document.body,this.config.bodyClassName),this.composer=new t.views.Composer(this,this.editableElement,this.config),this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new t.views.Synchronizer(this,this.textarea,this.composer)),this.config.toolbar&&(this.toolbar=new t.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(t,e){return this.currentView.getValue(t,e)},setValue:function(t,e){return this.fire("unset_placeholder"),t?(this.currentView.setValue(t,e),this):this.clear()},cleanUp:function(){this.currentView.cleanUp()},focus:function(t){return this.currentView.focus(t),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(e,n){var i=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,r=this.config.parser(e,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:i,uneditableClass:this.config.uneditableContainerClassname,clearInternals:n});return"object"==typeof e&&t.quirks.redraw(e),r},_initParser:function(){var e,n=this;t.browser.supportsModenPaste()?this.on("paste:composer",function(i){i.preventDefault(),(e=t.dom.getPastedHtml(i))&&n._cleanAndPaste(e)}):this.on("beforepaste:composer",function(e){e.preventDefault(),t.dom.getPastedHtmlWithDiv(n.composer,function(t){t&&n._cleanAndPaste(t)})})},_cleanAndPaste:function(e){var n=t.quirks.cleanPastedHTML(e,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.uneditableContainerClassname});this.composer.selection.deleteContents(),this.composer.selection.insertHTML(n)}})}(wysihtml5),function(t){var e=t.dom,n="wysihtml5-command-dialog-opened",i="input, select, textarea",r="[data-wysihtml5-dialog-field]",o="data-wysihtml5-dialog-field";t.toolbar.Dialog=t.lang.Dispatcher.extend({constructor:function(t,e){this.link=t,this.container=e},_observe:function(){var r,o,s,a,l,c;if(!this._observed){for(r=this,o=function(t){var e=r._serialize();e==r.elementToChange?r.fire("edit",e):r.fire("save",e),r.hide(),t.preventDefault(),t.stopPropagation()},e.observe(r.link,"click",function(){e.hasClass(r.link,n)&&setTimeout(function(){r.hide()},0)}),e.observe(this.container,"keydown",function(e){var n=e.keyCode;n===t.ENTER_KEY&&o(e),n===t.ESCAPE_KEY&&(r.fire("cancel"),r.hide())}),e.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",o),e.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(t){r.fire("cancel"),r.hide(),t.preventDefault(),t.stopPropagation()}),s=this.container.querySelectorAll(i),a=0,l=s.length,c=function(){clearInterval(r.interval)};l>a;a++)e.observe(s[a],"change",c);this._observed=!0}},_serialize:function(){for(var t=this.elementToChange||{},e=this.container.querySelectorAll(r),n=e.length,i=0;n>i;i++)t[e[i].getAttribute(o)]=e[i].value;return t},_interpolate:function(t){for(var e,n,i,s=document.querySelector(":focus"),a=this.container.querySelectorAll(r),l=a.length,c=0;l>c;c++)(e=a[c])!==s&&(t&&"hidden"===e.type||(n=e.getAttribute(o),i=this.elementToChange&&"boolean"!=typeof this.elementToChange?this.elementToChange.getAttribute(n)||"":e.defaultValue,e.value=i))},show:function(t){if(!e.hasClass(this.link,n)){var r=this,o=this.container.querySelector(i);if(this.elementToChange=t,this._observe(),this._interpolate(),t&&(this.interval=setInterval(function(){r._interpolate(!0)},500)),e.addClass(this.link,n),this.container.style.display="",this.fire("show"),o&&!t)try{o.focus()}catch(t){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,e.removeClass(this.link,n),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(t){var e=t.dom,n={position:"relative"},i={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},r={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},o={"x-webkit-speech":"",speech:""};t.toolbar.Speech=function(s,a){var l,c,h,u=document.createElement("input");return t.browser.supportsSpeechApiOn(u)?(l=s.editor.textarea.element.getAttribute("lang"),l&&(o.lang=l),c=document.createElement("div"),t.lang.object(i).merge({width:a.offsetWidth+"px",height:a.offsetHeight+"px"}),e.insert(u).into(c),e.insert(c).into(a),e.setStyles(r).on(u),e.setAttributes(o).on(u),e.setStyles(i).on(c),e.setStyles(n).on(a),h="onwebkitspeechchange"in u?"webkitspeechchange":"speechchange",e.observe(u,h,function(){s.execCommand("insertText",u.value),u.value=""}),void e.observe(u,"click",function(t){e.hasClass(a,"wysihtml5-command-disabled")&&t.preventDefault(),t.stopPropagation()})):void(a.style.display="none")}}(wysihtml5),function(t){var e="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",i="wysihtml5-command-active",r="wysihtml5-action-active",o=t.dom;t.toolbar.Toolbar=Base.extend({constructor:function(o,s,a){this.editor=o,this.container="string"==typeof s?document.getElementById(s):s,this.composer=o.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),a&&this.show(),null!=o.config.classNameCommandDisabled&&(e=o.config.classNameCommandDisabled),null!=o.config.classNameCommandsDisabled&&(n=o.config.classNameCommandsDisabled),null!=o.config.classNameCommandActive&&(i=o.config.classNameCommandActive),null!=o.config.classNameActionActive&&(r=o.config.classNameActionActive);for(var l=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),c=l.length,h=0;c>h;h++)new t.toolbar.Speech(this,l[h])},_getLinks:function(e){for(var n,i,r,o,s,a=this[e+"Links"]=t.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+e+"]")).get(),l=a.length,c=0,h=this[e+"Mapping"]={};l>c;c++)n=a[c],r=n.getAttribute("data-wysihtml5-"+e),o=n.getAttribute("data-wysihtml5-"+e+"-value"),i=this.container.querySelector("[data-wysihtml5-"+e+"-group='"+r+"']"),s=this._getDialog(n,r),h[r+":"+o]={link:n,group:i,name:r,value:o,dialog:s,state:!1}},_getDialog:function(e,n){var i,r,o=this,s=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return s&&(i=t.toolbar["Dialog_"+n]?new t.toolbar["Dialog_"+n](e,s):new t.toolbar.Dialog(e,s),i.on("show",function(){r=o.composer.selection.getBookmark(),o.editor.fire("show:dialog",{command:n,dialogContainer:s,commandLink:e})}),i.on("save",function(t){r&&o.composer.selection.setBookmark(r),o._execCommand(n,t),o.editor.fire("save:dialog",{command:n,dialogContainer:s,commandLink:e})}),i.on("cancel",function(){o.editor.focus(!1),o.editor.fire("cancel:dialog",{command:n,dialogContainer:s,commandLink:e})})),i},execCommand:function(t,e){if(!this.commandsDisabled){var n=this.commandMapping[t+":"+e];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(t,e)}},_execCommand:function(t,e){this.editor.focus(!1),this.composer.commands.exec(t,e),this._updateLinkStates()},
execAction:function(t){var e=this.editor;"change_view"===t&&e.textarea&&(e.currentView===e.textarea?e.fire("change_view","composer"):e.fire("change_view","textarea")),"showSource"==t&&e.fire("showSource")},_observe:function(){for(var t=this,e=this.editor,i=this.container,r=this.commandLinks.concat(this.actionLinks),s=r.length,a=0;s>a;a++)"A"===r[a].nodeName?o.setAttributes({href:"javascript:;",unselectable:"on"}).on(r[a]):o.setAttributes({unselectable:"on"}).on(r[a]);o.delegate(i,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(t){t.preventDefault()}),o.delegate(i,"[data-wysihtml5-command]","click",function(e){var n=this,i=n.getAttribute("data-wysihtml5-command"),r=n.getAttribute("data-wysihtml5-command-value");t.execCommand(i,r),e.preventDefault()}),o.delegate(i,"[data-wysihtml5-action]","click",function(e){var n=this.getAttribute("data-wysihtml5-action");t.execAction(n),e.preventDefault()}),e.on("interaction:composer",function(){t._updateLinkStates()}),e.on("focus:composer",function(){t.bookmark=null}),this.editor.config.handleTables&&(e.on("tableselect:composer",function(){t.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),e.on("tableunselect:composer",function(){t.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})),e.on("change_view",function(r){e.textarea&&setTimeout(function(){t.commandsDisabled="composer"!==r,t._updateLinkStates(),t.commandsDisabled?o.addClass(i,n):o.removeClass(i,n)},0)})},_updateLinkStates:function(){var n,s,a,l,c=this.commandMapping,h=this.actionMapping;for(n in c)l=c[n],this.commandsDisabled?(s=!1,o.removeClass(l.link,i),l.group&&o.removeClass(l.group,i),l.dialog&&l.dialog.hide()):(s=this.composer.commands.state(l.name,l.value),o.removeClass(l.link,e),l.group&&o.removeClass(l.group,e)),l.state!==s&&(l.state=s,s?(o.addClass(l.link,i),l.group&&o.addClass(l.group,i),l.dialog&&("object"==typeof s||t.lang.object(s).isArray()?(!l.dialog.multiselect&&t.lang.object(s).isArray()&&(s=1!==s.length||s[0],l.state=s),l.dialog.show(s)):l.dialog.hide())):(o.removeClass(l.link,i),l.group&&o.removeClass(l.group,i),l.dialog&&l.dialog.hide()));for(n in h)a=h[n],"change_view"===a.name&&(a.state=this.editor.currentView===this.editor.textarea,a.state?o.addClass(a.link,r):o.removeClass(a.link,r))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(t){t.toolbar.Dialog_createTable=t.toolbar.Dialog.extend({show:function(t){this.base(t)}})}(wysihtml5),function(t){var e=(t.dom,"[data-wysihtml5-dialog-field]"),n="data-wysihtml5-dialog-field";t.toolbar.Dialog_foreColorStyle=t.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var t={},i=this.container.querySelectorAll(e),r=i.length,o=0;r>o;o++)t[i[o].getAttribute(n)]=i[o].value;return t},_interpolate:function(i){for(var r,o=document.querySelector(":focus"),s=this.container.querySelectorAll(e),a=s.length,l=0,c=this.elementToChange?t.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,h=c?c.getAttribute("style"):null,u=h?t.quirks.styleParser.parseColor(h,"color"):null;a>l;l++)(r=s[l])!==o&&(i&&"hidden"===r.type||"color"===r.getAttribute(n)&&(r.value=u?u[3]&&1!=u[3]?"rgba("+u[0]+","+u[1]+","+u[2]+","+u[3]+");":"rgb("+u[0]+","+u[1]+","+u[2]+");":"rgb(0,0,0);"))}})}(wysihtml5),function(t){t.dom,t.toolbar.Dialog_fontSizeStyle=t.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(){var e=document.querySelector(":focus"),n=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),i=this.elementToChange?t.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,r=i?i.getAttribute("style"):null,o=r?t.quirks.styleParser.parseFontSize(r):null;n&&n!==e&&o&&!/^\s*$/.test(o)&&(n.value=o)}})}(wysihtml5),Handlebars=function(){var t=function(){"use strict";function t(t){this.string=t}return t.prototype.toString=function(){return""+this.string},t}(),e=function(t){"use strict";function e(t){return h[t]||"&amp;"}function n(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function i(t){return t instanceof c?""+t:t||0===t?(t=""+t,d.test(t)?t.replace(u,e):t):""}function r(t){return!t&&0!==t||!(!a(t)||0!==t.length)}var o,s,a,l={},c=t,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,d=/[&<>"'`]/;return l.extend=n,o=Object.prototype.toString,l.toString=o,s=function(t){return"function"==typeof t},s(/x/)&&(s=function(t){return"function"==typeof t&&"[object Function]"===o.call(t)}),l.isFunction=s,a=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===o.call(t)},l.isArray=a,l.escapeExpression=i,l.isEmpty=r,l}(t),n=function(){"use strict";function t(t,n){var i,r,o;for(n&&n.firstLine&&(i=n.firstLine,t+=" - "+i+":"+n.firstColumn),r=Error.prototype.constructor.call(this,t),o=0;o<e.length;o++)this[e[o]]=r[e[o]];i&&(this.lineNumber=i,this.column=n.firstColumn)}var e=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=Error(),t}(),i=function(t,e){"use strict";function n(t,e){this.helpers=t||{},this.partials=e||{},i(this)}function i(t){t.registerHelper("helperMissing",function(t){if(2!==arguments.length)throw new m("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,n){var i=n.inverse||function(){},r=n.fn;return l(e)&&(e=e.call(this)),!0===e?r(this):!1===e||null==e?i(this):a(e)?e.length>0?t.helpers.each(e,n):i(this):r(e)}),t.registerHelper("each",function(t,e){var n,i,r,o=e.fn,s=e.inverse,c=0,h="";if(l(t)&&(t=t.call(this)),e.data&&(n=d(e.data)),t&&"object"==typeof t)if(a(t))for(i=t.length;i>c;c++)n&&(n.index=c,n.first=0===c,n.last=c===t.length-1),h+=o(t[c],{data:n});else for(r in t)t.hasOwnProperty(r)&&(n&&(n.key=r,n.index=c,n.first=0===c),h+=o(t[r],{data:n}),c++);return 0===c&&(h=s(this)),h}),t.registerHelper("if",function(t,e){return l(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||p.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers.if.call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){return l(t)&&(t=t.call(this)),p.isEmpty(t)?void 0:e.fn(t)}),t.registerHelper("log",function(e,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(i,e)})}function r(t,e){u.log(t,e)}var o,s,a,l,c,h,u,d,f={},p=t,m=e;return f.VERSION="1.3.0",o=4,f.COMPILER_REVISION=o,s={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},f.REVISION_CHANGES=s,a=p.isArray,l=p.isFunction,c=p.toString,h="[object Object]",f.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:u,log:r,registerHelper:function(t,e,n){if(c.call(t)===h){if(n||e)throw new m("Arg not supported with multiple helpers");p.extend(this.helpers,t)}else n&&(e.not=n),this.helpers[t]=e},registerPartial:function(t,e){c.call(t)===h?p.extend(this.partials,t):this.partials[t]=e}},u={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(u.level<=t){var n=u.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,e)}}},f.logger=u,f.log=r,d=function(t){var e={};return p.extend(e,t),e},f.createFrame=d,f}(e,n),r=function(t,e,n){"use strict";function i(t){var e,n,i=t&&t[0]||1,r=d;if(i!==r){if(r>i)throw e=f[r],n=f[i],new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+e+") or downgrade your runtime to an older version ("+n+").");throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){if(!e)throw new u("No environment passed to template");var n=function(t,n,i,r,o,s){var a,l=e.VM.invokePartial.apply(this,arguments);if(null!=l)return l;if(e.compile)return a={helpers:r,partials:o,data:s},o[n]=e.compile(t,{data:void 0!==s},e),o[n](i,a);throw new u("The partial "+n+" could not be compiled when running in runtime-only mode")},i={escapeExpression:h.escapeExpression,invokePartial:n,programs:[],program:function(t,e,n){var i=this.programs[t];return n?i=s(t,e,n):i||(i=this.programs[t]=s(t,e)),i},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n={},h.extend(n,e),h.extend(n,t)),n},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(n,r){var o,s,a,l;return r=r||{},a=r.partial?r:e,r.partial||(o=r.helpers,s=r.partials),l=t.call(i,a,n,o,s,r.data),r.partial||e.VM.checkRevision(i.compilerInfo),l}}function o(t,e,n){var i=Array.prototype.slice.call(arguments,3),r=function(t,r){return r=r||{},e.apply(this,[t,r.data||n].concat(i))};return r.program=t,r.depth=i.length,r}function s(t,e,n){var i=function(t,i){return i=i||{},e(t,i.data||n)};return i.program=t,i.depth=0,i}function a(t,e,n,i,r,o){var s={partial:!0,helpers:i,partials:r,data:o};if(void 0===t)throw new u("The partial "+e+" could not be found");return t instanceof Function?t(n,s):void 0}function l(){return""}var c={},h=t,u=e,d=n.COMPILER_REVISION,f=n.REVISION_CHANGES;return c.checkRevision=i,c.template=r,c.programWithDepth=o,c.program=s,c.invokePartial=a,c.noop=l,c}(e,n,i);return function(t,e,n,i,r){"use strict";var o=t,s=e,a=n,l=i,c=r,h=function(){var t=new o.HandlebarsEnvironment;return l.extend(t,o),t.SafeString=s,t.Exception=a,t.Utils=l,t.VM=c,t.template=function(e){return c.template(e,t)},t},u=h();return u.create=h,u}(i,t,n,e,r)}(),this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.blockquote=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return' \n      <span class="fa fa-quote-left"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li>\n  <a class="btn ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.color=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+c((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===l?e.apply(t):e))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var s,a="",l="function",c=this.escapeExpression,h=this;return a+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',s=n.if.call(e,(s=e&&e.options,s=null==s||!1===s?s:s.toolbar,null==s||!1===s?s:s.size),{hash:{},inverse:h.noop,fn:h.program(1,o,r),data:r}),(s||0===s)&&(a+=s),a+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.black,typeof s===l?s.apply(e):s))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.black,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.silver,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.gray,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.maroon,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.red,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.purple,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.green,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.olive,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.navy,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.blue,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.orange,typeof s===l?s.apply(e):s))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.emphasis=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+h((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===c?e.apply(t):e))}function s(t,e){var i,r="";return r+='\n    <a class="btn ',i=n.if.call(t,(i=t&&t.options,i=null==i||!1===i?i:i.toolbar,null==i||!1===i?i:i.size),{hash:{},inverse:u.noop,fn:u.program(1,o,e),data:e}),(i||0===i)&&(r+=i),r+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+h((i=t&&t.locale,i=null==i||!1===i?i:i.emphasis,i=null==i||!1===i?i:i.small,typeof i===c?i.apply(t):i))+"</a>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var a,l="",c="function",h=this.escapeExpression,u=this;return l+='<li>\n  <div class="btn-group">\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.bold,typeof a===c?a.apply(e):a))+'</a>\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.italic,typeof a===c?a.apply(e):a))+'</a>\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.underline,typeof a===c?a.apply(e):a))+"</a>\n    ",a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,a=null==a||!1===a?a:a.emphasis,null==a||!1===a?a:a.small),{hash:{},inverse:u.noop,fn:u.program(3,s,r),data:r}),(a||0===a)&&(l+=a),l+="\n  </div>\n</li>\n"}),this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return'\n      <span class="fa fa-font"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+='" data-toggle="dropdown">\n    ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+='\n    <span class="current-font">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.normal,typeof l===h?l.apply(e):l))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.normal,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h1,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h2,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h3,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h4,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h5,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h6,typeof l===h?l.apply(e):l))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.html=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return'\n        <span class="fa fa-pencil"></span>\n      '}function a(){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li>\n  <div class="btn-group">\n    <a class="btn ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-action="change_view" title="'+u((l=e&&e.locale,l=null==l||!1===l?l:l.html,l=null==l||!1===l?l:l.edit,typeof l===h?l.apply(e):l))+'" tabindex="-1">\n      ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+="\n    </a>\n  </div>\n</li>\n"}),this.wysihtml5.tpl.image=Handlebars.template(function(t,e,n,i,r){function o(){return"modal-sm"}function s(t){var e,n="";return n+="btn-"+d((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===u?e.apply(t):e))}function a(){return'\n      <span class="fa fa-file-image-o"></span>\n    '}function l(){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var c,h="",u="function",d=this.escapeExpression,f=this;return h+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,o,r),data:r}),(c||0===c)&&(h+=c),h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.cancel,typeof c===u?c.apply(e):c))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,r),data:r}),(c||0===c)&&(h+=c),h+=' btn-default" data-wysihtml5-command="insertImage" title="'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'" tabindex="-1">\n    ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.fa),{hash:{},inverse:f.program(7,l,r),fn:f.program(5,a,r),data:r}),(c||0===c)&&(h+=c),h+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.link=Handlebars.template(function(t,e,n,i,r){function o(){return"modal-sm"}function s(t){var e,n="";return n+="btn-"+d((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===u?e.apply(t):e))}function a(){return'\n      <span class="fa fa-share-square-o"></span>\n    '}function l(){return'\n      <span class="glyphicon glyphicon-share"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var c,h="",u="function",d=this.escapeExpression,f=this;return h+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,o,r),data:r}),(c||0===c)&&(h+=c),h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.target,typeof c===u?c.apply(e):c))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.cancel,typeof c===u?c.apply(e):c))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,r),data:r}),(c||0===c)&&(h+=c),h+=' btn-default" data-wysihtml5-command="createLink" title="'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'" tabindex="-1">\n    ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.fa),{hash:{},inverse:f.program(7,l,r),fn:f.program(5,a,r),data:r}),(c||0===c)&&(h+=c),h+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.lists=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+y((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===g?e.apply(t):e))}function s(){return'\n      <span class="fa fa-list-ul"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '}function l(){return'\n      <span class="fa fa-list-ol"></span>\n    '}function c(){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '}function h(){return'\n      <span class="fa fa-outdent"></span>\n    '}function u(){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '}function d(){return'\n      <span class="fa fa-indent"></span>\n    '}function f(){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var p,m="",g="function",y=this.escapeExpression,v=this;return m+='<li>\n  <div class="btn-group">\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.unordered,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(5,a,r),fn:v.program(3,s,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.ordered,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(9,c,r),fn:v.program(7,l,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Outdent" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.outdent,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(13,u,r),fn:v.program(11,h,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Indent" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.indent,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(17,f,r),fn:v.program(15,d,r),data:r}),(p||0===p)&&(m+=p),m+="\n    </a>\n  </div>\n</li>\n"}),function(t){"use strict";"function"==typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],t):t(jQuery,wysihtml5)}(function(t,e){"use strict";!function(t,e){var n,i,r,o=function(t,n,i){return e.tpl[t]?e.tpl[t]({locale:n,options:i}):void 0},s=function(n,r){var o,s;this.el=n,o=t.extend(!0,{},i,r);for(s in o.customTemplates)o.customTemplates.hasOwnProperty(s)&&(e.tpl[s]=o.customTemplates[s]);this.toolbar=this.createToolbar(n,o),this.editor=this.createEditor(o)};s.prototype={constructor:s,createEditor:function(e){e=e||{},e=t.extend(!0,{},e),e.toolbar=this.toolbar[0],this.initializeEditor(this.el[0],e)},initializeEditor:function(t,n){var i,r=new e.Editor(this.el[0],n);if(r.on("beforeload",this.syncBootstrapDialogEvents),r.on("beforeload",this.loadParserRules),r.composer.editableArea.contentDocument?this.addMoreShortcuts(r,r.composer.editableArea.contentDocument.body||r.composer.editableArea.contentDocument,n.shortcuts):this.addMoreShortcuts(r,r.composer.editableArea,n.shortcuts),n&&n.events)for(i in n.events)n.events.hasOwnProperty(i)&&r.on(i,n.events[i]);return r},loadParserRules:function(){"string"===t.type(this.config.parserRules)&&t.ajax({dataType:"json",url:this.config.parserRules,context:this,error:function(t,e,n){},success:function(t){this.config.parserRules=t}}),this.config.pasteParserRulesets&&"string"===t.type(this.config.pasteParserRulesets)&&t.ajax({dataType:"json",url:this.config.pasteParserRulesets,context:this,error:function(t,e,n){},success:function(t){this.config.pasteParserRulesets=t}})},syncBootstrapDialogEvents:function(){var e=this;t.map(this.toolbar.commandMapping,function(t){return[t]}).filter(function(t){return t.dialog}).map(function(t){return t.dialog}).forEach(function(n){n.on("show",function(){t(this.container).modal("show")}),n.on("hide",function(){t(this.container).modal("hide"),setTimeout(e.composer.focus,0)}),t(n.container).on("shown.bs.modal",function(){t(this).find("input, select, textarea").first().focus()})}),this.on("change_view",function(){t(this.toolbar.container.children).find("a.btn").not('[data-wysihtml5-action="change_view"]').toggleClass("disabled")})},createToolbar:function(e,n){var s,a,l=this,c=t("<ul/>",{class:"wysihtml5-toolbar",style:"display:none"}),h=n.locale||i.locale||"en";r.hasOwnProperty(h)||(h="en"),s=t.extend(!0,{},r.en,r[h]);for(a in n.toolbar)n.toolbar[a]&&c.append(o(a,s,n));return c.find('a[data-wysihtml5-command="formatBlock"]').click(function(e){var n=e.delegateTarget||e.target||e.srcElement,i=t(n),r=i.data("wysihtml5-display-format-name"),o=i.data("wysihtml5-format-name")||i.html()
;(void 0===r||"true"===r)&&l.toolbar.find(".current-font").text(o)}),c.find('a[data-wysihtml5-command="foreColor"]').click(function(e){var n=e.target||e.srcElement,i=t(n);l.toolbar.find(".current-color").text(i.html())}),this.el.before(c),c},addMoreShortcuts:function(t,n,i){e.dom.observe(n,"keydown",function(n){var r,o=n.keyCode,s=i[o];(n.ctrlKey||n.metaKey||n.altKey)&&s&&e.commands[s]&&(r=t.toolbar.commandMapping[s+":null"],r&&r.dialog&&!r.state?r.dialog.show():e.commands[s].exec(t.composer,s),n.preventDefault())})}},n={resetDefaults:function(){t.fn.wysihtml5.defaultOptions=t.extend(!0,{},t.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(e){return this.each(function(){var n=t(this);n.data("wysihtml5",new s(n,e))})},shallowExtend:function(e){var i=t.extend({},t.fn.wysihtml5.defaultOptions,e||{},t(this).data()),r=this;return n.bypassDefaults.apply(r,[i])},deepExtend:function(e){var i=t.extend(!0,{},t.fn.wysihtml5.defaultOptions,e||{}),r=this;return n.bypassDefaults.apply(r,[i])},init:function(t){var e=this;return n.shallowExtend.apply(e,[t])}},t.fn.wysihtml5=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.wysihtml5"):n.init.apply(this,arguments)},t.fn.wysihtml5.Constructor=s,i=t.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},useLineBreaks:!1,parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small",75:"createLink"}},void 0===t.fn.wysihtml5.defaultOptionsCache&&(t.fn.wysihtml5.defaultOptionsCache=t.extend(!0,{},t.fn.wysihtml5.defaultOptions)),r=t.fn.wysihtml5.locale={}}(t,e)}),function(t){t.commands.small={exec:function(e,n){return t.commands.formatInline.exec(e,n,"small")},state:function(e,n){return t.commands.formatInline.state(e,n,"small")}}}(wysihtml5),function(t){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],t):t(jQuery)}(function(t){t.fn.wysihtml5.locale.en=t.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}});var wysihtml5,Base,Handlebars;Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&function(){var t=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return t.get.call(this)},set:function(e){return t.set.call(this,e)}})}(),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),wysihtml5={version:"0.4.15",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46},function(t,e){"function"==typeof define&&define.amd?define(t):e.rangy=t()}(function(){function t(t,e){var n=typeof t[e];return n==_||!(n!=C||!t[e])||"unknown"==n}function e(t,e){return!(typeof t[e]!=C||!t[e])}function n(t,e){return typeof t[e]!=S}function i(t){return function(e,n){for(var i=n.length;i--;)if(!t(e,n[i]))return!1;return!0}}function r(t){return t&&k(t,R)&&O(t,T)}function o(t){return e(t,"body")?t.body:t.getElementsByTagName("body")[0]}function s(n){e(window,"console")&&t(window.console,"log")&&window.console.log(n)}function a(t,e){e?window.alert(t):s(t)}function l(t){I.initialized=!0,I.supported=!1,a("Rangy is not supported on this page in your browser. Reason: "+t,I.config.alertOnFail)}function c(t){a("Rangy warning: "+t,I.config.alertOnWarn)}function h(t){return t.message||t.description||t+""}function u(){var e,n,i,a,c,u,d,p,m;if(!I.initialized){if(n=!1,i=!1,t(document,"createRange")&&(e=document.createRange(),k(e,E)&&O(e,N)&&(n=!0)),!(a=o(document))||"body"!=a.nodeName.toLowerCase())return void l("No body element found");if(a&&t(a,"createTextRange")&&(e=a.createTextRange(),r(e)&&(i=!0)),!n&&!i)return void l("Neither Range nor TextRange are available");I.initialized=!0,I.features={implementsDomRange:n,implementsTextRange:i};for(d in D)(c=D[d])instanceof f&&c.init(c,I);for(p=0,m=v.length;m>p;++p)try{v[p](I)}catch(t){u="Rangy init listener threw an exception. Continuing. Detail: "+h(t),s(u)}}}function d(t){t=t||window,u();for(var e=0,n=b.length;n>e;++e)b[e](t)}function f(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function p(t,e,n,i){var r=new f(e,n,function(t){if(!t.initialized){t.initialized=!0;try{i(I,t),t.supported=!0}catch(t){var n="Module '"+e+"' failed to load: "+h(t);s(n)}}});D[e]=r}function m(){}function g(){}var y,v,b,w,x,C="object",_="function",S="undefined",N=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],E=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],T=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],R=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],k=i(t),A=i(e),O=i(n),D={},I={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:t,isHostObject:e,isHostProperty:n,areHostMethods:k,areHostObjects:A,areHostProperties:O,isTextRange:r,getBody:o},features:{},modules:D,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==S||rangyAutoInitialize}};return I.fail=l,I.warn=c,{}.hasOwnProperty?I.util.extend=function(t,e,n){var i,r,o;for(o in e)e.hasOwnProperty(o)&&(i=t[o],r=e[o],n&&null!==i&&"object"==typeof i&&null!==r&&"object"==typeof r&&I.util.extend(i,r,!0),t[o]=r);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t}:l("hasOwnProperty not supported"),function(){var t,e,n=document.createElement("div");n.appendChild(document.createElement("span")),t=[].slice;try{1==t.call(n.childNodes,0)[0].nodeType&&(e=function(e){return t.call(e,0)})}catch(t){}e||(e=function(t){var e,n,i=[];for(e=0,n=t.length;n>e;++e)i[e]=t[e];return i}),I.util.toArray=e}(),t(document,"addEventListener")?y=function(t,e,n){t.addEventListener(e,n,!1)}:t(document,"attachEvent")?y=function(t,e,n){t.attachEvent("on"+e,n)}:l("Document does not have required addEventListener or attachEvent method"),I.util.addListener=y,v=[],I.init=u,I.addInitListener=function(t){I.initialized?t(I):v.push(t)},b=[],I.addShimListener=function(t){b.push(t)},I.shim=I.createMissingNativeApi=d,f.prototype={init:function(){var t,e,n,i,r=this.dependencies||[];for(t=0,e=r.length;e>t;++t){if(i=r[t],!((n=D[i])&&n instanceof f))throw Error("required module '"+i+"' not found");if(n.init(),!n.supported)throw Error("required module '"+i+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+t)},warn:function(t){I.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){I.warn("DEPRECATED: "+t+" in module "+this.name+"is deprecated. Please use "+e+" instead")},createError:function(t){return Error("Error in Rangy "+this.name+" module: "+t)}},I.createModule=function(t){var e,n,i;2==arguments.length?(e=arguments[1],n=[]):(e=arguments[2],n=arguments[1]),i=p(!1,t,n,e),I.initialized&&i.init()},I.createCoreModule=function(t,e,n){p(!0,t,e,n)},I.RangePrototype=m,I.rangePrototype=new m,I.selectionPrototype=new g,w=!1,x=function(){w||(w=!0,!I.initialized&&I.config.autoInitialize&&u())},typeof window==S?void l("No window found"):typeof document==S?void l("No document found"):(t(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",x,!1),y(window,"load",x),I.createCoreModule("DomUtil",[],function(t,e){function n(t){var e;return typeof t.namespaceURI==M||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e}function i(t){var e=t.parentNode;return 1==e.nodeType?e:null}function r(t){for(var e=0;t=t.previousSibling;)++e;return e}function o(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}}function s(t,e){var n,i=[];for(n=t;n;n=n.parentNode)i.push(n);for(n=e;n;n=n.parentNode)if(O(i,n))return n;return null}function a(t,e,n){for(var i=n?e:e.parentNode;i;){if(i===t)return!0;i=i.parentNode}return!1}function l(t,e){return a(t,e,!0)}function c(t,e,n){for(var i,r=n?t:t.parentNode;r;){if((i=r.parentNode)===e)return r;r=i}return null}function h(t){var e=t.nodeType;return 3==e||4==e||8==e}function u(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e}function d(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t}function f(t,e,n){var i,o,s=t.cloneNode(!1);if(s.deleteData(0,e),t.deleteData(e,t.length-e),d(s,t),n)for(i=0;o=n[i++];)o.node==t&&o.offset>e?(o.node=s,o.offset-=e):o.node==t.parentNode&&o.offset>r(t)&&++o.offset;return s}function p(t){if(9==t.nodeType)return t;if(typeof t.ownerDocument!=M)return t.ownerDocument;if(typeof t.document!=M)return t.document;if(t.parentNode)return p(t.parentNode);throw e.createError("getDocument: no document found for node")}function m(t){var n=p(t);if(typeof n.defaultView!=M)return n.defaultView;if(typeof n.parentWindow!=M)return n.parentWindow;throw e.createError("Cannot get a window object for node")}function g(t){if(typeof t.contentDocument!=M)return t.contentDocument;if(typeof t.contentWindow!=M)return t.contentWindow.document;throw e.createError("getIframeDocument: No Document object found for iframe element")}function y(t){if(typeof t.contentWindow!=M)return t.contentWindow;if(typeof t.contentDocument!=M)return t.contentDocument.defaultView;throw e.createError("getIframeWindow: No Window object found for iframe element")}function v(t){return t&&L.isHostMethod(t,"setTimeout")&&L.isHostObject(t,"document")}function b(t,e,n){var i;if(t?L.isHostProperty(t,"nodeType")?i=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?g(t):p(t):v(t)&&(i=t.document):i=document,!i)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return i}function w(t){for(var e;e=t.parentNode;)t=e;return t}function x(t,n,i,o){var a,l,h,u,d;if(t==i)return n===o?0:o>n?-1:1;if(a=c(i,t,!0))return n<=r(a)?-1:1;if(a=c(t,i,!0))return r(a)<o?-1:1;if(!(l=s(t,i)))throw Error("comparePoints error: nodes have no common ancestor");if(h=t===l?l:c(t,l,!0),u=i===l?l:c(i,l,!0),h===u)throw e.createError("comparePoints got to case 4 and childA and childB are the same!");for(d=l.firstChild;d;){if(d===h)return-1;if(d===u)return 1;d=d.nextSibling}}function C(t){try{return t.parentNode,!1}catch(t){return!0}}function _(t){if(!t)return"[No node]";if(D&&C(t))return"[Broken node]";if(h(t))return'"'+t.data+'"';if(1==t.nodeType){var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+r(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return t.nodeName}function S(t){for(var e,n=p(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}function N(t){this.root=t,this._next=t}function E(t){return new N(t)}function T(t,e){this.node=t,this.offset=e}function R(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}var k,A,O,D,I,M="undefined",L=t.util;L.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||e.fail("document missing a Node creation method"),L.isHostMethod(document,"getElementsByTagName")||e.fail("document missing getElementsByTagName method"),k=document.createElement("div"),L.areHostMethods(k,["insertBefore","appendChild","cloneNode"]||!L.areHostObjects(k,["previousSibling","nextSibling","childNodes","parentNode"]))||e.fail("Incomplete Element implementation"),L.isHostProperty(k,"innerHTML")||e.fail("Element is missing innerHTML property"),A=document.createTextNode("test"),L.areHostMethods(A,["splitText","deleteData","insertData","appendData","cloneNode"]||!L.areHostObjects(k,["previousSibling","nextSibling","childNodes","parentNode"])||!L.areHostProperties(A,["data"]))||e.fail("Incomplete Text Node implementation"),O=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},D=!1,function(){var e,n=document.createElement("b");n.innerHTML="1",e=n.firstChild,n.innerHTML="<br>",D=C(e),t.features.crashyTextNodes=D}(),typeof window.getComputedStyle!=M?I=function(t,e){return m(t).getComputedStyle(t,null)[e]}:typeof document.documentElement.currentStyle!=M?I=function(t,e){return t.currentStyle[e]}:e.fail("No means of obtaining computed style properties found"),N.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},T.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+_(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},R.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},R.prototype.toString=function(){return this.message},t.dom={arrayContains:O,isHtmlNamespace:n,parentElement:i,getNodeIndex:r,getNodeLength:o,getCommonAncestor:s,isAncestorOf:a,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:h,isTextOrCommentNode:u,insertAfter:d,splitDataNode:f,getDocument:p,getWindow:m,getIframeWindow:y,getIframeDocument:g,getBody:L.getBody,isWindow:v,getContentDocument:b,getRootContainer:w,comparePoints:x,isBrokenNode:C,inspectNode:_,getComputedStyleProperty:I,fragmentFromNodeChildren:S,createIterator:E,DomPosition:T},t.DOMException=R}),I.createCoreModule("DomRange",["DomUtil"],function(t){function e(t,e){return 3!=t.nodeType&&(st(t,e.startContainer)||st(t,e.endContainer))}function n(t){return t.document||at(t.startContainer)}function i(t){return new nt(t.parentNode,ot(t))}function r(t){return new nt(t.parentNode,ot(t)+1)}function o(t,e,n){var i=11==t.nodeType?t.firstChild:t;return rt(e)?n==e.length?tt.insertAfter(t,e):e.parentNode.insertBefore(t,0==n?e:ct(e,n)):n>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n]),i}function s(t,e,i){if(S(t),S(e),n(e)!=n(t))throw new it("WRONG_DOCUMENT_ERR");var r=lt(t.startContainer,t.startOffset,e.endContainer,e.endOffset),o=lt(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return i?0>=r&&o>=0:0>r&&o>0}function a(t){var e,i,r,o;for(r=n(t.range).createDocumentFragment();i=t.next();){if(e=t.isPartiallySelectedSubtree(),i=i.cloneNode(!e),e&&(o=t.getSubtreeIterator(),i.appendChild(a(o)),o.detach()),10==i.nodeType)throw new it("HIERARCHY_REQUEST_ERR");r.appendChild(i)}return r}function l(t,e,n){var i,r,o,s;for(n=n||{stop:!1};o=t.next();)if(t.isPartiallySelectedSubtree()){if(!1===e(o))return void(n.stop=!0);if(s=t.getSubtreeIterator(),l(s,e,n),s.detach(),n.stop)return}else for(i=tt.createIterator(o);r=i.next();)if(!1===e(r))return void(n.stop=!0)}function c(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(e=t.getSubtreeIterator(),c(e),e.detach()):t.remove()}function h(t){for(var e,i,r=n(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),i=t.getSubtreeIterator(),e.appendChild(h(i)),i.detach()):t.remove(),10==e.nodeType)throw new it("HIERARCHY_REQUEST_ERR");r.appendChild(e)}return r}function u(t,e,n){var i,r,o=!(!e||!e.length),s=!!n;return o&&(i=RegExp("^("+e.join("|")+")$")),r=[],l(new f(t,!1),function(e){var a,l;(!o||i.test(e.nodeType))&&(!s||n(e))&&(a=t.startContainer,e==a&&rt(a)&&t.startOffset==a.length||(l=t.endContainer,e==l&&rt(l)&&0==t.endOffset||r.push(e)))}),r}function d(t){return"["+(void 0===t.getName?"Range":t.getName())+"("+tt.inspectNode(t.startContainer)+":"+t.startOffset+", "+tt.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function f(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&rt(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||rt(this.sc)?ht(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||rt(this.ec)?ht(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function p(t){return function(e,n){for(var i,r=n?e:e.parentNode;r;){if(i=r.nodeType,dt(t,i))return r;r=r.parentNode}return null}}function m(t,e){if(j(t,e))throw new it("INVALID_NODE_TYPE_ERR")}function g(t,e){if(!dt(e,t.nodeType))throw new it("INVALID_NODE_TYPE_ERR")}function y(t,e){if(0>e||e>(rt(t)?t.length:t.childNodes.length))throw new it("INDEX_SIZE_ERR")}function v(t,e){if(z(t,!0)!==z(e,!0))throw new it("WRONG_DOCUMENT_ERR")}function b(t){if(W(t,!0))throw new it("NO_MODIFICATION_ALLOWED_ERR")}function w(t,e){if(!t)throw new it(e)}function x(t){return pt&&tt.isBrokenNode(t)||!dt(L,t.nodeType)&&!z(t,!0)}function C(t,e){return e<=(rt(t)?t.length:t.childNodes.length)}function _(t){return!!t.startContainer&&!!t.endContainer&&!x(t.startContainer)&&!x(t.endContainer)&&C(t.startContainer,t.startOffset)&&C(t.endContainer,t.endOffset)}function S(t){if(!_(t))throw Error("Range error: Range is no longer valid after DOM mutation ("+t.inspect()+")")}function N(t,e){var n,i,r,o,s;S(t),n=t.startContainer,i=t.startOffset,r=t.endContainer,o=t.endOffset,s=n===r,rt(r)&&o>0&&o<r.length&&ct(r,o,e),rt(n)&&i>0&&i<n.length&&(n=ct(n,i,e),s?(o-=i,r=n):r==n.parentNode&&o>=ot(n)&&o++,i=0),t.setStartAndEnd(n,i,r,o)}function E(t){S(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}function T(t){t.START_TO_START=U,t.START_TO_END=Y,t.END_TO_END=G,t.END_TO_START=X,t.NODE_BEFORE=K,t.NODE_AFTER=Q,t.NODE_BEFORE_AND_AFTER=Z,t.NODE_INSIDE=J}function R(t){T(t),T(t.prototype)}function k(t,e){return function(){var n,i,o,s,a,c,h;return S(this),n=this.startContainer,i=this.startOffset,o=this.commonAncestorContainer,s=new f(this,!0),n!==o&&(a=ht(n,o,!0),c=r(a),n=c.node,i=c.offset),l(s,b),s.reset(),h=t(s),s.detach(),e(this,n,i,n,i),h}}function A(n,o){function s(t,e){return function(n){g(n,M),g(ft(n),L);var o=(t?i:r)(n);(e?a:l)(this,o.node,o.offset)}}function a(t,e,n){var i=t.endContainer,r=t.endOffset;(e!==t.startContainer||n!==t.startOffset)&&((ft(e)!=ft(i)||1==lt(e,n,i,r))&&(i=e,r=n),o(t,e,n,i,r))}function l(t,e,n){var i=t.startContainer,r=t.startOffset;(e!==t.endContainer||n!==t.endOffset)&&((ft(e)!=ft(i)||-1==lt(e,n,i,r))&&(i=e,r=n),o(t,i,r,e,n))}var u=function(){};u.prototype=t.rangePrototype,n.prototype=new u,et.extend(n.prototype,{setStart:function(t,e){m(t,!0),y(t,e),a(this,t,e)},setEnd:function(t,e){m(t,!0),y(t,e),l(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],n=t[1],i=e,r=n;switch(t.length){case 3:r=t[2];break;case 4:i=t[2],r=t[3]}o(this,e,n,i,r)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(t){S(this),t?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){m(t,!0),o(this,t,0,t,ut(t))},selectNode:function(t){m(t,!1),g(t,M);var e=i(t),n=r(t);o(this,e.node,e.offset,n.node,n.offset)},extractContents:k(h,o),deleteContents:k(c,o),canSurroundContents:function(){var t,n;return S(this),b(this.startContainer),b(this.endContainer),t=new f(this,!0),n=t._first&&e(t._first,this)||t._last&&e(t._last,this),t.detach(),!n},splitBoundaries:function(){N(this)},splitBoundariesPreservingPositions:function(t){N(this,t)},normalizeBoundaries:function(){var t,e,n,i,r,s,a,l,c;S(this),t=this.startContainer,e=this.startOffset,n=this.endContainer,i=this.endOffset,r=function(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(n=t,i=t.length,t.appendData(e.data),e.parentNode.removeChild(e))},s=function(r){var o,s,a=r.previousSibling;a&&a.nodeType==r.nodeType&&(t=r,o=r.length,e=a.length,r.insertData(0,a.data),a.parentNode.removeChild(a),t==n?(i+=e,n=t):n==r.parentNode&&(s=ot(r),i==s?(n=r,i=o):i>s&&i--))},a=!0,rt(n)?n.length==i&&r(n):(i>0&&(l=n.childNodes[i-1])&&rt(l)&&r(l),a=!this.collapsed),a?rt(t)?0==e&&s(t):e<t.childNodes.length&&(c=t.childNodes[e])&&rt(c)&&s(c):(t=n,e=i),o(this,t,e,n,i)},collapseToPoint:function(t,e){m(t,!0),y(t,e),this.setStartAndEnd(t,e)}}),R(n)}function O(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:tt.getCommonAncestor(t.startContainer,t.endContainer)}function D(t,e,n,i,r){t.startContainer=e,t.startOffset=n,t.endContainer=i,t.endOffset=r,t.document=tt.getDocument(e),O(t)}function I(t){this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=0,this.document=t,O(this)}var M,L,B,P,H,z,W,j,F,q,V,$,U,Y,G,X,K,Q,Z,J,tt=t.dom,et=t.util,nt=tt.DomPosition,it=t.DOMException,rt=tt.isCharacterDataNode,ot=tt.getNodeIndex,st=tt.isOrIsAncestorOf,at=tt.getDocument,lt=tt.comparePoints,ct=tt.splitDataNode,ht=tt.getClosestAncestorIn,ut=tt.getNodeLength,dt=tt.arrayContains,ft=tt.getRootContainer,pt=t.features.crashyTextNodes;f.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,rt(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!rt(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(t=n===this.sc?this.so:0,e=n===this.ec?this.eo:n.length,t!=e&&n.deleteData(t,e-t))},isPartiallySelectedSubtree:function(){return e(this._current,this.range)},getSubtreeIterator:function(){var t,e,i,r,o,s;return this.isSingleCharacterDataNode?(t=this.range.cloneRange(),t.collapse(!1)):(t=new I(n(this.range)),e=this._current,i=e,r=0,o=e,s=ut(e),st(e,this.sc)&&(i=this.sc,r=this.so),st(e,this.ec)&&(o=this.ec,s=this.eo),D(t,i,r,o,s)),new f(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},M=[1,3,4,5,7,8,10],L=[2,9,11],B=[5,6,10,12],P=[1,3,4,5,7,8,10,11],H=[1,3,4,5,7,8],z=p([9,11]),W=p(B),j=p([6,10,12]),F=document.createElement("style"),q=!1;try{F.innerHTML="<b>x</b>",q=3==F.firstChild.nodeType}catch(t){}t.features.htmlParsingConforms=q,V=q?function(t){var e,n=this.startContainer,i=at(n);if(!n)throw new it("INVALID_STATE_ERR");return e=null,1==n.nodeType?e=n:rt(n)&&(e=tt.parentElement(n)),e=null===e||"HTML"==e.nodeName&&tt.isHtmlNamespace(at(e).documentElement)&&tt.isHtmlNamespace(e)?i.createElement("body"):e.cloneNode(!1),e.innerHTML=t,tt.fragmentFromNodeChildren(e)}:function(t){var e=n(this),i=e.createElement("body");return i.innerHTML=t,tt.fragmentFromNodeChildren(i)},$=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],U=0,Y=1,G=2,X=3,K=0,Q=1,Z=2,J=3,et.extend(t.rangePrototype,{compareBoundaryPoints:function(t,e){var n,i,r,o,s,a;return S(this),v(this.startContainer,e.startContainer),s=t==X||t==U?"start":"end",a=t==Y||t==U?"start":"end",n=this[s+"Container"],i=this[s+"Offset"],r=e[a+"Container"],o=e[a+"Offset"],lt(n,i,r,o)},insertNode:function(t){if(S(this),g(t,P),b(this.startContainer),st(t,this.startContainer))throw new it("HIERARCHY_REQUEST_ERR");var e=o(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){var t,e,i;return S(this),this.collapsed?n(this).createDocumentFragment():this.startContainer===this.endContainer&&rt(this.startContainer)?(t=this.startContainer.cloneNode(!0),t.data=t.data.slice(this.startOffset,this.endOffset),e=n(this).createDocumentFragment(),e.appendChild(t),e):(i=new f(this,!0),t=a(i),i.detach(),t)},canSurroundContents:function(){var t,n;return S(this),b(this.startContainer),b(this.endContainer),t=new f(this,!0),n=t._first&&e(t._first,this)||t._last&&e(t._last,this),t.detach(),!n},surroundContents:function(t){if(g(t,H),!this.canSurroundContents())throw new it("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);o(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){var t,e,i;for(S(this),t=new I(n(this)),e=$.length;e--;)i=$[e],t[i]=this[i];return t},toString:function(){var t,e,n;return S(this),t=this.startContainer,t===this.endContainer&&rt(t)?3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"":(e=[],n=new f(this,!0),l(n,function(t){(3==t.nodeType||4==t.nodeType)&&e.push(t.data)}),n.detach(),e.join(""))},compareNode:function(t){var e,n,i,r;if(S(this),e=t.parentNode,n=ot(t),!e)throw new it("NOT_FOUND_ERR");return i=this.comparePoint(e,n),r=this.comparePoint(e,n+1),0>i?r>0?Z:K:r>0?Q:J},comparePoint:function(t,e){return S(this),w(t,"HIERARCHY_REQUEST_ERR"),v(t,this.startContainer),lt(t,e,this.startContainer,this.startOffset)<0?-1:lt(t,e,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:V,toHtml:function(){return E(this)},intersectsNode:function(t,e){var i,r,o,s;return S(this),w(t,"NOT_FOUND_ERR"),at(t)===n(this)&&(i=t.parentNode,r=ot(t),w(i,"NOT_FOUND_ERR"),o=lt(i,r,this.endContainer,this.endOffset),s=lt(i,r+1,this.startContainer,this.startOffset),e?0>=o&&s>=0:0>o&&s>0)},isPointInRange:function(t,e){return S(this),w(t,"HIERARCHY_REQUEST_ERR"),v(t,this.startContainer),lt(t,e,this.startContainer,this.startOffset)>=0&&lt(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return s(this,t,!1)},intersectsOrTouchesRange:function(t){return s(this,t,!0)},intersection:function(t){var e,n,i;return this.intersectsRange(t)?(e=lt(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=lt(this.endContainer,this.endOffset,t.endContainer,t.endOffset),i=this.cloneRange(),-1==e&&i.setStart(t.startContainer,t.startOffset),1==n&&i.setEnd(t.endContainer,t.endOffset),i):null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return-1==lt(t.startContainer,t.startOffset,this.startContainer,this.startOffset)&&e.setStart(t.startContainer,t.startOffset),1==lt(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new it("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==J},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,ut(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e,n,i=this.cloneRange();return i.selectNode(t),e=i.getNodes([3]),e.length>0?(i.setStart(e[0],0),n=e.pop(),i.setEnd(n,n.length),this.containsRange(i)):this.containsNodeContents(t)},getNodes:function(t,e){return S(this),u(this,t,e)},getDocument:function(){return n(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(e){var i,r,o,s=n(this),a=t.createRange(s);return e=e||tt.getBody(s),a.selectNodeContents(e),i=this.intersection(a),r=0,o=0,i&&(a.setEnd(i.startContainer,i.startOffset),r=(""+a).length,o=r+(""+i).length),{start:r,end:o,containerNode:e}},moveToBookmark:function(t){var e,n,i,r,o,s,a,l=t.containerNode,c=0;for(this.setStart(l,0),this.collapse(!0),e=[l],i=!1,r=!1;!r&&(n=e.pop());)if(3==n.nodeType)o=c+n.length,!i&&t.start>=c&&t.start<=o&&(this.setStart(n,t.start-c),i=!0),i&&t.end>=c&&t.end<=o&&(this.setEnd(n,t.end-c),r=!0),c=o;else for(a=n.childNodes,s=a.length;s--;)e.push(a[s])},getName:function(){return"DomRange"},equals:function(t){return I.rangesEqual(this,t)},isValid:function(){return _(this)},inspect:function(){return d(this)},detach:function(){}}),A(I,D),et.extend(I,{rangeProperties:$,RangeIterator:f,copyComparisonConstants:R,createPrototypeRange:A,inspect:d,toHtml:E,getRangeDocument:n,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),t.DomRange=I}),I.createCoreModule("WrappedRange",["DomRange"],function(t,e){var n,i,r,o,s,a,l,c,h=t.dom,u=t.util,d=h.DomPosition,f=t.DomRange,p=h.getBody,m=h.getContentDocument,g=h.isCharacterDataNode;t.features.implementsDomRange&&function(){function i(t){for(var e,n=v.length;n--;)e=v[n],t[e]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}function r(t,e,n,i,r){var o=t.startContainer!==e||t.startOffset!=n,s=t.endContainer!==i||t.endOffset!=r,a=!t.equals(t.nativeRange);(o||s||a)&&(t.setEnd(i,r),t.setStart(e,n))}var o,s,a,l,c,d,g,y,v=f.rangeProperties;n=function(t){if(!t)throw e.createError("WrappedRange: Range must be specified");this.nativeRange=t,i(this)},f.createPrototypeRange(n,r),o=n.prototype,o.selectNode=function(t){this.nativeRange.selectNode(t),i(this)},o.cloneContents=function(){return this.nativeRange.cloneContents()},o.surroundContents=function(t){this.nativeRange.surroundContents(t),i(this)},o.collapse=function(t){this.nativeRange.collapse(t),i(this)},o.cloneRange=function(){return new n(this.nativeRange.cloneRange())},o.refresh=function(){i(this)},o.toString=function(){return""+this.nativeRange},a=document.createTextNode("test"),p(document).appendChild(a),l=document.createRange(),l.setStart(a,0),l.setEnd(a,0);try{l.setStart(a,1),o.setStart=function(t,e){this.nativeRange.setStart(t,e),i(this)},o.setEnd=function(t,e){this.nativeRange.setEnd(t,e),i(this)},s=function(t){return function(e){this.nativeRange[t](e),i(this)}}}catch(t){o.setStart=function(t,e){try{this.nativeRange.setStart(t,e)}catch(n){this.nativeRange.setEnd(t,e),this.nativeRange.setStart(t,e)}i(this)},o.setEnd=function(t,e){try{this.nativeRange.setEnd(t,e)}catch(n){this.nativeRange.setStart(t,e),this.nativeRange.setEnd(t,e)}i(this)},s=function(t,e){return function(n){try{this.nativeRange[t](n)}catch(i){this.nativeRange[e](n),this.nativeRange[t](n)}i(this)}}}
o.setStartBefore=s("setStartBefore","setEndBefore"),o.setStartAfter=s("setStartAfter","setEndAfter"),o.setEndBefore=s("setEndBefore","setStartBefore"),o.setEndAfter=s("setEndAfter","setStartAfter"),o.selectNodeContents=function(t){this.setStartAndEnd(t,0,h.getNodeLength(t))},l.selectNodeContents(a),l.setEnd(a,3),c=document.createRange(),c.selectNodeContents(a),c.setEnd(a,4),c.setStart(a,2),o.compareBoundaryPoints=-1==l.compareBoundaryPoints(l.START_TO_END,c)&&1==l.compareBoundaryPoints(l.END_TO_START,c)?function(t,e){return e=e.nativeRange||e,t==e.START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)},d=document.createElement("div"),d.innerHTML="123",g=d.firstChild,y=p(document),y.appendChild(d),l.setStart(g,1),l.setEnd(g,2),l.deleteContents(),"13"==g.data&&(o.deleteContents=function(){this.nativeRange.deleteContents(),i(this)},o.extractContents=function(){var t=this.nativeRange.extractContents();return i(this),t}),y.removeChild(d),y=null,u.isHostMethod(l,"createContextualFragment")&&(o.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),p(document).removeChild(a),o.getName=function(){return"WrappedRange"},t.WrappedRange=n,t.createNativeRange=function(t){return t=m(t,e,"createNativeRange"),t.createRange()}}(),t.features.implementsTextRange&&(r=function(t){var e,n,i,r=t.parentElement(),o=t.duplicate();return o.collapse(!0),e=o.parentElement(),o=t.duplicate(),o.collapse(!1),n=o.parentElement(),i=e==n?e:h.getCommonAncestor(e,n),i==r?i:h.getCommonAncestor(r,i)},o=function(t){return 0==t.compareEndPoints("StartToEnd",t)},s=function(t,e,n,i,r){var o,s,a,l,c,u,f,p,m,y,v,b,w,x,C,_,S=t.duplicate();if(S.collapse(n),o=S.parentElement(),h.isOrIsAncestorOf(e,o)||(o=e),!o.canHaveHTML)return s=new d(o.parentNode,h.getNodeIndex(o)),{boundaryPosition:s,nodeInfo:{nodeIndex:s.offset,containerElement:s.node}};for(a=h.getDocument(o).createElement("span"),a.parentNode&&a.parentNode.removeChild(a),c=n?"StartToStart":"StartToEnd",y=r&&r.containerElement==o?r.nodeIndex:0,v=o.childNodes.length,b=v,w=b;w==v?o.appendChild(a):o.insertBefore(a,o.childNodes[w]),S.moveToElementText(a),0!=(l=S.compareEndPoints(c,t))&&y!=b;){if(-1==l){if(b==y+1)break;y=w}else b=b==y+1?y:w;w=Math.floor((y+b)/2),o.removeChild(a)}if(m=a.nextSibling,-1==l&&m&&g(m)){if(S.setEndPoint(n?"EndToStart":"EndToEnd",t),/[\r\n]/.test(m.data))for(C=S.duplicate(),_=C.text.replace(/\r\n/g,"\r").length,x=C.moveStart("character",_);-1==(l=C.compareEndPoints("StartToEnd",C));)x++,C.moveStart("character",1);else x=S.text.length;p=new d(m,x)}else u=(i||!n)&&a.previousSibling,f=(i||n)&&a.nextSibling,p=f&&g(f)?new d(f,0):u&&g(u)?new d(u,u.data.length):new d(o,h.getNodeIndex(a));return a.parentNode.removeChild(a),{boundaryPosition:p,nodeInfo:{nodeIndex:w,containerElement:o}}},a=function(t,e){var n,i,r,o,s=t.offset,a=h.getDocument(t.node),l=p(a).createTextRange(),c=g(t.node);return c?(n=t.node,i=n.parentNode):(o=t.node.childNodes,n=s<o.length?o[s]:null,i=t.node),r=a.createElement("span"),r.innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),l.moveToElementText(r),l.collapse(!e),i.removeChild(r),c&&l[e?"moveStart":"moveEnd"]("character",s),l},i=function(t){this.textRange=t,this.refresh()},i.prototype=new f(document),i.prototype.refresh=function(){var t,e,n,i=r(this.textRange);o(this.textRange)?e=t=s(this.textRange,i,!0,!0).boundaryPosition:(n=s(this.textRange,i,!0,!1),t=n.boundaryPosition,e=s(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},i.prototype.getName=function(){return"WrappedTextRange"},f.copyComparisonConstants(i),l=function(t){var e,n,i;return t.collapsed?a(new d(t.startContainer,t.startOffset),!0):(e=a(new d(t.startContainer,t.startOffset),!0),n=a(new d(t.endContainer,t.endOffset),!1),i=p(f.getRangeDocument(t)).createTextRange(),i.setEndPoint("StartToStart",e),i.setEndPoint("EndToEnd",n),i)},i.rangeToTextRange=l,i.prototype.toTextRange=function(){return l(this)},t.WrappedTextRange=i,(!t.features.implementsDomRange||t.config.preferTextRange)&&(c=function(){return this}(),void 0===c.Range&&(c.Range=i),t.createNativeRange=function(t){return t=m(t,e,"createNativeRange"),p(t).createTextRange()},t.WrappedRange=i)),t.createRange=function(n){return n=m(n,e,"createRange"),new t.WrappedRange(t.createNativeRange(n))},t.createRangyRange=function(t){return t=m(t,e,"createRangyRange"),new f(t)},t.createIframeRange=function(n){return e.deprecationNotice("createIframeRange()","createRange(iframeEl)"),t.createRange(n)},t.createIframeRangyRange=function(n){return e.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),t.createRangyRange(n)},t.addShimListener(function(e){var n=e.document;void 0===n.createRange&&(n.createRange=function(){return t.createRange(n)}),n=e=null})}),I.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(t,e){function n(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function i(t,n){if(t){if(E.isWindow(t))return t;if(t instanceof y)return t.win;var i=E.getContentDocument(t,e,n);return E.getWindow(i)}return window}function r(t){return i(t,"getWinSelection").getSelection()}function o(t){return i(t,"getDocSelection").document.selection}function s(t){var e=!1;return t.anchorNode&&(e=1==E.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}function a(t,e,n){var i=n?"end":"start",r=n?"start":"end";t.anchorNode=e[i+"Container"],t.anchorOffset=e[i+"Offset"],t.focusNode=e[r+"Container"],t.focusOffset=e[r+"Offset"]}function l(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}function c(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0}function h(e){var n;return e instanceof k?(n=t.createNativeRange(e.getDocument()),n.setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)):e instanceof A?n=e.nativeRange:L.implementsDomRange&&e instanceof E.getWindow(e.startContainer).Range&&(n=e),n}function u(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;n>e;++e)if(!E.isAncestorOf(t[0],t[e]))return!1;return!0}function d(t){var n=t.getNodes();if(!u(n))throw e.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return n[0]}function f(t){return!!t&&void 0!==t.text}function p(t,e){var n=new A(e);t._ranges=[n],a(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed}function m(e){var n,i,r,o;if(e._ranges.length=0,"None"==e.docSelection.type)c(e);else if(n=e.docSelection.createRange(),f(n))p(e,n);else{for(e.rangeCount=n.length,r=P(n.item(0)),o=0;o<e.rangeCount;++o)i=t.createRange(r),i.selectNode(n.item(o)),e._ranges.push(i);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,a(e,e._ranges[e.rangeCount-1],!1)}}function g(t,n){var i,r,o=t.docSelection.createRange(),s=d(n),a=P(o.item(0)),l=H(a).createControlRange();for(i=0,r=o.length;r>i;++i)l.add(o.item(i));try{l.add(s)}catch(t){throw e.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}l.select(),m(t)}function y(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function v(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0}function b(t,e){for(var n,i,r=et.length;r--;)if(n=et[r],i=n.selection,"deleteAll"==e)v(i);else if(n.win==t)return"delete"==e?(et.splice(r,1),!0):i;return"deleteAll"==e&&(et.length=0),null}function w(t,n){var i,r,o,s=P(n[0].startContainer),a=H(s).createControlRange();for(i=0,o=n.length;o>i;++i){r=d(n[i]);try{a.add(r)}catch(t){throw e.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}a.select(),m(t)}function x(t,e){if(t.win.document!=P(e))throw new O("WRONG_DOCUMENT_ERR")}function C(e){return function(n,i){var r;this.rangeCount?(r=this.getRangeAt(0),r["set"+(e?"Start":"End")](n,i)):(r=t.createRange(this.win.document),r.setStartAndEnd(n,i)),this.setSingleRange(r,this.isBackward())}}function _(t){var e,n,i=[],r=new D(t.anchorNode,t.anchorOffset),o=new D(t.focusNode,t.focusOffset),s="function"==typeof t.getName?t.getName():"Selection";if(void 0!==t.rangeCount)for(e=0,n=t.rangeCount;n>e;++e)i[e]=k.inspect(t.getRangeAt(e));return"["+s+"(Ranges: "+i.join(", ")+")(anchor: "+r.inspect()+", focus: "+o.inspect()+"]"}var S,N,E,T,R,k,A,O,D,I,M,L,B,P,H,z,W,j,F,q,V,$,U,Y,G,X,K,Q,Z,J,tt,et,nt,it,rt,ot,st,at;if(t.config.checkSelectionRanges=!0,S="boolean",N="number",E=t.dom,T=t.util,R=T.isHostMethod,k=t.DomRange,A=t.WrappedRange,O=t.DOMException,D=E.DomPosition,L=t.features,B="Control",P=E.getDocument,H=E.getBody,z=k.rangesEqual,W=R(window,"getSelection"),j=T.isHostObject(document,"selection"),L.implementsWinGetSelection=W,L.implementsDocSelection=j,F=j&&(!W||t.config.preferTextRange),F?(I=o,t.isSelectionValid=function(t){var e=i(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||P(n.createRange().parentElement())==e}):W?(I=r,t.isSelectionValid=function(){return!0}):e.fail("Neither document.selection or window.getSelection() detected."),t.getNativeSelection=I,q=I(),V=t.createNativeRange(document),$=H(document),U=T.areHostProperties(q,["anchorNode","focusNode","anchorOffset","focusOffset"]),L.selectionHasAnchorAndFocus=U,Y=R(q,"extend"),L.selectionHasExtend=Y,G=typeof q.rangeCount==N,L.selectionHasRangeCount=G,X=!1,K=!0,Q=Y?function(e,n){var i=k.getRangeDocument(n),r=t.createRange(i);r.collapseToPoint(n.endContainer,n.endOffset),e.addRange(h(r)),e.extend(n.startContainer,n.startOffset)}:null,T.areHostMethods(q,["addRange","getRangeAt","removeAllRanges"])&&typeof q.rangeCount==N&&L.implementsDomRange&&function(){var e,n,i,r,o,a,l,c,h,u,d,f=window.getSelection();if(f){for(e=f.rangeCount,n=e>1,i=[],r=s(f),o=0;e>o;++o)i[o]=f.getRangeAt(o);for(a=H(document),l=a.appendChild(document.createElement("div")),l.contentEditable="false",c=l.appendChild(document.createTextNode("   ")),h=document.createRange(),h.setStart(c,1),h.collapse(!0),f.addRange(h),K=1==f.rangeCount,f.removeAllRanges(),n||(u=window.navigator.appVersion.match(/Chrome\/(.*?) /),u&&parseInt(u[1])>=36?X=!1:(d=h.cloneRange(),h.setStart(c,0),d.setEnd(c,3),d.setStart(c,2),f.addRange(h),f.addRange(d),X=2==f.rangeCount)),a.removeChild(l),f.removeAllRanges(),o=0;e>o;++o)0==o&&r?Q?Q(f,i[o]):(t.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),f.addRange(i[o])):f.addRange(i[o])}}(),L.selectionSupportsMultipleRanges=X,L.collapsedNonEditableSelectionsSupported=K,Z=!1,$&&R($,"createControlRange")&&(J=$.createControlRange(),T.areHostProperties(J,["item","add"])&&(Z=!0)),L.implementsControlRange=Z,M=U?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed},R(q,"getRangeAt")?tt=function(t,e){try{return t.getRangeAt(e)}catch(t){return null}}:U&&(tt=function(e){var n=P(e.anchorNode),i=t.createRange(n);return i.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),i.collapsed!==this.isCollapsed&&i.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),i}),y.prototype=t.selectionPrototype,et=[],nt=function(t){var e,n,r;return t&&t instanceof y?(t.refresh(),t):(t=i(t,"getNativeSelection"),e=b(t),n=I(t),r=j?o(t):null,e?(e.nativeSelection=n,e.docSelection=r,e.refresh()):(e=new y(n,r,t),et.push({win:t,selection:e})),e)},t.getSelection=nt,t.getIframeSelection=function(n){return e.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),t.getSelection(E.getIframeWindow(n))},it=y.prototype,!F&&U&&T.areHostMethods(q,["removeAllRanges","addRange"]))it.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)},rt=function(t,e){Q(t.nativeSelection,e),t.refresh()},it.addRange=G?function(e,i){var r,o;Z&&j&&this.docSelection.type==B?g(this,e):n(i)&&Y?rt(this,e):(X?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(h(e).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1?(t.config.checkSelectionRanges&&(o=tt(this.nativeSelection,this.rangeCount-1))&&!z(o,e)&&(e=new A(o)),this._ranges[this.rangeCount-1]=e,a(this,e,at(this.nativeSelection)),this.isCollapsed=M(this)):this.refresh())}:function(t,e){n(e)&&Y?rt(this,t):(this.nativeSelection.addRange(h(t)),this.refresh())},it.setRanges=function(t){if(Z&&j&&t.length>1)w(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;n>e;++e)this.addRange(t[e])}};else{if(!(R(q,"empty")&&R(V,"select")&&Z&&F))return e.fail("No means of selecting a Range or TextRange was found"),!1;it.removeAllRanges=function(){var t,e,n;try{this.docSelection.empty(),"None"!=this.docSelection.type&&(this.anchorNode?t=P(this.anchorNode):this.docSelection.type==B&&(e=this.docSelection.createRange(),e.length&&(t=P(e.item(0)))),t&&(n=H(t).createTextRange(),n.select(),this.docSelection.empty()))}catch(t){}c(this)},it.addRange=function(e){this.docSelection.type==B?g(this,e):(t.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,e,!1))},it.setRanges=function(t){this.removeAllRanges();var e=t.length;e>1?w(this,t):e&&this.addRange(t[0])}}if(it.getRangeAt=function(t){if(0>t||t>=this.rangeCount)throw new O("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()},F)ot=function(e){var n;t.isSelectionValid(e.win)?n=e.docSelection.createRange():(n=H(e.win.document).createTextRange(),n.collapse(!0)),e.docSelection.type==B?m(e):f(n)?p(e,n):c(e)};else if(R(q,"getRangeAt")&&typeof q.rangeCount==N)ot=function(e){if(Z&&j&&e.docSelection.type==B)m(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var n=0,i=e.rangeCount;i>n;++n)e._ranges[n]=new t.WrappedRange(e.nativeSelection.getRangeAt(n));a(e,e._ranges[e.rangeCount-1],at(e.nativeSelection)),e.isCollapsed=M(e)}else c(e)};else{if(!U||typeof q.isCollapsed!=S||typeof V.collapsed!=S||!L.implementsDomRange)return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;ot=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=tt(n,0),t._ranges=[e],t.rangeCount=1,l(t),t.isCollapsed=M(t)):c(t)}}it.refresh=function(t){var e,n=t?this._ranges.slice(0):null,i=this.anchorNode,r=this.anchorOffset;if(ot(this),t){if((e=n.length)!=this._ranges.length)return!0;if(this.anchorNode!=i||this.anchorOffset!=r)return!0;for(;e--;)if(!z(n[e],this._ranges[e]))return!0;return!1}},st=function(t,e){var n,i,r=t.getAllRanges();for(t.removeAllRanges(),n=0,i=r.length;i>n;++n)z(e,r[n])||t.addRange(r[n]);t.rangeCount||c(t)},it.removeRange=Z&&j?function(t){var e,n,i,r,o,s,a,l;if(this.docSelection.type==B){for(e=this.docSelection.createRange(),n=d(t),i=P(e.item(0)),r=H(i).createControlRange(),s=!1,a=0,l=e.length;l>a;++a)o=e.item(a),o!==n||s?r.add(e.item(a)):s=!0;r.select(),m(this)}else st(this,t)}:function(t){st(this,t)},!F&&U&&L.implementsDomRange?(at=s,it.isBackward=function(){return at(this)}):at=it.isBackward=function(){return!1},it.isBackwards=it.isBackward,it.toString=function(){var t,e,n=[];for(t=0,e=this.rangeCount;e>t;++t)n[t]=""+this._ranges[t];return n.join("")},it.collapse=function(e,n){x(this,e);var i=t.createRange(e);i.collapseToPoint(e,n),this.setSingleRange(i),this.isCollapsed=!0},it.collapseToStart=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},it.collapseToEnd=function(){if(!this.rangeCount)throw new O("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},it.selectAllChildren=function(e){x(this,e);var n=t.createRange(e);n.selectNodeContents(e),this.setSingleRange(n)},it.deleteFromDocument=function(){var t,e,n,i,r;if(Z&&j&&this.docSelection.type==B){for(t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount&&(n=this.getAllRanges(),n.length)){for(this.removeAllRanges(),i=0,r=n.length;r>i;++i)n[i].deleteContents();this.addRange(n[r-1])}},it.eachRange=function(t,e){for(var n=0,i=this._ranges.length;i>n;++n)if(t(this.getRangeAt(n)))return e},it.getAllRanges=function(){var t=[];return this.eachRange(function(e){t.push(e)}),t},it.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},it.callMethodOnEachRange=function(t,e){var n=[];return this.eachRange(function(i){n.push(i[t].apply(i,e))}),n},it.setStart=C(!0),it.setEnd=C(!1),t.rangePrototype.select=function(t){nt(this.getDocument()).setSingleRange(this,t)},it.changeEachRange=function(t){var e=[],n=this.isBackward();this.eachRange(function(n){t(n),e.push(n)}),this.removeAllRanges(),n&&1==e.length?this.addRange(e[0],"backward"):this.setRanges(e)},it.containsNode=function(t,e){return this.eachRange(function(n){return n.containsNode(t,e)},!0)||!1},it.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},it.moveToBookmark=function(e){var n,i,r,o=[];for(n=0;i=e.rangeBookmarks[n++];)r=t.createRange(this.win),r.moveToBookmark(i),o.push(r);e.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},it.toHtml=function(){var t=[];return this.eachRange(function(e){t.push(k.toHtml(e))}),t.join("")},L.implementsTextRange&&(it.getNativeTextRange=function(){var n,i;if(n=this.docSelection){if(i=n.createRange(),f(i))return i;throw e.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return t.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw e.createError("getNativeTextRange: selection contains no range")}),it.getName=function(){return"WrappedSelection"},it.inspect=function(){return _(this)},it.detach=function(){b(this.win,"delete"),v(this)},y.detachAll=function(){b(null,"deleteAll")},y.inspect=_,y.isDirectionBackward=n,t.Selection=y,t.selectionPrototype=it,t.addShimListener(function(t){void 0===t.getSelection&&(t.getSelection=function(){return nt(t)}),t=null})}),I)},this),function(t,e){"function"==typeof define&&define.amd?define(["rangy"],t):t(e.rangy)}(function(t){t.createModule("SaveRestore",["WrappedRange"],function(t,e){function n(t,e){return(e||document).getElementById(t)}function i(t,e){var n,i="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),r=p.getDocument(t.startContainer),o=t.cloneRange();return o.collapse(e),n=r.createElement("span"),n.id=i,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(r.createTextNode(m)),o.insertNode(n),n}function r(t,i,r,o){var s=n(r,t);s?(i[o?"setStartBefore":"setEndBefore"](s),s.parentNode.removeChild(s)):e.warn("Marker element has been removed. Cannot restore selection.")}function o(t,e){return e.compareBoundaryPoints(t.START_TO_START,t)}function s(e,n){var r,o,s=t.DomRange.getRangeDocument(e),a=""+e;return e.collapsed?(o=i(e,!1),{document:s,markerId:o.id,collapsed:!0}):(o=i(e,!1),r=i(e,!0),{document:s,startMarkerId:r.id,endMarkerId:o.id,collapsed:!1,backward:n,toString:function(){return"original text: '"+a+"', new text: '"+e+"'"}})}function a(i,o){var s,a,l,c=i.document;return void 0===o&&(o=!0),s=t.createRange(c),i.collapsed?(a=n(i.markerId,c),a?(a.style.display="inline",l=a.previousSibling,l&&3==l.nodeType?(a.parentNode.removeChild(a),s.collapseToPoint(l,l.length)):(s.collapseBefore(a),a.parentNode.removeChild(a))):e.warn("Marker element has been removed. Cannot restore selection.")):(r(c,s,i.startMarkerId,!0),r(c,s,i.endMarkerId,!1)),o&&s.normalizeBoundaries(),s}function l(e,i){var r,a,l,c,h=[];for(e=e.slice(0),e.sort(o),l=0,c=e.length;c>l;++l)h[l]=s(e[l],i);for(l=c-1;l>=0;--l)r=e[l],a=t.DomRange.getRangeDocument(r),r.collapsed?r.collapseAfter(n(h[l].markerId,a)):(r.setEndBefore(n(h[l].endMarkerId,a)),r.setStartAfter(n(h[l].startMarkerId,a)));return h}function c(n){var i,r,o,s;return t.isSelectionValid(n)?(i=t.getSelection(n),r=i.getAllRanges(),o=1==r.length&&i.isBackward(),s=l(r,o),o?i.setSingleRange(r[0],"backward"):i.setRanges(r),{win:n,rangeInfos:s,restored:!1}):(e.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null)}function h(t){var e,n=[],i=t.length;for(e=i-1;e>=0;e--)n[e]=a(t[e],!0);return n}function u(e,n){var i,r,o,s;e.restored||(i=e.rangeInfos,r=t.getSelection(e.win),o=h(i),s=i.length,1==s&&n&&t.features.selectionHasExtend&&i[0].backward?(r.removeAllRanges(),r.addRange(o[0],!0)):r.setRanges(o),e.restored=!0)}function d(t,e){var i=n(e,t);i&&i.parentNode.removeChild(i)}function f(t){var e,n,i,r=t.rangeInfos;for(e=0,n=r.length;n>e;++e)i=r[e],i.collapsed?d(t.doc,i.markerId):(d(t.doc,i.startMarkerId),d(t.doc,i.endMarkerId))}var p=t.dom,m="\ufeff";t.util.extend(t,{saveRange:s,restoreRange:a,saveRanges:l,restoreRanges:h,saveSelection:c,restoreSelection:u,removeMarkerElement:d,removeMarkers:f})})},this),Base=function(){},Base.extend=function(t,e){var n,i,r,o=Base.prototype.extend;return Base._prototyping=!0,n=new this,o.call(n,t),n.base=function(){},delete Base._prototyping,i=n.constructor,r=n.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==r)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||o).call(arguments[0],n)},r.ancestor=this,r.extend=this.extend,r.forEach=this.forEach,r.implement=this.implement,r.prototype=n,r.toString=this.toString,r.valueOf=function(t){return"object"==t?r:i.valueOf()},o.call(r,e),"function"==typeof r.init&&r.init(),r},Base.prototype={extend:function(t,e){var n,i,r,o,s,a,l;if(arguments.length>1)n=this[t],!n||"function"!=typeof e||n.valueOf&&n.valueOf()==e.valueOf()||!/\bbase\b/.test(e)||(i=e.valueOf(),e=function(){var t,e=this.base||Base.prototype.base;return this.base=n,t=i.apply(this,arguments),this.base=e,t},e.valueOf=function(t){return"object"==t?e:i},e.toString=Base.toString),this[t]=e;else if(t){for(r=Base.prototype.extend,Base._prototyping||"function"==typeof this||(r=this.extend||r),o={toSource:null},s=["constructor","toString","valueOf"],a=Base._prototyping?0:1;l=s[a++];)t[l]!=o[l]&&r.call(this,l,t[l]);for(l in t)o[l]||r.call(this,l,t[l])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(t,e,n){for(var i in t)void 0===this.prototype[i]&&e.call(n,t[i],i,t)},implement:function(){for(var t=0;t<arguments.length;t++)"function"==typeof arguments[t]?arguments[t](this.prototype):this.prototype.extend(arguments[t]);return this},toString:function(){return this.valueOf()+""}}),wysihtml5.browser=function(){function t(t){return+(/ipad|iphone|ipod/.test(t)&&t.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1]}function e(t){return+(t.match(/android (\d+)/)||[void 0,0])[1]}function n(t,e){var n,i=-1;return"Microsoft Internet Explorer"==navigator.appName?n=RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"):"Netscape"==navigator.appName&&(n=RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")),n&&null!=n.exec(navigator.userAgent)&&(i=parseFloat(RegExp.$1)),-1!==i&&(!t||(e?"<"===e?i>t:">"===e?t>i:"<="===e?i>=t:">="===e?t>=i:void 0:t===i))}var i=navigator.userAgent,r=document.createElement("div"),o=-1!==i.indexOf("Gecko")&&-1===i.indexOf("KHTML"),s=-1!==i.indexOf("AppleWebKit/"),a=-1!==i.indexOf("Chrome/"),l=-1!==i.indexOf("Opera/");return{USER_AGENT:i,supported:function(){var n=this.USER_AGENT.toLowerCase(),i="contentEditable"in r,o=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,s=document.querySelector&&document.querySelectorAll,a=this.isIos()&&t(n)<5||this.isAndroid()&&e(n)<4||-1!==n.indexOf("opera mobi")||-1!==n.indexOf("hpwos/");return i&&o&&s&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return n()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return n()},hasCurrentStyleProperty:function(){return"currentStyle"in r},hasHistoryIssue:function(){return o&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return o},supportsPlaceholderAttributeOn:function(t){return"placeholder"in t},supportsEvent:function(t){return"on"+t in r||function(){return r.setAttribute("on"+t,"return;"),"function"==typeof r["on"+t]}()},supportsEventsInIframeCorrectly:function(){return!l},supportsHTML5Tags:function(t){var e=t.createElement("div"),n="<article>foo</article>";return e.innerHTML=n,e.innerHTML.toLowerCase()===n},supportsCommand:function(){var t={formatBlock:n(10,"<="),insertUnorderedList:n(),insertOrderedList:n()},e={insertHTML:o};return function(n,i){if(!t[i]){try{return n.queryCommandSupported(i)}catch(t){}try{return n.queryCommandEnabled(i)}catch(t){return!!e[i]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return n()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return o||l||s},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return o||n()||l},autoScrollsToCaret:function(){return!s},autoClosesUnclosedTags:function(){var t,e,n=r.cloneNode(!1);return n.innerHTML="<p><div></div>",e=n.innerHTML.toLowerCase(),t="<p></p><div></div>"===e||"<p><div></div></p>"===e,this.autoClosesUnclosedTags=function(){return t},t},supportsNativeGetElementsByClassName:function(){return-1!==(document.getElementsByClassName+"").indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return l},supportsSpeechApiOn:function(t){return(i.match(/Chrome\/(\d+)/)||[void 0,0])[1]>=11&&("onwebkitspeechchange"in t||"speech"in t)},crashesWhenDefineProperty:function(t){return n(9)&&("XMLHttpRequest"===t||"XDomainRequest"===t)},doesAsyncFocus:function(){return n()},hasProblemsSettingCaretAfterImg:function(){return n()},hasUndoInContextMenu:function(){return o||a||l},hasInsertNodeIssue:function(){return l},hasIframeFocusIssue:function(){return n()},createsNestedInvalidMarkupAfterPaste:function(){return s},supportsMutationEvents:function(){return"MutationEvent"in window},supportsModenPaste:function(){return!("clipboardData"in window)}}}(),wysihtml5.lang.array=function(t){return{contains:function(e){if(Array.isArray(e)){for(var n=e.length;n--;)if(-1!==wysihtml5.lang.array(t).indexOf(e[n]))return!0;return!1}return-1!==wysihtml5.lang.array(t).indexOf(e)},indexOf:function(e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},without:function(e){e=wysihtml5.lang.array(e);for(var n=[],i=0,r=t.length;r>i;i++)e.contains(t[i])||n.push(t[i]);return n},get:function(){for(var e=0,n=t.length,i=[];n>e;e++)i.push(t[e]);return i},map:function(e,n){if(Array.prototype.map)return t.map(e,n);for(var i=t.length>>>0,r=Array(i),o=0;i>o;o++)r[o]=e.call(n,t[o],o,t);return r},unique:function(){for(var e=[],n=t.length,i=0;n>i;)wysihtml5.lang.array(e).contains(t[i])||e.push(t[i]),i++;return e}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(t,e){return this.events=this.events||{},this.events[t]=this.events[t]||[],this.events[t].push(e),this},off:function(t,e){this.events=this.events||{};var n,i,r=0;if(t){for(n=this.events[t]||[],i=[];r<n.length;r++)n[r]!==e&&e&&i.push(n[r]);this.events[t]=i}else this.events={};return this},fire:function(t,e){this.events=this.events||{};for(var n=this.events[t]||[],i=0;i<n.length;i++)n[i].call(this,e);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(t){return{merge:function(e){for(var n in e)t[n]=e[n];return this},get:function(){return t},clone:function(e){var n,i={};if(null===t||!wysihtml5.lang.object(t).isPlainObject())return t;for(n in t)t.hasOwnProperty(n)&&(i[n]=e?wysihtml5.lang.object(t[n]).clone(e):t[n]);return i},isArray:function(){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(){return"[object Function]"===Object.prototype.toString.call(t)},isPlainObject:function(){return"[object Object]"===Object.prototype.toString.call(t)}}},function(){var t=/^\s+/,e=/\s+$/,n=/[&<>\t"]/g,i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(r){return r+="",{trim:function(){return r.replace(t,"").replace(e,"")},interpolate:function(t){for(var e in t)r=this.replace("#{"+e+"}").by(t[e]);return r},replace:function(t){return{by:function(e){return r.split(t).join(e)}}},escapeHTML:function(t,e){var o=r.replace(n,function(t){return i[t]});return t&&(o=o.replace(/(?:\r\n|\r|\n)/g,"<br />")),e&&(o=o.replace(/  /gi,"&nbsp; ")),o}}}}(),function(t){function e(t,e){return o(t,e)?t:(t===t.ownerDocument.documentElement&&(t=t.ownerDocument.body),s(t,e))}function n(t){return t.replace(l,function(t,e){var n,i,r=(e.match(c)||[])[1]||"",o=u[r];return e=e.replace(c,""),e.split(o).length>e.split(r).length&&(e+=r,r=""),n=e,i=e,e.length>h&&(i=i.substr(0,h)+"..."),"www."===n.substr(0,4)&&(n="http://"+n),'<a href="'+n+'">'+i+"</a>"+r})}function i(t){var e=t._wysihtml5_tempElement;return e||(e=t._wysihtml5_tempElement=t.createElement("div")),e}function r(e){var r=e.parentNode,o=t.lang.string(e.data).escapeHTML(),s=i(r.ownerDocument);for(s.innerHTML="<span></span>"+n(o),s.removeChild(s.firstChild);s.firstChild;)r.insertBefore(s.firstChild,e);r.removeChild(e)}function o(e,n){for(var i;e.parentNode;){if(e=e.parentNode,i=e.nodeName,e.className&&t.lang.array(e.className.split(" ")).contains(n))return!0;if(a.contains(i))return!0;if("body"===i)return!1}return!1}function s(e,n){if(!(a.contains(e.nodeName)||e.className&&t.lang.array(e.className.split(" ")).contains(n))){if(e.nodeType===t.TEXT_NODE&&e.data.match(l))return void r(e);for(var i=t.lang.array(e.childNodes).get(),o=i.length,c=0;o>c;c++)s(i[c],n);return e}}var a=t.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,c=/([^\w\/\-](,?))$/i,h=100,u={")":"(","]":"[","}":"{"};t.dom.autoLink=e,t.dom.autoLink.URL_REG_EXP=l}(wysihtml5),function(t){var e=t.dom;e.addClass=function(t,n){var i=t.classList;return i?i.add(n):void(e.hasClass(t,n)||(t.className+=" "+n))},e.removeClass=function(t,e){var n=t.classList;return n?n.remove(e):void(t.className=t.className.replace(RegExp("(^|\\s+)"+e+"(\\s+|$)")," "))},e.hasClass=function(t,e){var n,i=t.classList;return i?i.contains(e):(n=t.className,n.length>0&&(n==e||RegExp("(^|\\s)"+e+"(\\s|$)").test(n)))}}(wysihtml5),wysihtml5.dom.contains=function(){var t=document.documentElement;return t.contains?function(t,e){return e.nodeType!==wysihtml5.ELEMENT_NODE&&(e=e.parentNode),t!==e&&t.contains(e)}:t.compareDocumentPosition?function(t,e){return!!(16&t.compareDocumentPosition(e))}:void 0}(),wysihtml5.dom.convertToList=function(){function t(t,e){var n=t.createElement("li");return e.appendChild(n),n}function e(t,e){return t.createElement(e)}function n(n,i,r){if("UL"===n.nodeName||"OL"===n.nodeName||"MENU"===n.nodeName)return n;var o,s,a,l,c,h,u,d,f,p=n.ownerDocument,m=e(p,i),g=n.querySelectorAll("br"),y=g.length;for(f=0;y>f;f++)for(l=g[f];(c=l.parentNode)&&c!==n&&c.lastChild===l;){if("block"===wysihtml5.dom.getStyle("display").from(c)){c.removeChild(l);break}wysihtml5.dom.insert(l).after(l.parentNode)}
for(o=wysihtml5.lang.array(n.childNodes).get(),s=o.length,f=0;s>f;f++)d=d||t(p,m),a=o[f],h="block"===wysihtml5.dom.getStyle("display").from(a),u="BR"===a.nodeName,!h||r&&wysihtml5.dom.hasClass(a,r)?u?d=d.firstChild?null:d:d.appendChild(a):(d=d.firstChild?t(p,m):d,d.appendChild(a),d=null);return 0===o.length&&t(p,m),n.parentNode.replaceChild(m,n),m}return n}(),wysihtml5.dom.copyAttributes=function(t){return{from:function(e){return{to:function(n){for(var i,r=0,o=t.length;o>r;r++)i=t[r],void 0!==e[i]&&""!==e[i]&&(n[i]=e[i]);return{andTo:arguments.callee}}}}}},function(t){var e=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],n=function(e){return!!i(e)&&parseInt(t.getStyle("width").from(e),10)<e.offsetWidth},i=function(n){for(var i=0,r=e.length;r>i;i++)if("border-box"===t.getStyle(e[i]).from(n))return e[i]};t.copyStyles=function(i){return{from:function(r){n(r)&&(i=wysihtml5.lang.array(i).without(e));for(var o,s="",a=i.length,l=0;a>l;l++)o=i[l],s+=o+":"+t.getStyle(o).from(r)+";";return{to:function(e){return t.setStyles(s).on(e),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(t){t.dom.delegate=function(e,n,i,r){return t.dom.observe(e,i,function(i){for(var o=i.target,s=t.lang.array(e.querySelectorAll(n));o&&o!==e;){if(s.contains(o)){r.call(o,i);break}o=o.parentNode}})}}(wysihtml5),function(t){t.dom.domNode=function(e){var n=[t.ELEMENT_NODE,t.TEXT_NODE],i=function(e){return e.nodeType===t.TEXT_NODE&&/^\s*$/g.test(e.data)};return{prev:function(r){var o=e.previousSibling,s=r&&r.nodeTypes?r.nodeTypes:n;return o?!t.lang.array(s).contains(o.nodeType)||r&&r.ignoreBlankTexts&&i(o)?t.dom.domNode(o).prev(r):o:null},next:function(r){var o=e.nextSibling,s=r&&r.nodeTypes?r.nodeTypes:n;return o?!t.lang.array(s).contains(o.nodeType)||r&&r.ignoreBlankTexts&&i(o)?t.dom.domNode(o).next(r):o:null}}}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var t=function(t,e){var n=e.createElement("div");n.style.display="none",e.body.appendChild(n);try{n.innerHTML=t}catch(t){}return e.body.removeChild(n),n},e=function(t){if(!t._wysihtml5_supportsHTML5Tags){for(var e=0,i=n.length;i>e;e++)t.createElement(n[e]);t._wysihtml5_supportsHTML5Tags=!0}},n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,i){i=i||document;var r;return"object"==typeof n&&n.nodeType?(r=i.createElement("div"),r.appendChild(n)):wysihtml5.browser.supportsHTML5Tags(i)?(r=i.createElement("div"),r.innerHTML=n):(e(i),r=t(n,i)),r}}(),wysihtml5.dom.getParentElement=function(){function t(t,e){return!e||!e.length||("string"==typeof e?t===e:wysihtml5.lang.array(e).contains(t))}function e(t){return t.nodeType===wysihtml5.ELEMENT_NODE}function n(t,e,n){var i=(t.className||"").match(n)||[];return e?i[i.length-1]===e:!!i.length}function i(t,e,n){var i=(t.getAttribute("style")||"").match(n)||[];return e?i[i.length-1]===e:!!i.length}return function(r,o,s,a){var l=o.cssStyle||o.styleRegExp,c=o.className||o.classRegExp;for(s=s||50;s--&&r&&"BODY"!==r.nodeName&&(!a||r!==a);){if(e(r)&&t(r.nodeName,o.nodeName)&&(!l||i(r,o.cssStyle,o.styleRegExp))&&(!c||n(r,o.className,o.classRegExp)))return r;r=r.parentNode}return null}}(),wysihtml5.dom.getStyle=function(){function t(t){return t.replace(n,function(t){return t.charAt(1).toUpperCase()})}var e={float:"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},n=/\-[a-z]/g;return function(n){return{from:function(i){var r,o,s,a,l,c,h,u,d;if(i.nodeType===wysihtml5.ELEMENT_NODE){if(r=i.ownerDocument,o=e[n]||t(n),s=i.style,a=i.currentStyle,l=s[o])return l;if(a)try{return a[o]}catch(t){}return c=r.defaultView||r.parentWindow,h=("height"===n||"width"===n)&&"TEXTAREA"===i.nodeName,c.getComputedStyle?(h&&(u=s.overflow,s.overflow="hidden"),d=c.getComputedStyle(i,null).getPropertyValue(n),h&&(s.overflow=u||""),d):void 0}}}}}(),wysihtml5.dom.getTextNodes=function(t,e){var n=[];for(t=t.firstChild;t;t=t.nextSibling)3==t.nodeType?e&&/^\s*$/.test(t.innerText||t.textContent)||n.push(t):n=n.concat(wysihtml5.dom.getTextNodes(t,e));return n},wysihtml5.dom.hasElementWithTagName=function(){function t(t){return t._wysihtml5_identifier||(t._wysihtml5_identifier=n++)}var e={},n=1;return function(n,i){var r=t(n)+":"+i,o=e[r];return o||(o=e[r]=n.getElementsByTagName(i)),o.length>0}}(),function(t){function e(t){return t._wysihtml5_identifier||(t._wysihtml5_identifier=i++)}var n={},i=1;t.dom.hasElementWithClassName=function(i,r){if(!t.browser.supportsNativeGetElementsByClassName())return!!i.querySelector("."+r);var o=e(i)+":"+r,s=n[o];return s||(s=n[o]=i.getElementsByClassName(r)),s.length>0}}(wysihtml5),wysihtml5.dom.insert=function(t){return{after:function(e){e.parentNode.insertBefore(t,e.nextSibling)},before:function(e){e.parentNode.insertBefore(t,e)},into:function(e){e.appendChild(t)}}},wysihtml5.dom.insertCSS=function(t){return t=t.join("\n"),{into:function(e){var n,i,r=e.createElement("style");return r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(e.createTextNode(t)),n=e.querySelector("head link"),n?void n.parentNode.insertBefore(r,n):void((i=e.querySelector("head"))&&i.appendChild(r))}}},function(t){t.dom.lineBreaks=function(e){function n(t){return"BR"===t.nodeName}function i(e){return!!n(e)||"block"===t.dom.getStyle("display").from(e)}return{add:function(){var n=e.ownerDocument,r=t.dom.domNode(e).next({ignoreBlankTexts:!0}),o=t.dom.domNode(e).prev({ignoreBlankTexts:!0});r&&!i(r)&&t.dom.insert(n.createElement("br")).after(e),o&&!i(o)&&t.dom.insert(n.createElement("br")).before(e)},remove:function(){var i=t.dom.domNode(e).next({ignoreBlankTexts:!0}),r=t.dom.domNode(e).prev({ignoreBlankTexts:!0});i&&n(i)&&i.parentNode.removeChild(i),r&&n(r)&&r.parentNode.removeChild(r)}}}}(wysihtml5),wysihtml5.dom.observe=function(t,e,n){e="string"==typeof e?[e]:e;for(var i,r,o=0,s=e.length;s>o;o++)r=e[o],t.addEventListener?t.addEventListener(r,n,!1):(i=function(e){"target"in e||(e.target=e.srcElement),e.preventDefault=e.preventDefault||function(){this.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=!0},n.call(t,e)},t.attachEvent("on"+r,i));return{stop:function(){for(var r,o=0,s=e.length;s>o;o++)r=e[o],t.removeEventListener?t.removeEventListener(r,n,!1):t.detachEvent("on"+r,i)}}},wysihtml5.dom.parse=function(t,e){function n(t,e,i,r){var o,s,a,l=t.nodeType,c=t.childNodes,h=c.length,u=p[l],d=0;if(r&&1===l&&wysihtml5.dom.hasClass(t,r))return t;if(!(s=u&&u(t,i))){if(!1===s){for(o=t.ownerDocument.createDocumentFragment(),d=h;d--;)c[d]&&(a=n(c[d],e,i,r))&&(c[d]===a&&d--,o.insertBefore(a,o.firstChild));return"block"===wysihtml5.dom.getStyle("display").from(t)&&o.appendChild(t.ownerDocument.createElement("br")),wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(t.nodeName.toLowerCase())&&t.parentNode.lastChild!==t&&(t.nextSibling&&3===t.nextSibling.nodeType&&/^\s/.test(t.nextSibling.nodeValue)||o.appendChild(t.ownerDocument.createTextNode(" "))),o.normalize&&o.normalize(),o}return null}for(d=0;h>d;d++)c[d]&&(a=n(c[d],e,i,r))&&(c[d]===a&&d--,s.appendChild(a));if(e&&s.nodeName.toLowerCase()===m&&(!s.childNodes.length||/^\s*$/gi.test(s.innerHTML)&&(i||"_wysihtml5-temp-placeholder"!==t.className&&"rangySelectionBoundary"!==t.className)||!s.attributes.length)){for(o=s.ownerDocument.createDocumentFragment();s.firstChild;)o.appendChild(s.firstChild);return o.normalize&&o.normalize(),o}return s.normalize&&s.normalize(),s}function i(t,e){var n,i,r,o;for(n in e)if(e.hasOwnProperty(n))for(wysihtml5.lang.object(e[n]).isFunction()?i=e[n]:"string"==typeof e[n]&&S[e[n]]&&(i=S[e[n]]),r=t.querySelectorAll(n),o=r.length;o--;)i(r[o])}function r(t,e){var n,i,r,s=v.tags,l=t.nodeName.toLowerCase(),c=t.scopeName;if(t._wysihtml5)return null;if(t._wysihtml5=1,"wysihtml5-temp"===t.className)return null;if(c&&"HTML"!=c&&(l=c+":"+l),"outerHTML"in t&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==t.nodeName||"</p>"===t.outerHTML.slice(-4).toLowerCase()||(l="div")),l in s){if(!(n=s[l])||n.remove)return null;if(n.unwrap)return!1;n="string"==typeof n?{rename_tag:n}:n}else{if(!t.firstChild)return null;n={rename_tag:m}}if(n.one_of_type&&!o(t,v,n.one_of_type,e)){if(!n.remove_action)return null;if("unwrap"===n.remove_action)return!1;if("rename"!==n.remove_action)return null;r=n.remove_action_rename_to||m}return i=t.ownerDocument.createElement(r||n.rename_tag||l),u(t,i,n,e),a(t,i,n),t=null,i.normalize&&i.normalize(),i}function o(t,e,n,i){var r,o;if("SPAN"===t.nodeName&&!i&&("_wysihtml5-temp-placeholder"===t.className||"rangySelectionBoundary"===t.className))return!0;for(o in n)if(n.hasOwnProperty(o)&&e.type_definitions&&e.type_definitions[o]&&(r=e.type_definitions[o],s(t,r)))return!0;return!1}function s(t,e){var n,i,r,o,s,a,l,c,h=t.getAttribute("class"),u=t.getAttribute("style");if(e.methods)for(a in e.methods)if(e.methods.hasOwnProperty(a)&&_[a]&&_[a](t))return!0;if(h&&e.classes)for(h=h.replace(/^\s+/g,"").replace(/\s+$/g,"").split(g),n=h.length,l=0;n>l;l++)if(e.classes[h[l]])return!0;if(u&&e.styles){u=u.split(";");for(i in e.styles)if(e.styles.hasOwnProperty(i))for(c=u.length;c--;)if(s=u[c].split(":"),s[0].replace(/\s/g,"").toLowerCase()===i&&(!0===e.styles[i]||1===e.styles[i]||wysihtml5.lang.array(e.styles[i]).contains(s[1].replace(/\s/g,"").toLowerCase())))return!0}if(e.attrs)for(r in e.attrs)if(e.attrs.hasOwnProperty(r)&&"string"==typeof(o=wysihtml5.dom.getAttribute(t,r))&&o.search(e.attrs[r])>-1)return!0;return!1}function a(t,e,n){var i,r;if(n&&n.keep_styles)for(i in n.keep_styles)if(n.keep_styles.hasOwnProperty(i)){if(r="float"===i?t.style.styleFloat||t.style.cssFloat:t.style[i],n.keep_styles[i]instanceof RegExp&&!n.keep_styles[i].test(r))continue;"float"===i?e.style[t.style.styleFloat?"styleFloat":"cssFloat"]=r:t.style[i]&&(e.style[i]=r)}}function l(t,e){var n,i=[];for(n in e)e.hasOwnProperty(n)&&0===n.indexOf(t)&&i.push(n);return i}function c(t,e,n,i){var r,o=w[n];return!(!o||!(e||"alt"===t&&"IMG"==i)||"string"!=typeof(r=o(e)))&&r}function h(t,e){var n,i,r,o,s,a=wysihtml5.lang.object(v.attributes||{}).clone(),h=wysihtml5.lang.object(a).merge(wysihtml5.lang.object(e||{}).clone()).get(),u={},d=wysihtml5.dom.getAttributes(t);for(n in h)if(/\*$/.test(n))for(r=l(n.slice(0,-1),d),o=0,s=r.length;s>o;o++)!1!==(i=c(r[o],d[r[o]],h[n],t.nodeName))&&(u[r[o]]=i);else!1!==(i=c(n,d[n],h[n],t.nodeName))&&(u[n]=i);return u}function u(t,e,n,i){var r,o,s,a,l,c={},u=n.set_class,d=n.add_class,f=n.add_style,p=n.set_attributes,m=v.classes,y=0,b=[],w=[],_=[],S=[];if(p&&(c=wysihtml5.lang.object(p).clone()),c=wysihtml5.lang.object(c).merge(h(t,n.check_attributes)).get(),u&&b.push(u),d)for(a in d)(l=C[d[a]])&&"string"==typeof(s=l(wysihtml5.dom.getAttribute(t,a)))&&b.push(s);if(f)for(a in f)(l=x[f[a]])&&(newStyle=l(wysihtml5.dom.getAttribute(t,a)),"string"==typeof newStyle&&w.push(newStyle));if("string"==typeof m&&"any"===m&&t.getAttribute("class"))if(v.classes_blacklist){for(S=t.getAttribute("class"),S&&(b=b.concat(S.split(g))),r=b.length;r>y;y++)o=b[y],v.classes_blacklist[o]||_.push(o);_.length&&(c.class=wysihtml5.lang.array(_).unique().join(" "))}else c.class=t.getAttribute("class");else{for(i||(m["_wysihtml5-temp-placeholder"]=1,m._rangySelectionBoundary=1,m["wysiwyg-tmp-selected-cell"]=1),S=t.getAttribute("class"),S&&(b=b.concat(S.split(g))),r=b.length;r>y;y++)o=b[y],m[o]&&_.push(o);_.length&&(c.class=wysihtml5.lang.array(_).unique().join(" "))}c.class&&i&&(c.class=c.class.replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(c.class)&&delete c.class),w.length&&(c.style=wysihtml5.lang.array(w).unique().join(" "));for(a in c)try{e.setAttribute(a,c[a])}catch(t){}c.src&&(void 0!==c.width&&e.setAttribute("width",c.width),void 0!==c.height&&e.setAttribute("height",c.height))}function d(t){var e,n=t.nextSibling;return n&&n.nodeType===wysihtml5.TEXT_NODE?void(n.data=t.data.replace(b,"")+n.data.replace(b,"")):(e=t.data.replace(b,""),t.ownerDocument.createTextNode(e))}function f(t){return v.comments?t.ownerDocument.createComment(t.nodeValue):void 0}var p={1:r,3:d,8:f},m="span",g=/\s+/,y={tags:{},classes:{}},v={},b=/\uFEFF/g,w={url:function(){var t=/^https?:\/\//i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),src:function(){var t=/^(\/|https?:\/\/)/i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),href:function(){var t=/^(#|\/|https?:\/\/|mailto:)/i;return function(e){return e&&e.match(t)?e.replace(t,function(t){return t.toLowerCase()}):null}}(),alt:function(){var t=/[^ a-z0-9_\-]/gi;return function(e){return e?e.replace(t,""):""}}(),numbers:function(){var t=/\D/g;return function(e){return(e=(e||"").replace(t,""))||null}}(),any:function(){return function(t){return t}}()},x={align_text:function(){var t={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(e){return t[(e+"").toLowerCase()]}}()},C={align_img:function(){var t={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(e){return t[(e+"").toLowerCase()]}}(),align_text:function(){var t={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(e){return t[(e+"").toLowerCase()]}}(),clear_br:function(){var t={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(e){return t[(e+"").toLowerCase()]}}(),size_font:function(){var t={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(e){return t[(e+"").charAt(0)]}}()},_={has_visible_contet:function(){var t,e=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(n){if((t=(n.innerText||n.textContent).replace(/\s/g,""))&&t.length>0)return!0;for(var i=e.length;i--;)if(n.querySelector(e[i]))return!0;return!!(n.offsetWidth&&n.offsetWidth>0&&n.offsetHeight&&n.offsetHeight>0)}}()},S={unwrap:function(t){wysihtml5.dom.unwrap(t)},remove:function(t){t.parentNode.removeChild(t)}};return function(t,e){var r,o,s,a,l,c,h,u,d;for(wysihtml5.lang.object(v).merge(y).merge(e.rules).get(),r=e.context||t.ownerDocument||document,o=r.createDocumentFragment(),s="string"==typeof t,a=!1,!0===e.clearInternals&&(a=!0),l=s?wysihtml5.dom.getAsDom(t,r):t,v.selectors&&i(l,v.selectors);l.firstChild;)h=l.firstChild,c=n(h,e.cleanUp,a,e.uneditableClass),c&&o.appendChild(c),h!==c&&l.removeChild(h);if(e.unjoinNbsps)for(u=wysihtml5.dom.getTextNodes(o),d=u.length;d--;)u[d].nodeValue=u[d].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");return l.innerHTML="",l.appendChild(o),s?wysihtml5.quirks.getCorrectInnerHTML(l):l}(t,e)},wysihtml5.dom.removeEmptyTextNodes=function(t){for(var e,n=wysihtml5.lang.array(t.childNodes).get(),i=n.length,r=0;i>r;r++)e=n[r],e.nodeType===wysihtml5.TEXT_NODE&&""===e.data&&e.parentNode.removeChild(e)},wysihtml5.dom.renameElement=function(t,e){for(var n,i=t.ownerDocument.createElement(e);n=t.firstChild;)i.appendChild(n);return wysihtml5.dom.copyAttributes(["align","className"]).from(t).to(i),t.parentNode.replaceChild(i,t),i},wysihtml5.dom.replaceWithChildNodes=function(t){if(t.parentNode){if(!t.firstChild)return void t.parentNode.removeChild(t);for(var e=t.ownerDocument.createDocumentFragment();t.firstChild;)e.appendChild(t.firstChild);t.parentNode.replaceChild(e,t),t=e=null}},function(t){function e(e){return"block"===t.getStyle("display").from(e)}function n(t){return"BR"===t.nodeName}function i(t){var e=t.ownerDocument.createElement("br");t.appendChild(e)}function r(t,r){if(t.nodeName.match(/^(MENU|UL|OL)$/)){var o,s,a,l,c,h,u=t.ownerDocument,d=u.createDocumentFragment(),f=wysihtml5.dom.domNode(t).prev({ignoreBlankTexts:!0});if(r)for(!f||e(f)||n(f)||i(d);h=t.firstElementChild||t.firstChild;){for(s=h.lastChild;o=h.firstChild;)a=o===s,l=a&&!e(o)&&!n(o),d.appendChild(o),l&&i(d);h.parentNode.removeChild(h)}else for(;h=t.firstElementChild||t.firstChild;){if(h.querySelector&&h.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;o=h.firstChild;)d.appendChild(o);else{for(c=u.createElement("p");o=h.firstChild;)c.appendChild(o);d.appendChild(c)}h.parentNode.removeChild(h)}t.parentNode.replaceChild(d,t)}}t.resolveList=r}(wysihtml5.dom),function(t){var e=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],i=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],r=["referrer","write","open","close"];t.dom.Sandbox=Base.extend({constructor:function(e,n){this.callback=e||t.EMPTY_FUNCTION,this.config=t.lang.object({}).merge(n).get(),this.editableArea=this._createIframe()},insertInto:function(t){"string"==typeof t&&(t=e.getElementById(t)),t.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var t=this.getIframe();t.parentNode.removeChild(t)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,i=e.createElement("iframe");return i.className="wysihtml5-sandbox",t.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(i),t.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(i.src="javascript:'<html></html>'"),i.onload=function(){i.onreadystatechange=i.onload=null,n._onLoadIframe(i)},i.onreadystatechange=function(){/loaded|complete/.test(i.readyState)&&(i.onreadystatechange=i.onload=null,n._onLoadIframe(i))},i},_onLoadIframe:function(o){var s,a,l,c,h,u,d;if(t.dom.contains(e.documentElement,o)){if(s=this,a=o.contentWindow,l=o.contentWindow.document,c=e.characterSet||e.charset||"utf-8",h=this._getHtml({charset:c,stylesheets:this.config.stylesheets}),l.open("text/html","replace"),l.write(h),l.close(),this.getWindow=function(){return o.contentWindow},this.getDocument=function(){return o.contentWindow.document},a.onerror=function(t,e,n){throw Error("wysihtml5.Sandbox: "+t,e,n)},!t.browser.supportsSandboxedIframes()){for(u=0,d=n.length;d>u;u++)this._unset(a,n[u]);for(u=0,d=i.length;d>u;u++)this._unset(a,i[u],t.EMPTY_FUNCTION);for(u=0,d=r.length;d>u;u++)this._unset(l,r[u]);this._unset(l,"cookie","",!0)}this.loaded=!0,setTimeout(function(){s.callback(s)},0)}},_getHtml:function(e){var n,i=e.stylesheets,r="",o=0;if(i="string"==typeof i?[i]:i)for(n=i.length;n>o;o++)r+='<link rel="stylesheet" href="'+i[o]+'">';return e.stylesheets=r,t.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(e)},_unset:function(e,n,i,r){try{e[n]=i}catch(t){}try{e.__defineGetter__(n,function(){return i})}catch(t){}if(r)try{e.__defineSetter__(n,function(){})}catch(t){}if(!t.browser.crashesWhenDefineProperty(n))try{var o={get:function(){return i}};r&&(o.set=function(){}),Object.defineProperty(e,n,o)}catch(t){}}})}(wysihtml5),function(t){var e=document;t.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(e,n,i){this.callback=e||t.EMPTY_FUNCTION,this.config=t.lang.object({}).merge(n).get(),this.element=i?this._bindElement(i):this._createElement()},_createElement:function(){var t=e.createElement("div");return t.className="wysihtml5-sandbox",this._loadElement(t),t},_bindElement:function(t){return t.className=t.className&&""!=t.className?t.className+" wysihtml5-sandbox":"wysihtml5-sandbox",this._loadElement(t,!0),t},_loadElement:function(t,e){var n,i=this;e||(n=this._getHtml(),t.innerHTML=n),this.getWindow=function(){return t.ownerDocument.defaultView},this.getDocument=function(){return t.ownerDocument},this.loaded=!0,setTimeout(function(){i.callback(i)},0)},_getHtml:function(){return""}})}(wysihtml5),function(){var t={className:"class"};wysihtml5.dom.setAttributes=function(e){return{on:function(n){for(var i in e)n.setAttribute(t[i]||i,e[i])}}}}(),wysihtml5.dom.setStyles=function(t){return{on:function(e){var n,i=e.style;if("string"==typeof t)return void(i.cssText+=";"+t);for(n in t)"float"===n?(i.cssFloat=t[n],i.styleFloat=t[n]):i[n]=t[n]}}},function(t){t.simulatePlaceholder=function(e,n,i){var r="placeholder",o=function(){var e=n.element.offsetWidth>0&&n.element.offsetHeight>0;n.hasPlaceholderSet()&&(n.clear(),n.element.focus(),e&&setTimeout(function(){var t=n.selection.getSelection();t.focusNode&&t.anchorNode||n.selection.selectNode(n.element.firstChild||n.element)},0)),n.placeholderSet=!1,t.removeClass(n.element,r)},s=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(i),t.addClass(n.element,r))};e.on("set_placeholder",s).on("unset_placeholder",o).on("focus:composer",o).on("paste:composer",o).on("blur:composer",s),s()}}(wysihtml5.dom),function(t){var e=document.documentElement;"textContent"in e?(t.setTextContent=function(t,e){t.textContent=e},t.getTextContent=function(t){return t.textContent}):"innerText"in e?(t.setTextContent=function(t,e){t.innerText=e},t.getTextContent=function(t){return t.innerText}):(t.setTextContent=function(t,e){t.nodeValue=e},t.getTextContent=function(t){return t.nodeValue})}(wysihtml5.dom),wysihtml5.dom.getAttribute=function(t,e){var n,i,r,o=!wysihtml5.browser.supportsGetAttributeCorrectly();return e=e.toLowerCase(),n=t.nodeName,"IMG"==n&&"src"==e&&!0===wysihtml5.dom.isLoadedImage(t)?t.src:o&&"outerHTML"in t?(i=t.outerHTML.toLowerCase(),r=-1!=i.indexOf(" "+e+"="),r?t.getAttribute(e):null):t.getAttribute(e)},wysihtml5.dom.getAttributes=function(t){var e,n=!wysihtml5.browser.supportsGetAttributeCorrectly(),i=t.nodeName,r=[];for(e in t.attributes)(t.attributes.hasOwnProperty&&t.attributes.hasOwnProperty(e)||!t.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t.attributes,e))&&t.attributes[e].specified&&("IMG"==i&&"src"==t.attributes[e].name.toLowerCase()&&!0===wysihtml5.dom.isLoadedImage(t)?r.src=t.src:wysihtml5.lang.array(["rowspan","colspan"]).contains(t.attributes[e].name.toLowerCase())&&n?1!==t.attributes[e].value&&(r[t.attributes[e].name]=t.attributes[e].value):r[t.attributes[e].name]=t.attributes[e].value);return r},wysihtml5.dom.isLoadedImage=function(t){try{return t.complete&&!t.mozMatchesSelector(":-moz-broken")}catch(e){if(t.complete&&"complete"===t.readyState)return!0}},function(t){function e(t,e){var n,i,r,o,s=[];for(i=0,r=t.length;r>i;i++)if(n=t[i].querySelectorAll(e))for(o=n.length;o--;s.unshift(n[o]));return s}function n(t){t.parentNode.removeChild(t)}function i(t,e){t.parentNode.insertBefore(e,t.nextSibling)}function r(t,e){for(var n=t.nextSibling;1!=n.nodeType;)if(n=n.nextSibling,!e||e==n.tagName.toLowerCase())return n;return null}var o=t.dom,s=function(t){this.el=t,this.isColspan=!1,this.isRowspan=!1,this.firstCol=!0,this.lastCol=!0,this.firstRow=!0,this.lastRow=!0,this.isReal=!0,this.spanCollection=[],this.modified=!1},a=function(t,e){t?(this.cell=t,this.table=o.getParentElement(t,{nodeName:["TABLE"]})):e&&(this.table=e,this.cell=this.table.querySelectorAll("th, td")[0])};a.prototype={addSpannedCellToMap:function(t,e,n,i,r,o){var a,l,c=[],h=n+(o?parseInt(o,10)-1:0),u=i+(r?parseInt(r,10)-1:0);for(a=n;h>=a;a++)for(void 0===e[a]&&(e[a]=[]),l=i;u>=l;l++)e[a][l]=new s(t),e[a][l].isColspan=r&&parseInt(r,10)>1,e[a][l].isRowspan=o&&parseInt(o,10)>1,e[a][l].firstCol=l==i,e[a][l].lastCol=l==u,e[a][l].firstRow=a==n,e[a][l].lastRow=a==h,e[a][l].isReal=l==i&&a==n,e[a][l].spanCollection=c,c.push(e[a][l])},setCellAsModified:function(t){if(t.modified=!0,t.spanCollection.length>0)for(var e=0,n=t.spanCollection.length;n>e;e++)t.spanCollection[e].modified=!0},setTableMap:function(){var t,e,n,i,r,a,l,c,h=[],u=this.getTableRows();for(t=0;t<u.length;t++)for(e=u[t],n=this.getRowCells(e),a=0,void 0===h[t]&&(h[t]=[]),i=0;i<n.length;i++){for(r=n[i];void 0!==h[t][a];)a++;l=o.getAttribute(r,"colspan"),c=o.getAttribute(r,"rowspan"),l||c?(this.addSpannedCellToMap(r,h,t,a,l,c),a+=l?parseInt(l,10):1):(h[t][a]=new s(r),a++)}return this.map=h,h},getRowCells:function(n){var i=this.table.querySelectorAll("table"),r=i?e(i,"th, td"):[],o=n.querySelectorAll("th, td");return r.length>0?t.lang.array(o).without(r):o},getTableRows:function(){var n=this.table.querySelectorAll("table"),i=n?e(n,"tr"):[],r=this.table.querySelectorAll("tr");return i.length>0?t.lang.array(r).without(i):r},getMapIndex:function(t){var e,n,i=this.map.length,r=this.map&&this.map[0]?this.map[0].length:0;for(e=0;i>e;e++)for(n=0;r>n;n++)if(this.map[e][n].el===t)return{row:e,col:n};return!1},getElementAtIndex:function(t){return this.setTableMap(),this.map[t.row]&&this.map[t.row][t.col]&&this.map[t.row][t.col].el?this.map[t.row][t.col].el:null},getMapElsTo:function(t){var e,n,i,r,o,s,a=[];if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(t),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),null!=this.idx_start&&null!=this.idx_end)for(i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(o=this.idx_start.col,s=this.idx_end.col;s>=o;o++)a.push(this.map[i][o].el);return a},orderSelectionEnds:function(t){var e,n;return this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(t),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(t,e,n){var i,r,o,s=this.table.ownerDocument,a=s.createDocumentFragment();for(r=0;e>r;r++){if(i=s.createElement(t),n)for(o in n)n.hasOwnProperty(o)&&i.setAttribute(o,n[o]);i.appendChild(document.createTextNode(" ")),a.appendChild(i)}return a},correctColIndexForUnreals:function(t,e){var n,i=this.map[e],r=-1;for(n=0,t;t>n;n++)i[n].isReal&&r++;return r},getLastNewCellOnRow:function(t,e){var n,i,r,o,s=this.getRowCells(t);for(r=0,o=s.length;o>r;r++)if(n=s[r],!1===(i=this.getMapIndex(n))||void 0!==e&&i.row!=e)return n;return null},removeEmptyTable:function(){var t=this.table.querySelectorAll("td, th");return(!t||0==t.length)&&(n(this.table),!0)},splitRowToCells:function(t){var e,n,r;t.isColspan&&(e=parseInt(o.getAttribute(t.el,"colspan")||1,10),n=t.el.tagName.toLowerCase(),e>1&&(r=this.createCells(n,e-1),i(t.el,r)),t.el.removeAttribute("colspan"))},getRealRowEl:function(t,e){var n,i,r=null,s=null;for(e=e||this.idx,n=0,i=this.map[e.row].length;i>n;n++)if(s=this.map[e.row][n],s.isReal&&(r=o.getParentElement(s.el,{nodeName:["TR"]})))return r;return null===r&&t&&(r=o.getParentElement(this.map[e.row][e.col].el,{nodeName:["TR"]})||null),r},injectRowAt:function(t,e,n,r,s){var a,l,c=this.getRealRowEl(!1,{row:t,col:e}),h=this.createCells(r,n);c?(a=this.correctColIndexForUnreals(e,t),a>=0?i(this.getRowCells(c)[a],h):c.insertBefore(h,c.firstChild)):(l=this.table.ownerDocument.createElement("tr"),l.appendChild(h),i(o.getParentElement(s.el,{nodeName:["TR"]}),l))},canMerge:function(t){var e,n,i,r,o,s;for(this.to=t,this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(this.to),(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)&&(e=this.idx_start,this.idx_start=this.idx_end,this.idx_end=e),this.idx_start.col>this.idx_end.col&&(n=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=n),i=this.idx_start.row,r=this.idx_end.row;r>=i;i++)for(o=this.idx_start.col,s=this.idx_end.col;s>=o;o++)if(this.map[i][o].isColspan||this.map[i][o].isRowspan)return!1;return!0},decreaseCellSpan:function(t,e){var n=parseInt(o.getAttribute(t.el,e),10)-1;n>=1?t.el.setAttribute(e,n):(t.el.removeAttribute(e),"colspan"==e&&(t.isColspan=!1),"rowspan"==e&&(t.isRowspan=!1),t.firstCol=!0,t.lastCol=!0,t.firstRow=!0,t.lastRow=!0,t.isReal=!0)},removeSurplusLines:function(){var t,e,i,r,s,a,l,c;if(this.setTableMap(),this.map){for(i=0,r=this.map.length;r>i;i++){for(t=this.map[i],l=!0,s=0,a=t.length;a>s;s++)if(e=t[s],!(o.getAttribute(e.el,"rowspan")&&parseInt(o.getAttribute(e.el,"rowspan"),10)>1&&!0!==e.firstRow)){l=!1;break}if(l)for(s=0;a>s;s++)this.decreaseCellSpan(t[s],"rowspan")}for(c=this.getTableRows(),i=0,r=c.length;r>i;i++)t=c[i],0==t.childNodes.length&&/^\s*$/.test(t.textContent||t.innerText)&&n(t)}},fillMissingCells:function(){var t,e,n,r=0,o=0,a=null;if(this.setTableMap(),this.map){for(r=this.map.length,t=0;r>t;t++)this.map[t].length>o&&(o=this.map[t].length);for(e=0;r>e;e++)for(n=0;o>n;n++)this.map[e]&&!this.map[e][n]&&n>0&&(this.map[e][n]=new s(this.createCells("td",1)),(a=this.map[e][n-1])&&a.el&&a.el.parent&&i(this.map[e][n-1].el,this.map[e][n].el))}},rectify:function(){return!this.removeEmptyTable()&&(this.removeSurplusLines(),this.fillMissingCells(),!0)},unmerge:function(){var t,e,n,i,r,s;if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx)){if(t=this.map[this.idx.row][this.idx.col],e=o.getAttribute(t.el,"colspan")?parseInt(o.getAttribute(t.el,"colspan"),10):1,n=t.el.tagName.toLowerCase(),t.isRowspan){if((i=parseInt(o.getAttribute(t.el,"rowspan"),10))>1)for(r=1,s=i-1;s>=r;r++)this.injectRowAt(this.idx.row+r,this.idx.col,e,n,t);t.el.removeAttribute("rowspan")}this.splitRowToCells(t)}},merge:function(t){var e,i,r,o,s,a;if(this.rectify())if(this.canMerge(t)){for(e=this.idx_end.row-this.idx_start.row+1,i=this.idx_end.col-this.idx_start.col+1,r=this.idx_start.row,o=this.idx_end.row;o>=r;r++)for(s=this.idx_start.col,a=this.idx_end.col;a>=s;s++)r==this.idx_start.row&&s==this.idx_start.col?(e>1&&this.map[r][s].el.setAttribute("rowspan",e),i>1&&this.map[r][s].el.setAttribute("colspan",i)):(/^\s*<br\/?>\s*$/.test(this.map[r][s].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[r][s].el.innerHTML),n(this.map[r][s].el));this.rectify()}else window.console},collapseCellToNextRow:function(t){var e,n,r,s=this.getMapIndex(t.el),a=s.row+1,l={row:a,col:s.col};a<this.map.length&&null!==(e=this.getRealRowEl(!1,l))&&(n=this.correctColIndexForUnreals(l.col,l.row),n>=0?i(this.getRowCells(e)[n],t.el):(r=this.getLastNewCellOnRow(e,a),null!==r?i(r,t.el):e.insertBefore(t.el,e.firstChild)),parseInt(o.getAttribute(t.el,"rowspan"),10)>2?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)-1):t.el.removeAttribute("rowspan"))},removeRowCell:function(t){t.isReal?t.isRowspan?this.collapseCellToNextRow(t):n(t.el):parseInt(o.getAttribute(t.el,"rowspan"),10)>2?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)-1):t.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var t,e,n,i=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(t=this.map[this.idx.row],e=0,n=t.length;n>e;e++)t[e].isReal&&i.push(t[e].el);return i},getColumnElementsByCell:function(){var t,e,n=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),
!1!==this.idx)for(t=0,e=this.map.length;e>t;t++)this.map[t][this.idx.col]&&this.map[t][this.idx.col].isReal&&n.push(this.map[t][this.idx.col].el);return n},removeRow:function(){var t,e,i,r=o.getParentElement(this.cell,{nodeName:["TR"]});if(r){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(t=this.map[this.idx.row],e=0,i=t.length;i>e;e++)t[e].modified||(this.setCellAsModified(t[e]),this.removeRowCell(t[e]));n(r)}},removeColCell:function(t){t.isColspan?parseInt(o.getAttribute(t.el,"colspan"),10)>2?t.el.setAttribute("colspan",parseInt(o.getAttribute(t.el,"colspan"),10)-1):t.el.removeAttribute("colspan"):t.isReal&&n(t.el)},removeColumn:function(){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=0,e=this.map.length;e>t;t++)this.map[t][this.idx.col].modified||(this.setCellAsModified(this.map[t][this.idx.col]),this.removeColCell(this.map[t][this.idx.col]))},remove:function(t){if(this.rectify()){switch(t){case"row":this.removeRow();break;case"column":this.removeColumn()}this.rectify()}},addRow:function(t){var e,n,r,s,a,l=this.table.ownerDocument;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"below"==t&&o.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(o.getAttribute(this.cell,"rowspan"),10)-1),!1!==this.idx){for(e=this.map[this.idx.row],n=l.createElement("tr"),r=0,s=e.length;s>r;r++)e[r].modified||(this.setCellAsModified(e[r]),this.addRowCell(e[r],n,t));switch(t){case"below":i(this.getRealRowEl(!0),n);break;case"above":(a=o.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]}))&&a.parentNode.insertBefore(n,a)}}},addRowCell:function(t,e,n){var i=t.isColspan?{colspan:o.getAttribute(t.el,"colspan")}:null;t.isReal?"above"!=n&&t.isRowspan?t.el.setAttribute("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)+1):e.appendChild(this.createCells("td",1,i)):"above"!=n&&t.isRowspan&&t.lastRow?e.appendChild(this.createCells("td",1,i)):c.isRowspan&&t.el.attr("rowspan",parseInt(o.getAttribute(t.el,"rowspan"),10)+1)},add:function(t){this.rectify()&&(("below"==t||"above"==t)&&this.addRow(t),("before"==t||"after"==t)&&this.addColumn(t))},addColCell:function(t,e,n){var r,s=t.el.tagName.toLowerCase();switch(n){case"before":r=!t.isColspan||t.firstCol;break;case"after":r=!t.isColspan||t.lastCol||t.isColspan&&c.el==this.cell}if(r){switch(n){case"before":t.el.parentNode.insertBefore(this.createCells(s,1),t.el);break;case"after":i(t.el,this.createCells(s,1))}t.isRowspan&&this.handleCellAddWithRowspan(t,e+1,n)}else t.el.setAttribute("colspan",parseInt(o.getAttribute(t.el,"colspan"),10)+1)},addColumn:function(t){var e,n,i,r;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"after"==t&&o.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(o.getAttribute(this.cell,"colspan"),10)-1),!1!==this.idx)for(i=0,r=this.map.length;r>i;i++)e=this.map[i],e[this.idx.col]&&(n=e[this.idx.col],n.modified||(this.setCellAsModified(n),this.addColCell(n,i,t)))},handleCellAddWithRowspan:function(t,e,n){var s,a,l,c,h=parseInt(o.getAttribute(this.cell,"rowspan"),10)-1,u=o.getParentElement(t.el,{nodeName:["TR"]}),d=t.el.tagName.toLowerCase(),f=this.table.ownerDocument;for(c=0;h>c;c++)if(s=this.correctColIndexForUnreals(this.idx.col,e+c),u=r(u,"tr"))if(s>0)switch(n){case"before":a=this.getRowCells(u),s>0&&this.map[e+c][this.idx.col].el!=a[s]&&s==a.length-1?i(a[s],this.createCells(d,1)):a[s].parentNode.insertBefore(this.createCells(d,1),a[s]);break;case"after":i(this.getRowCells(u)[s],this.createCells(d,1))}else u.insertBefore(this.createCells(d,1),u.firstChild);else l=f.createElement("tr"),l.appendChild(this.createCells(d,1)),this.table.appendChild(l)}},o.table={getCellsBetween:function(t,e){return new a(t).getMapElsTo(e)},addCells:function(t,e){new a(t).add(e)},removeCells:function(t,e){new a(t).remove(e)},mergeCellsBetween:function(t,e){new a(t).merge(e)},unmergeCell:function(t){new a(t).unmerge()},orderSelectionEnds:function(t,e){return new a(t).orderSelectionEnds(e)},indexOf:function(t){var e=new a(t);return e.setTableMap(),e.getMapIndex(t)},findCell:function(t,e){return new a(null,t).getElementAtIndex(e)},findRowByCell:function(t){return new a(t).getRowElementsByCell()},findColumnByCell:function(t){return new a(t).getColumnElementsByCell()},canMerge:function(t,e){return new a(t).canMerge(e)}}}(wysihtml5),wysihtml5.dom.query=function(t,e){var n,i,r,o,s=[];for(t.nodeType&&(t=[t]),i=0,r=t.length;r>i;i++)if(n=t[i].querySelectorAll(e))for(o=n.length;o--;s.unshift(n[o]));return s},wysihtml5.dom.compareDocumentPosition=function(){return document.documentElement.compareDocumentPosition?function(t,e){return t.compareDocumentPosition(e)}:function(t,e){var n,i,r,o,s,a,l,c,h;if(n=9===t.nodeType?t:t.ownerDocument,i=9===e.nodeType?e:e.ownerDocument,t===e)return 0;if(t===e.ownerDocument)return 20;if(t.ownerDocument===e)return 10;if(n!==i)return 1;if(2===t.nodeType&&t.childNodes&&-1!==wysihtml5.lang.array(t.childNodes).indexOf(e))return 20;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml5.lang.array(e.childNodes).indexOf(t))return 10;for(r=t,o=[],s=null;r;){if(r==e)return 10;o.push(r),r=r.parentNode}for(r=e,s=null;r;){if(r==t)return 20;if(-1!==(a=wysihtml5.lang.array(o).indexOf(r)))return l=o[a],c=wysihtml5.lang.array(l.childNodes).indexOf(o[a-1]),h=wysihtml5.lang.array(l.childNodes).indexOf(s),c>h?2:4;s=r,r=r.parentNode}return 1}}(),wysihtml5.dom.unwrap=function(t){if(t.parentNode){for(;t.lastChild;)wysihtml5.dom.insert(t.lastChild).after(t);t.parentNode.removeChild(t)}},wysihtml5.dom.getPastedHtml=function(t){var e;return t.clipboardData&&(wysihtml5.lang.array(t.clipboardData.types).contains("text/html")?e=t.clipboardData.getData("text/html"):wysihtml5.lang.array(t.clipboardData.types).contains("text/plain")&&(e=wysihtml5.lang.string(t.clipboardData.getData("text/plain")).escapeHTML(!0,!0))),e},wysihtml5.dom.getPastedHtmlWithDiv=function(t,e){var n=t.selection.getBookmark(),i=t.element.ownerDocument,r=i.createElement("DIV");i.body.appendChild(r),r.style.width="1px",r.style.height="1px",r.style.overflow="hidden",r.setAttribute("contenteditable","true"),r.focus(),setTimeout(function(){t.selection.setBookmark(n),e(r.innerHTML),r.parentNode.removeChild(r)},0)},wysihtml5.quirks.cleanPastedHTML=function(){var t=function(t){var e=wysihtml5.lang.string(t).trim(),n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");return RegExp("^((?!^"+n+"$).)*$","i")},e=function(e,n){var i,r,o=wysihtml5.lang.object(e).clone(!0);for(i in o.tags)if(o.tags.hasOwnProperty(i)&&o.tags[i].keep_styles)for(r in o.tags[i].keep_styles)o.tags[i].keep_styles.hasOwnProperty(r)&&n[r]&&(o.tags[i].keep_styles[r]=t(n[r]));return o},n=function(t,e){var n,i,r;if(!t)return null;for(i=0,r=t.length;r>i;i++)if(t[i].condition||(n=t[i].set),t[i].condition&&t[i].condition.test(e))return t[i].set;return n};return function(t,i){var r={color:wysihtml5.dom.getStyle("color").from(i.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(i.referenceNode)},o=e(n(i.rules,t)||{},r);return wysihtml5.dom.parse(t,{rules:o,cleanUp:!0,context:i.referenceNode.ownerDocument,uneditableClass:i.uneditableClass,clearInternals:!0,unjoinNbsps:!0})}}(),wysihtml5.quirks.ensureProperClearing=function(){var t=function(){var t=this;setTimeout(function(){var e=t.innerHTML.toLowerCase();("<p>&nbsp;</p>"==e||"<p>&nbsp;</p><p>&nbsp;</p>"==e)&&(t.innerHTML="")},0)};return function(e){wysihtml5.dom.observe(e.element,["cut","keydown"],t)}}(),function(t){t.quirks.getCorrectInnerHTML=function(e){var n,i,r,o,s,a=e.innerHTML;if(-1===a.indexOf("%7E"))return a;for(n=e.querySelectorAll("[href*='~'], [src*='~']"),s=0,o=n.length;o>s;s++)i=n[s].href||n[s].src,r=t.lang.string(i).replace("~").by("%7E"),a=t.lang.string(a).replace(r).by(i);return a}}(wysihtml5),function(t){var e="wysihtml5-quirks-redraw";t.quirks.redraw=function(n){t.dom.addClass(n,e),t.dom.removeClass(n,e);try{var i=n.ownerDocument;i.execCommand("italic",!1,null),i.execCommand("italic",!1,null)}catch(t){}}}(wysihtml5),wysihtml5.quirks.tableCellsSelection=function(t,e){function n(n){h.start=n,h.end=n,h.cells=[n],h.table=c.getParentElement(h.start,{nodeName:["TABLE"]}),h.table&&(i(),c.addClass(n,u),d=c.observe(t,"mousemove",o),f=c.observe(t,"mouseup",s),e.fire("tableselectstart").fire("tableselectstart:composer"))}function i(){var e,n;if(t&&(e=t.querySelectorAll("."+u),e.length>0))for(n=0;n<e.length;n++)c.removeClass(e[n],u)}function r(t){for(var e=0;e<t.length;e++)c.addClass(t[e],u)}function o(t){var n,o=null,s=c.getParentElement(t.target,{nodeName:["TD","TH"]});s&&h.table&&h.start&&(o=c.getParentElement(s,{nodeName:["TABLE"]}))&&o===h.table&&(i(),n=h.end,h.end=s,h.cells=c.table.getCellsBetween(h.start,s),h.cells.length>1&&e.composer.selection.deselect(),r(h.cells),h.end!==n&&e.fire("tableselectchange").fire("tableselectchange:composer"))}function s(){d.stop(),f.stop(),e.fire("tableselect").fire("tableselect:composer"),setTimeout(function(){a()},0)}function a(){var n=c.observe(t.ownerDocument,"click",function(t){n.stop(),c.getParentElement(t.target,{nodeName:["TABLE"]})!=h.table&&(i(),h.table=null,h.start=null,h.end=null,e.fire("tableunselect").fire("tableunselect:composer"))})}function l(t,n){h.start=t,h.end=n,h.table=c.getParentElement(h.start,{nodeName:["TABLE"]}),selectedCells=c.table.getCellsBetween(h.start,h.end),r(selectedCells),a(),e.fire("tableselect").fire("tableselect:composer")}var c=wysihtml5.dom,h={table:null,start:null,end:null,cells:null,select:l},u="wysiwyg-tmp-selected-cell",d=null,f=null;return function(){return c.observe(t,"mousedown",function(t){var e=wysihtml5.dom.getParentElement(t.target,{nodeName:["TD","TH"]});e&&n(e)}),h}()},function(t){var e=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,n=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,i=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,o=function(t){return RegExp("(^|\\s|;)"+t+"\\s*:\\s*[^;$]+","gi")};t.quirks.styleParser={parseColor:function(s,a){var l,c,h,u=o(a),d=s.match(u),f=10;if(d){for(h=d.length;h--;)d[h]=t.lang.string(d[h].split(":")[1]).trim();if(l=d[d.length-1],e.test(l))c=l.match(e);else if(n.test(l))c=l.match(n);else if(i.test(l))c=l.match(i),f=16;else if(r.test(l))return c=l.match(r),c.shift(),c.push(1),t.lang.array(c).map(function(t,e){return 3>e?16*parseInt(t,16)+parseInt(t,16):parseFloat(t)});if(c)return c.shift(),c[3]||c.push(1),t.lang.array(c).map(function(t,e){return 3>e?parseInt(t,f):parseFloat(t)})}return!1},unparseColor:function(t,e){if(e){if("hex"==e)return t[0].toString(16).toUpperCase()+t[1].toString(16).toUpperCase()+t[2].toString(16).toUpperCase();if("hash"==e)return"#"+t[0].toString(16).toUpperCase()+t[1].toString(16).toUpperCase()+t[2].toString(16).toUpperCase();if("rgb"==e)return"rgb("+t[0]+","+t[1]+","+t[2]+")";if("rgba"==e)return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")";if("csv"==e)return t[0]+","+t[1]+","+t[2]+","+t[3]}return t[3]&&1!==t[3]?"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")":"rgb("+t[0]+","+t[1]+","+t[2]+")"},parseFontSize:function(e){var n=e.match(o("font-size"));return!!n&&t.lang.string(n[n.length-1].split(":")[1]).trim()}}}(wysihtml5),function(t){function e(t){var e=0;if(t.parentNode)do{e+=t.offsetTop||0,t=t.offsetParent}while(t);return e}function n(t,e){for(var n=0;e!==t;)if(n++,!(e=e.parentNode))throw Error("not a descendant of ancestor!");return n}function i(t){if(!t.canSurroundContents())for(var e=t.commonAncestorContainer,i=n(e,t.startContainer),r=n(e,t.endContainer);!t.canSurroundContents();)i>r?(t.setStartBefore(t.startContainer),i=n(e,t.startContainer)):(t.setEndAfter(t.endContainer),r=n(e,t.endContainer))}var r=t.dom;t.Selection=Base.extend({constructor:function(t,e,n){window.rangy.init(),this.editor=t,this.composer=t.composer,this.doc=this.composer.doc,this.contain=e,this.unselectableClass=n||!1},getBookmark:function(){var t=this.getRange();return t&&i(t),t&&t.cloneRange()},setBookmark:function(t){t&&this.setSelection(t)},setBefore:function(t){var e=rangy.createRange(this.doc);return e.setStartBefore(t),e.setEndBefore(t),this.setSelection(e)},setAfter:function(t){var e=rangy.createRange(this.doc);return e.setStartAfter(t),e.setEndAfter(t),this.setSelection(e)},selectNode:function(e,n){var i=rangy.createRange(this.doc),o=e.nodeType===t.ELEMENT_NODE,s="canHaveHTML"in e?e.canHaveHTML:"IMG"!==e.nodeName,a=o?e.innerHTML:e.data,l=""===a||a===t.INVISIBLE_SPACE,c=r.getStyle("display").from(e),h="block"===c||"list-item"===c;if(l&&o&&s&&!n)try{e.innerHTML=t.INVISIBLE_SPACE}catch(t){}s?i.selectNodeContents(e):i.selectNode(e),s&&l&&o?i.collapse(h):s&&l&&(i.setStartAfter(e),i.setEndAfter(e)),this.setSelection(i)},getSelectedNode:function(t){var e,n;return t&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange())&&n.length?n.item(0):(e=this.getSelection(this.doc),e.focusNode===e.anchorNode?e.focusNode:(n=this.getRange(this.doc),n?n.commonAncestorContainer:this.doc.body))},fixSelBorders:function(){var t=this.getRange();i(t),this.setSelection(t)},getSelectedOwnNodes:function(){var t,e,n=this.getOwnRanges(),i=[];for(t=0,e=n.length;e>t;t++)i.push(n[t].commonAncestorContainer||this.doc.body);return i},findNodesInSelection:function(e){var n,i,r,o=this.getOwnRanges(),s=[];for(i=0,r=o.length;r>i;i++)n=o[i].getNodes([1],function(n){return t.lang.array(e).contains(n.nodeName)}),s=s.concat(n);return s},containsUneditable:function(){var t,e,n=this.getOwnUneditables(),i=this.getSelection();for(t=0,e=n.length;e>t;t++)if(i.containsNode(n[t]))return!0;return!1},deleteContents:function(){var t,e=this.getOwnRanges();for(t=e.length;t--;)e[t].deleteContents();this.setSelection(e[0])},getPreviousNode:function(e,n){var i,r,o;return e||(i=this.getSelection(),e=i.anchorNode),e!==this.contain&&((r=e.previousSibling)!==this.contain&&(r&&3!==r.nodeType&&1!==r.nodeType?r=this.getPreviousNode(r,n):r&&3===r.nodeType&&/^\s*$/.test(r.textContent)?r=this.getPreviousNode(r,n):n&&r&&1===r.nodeType&&!t.lang.array(["BR","HR","IMG"]).contains(r.nodeName)&&/^[\s]*$/.test(r.innerHTML)?r=this.getPreviousNode(r,n):r||e===this.contain||(o=e.parentNode)!==this.contain&&(r=this.getPreviousNode(o,n)),r!==this.contain&&r))},getSelectionParentsByTag:function(){var e,n,i,r=this.getSelectedOwnNodes(),o=[];for(n=0,i=r.length;i>n;n++)(e=r[n].nodeName&&"LI"===r[n].nodeName?r[n]:t.dom.getParentElement(r[n],{nodeName:["LI"]},!1,this.contain))&&o.push(e);return o.length?o:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var t=this.getRange(),e=t.startContainer,n=t.startOffset,i=rangy.createRange(this.doc);return i.selectNodeContents(e),i.setStart(e,n),i}},caretIsLastInSelection:function(){return/^\s*$/.test((rangy.createRange(this.doc),this.getSelection(),this.getRangeToNodeEnd().cloneContents()).textContent)},caretIsFirstInSelection:function(){var e=rangy.createRange(this.doc),n=this.getSelection(),i=this.getRange(),r=i.startContainer;return r.nodeType===t.TEXT_NODE?this.isCollapsed()&&r.nodeType===t.TEXT_NODE&&/^\s*$/.test(r.data.substr(0,i.startOffset)):(e.selectNodeContents(this.getRange().commonAncestorContainer),e.collapse(!0),this.isCollapsed()&&(e.startContainer===n.anchorNode||e.endContainer===n.anchorNode)&&e.startOffset===n.anchorOffset)},caretIsInTheBeginnig:function(e){var n=this.getSelection(),i=n.anchorNode,r=n.anchorOffset;return e?0===r&&(i.nodeName&&i.nodeName===e.toUpperCase()||t.dom.getParentElement(i.parentNode,{nodeName:e},1)):0===r&&!this.getPreviousNode(i,!0)},caretIsBeforeUneditable:function(){var t,e,n,i,r=this.getSelection(),o=r.anchorNode;if(0===r.anchorOffset&&(t=this.getPreviousNode(o,!0)))for(e=this.getOwnUneditables(),n=0,i=e.length;i>n;n++)if(t===e[n])return e[n];return!1},executeAndRestoreRangy:function(t){var e=this.doc.defaultView||this.doc.parentWindow,n=rangy.saveSelection(e);if(n)try{t()}catch(t){setTimeout(function(){throw t},0)}else t();rangy.restoreSelection(n)},executeAndRestore:function(e,n){var i,o,s,a,l,c,h,u,d,f=this.doc.body,p=n&&f.scrollTop,m=n&&f.scrollLeft,g="_wysihtml5-temp-placeholder",y='<span class="'+g+'">'+t.INVISIBLE_SPACE+"</span>",v=this.getRange(!0);if(!v)return void e(f,f);v.collapsed||(h=v.cloneRange(),c=h.createContextualFragment(y),h.collapse(!1),h.insertNode(c),h.detach()),l=v.createContextualFragment(y),v.insertNode(l),c&&(i=this.contain.querySelectorAll("."+g),v.setStartBefore(i[0]),v.setEndAfter(i[i.length-1])),this.setSelection(v);try{e(v.startContainer,v.endContainer)}catch(t){setTimeout(function(){throw t},0)}if((i=this.contain.querySelectorAll("."+g))&&i.length)for(u=rangy.createRange(this.doc),s=i[0].nextSibling,i.length>1&&(a=i[i.length-1].previousSibling),a&&s?(u.setStartBefore(s),u.setEndAfter(a)):(o=this.doc.createTextNode(t.INVISIBLE_SPACE),r.insert(o).after(i[0]),u.setStartBefore(o),u.setEndAfter(o)),this.setSelection(u),d=i.length;d--;)i[d].parentNode.removeChild(i[d]);else this.contain.focus();n&&(f.scrollTop=p,f.scrollLeft=m);try{i.parentNode.removeChild(i)}catch(t){}},set:function(t,e){var n=rangy.createRange(this.doc);n.setStart(t,e||0),this.setSelection(n)},insertHTML:function(t){var e,n=(rangy.createRange(this.doc),this.doc.createElement("DIV")),i=this.doc.createDocumentFragment();for(n.innerHTML=t,e=n.lastChild;n.firstChild;)i.appendChild(n.firstChild);this.insertNode(i),e&&this.setAfter(e)},insertNode:function(t){var e=this.getRange();e&&e.insertNode(t)},surround:function(t){var e,n,i=this.getOwnRanges(),r=[];if(0==i.length)return r;for(n=i.length;n--;){e=this.doc.createElement(t.nodeName),r.push(e),t.className&&(e.className=t.className),t.cssStyle&&e.setAttribute("style",t.cssStyle);try{i[n].surroundContents(e),this.selectNode(e)}catch(t){e.appendChild(i[n].extractContents()),i[n].insertNode(e)}}return r},deblockAndSurround:function(e){var n,i,r,o=this.doc.createElement("div"),s=rangy.createRange(this.doc);if(o.className=e.className,this.composer.commands.exec("formatBlock",e.nodeName,e.className),n=this.contain.querySelectorAll("."+e.className),n[0])for(n[0].parentNode.insertBefore(o,n[0]),s.setStartBefore(n[0]),s.setEndAfter(n[n.length-1]),i=s.extractContents();i.firstChild;)if(r=i.firstChild,1==r.nodeType&&t.dom.hasClass(r,e.className)){for(;r.firstChild;)o.appendChild(r.firstChild);"BR"!==r.nodeName&&o.appendChild(this.doc.createElement("br")),i.removeChild(r)}else o.appendChild(r);else o=null;return o},scrollIntoView:function(){var n,i=this.doc,r=i.documentElement.scrollHeight>i.documentElement.offsetHeight,o=i._wysihtml5ScrollIntoViewElement=i._wysihtml5ScrollIntoViewElement||function(){var e=i.createElement("span");return e.innerHTML=t.INVISIBLE_SPACE,e}();r&&(this.insertNode(o),n=e(o),o.parentNode.removeChild(o),n>=i.body.scrollTop+i.documentElement.offsetHeight-5&&(i.body.scrollTop=n))},selectLine:function(){t.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var t=this.doc.defaultView,e=t.getSelection();e.modify("move","left","lineboundary"),e.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var t,e,n,i,r,o=this.doc.selection.createRange(),s=o.boundingTop,a=this.doc.body.scrollWidth;if(o.moveToPoint){for(0===s&&(n=this.doc.createElement("span"),this.insertNode(n),s=n.offsetTop,n.parentNode.removeChild(n)),s+=1,i=-10;a>i;i+=2)try{o.moveToPoint(i,s);break}catch(t){}for(t=s,e=this.doc.selection.createRange(),r=a;r>=0;r--)try{e.moveToPoint(r,t);break}catch(t){}o.setEndPoint("EndToEnd",e),o.select()}},getText:function(){var t=this.getSelection();return t?""+t:""},getNodes:function(t,e){var n=this.getRange();return n?n.getNodes([t],e):[]},fixRangeOverflow:function(t){var e,n;this.contain&&this.contain.firstChild&&t&&(e=t.compareNode(this.contain),2!==e?(1===e&&t.setStartBefore(this.contain.firstChild),0===e&&t.setEndAfter(this.contain.lastChild),3===e&&(t.setStartBefore(this.contain.firstChild),t.setEndAfter(this.contain.lastChild))):this._detectInlineRangeProblems(t)&&(n=t.endContainer.previousElementSibling)&&t.setEnd(n,this._endOffsetForNode(n)))},_endOffsetForNode:function(t){var e=document.createRange();return e.selectNodeContents(t),e.endOffset},_detectInlineRangeProblems:function(t){var e=r.compareDocumentPosition(t.startContainer,t.endContainer);return 0==t.endOffset&&4&e},getRange:function(t){var e=this.getSelection(),n=e&&e.rangeCount&&e.getRangeAt(0);return!0!==t&&this.fixRangeOverflow(n),n},getOwnUneditables:function(){var e=r.query(this.contain,"."+this.unselectableClass),n=r.query(e,"."+this.unselectableClass);return t.lang.array(e).without(n)},getOwnRanges:function(){var t,e,n,i,r,o,s,a=[],l=this.getRange();if(l&&a.push(l),this.unselectableClass&&this.contain&&l&&(e=this.getOwnUneditables(),e.length>0))for(i=0,r=e.length;r>i;i++)for(t=[],o=0,s=a.length;s>o;o++){if(a[o])switch(a[o].compareNode(e[i])){case 2:break;case 3:n=a[o].cloneRange(),n.setEndBefore(e[i]),t.push(n),n=a[o].cloneRange(),n.setStartAfter(e[i]),t.push(n);break;default:t.push(a[o])}a=t}return a},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(t){var e=this.doc.defaultView||this.doc.parentWindow;return rangy.getSelection(e).setSingleRange(t)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},isEndToEndInNode:function(e){var n=this.getRange(),i=n.commonAncestorContainer,r=n.startContainer,o=n.endContainer;if(i.nodeType===t.TEXT_NODE&&(i=i.parentNode),r.nodeType===t.TEXT_NODE&&!/^\s*$/.test(r.data.substr(n.startOffset)))return!1;if(o.nodeType===t.TEXT_NODE&&!/^\s*$/.test(o.data.substr(n.endOffset)))return!1;for(;r&&r!==i;){if(r.nodeType!==t.TEXT_NODE&&!t.dom.contains(i,r))return!1;if(t.dom.domNode(r).prev({ignoreBlankTexts:!0}))return!1;r=r.parentNode}for(;o&&o!==i;){if(o.nodeType!==t.TEXT_NODE&&!t.dom.contains(i,o))return!1;if(t.dom.domNode(o).next({ignoreBlankTexts:!0}))return!1;o=o.parentNode}return!!t.lang.array(e).contains(i.nodeName)&&i},deselect:function(){var t=this.getSelection();t&&t.removeAllRanges()}})}(wysihtml5),function(t,e){function n(t,e,n){if(!t.className)return!1;var i=t.className.match(n)||[];return i[i.length-1]===e}function i(t,e){return!(!t.getAttribute||!t.getAttribute("style"))&&(t.getAttribute("style").match(e),!!t.getAttribute("style").match(e))}function r(t,e,n){t.getAttribute("style")?(a(t,n),t.getAttribute("style")&&!/^\s*$/.test(t.getAttribute("style"))?t.setAttribute("style",e+";"+t.getAttribute("style")):t.setAttribute("style",e)):t.setAttribute("style",e)}function o(t,e,n){t.className?(s(t,n),t.className+=" "+e):t.className=e}function s(t,e){t.className&&(t.className=t.className.replace(e,""))}function a(t,e){var n,i,r=[];if(t.getAttribute("style")){for(n=t.getAttribute("style").split(";"),i=n.length;i--;)n[i].match(e)||/^\s*$/.test(n[i])||r.push(n[i]);r.length?t.setAttribute("style",r.join(";")):t.removeAttribute("style")}}function l(t,e){var n,i,r,o=[],s=e.split(";"),a=t.getAttribute("style");if(a){for(a=a.replace(/\s/gi,"").toLowerCase(),o.push(RegExp("(^|\\s|;)"+e.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi")),n=s.length;n-- >0;)/^\s*$/.test(s[n])||o.push(RegExp("(^|\\s|;)"+s[n].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(i=0,r=o.length;r>i;i++)if(a.match(o[i]))return o[i]}return!1}function c(n,i,r,o){return r?l(n,r):o?t.dom.hasClass(n,o):e.dom.arrayContains(i,n.tagName.toLowerCase())}function h(t,e,n,i){for(var r=t.length;r--;)if(!c(t[r],e,n,i))return!1;return!!t.length}function u(t,e,n){var i=l(t,e);return i?(a(t,i),"remove"):(r(t,e,n),"change")}function d(t,e){return t.className.replace(w," ")==e.className.replace(w," ")}function f(t){for(var e=t.parentNode;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}function p(t,e){if(t.attributes.length!=e.attributes.length)return!1;for(var n,i,r,o=0,s=t.attributes.length;s>o;++o)if(n=t.attributes[o],"class"!=(r=n.name)){if(i=e.attributes.getNamedItem(r),n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function m(t,n){return e.dom.isCharacterDataNode(t)?0==n?!!t.previousSibling:n!=t.length||!!t.nextSibling:n>0&&n<t.childNodes.length}function g(t,n,i,r){var o,s;if(e.dom.isCharacterDataNode(n)&&(0==i?(i=e.dom.getNodeIndex(n),n=n.parentNode):i==n.length?(i=e.dom.getNodeIndex(n)+1,n=n.parentNode):o=e.dom.splitDataNode(n,i)),!(o||r&&n===r)){for(o=n.cloneNode(!1),o.id&&o.removeAttribute("id");s=n.childNodes[i];)o.appendChild(s);e.dom.insertAfter(o,n)}return n==t?o:g(t,o.parentNode,e.dom.getNodeIndex(o),r)}function y(e){this.isElementMerge=e.nodeType==t.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?e.lastChild:e,this.textNodes=[this.firstTextNode]}function v(t,e,n,i,r,o,s){this.tagNames=t||[b],this.cssClass=e||!1!==e&&"",this.similarClassRegExp=n,this.cssStyle=r||"",this.similarStyleRegExp=o,this.normalize=i,this.applyToAnyTagName=!1,this.container=s}var b="span",w=/\s+/g;y.prototype={doMerge:function(){var t,e,n,i,r,o=[];for(i=0,r=this.textNodes.length;r>i;++i)t=this.textNodes[i],e=t.parentNode,o[i]=t.data,i&&(e.removeChild(t),e.hasChildNodes()||e.parentNode.removeChild(e));return this.firstTextNode.data=n=o.join(""),n},getLength:function(){for(var t=this.textNodes.length,e=0;t--;)e+=this.textNodes[t].length;return e},toString:function(){var t,e,n=[];for(t=0,e=this.textNodes.length;e>t;++t)n[t]="'"+this.textNodes[t].data+"'";return"[Merge("+n.join(",")+")]"}},v.prototype={getAncestorWithClass:function(i){for(var r;i;){if(r=this.cssClass?n(i,this.cssClass,this.similarClassRegExp):""===this.cssStyle,i.nodeType==t.ELEMENT_NODE&&"false"!=i.getAttribute("contenteditable")&&e.dom.arrayContains(this.tagNames,i.tagName.toLowerCase())&&r)return i;i=i.parentNode}return!1},getAncestorWithStyle:function(n){for(var r;n;){if(r=!!this.cssStyle&&i(n,this.similarStyleRegExp),n.nodeType==t.ELEMENT_NODE&&"false"!=n.getAttribute("contenteditable")&&e.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&r)return n;n=n.parentNode}return!1},getMatchingAncestor:function(t){var e=this.getAncestorWithClass(t),n=!1;return e?this.cssStyle&&(n="class"):(e=this.getAncestorWithStyle(t))&&(n="style"),{element:e,type:n}},postApply:function(t,e){var n,i,r,o,s,a,l=t[0],c=t[t.length-1],h=[],u=l,d=c,f=0,p=c.length;for(o=0,s=t.length;s>o;++o)i=t[o],r=null,i&&i.parentNode&&(r=this.getAdjacentMergeableTextNode(i.parentNode,!1)),r?(n||(n=new y(r),h.push(n)),n.textNodes.push(i),i===l&&(u=n.firstTextNode,f=u.length),i===c&&(d=n.firstTextNode,p=n.getLength())):n=null;if(c&&c.parentNode&&(a=this.getAdjacentMergeableTextNode(c.parentNode,!0))&&(n||(n=new y(c),h.push(n)),n.textNodes.push(a)),h.length){for(o=0,s=h.length;s>o;++o)h[o].doMerge();e.setStart(u,f),e.setEnd(d,p)}},getAdjacentMergeableTextNode:function(e,n){var i,r=e.nodeType==t.TEXT_NODE,o=r?e.parentNode:e,s=n?"nextSibling":"previousSibling";if(r){if((i=e[s])&&i.nodeType==t.TEXT_NODE)return i}else if((i=o[s])&&this.areElementsMergeable(e,i))return i[n?"firstChild":"lastChild"];return null},areElementsMergeable:function(t,n){return e.dom.arrayContains(this.tagNames,(t.tagName||"").toLowerCase())&&e.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&d(t,n)&&p(t,n)},createContainer:function(t){var e=t.createElement(this.tagNames[0]);return this.cssClass&&(e.className=this.cssClass),this.cssStyle&&e.setAttribute("style",this.cssStyle),e},applyToTextNode:function(t){var n,i=t.parentNode;1==i.childNodes.length&&e.dom.arrayContains(this.tagNames,i.tagName.toLowerCase())?(this.cssClass&&o(i,this.cssClass,this.similarClassRegExp),this.cssStyle&&r(i,this.cssStyle,this.similarStyleRegExp)):(n=this.createContainer(e.dom.getDocument(t)),t.parentNode.insertBefore(n,t),n.appendChild(t))},isRemovable:function(n){return e.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&""===t.lang.string(n.className).trim()&&(!n.getAttribute("style")||""===t.lang.string(n.getAttribute("style")).trim())},undoToTextNode:function(t,e,n,i){var r,o=!n,a=n||i,l=!1;e.containsNode(a)||(r=e.cloneRange(),r.selectNode(a),r.isPointInRange(e.endContainer,e.endOffset)&&m(e.endContainer,e.endOffset)&&(g(a,e.endContainer,e.endOffset,this.container),e.setEndAfter(a)),r.isPointInRange(e.startContainer,e.startOffset)&&m(e.startContainer,e.startOffset)&&(a=g(a,e.startContainer,e.startOffset,this.container))),!o&&this.similarClassRegExp&&s(a,this.similarClassRegExp),o&&this.similarStyleRegExp&&(l="change"===u(a,this.cssStyle,this.similarStyleRegExp)),this.isRemovable(a)&&!l&&f(a)},applyToRange:function(e){var n,i,r,o,s,a;for(i=e.length;i--;){if(n=e[i].getNodes([t.TEXT_NODE]),!n.length)try{return r=this.createContainer(e[i].endContainer.ownerDocument),e[i].surroundContents(r),void this.selectNode(e[i],r)}catch(t){}if(e[i].splitBoundaries(),n=e[i].getNodes([t.TEXT_NODE]),n.length){for(s=0,a=n.length;a>s;++s)o=n[s],this.getMatchingAncestor(o).element||this.applyToTextNode(o);e[i].setStart(n[0],0),o=n[n.length-1],e[i].setEnd(o,o.length),this.normalize&&this.postApply(n,e[i])}}},undoToRange:function(e){var n,i,r,o,s,a,l,c;for(o=e.length;o--;){for(n=e[o].getNodes([t.TEXT_NODE]),n.length?(e[o].splitBoundaries(),n=e[o].getNodes([t.TEXT_NODE])):(s=e[o].endContainer.ownerDocument,a=s.createTextNode(t.INVISIBLE_SPACE),e[o].insertNode(a),e[o].selectNode(a),n=[a]),l=0,c=n.length;c>l;++l)e[o].isValid()&&(i=n[l],r=this.getMatchingAncestor(i),"style"===r.type?this.undoToTextNode(i,e[o],!1,r.element):r.element&&this.undoToTextNode(i,e[o],r.element));1==c?this.selectNode(e[o],n[0]):(e[o].setStart(n[0],0),i=n[n.length-1],e[o].setEnd(i,i.length),this.normalize&&this.postApply(n,e[o]))}},selectNode:function(e,n){var i=n.nodeType===t.ELEMENT_NODE,r=!("canHaveHTML"in n)||n.canHaveHTML,o=i?n.innerHTML:n.data,s=""===o||o===t.INVISIBLE_SPACE;if(s&&i&&r)try{n.innerHTML=t.INVISIBLE_SPACE}catch(t){}e.selectNodeContents(n),s&&i?e.collapse(!1):s&&(e.setStartAfter(n),e.setEndAfter(n))},getTextSelectedByRange:function(t,e){var n,i,r=e.cloneRange();return r.selectNodeContents(t),n=r.intersection(e),i=n?""+n:"",r.detach(),i},isAppliedToRange:function(e){var n,i,r,o,s,a,l=[],c="full";for(r=e.length;r--;){if(i=e[r].getNodes([t.TEXT_NODE]),!i.length)return!!(n=this.getMatchingAncestor(e[r].startContainer).element)&&{elements:[n],coverage:c};for(o=0,s=i.length;s>o;++o)a=this.getTextSelectedByRange(i[o],e[r]),n=this.getMatchingAncestor(i[o]).element,n&&""!=a?(l.push(n),1===t.dom.getTextNodes(n,!0).length?c="full":"full"===c&&(c="inline")):n||(c="partial")}return!!l.length&&{elements:l,coverage:c}},toggleRange:function(t){var e,n=this.isAppliedToRange(t);n?"full"===n.coverage?this.undoToRange(t):"inline"===n.coverage?(e=h(n.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(t),e||this.applyToRange(t)):(h(n.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(t),this.applyToRange(t)):this.applyToRange(t)}},t.selection.HTMLApplier=v}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(t){this.editor=t,this.composer=t.composer,this.doc=this.composer.doc},support:function(t){return wysihtml5.browser.supportsCommand(this.doc,t)},exec:function(t,e){var n=wysihtml5.commands[t],i=wysihtml5.lang.array(arguments).get(),r=n&&n.exec,o=null;if(this.editor.fire("beforecommand:composer"),r)i.unshift(this.composer),o=r.apply(n,i);else try{o=this.doc.execCommand(t,!1,e)}catch(t){}return this.editor.fire("aftercommand:composer"),o},state:function(t){var e=wysihtml5.commands[t],n=wysihtml5.lang.array(arguments).get(),i=e&&e.state;if(i)return n.unshift(this.composer),i.apply(e,n);try{return this.doc.queryCommandState(t)}catch(t){return!1}},stateValue:function(t){
var e=wysihtml5.commands[t],n=wysihtml5.lang.array(arguments).get(),i=e&&e.stateValue;return!!i&&(n.unshift(this.composer),i.apply(e,n))}}),wysihtml5.commands.bold={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"b")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"b")}},function(t){function e(e,n){var s,a,l,c,h,u,d,f,p,m=e.doc,g="_wysihtml5-temp-"+ +new Date,y=/non-matching-class/g,v=0;for(t.commands.formatInline.exec(e,i,r,g,y,i,i,!0,!0),a=m.querySelectorAll(r+"."+g),s=a.length;s>v;v++){l=a[v],l.removeAttribute("class");for(p in n)"text"!==p&&l.setAttribute(p,n[p])}u=l,1===s&&(d=o.getTextContent(l),c=!!l.querySelector("*"),h=""===d||d===t.INVISIBLE_SPACE,!c&&h&&(o.setTextContent(l,n.text||l.href),f=m.createTextNode(" "),e.selection.setAfter(l),o.insert(f).after(l),u=f)),e.selection.setAfter(u)}function n(t,e,n){var i,r,o,s;for(r=e.length;r--;){for(i=e[r].attributes,o=i.length;o--;)e[r].removeAttribute(i.item(o).name);for(s in n)n.hasOwnProperty(s)&&e[r].setAttribute(s,n[s])}}var i,r="A",o=t.dom;t.commands.createLink={exec:function(t,i,r){var o=this.state(t,i);o?t.selection.executeAndRestore(function(){n(t,o,r)}):(r="object"==typeof r?r:{href:r},e(t,r))},state:function(e,n){return t.commands.formatInline.state(e,n,"A")}}}(wysihtml5),function(t){function e(t,e){for(var i,r,o,s=e.length,a=0;s>a;a++)i=e[a],r=n.getParentElement(i,{nodeName:"code"}),o=n.getTextContent(i),o.match(n.autoLink.URL_REG_EXP)&&!r?r=n.renameElement(i,"code"):n.replaceWithChildNodes(i)}var n=t.dom;t.commands.removeLink={exec:function(t,n){var i=this.state(t,n);i&&t.selection.executeAndRestore(function(){e(t,i)})},state:function(e,n){return t.commands.formatInline.state(e,n,"A")}}}(wysihtml5),function(t){var e=/wysiwyg-font-size-[0-9a-z\-]+/g;t.commands.fontSize={exec:function(n,i,r){t.commands.formatInline.execWithToggle(n,i,"span","wysiwyg-font-size-"+r,e)},state:function(n,i,r){return t.commands.formatInline.state(n,i,"span","wysiwyg-font-size-"+r,e)}}}(wysihtml5),function(t){var e=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;t.commands.fontSizeStyle={exec:function(n,i,r){r="object"==typeof r?r.size:r,/^\s*$/.test(r)||t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,"font-size:"+r,e)},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"font-size",e)},stateValue:function(e,n){var i,r=this.state(e,n);return r&&t.lang.object(r).isArray()&&(r=r[0]),!(!r||!(i=r.getAttribute("style")))&&t.quirks.styleParser.parseFontSize(i)}}}(wysihtml5),function(t){var e=/wysiwyg-color-[0-9a-z]+/g;t.commands.foreColor={exec:function(n,i,r){t.commands.formatInline.execWithToggle(n,i,"span","wysiwyg-color-"+r,e)},state:function(n,i,r){return t.commands.formatInline.state(n,i,"span","wysiwyg-color-"+r,e)}}}(wysihtml5),function(t){var e=/(\s|^)color\s*:\s*[^;\s]+;?/gi;t.commands.foreColorStyle={exec:function(n,i,r){var o,s=t.quirks.styleParser.parseColor("object"==typeof r?"color:"+r.color:"color:"+r,"color");s&&(o="color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(o+="color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,o,e))},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"color",e)},stateValue:function(e,n,i){var r,o=this.state(e,n);return o&&t.lang.object(o).isArray()&&(o=o[0]),!!(o&&(r=o.getAttribute("style"))&&r)&&(val=t.quirks.styleParser.parseColor(r,"color"),t.quirks.styleParser.unparseColor(val,i))}}}(wysihtml5),function(t){var e=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;t.commands.bgColorStyle={exec:function(n,i,r){var o,s=t.quirks.styleParser.parseColor("object"==typeof r?"background-color:"+r.color:"background-color:"+r,"background-color");s&&(o="background-color: rgb("+s[0]+","+s[1]+","+s[2]+");",1!==s[3]&&(o+="background-color: rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]+");"),t.commands.formatInline.execWithToggle(n,i,"span",!1,!1,o,e))},state:function(n,i){return t.commands.formatInline.state(n,i,"span",!1,!1,"background-color",e)},stateValue:function(e,n,i){var r,o=this.state(e,n),s=!1;return o&&t.lang.object(o).isArray()&&(o=o[0]),!(!o||!(r=o.getAttribute("style")))&&(s=t.quirks.styleParser.parseColor(r,"background-color"),t.quirks.styleParser.unparseColor(s,i))}}}(wysihtml5),function(t){function e(e,n,r){e.className?(i(e,r),e.className=t.lang.string(e.className+" "+n).trim()):e.className=n}function n(e,n,i){r(e,i),e.getAttribute("style")?e.setAttribute("style",t.lang.string(e.getAttribute("style")+" "+n).trim()):e.setAttribute("style",n)}function i(e,n){var i=n.test(e.className);return e.className=e.className.replace(n,""),""==t.lang.string(e.className).trim()&&e.removeAttribute("class"),i}function r(e,n){var i=n.test(e.getAttribute("style"));return e.setAttribute("style",(e.getAttribute("style")||"").replace(n,"")),""==t.lang.string(e.getAttribute("style")||"").trim()&&e.removeAttribute("style"),i}function o(t){var e=t.lastChild;e&&s(e)&&e.parentNode.removeChild(e)}function s(t){return"BR"===t.nodeName}function a(e,n){var i,r,s;for(e.selection.isCollapsed()&&e.selection.selectLine(),i=e.selection.surround(n),r=0,s=i.length;s>r;r++)t.dom.lineBreaks(i[r]).remove(),o(i[r])}function l(e){return!!t.lang.string(e.className).trim()}function c(e){return!!t.lang.string(e.getAttribute("style")||"").trim()}var h=t.dom,u=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];t.commands.formatBlock={exec:function(o,s,d,f,p,m,g){var y,v,b,w,x,C=(o.doc,this.state(o,s,d,f,p,m,g)),_=o.config.useLineBreaks,S=_?"DIV":"P";return d="string"==typeof d?d.toUpperCase():d,C.length?void o.selection.executeAndRestoreRangy(function(){var e,n,o;for(e=C.length;e--;){if(p&&(v=i(C[e],p)),g&&(w=r(C[e],g)),(w||v)&&null===d&&C[e].nodeName!=S)return;n=l(C[e]),o=c(C[e]),n||o||!_&&"P"!==d?h.renameElement(C[e],"P"===d?"DIV":S):(t.dom.lineBreaks(C[e]).add(),h.replaceWithChildNodes(C[e]))}}):void((null!==d&&!t.lang.array(u).contains(d)||(y=o.selection.findNodesInSelection(u).concat(o.selection.getSelectedOwnNodes()),o.selection.executeAndRestoreRangy(function(){for(var t=y.length;t--;)x=h.getParentElement(y[t],{nodeName:u}),x==o.element&&(x=null),x&&(d&&(x=h.renameElement(x,d)),f&&e(x,f,p),m&&n(x,m,g),b=!0)}),!b))&&a(o,{nodeName:d||S,className:f||null,cssStyle:m||null}))},state:function(e,n,i,r,o,s,a){var l,c,u,d=e.selection.getSelectedOwnNodes(),f=[];for(i="string"==typeof i?i.toUpperCase():i,c=0,u=d.length;u>c;c++)(l=h.getParentElement(d[c],{nodeName:i,className:r,classRegExp:o,cssStyle:s,styleRegExp:a}))&&-1==t.lang.array(f).indexOf(l)&&f.push(l);return 0!=f.length&&f}}}(wysihtml5),wysihtml5.commands.formatCode={exec:function(t,e,n){var i,r,o,s=this.state(t);s?t.selection.executeAndRestore(function(){i=s.querySelector("code"),wysihtml5.dom.replaceWithChildNodes(s),i&&wysihtml5.dom.replaceWithChildNodes(i)}):(r=t.selection.getRange(),o=r.extractContents(),s=t.doc.createElement("pre"),i=t.doc.createElement("code"),n&&(i.className=n),s.appendChild(i),i.appendChild(o),r.insertNode(s),t.selection.selectNode(s))},state:function(t){var e=t.selection.getSelectedNode();return e&&e.nodeName&&"PRE"==e.nodeName&&e.firstChild&&e.firstChild.nodeName&&"CODE"==e.firstChild.nodeName?e:wysihtml5.dom.getParentElement(e,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(e,{nodeName:"PRE"})}},function(t){function e(t){var e=i[t];return e?[t.toLowerCase(),e.toLowerCase()]:[t.toLowerCase()]}function n(n,i,o,s,a,l){var c=n;return i&&(c+=":"+i),s&&(c+=":"+s),r[c]||(r[c]=new t.selection.HTMLApplier(e(n),i,o,!0,s,a,l)),r[c]}var i={strong:"b",em:"i",b:"strong",i:"em"},r={};t.commands.formatInline={exec:function(t,e,i,r,o,s,a,l,c){var h=t.selection.createRange(),u=t.selection.getOwnRanges();return!(!u||0==u.length)&&(t.selection.getSelection().removeAllRanges(),n(i,r,o,s,a,t.element).toggleRange(u),void(l?c||t.cleanUp():(h.setStart(u[0].startContainer,u[0].startOffset),h.setEnd(u[u.length-1].endContainer,u[u.length-1].endOffset),t.selection.setSelection(h),t.selection.executeAndRestore(function(){c||t.cleanUp()},!0,!0))))},execWithToggle:function(e,n,i,r,o,s,a){var l,c=this;this.state(e,n,i,r,o,s,a)&&e.selection.isCollapsed()&&!e.selection.caretIsLastInSelection()&&!e.selection.caretIsFirstInSelection()?(l=c.state(e,n,i,r,o)[0],e.selection.executeAndRestoreRangy(function(){l.parentNode,e.selection.selectNode(l,!0),t.commands.formatInline.exec(e,n,i,r,o,s,a,!0,!0)})):this.state(e,n,i,r,o,s,a)&&!e.selection.isCollapsed()?e.selection.executeAndRestoreRangy(function(){t.commands.formatInline.exec(e,n,i,r,o,s,a,!0,!0)}):t.commands.formatInline.exec(e,n,i,r,o,s,a)},state:function(e,r,o,s,a,l,c){var h,u,d=e.doc,f=i[o]||o;return!(!t.dom.hasElementWithTagName(d,o)&&!t.dom.hasElementWithTagName(d,f))&&(!(s&&!t.dom.hasElementWithClassName(d,s))&&(!(!(h=e.selection.getOwnRanges())||0===h.length)&&(!(!(u=n(o,s,a,l,c,e.element).isAppliedToRange(h))||!u.elements)&&u.elements)))}}}(wysihtml5),function(t){t.commands.insertBlockQuote={exec:function(e,n){var i=this.state(e,n),r=e.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]);e.selection.executeAndRestore(function(){if(i)e.config.useLineBreaks&&t.dom.lineBreaks(i).add(),t.dom.unwrap(i);else if(e.selection.isCollapsed()&&e.selection.selectLine(),r){var n=r.ownerDocument.createElement("blockquote");t.dom.insert(n).after(r),n.appendChild(r)}else e.selection.surround({nodeName:"blockquote"})})},state:function(e){var n=e.selection.getSelectedNode(),i=t.dom.getParentElement(n,{nodeName:"BLOCKQUOTE"},!1,e.element);return i||!1}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(t,e,n){t.commands.support(e)?t.doc.execCommand(e,!1,n):t.selection.insertHTML(n)},state:function(){return!1}},function(t){var e="IMG";t.commands.insertImage={exec:function(n,i,r){var o,s,a,l,c;if(r="object"==typeof r?r:{src:r},o=n.doc,s=this.state(n))return n.selection.setBefore(s),l=s.parentNode,l.removeChild(s),t.dom.removeEmptyTextNodes(l),"A"!==l.nodeName||l.firstChild||(n.selection.setAfter(l),l.parentNode.removeChild(l)),void t.quirks.redraw(n.element);s=o.createElement(e);for(c in r)s.setAttribute("className"===c?"class":c,r[c]);n.selection.insertNode(s),t.browser.hasProblemsSettingCaretAfterImg()?(a=o.createTextNode(t.INVISIBLE_SPACE),n.selection.insertNode(a),n.selection.setAfter(a)):n.selection.setAfter(s)},state:function(n){var i,r,o,s=n.doc;return!!t.dom.hasElementWithTagName(s,e)&&(!!(i=n.selection.getSelectedNode())&&(i.nodeName===e?i:i.nodeType===t.ELEMENT_NODE&&(r=n.selection.getText(),!(r=t.lang.string(r).trim())&&(o=n.selection.getNodes(t.ELEMENT_NODE,function(t){return"IMG"===t.nodeName}),1===o.length&&o[0]))))}}}(wysihtml5),function(t){var e="<br>"+(t.browser.needsSpaceAfterLineBreak()?" ":"");t.commands.insertLineBreak={exec:function(n,i){n.commands.support(i)?(n.doc.execCommand(i,!1,null),t.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",e)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(t,e){wysihtml5.commands.insertList.exec(t,e,"OL")},state:function(t,e){return wysihtml5.commands.insertList.state(t,e,"OL")}},wysihtml5.commands.insertUnorderedList={exec:function(t,e){wysihtml5.commands.insertList.exec(t,e,"UL")},state:function(t,e){return wysihtml5.commands.insertList.state(t,e,"UL")}},wysihtml5.commands.insertList=function(t){var e=function(t,e){if(t&&t.nodeName){"string"==typeof e&&(e=[e]);for(var n=e.length;n--;)if(t.nodeName===e[n])return!0}return!1},n=function(n,i,r){var o,s,a={el:null,other:!1};return n&&(o=t.dom.getParentElement(n,{nodeName:"LI"}),s="UL"===i?"OL":"UL",e(n,i)?a.el=n:e(n,s)?a={el:n,other:!0}:o&&(e(o.parentNode,i)?a.el=o.parentNode:e(o.parentNode,s)&&(a={el:o.parentNode,other:!0}))),a.el&&!r.element.contains(a.el)&&(a.el=null),a},i=function(e,n,i){var r,s="UL"===n?"OL":"UL";i.selection.executeAndRestore(function(){var a,l,c=o(s,i);if(c.length)for(a=c.length;a--;)t.dom.renameElement(c[a],n.toLowerCase());else{for(r=o(["OL","UL"],i),l=r.length;l--;)t.dom.resolveList(r[l],i.config.useLineBreaks);t.dom.resolveList(e,i.config.useLineBreaks)}})},r=function(e,n,i){var r="UL"===n?"OL":"UL";i.selection.executeAndRestore(function(){var s,a=[e].concat(o(r,i));for(s=a.length;s--;)t.dom.renameElement(a[s],n.toLowerCase())})},o=function(t,n){var i,r=n.selection.getOwnRanges(),o=[];for(i=r.length;i--;)o=o.concat(r[i].getNodes([1],function(n){return e(n,t)}));return o},s=function(e,n){n.selection.executeAndRestoreRangy(function(){var i,r,o="_wysihtml5-temp-"+(new Date).getTime(),s=n.selection.deblockAndSurround({nodeName:"div",className:o}),a=/\uFEFF/g;s.innerHTML=s.innerHTML.replace(a,""),s&&(i=t.lang.array(["","<br>",t.INVISIBLE_SPACE]).contains(s.innerHTML),r=t.dom.convertToList(s,e.toLowerCase(),n.parent.config.uneditableContainerClassname),i&&n.selection.selectNode(r.querySelector("li"),!0))})};return{exec:function(t,e,o){var a=t.doc,l="OL"===o?"insertOrderedList":"insertUnorderedList",c=t.selection.getSelectedNode(),h=n(c,o,t);h.el?h.other?r(h.el,o,t):i(h.el,o,t):t.commands.support(l)?a.execCommand(l,!1,null):s(o,t)},state:function(t,e,i){var r=t.selection.getSelectedNode(),o=n(r,i,t);return!(!o.el||o.other)&&o.el}}}(wysihtml5),wysihtml5.commands.italic={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"i")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"i")}},function(t){var e="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyCenter={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyLeft={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyRight={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;t.commands.justifyFull={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,e,n)}}}(wysihtml5),function(t){var e="text-align: right;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignRightStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),function(t){var e="text-align: left;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignLeftStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),function(t){var e="text-align: center;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;t.commands.alignCenterStyle={exec:function(i){return t.commands.formatBlock.exec(i,"formatBlock",null,null,null,e,n)},state:function(i){return t.commands.formatBlock.state(i,"formatBlock",null,null,null,e,n)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(t){return t.undoManager.redo()},state:function(){return!1}},wysihtml5.commands.underline={exec:function(t,e){wysihtml5.commands.formatInline.execWithToggle(t,e,"u")},state:function(t,e){return wysihtml5.commands.formatInline.state(t,e,"u")}},wysihtml5.commands.undo={exec:function(t){return t.undoManager.undo()},state:function(){return!1}},wysihtml5.commands.createTable={exec:function(t,e,n){var i,r,o;if(n&&n.cols&&n.rows&&parseInt(n.cols,10)>0&&parseInt(n.rows,10)>0){for(o=n.tableStyle?'<table style="'+n.tableStyle+'">':"<table>",o+="<tbody>",r=0;r<n.rows;r++){for(o+="<tr>",i=0;i<n.cols;i++)o+="<td>&nbsp;</td>";o+="</tr>"}o+="</tbody></table>",t.commands.exec("insertHTML",o)}},state:function(){return!1}},wysihtml5.commands.mergeTableCells={exec:function(t,e){t.tableSelection&&t.tableSelection.start&&t.tableSelection.end&&(this.state(t,e)?wysihtml5.dom.table.unmergeCell(t.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(t.tableSelection.start,t.tableSelection.end))},state:function(t){if(t.tableSelection){var e=t.tableSelection.start,n=t.tableSelection.end;if(e&&n&&e==n&&(wysihtml5.dom.getAttribute(e,"colspan")&&parseInt(wysihtml5.dom.getAttribute(e,"colspan"),10)>1||wysihtml5.dom.getAttribute(e,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(e,"rowspan"),10)>1))return[e]}return!1}},wysihtml5.commands.addTableCells={exec:function(t,e,n){if(t.tableSelection&&t.tableSelection.start&&t.tableSelection.end){var i=wysihtml5.dom.table.orderSelectionEnds(t.tableSelection.start,t.tableSelection.end);"before"==n||"above"==n?wysihtml5.dom.table.addCells(i.start,n):("after"==n||"below"==n)&&wysihtml5.dom.table.addCells(i.end,n),setTimeout(function(){t.tableSelection.select(i.start,i.end)},0)}},state:function(){return!1}},wysihtml5.commands.deleteTableCells={exec:function(t,e,n){if(t.tableSelection&&t.tableSelection.start&&t.tableSelection.end){var i,r=wysihtml5.dom.table.orderSelectionEnds(t.tableSelection.start,t.tableSelection.end),o=wysihtml5.dom.table.indexOf(r.start),s=t.tableSelection.table;wysihtml5.dom.table.removeCells(r.start,n),setTimeout(function(){i=wysihtml5.dom.table.findCell(s,o),i||("row"==n&&(i=wysihtml5.dom.table.findCell(s,{row:o.row-1,col:o.col})),"column"==n&&(i=wysihtml5.dom.table.findCell(s,{row:o.row,col:o.col-1}))),i&&t.tableSelection.select(i,i)},0)}},state:function(){return!1}},wysihtml5.commands.indentList={exec:function(t){var e=t.selection.getSelectionParentsByTag("LI");return!!e&&this.tryToPushLiLevel(e,t.selection)},state:function(){return!1},tryToPushLiLevel:function(t,e){var n,i,r,o,s,a=!1;return e.executeAndRestoreRangy(function(){for(var e=t.length;e--;)o=t[e],n="OL"===o.parentNode.nodeName?"OL":"UL",i=o.ownerDocument.createElement(n),r=wysihtml5.dom.domNode(o).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}),s=r?r.querySelector("ul, ol"):null,r&&(s?s.appendChild(o):(i.appendChild(o),r.appendChild(i)),a=!0)}),a}},wysihtml5.commands.outdentList={exec:function(t){var e=t.selection.getSelectionParentsByTag("LI");return!!e&&this.tryToPullLiLevel(e,t)},state:function(){return!1},tryToPullLiLevel:function(t,e){var n,i,r,o,s,a=!1,l=this;return e.selection.executeAndRestoreRangy(function(){var c,h;for(c=t.length;c--;)if(o=t[c],o.parentNode&&(n=o.parentNode,"OL"===n.tagName||"UL"===n.tagName)){if(a=!0,i=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["OL","UL"]},!1,e.element),r=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["LI"]},!1,e.element),i&&r)o.nextSibling&&(s=l.getAfterList(n,o),o.appendChild(s)),i.insertBefore(o,r.nextSibling);else{for(o.nextSibling&&(s=l.getAfterList(n,o),o.appendChild(s)),h=o.childNodes.length;h--;)n.parentNode.insertBefore(o.childNodes[h],n.nextSibling);n.parentNode.insertBefore(document.createElement("br"),n.nextSibling),o.parentNode.removeChild(o)}0===n.childNodes.length&&n.parentNode.removeChild(n)}}),a},getAfterList:function(t,e){for(var n=t.nodeName,i=document.createElement(n);e.nextSibling;)i.appendChild(e.nextSibling);return i}},function(t){var e="data-wysihtml5-selection-node",n="data-wysihtml5-selection-offset",i=(t.INVISIBLE_SPACE,t.INVISIBLE_SPACE,t.dom);t.UndoManager=t.lang.Dispatcher.extend({constructor:function(t){this.editor=t,this.composer=t.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var t,e=this;this.composer.sandbox.getDocument(),i.observe(this.element,"keydown",function(t){if(!t.altKey&&(t.ctrlKey||t.metaKey)){var n=t.keyCode,i=90===n&&!t.shiftKey,r=90===n&&t.shiftKey||89===n;i?(e.undo(),t.preventDefault()):r&&(e.redo(),t.preventDefault())}}),i.observe(this.element,"keydown",function(n){var i=n.keyCode;i!==t&&(t=i,(8===i||46===i)&&e.transact())}),this.editor.on("newword:composer",function(){e.transact()}).on("beforecommand:composer",function(){e.transact()})},transact:function(){var i,r,o,s,a,l,c,h=this.historyStr[this.position-1],u=this.composer.getValue(!1,!1),d=this.element.offsetWidth>0&&this.element.offsetHeight>0;u!==h&&(l=this.historyStr.length=this.historyDom.length=this.position,l>25&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++,d&&(i=this.composer.selection.getRange(),r=i&&i.startContainer?i.startContainer:this.element,o=i&&i.startOffset?i.startOffset:0,r.nodeType===t.ELEMENT_NODE?s=r:(s=r.parentNode,a=this.getChildNodeIndex(s,r)),s.setAttribute(n,o),void 0!==a&&s.setAttribute(e,a)),c=this.element.cloneNode(!!u),this.historyDom.push(c),this.historyStr.push(u),s&&(s.removeAttribute(n),s.removeAttribute(e)))},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(t){var i,r,o,s,a,l;for(this.element.innerHTML="",i=0,r=t.childNodes,o=t.childNodes.length;o>i;i++)this.element.appendChild(r[i].cloneNode(!0));t.hasAttribute(n)?(s=t.getAttribute(n),l=t.getAttribute(e),a=this.element):(a=this.element.querySelector("["+n+"]")||this.element,s=a.getAttribute(n),l=a.getAttribute(e),a.removeAttribute(n),a.removeAttribute(e)),null!==l&&(a=this.getChildNodeByIndex(a,+l)),this.composer.selection.set(a,s)},getChildNodeIndex:function(t,e){for(var n=0,i=t.childNodes,r=i.length;r>n;n++)if(i[n]===e)return n},getChildNodeByIndex:function(t,e){return t.childNodes[e]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(t,e,n){this.parent=t,this.element=e,this.config=n,this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var t=this;this.parent.on("beforeload",function(){t.parent.on("change_view",function(e){e===t.name?(t.parent.currentView=t,t.show(),setTimeout(function(){t.focus()},0)):t.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(t){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(t){var e=t.dom,n=t.browser;t.views.Composer=t.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(t,e,n){this.base(t,e,n),this.config.noTextarea?this.editableArea=e:this.textarea=this.parent.textarea,this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(e,n){var i=this.isEmpty()?"":t.quirks.getCorrectInnerHTML(this.element);return!1!==e&&(i=this.parent.parse(i,!1!==n)),i},setValue:function(t,e){e&&(t=this.parent.parse(t));try{this.element.innerHTML=t}catch(e){this.element.innerText=t}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"",this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=e.getStyle("display").from(this.editableArea),"none"===this._displayStyle&&(this._displayStyle=null),this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(e){t.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;e&&n&&this.selection&&("BR"===n.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return e.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var t=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(t)||""===t||"<br>"===t||"<p></p>"===t||"<p><br></p>"===t||this.hasPlaceholderSet()},_initContentEditableArea:function(){var t=this;this.config.noTextarea?this.sandbox=new e.ContentEditableArea(function(){t._create()},{},this.editableArea):(this.sandbox=new e.ContentEditableArea(function(){t._create()}),this.editableArea=this.sandbox.getContentEditable(),e.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var t,n=this;this.sandbox=new e.Sandbox(function(){n._create()},{stylesheets:this.config.stylesheets}),this.editableArea=this.sandbox.getIframe(),t=this.textarea.element,e.insert(this.editableArea).after(t),this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var t=document.createElement("input");t.type="hidden",t.name="_wysihtml5_mode",t.value=1,e.insert(t).after(this.textarea.element)}},_create:function(){var i,r,o=this;this.doc=this.sandbox.getDocument(),this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body,this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1)),this.selection=new t.Selection(this.parent,this.element,this.config.uneditableContainerClassname),this.commands=new t.Commands(this.parent),this.config.noTextarea||e.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),e.addClass(this.element,this.config.composerClassName),this.config.style&&!this.config.contentEditableMode&&this.style(),this.observe(),i=this.config.name,i&&(e.addClass(this.element,i),this.config.contentEditableMode||e.addClass(this.editableArea,i)),this.enable(),!this.config.noTextarea&&this.textarea.element.disabled&&this.disable(),r="string"==typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"),r&&e.simulatePlaceholder(this.parent,this,r),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||n.isIos()||setTimeout(function(){o.focus(!0)},100),n.clearsContentEditableCorrectly()||t.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.config.noTextarea||this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var i,r,o,s=this,a=n.canDisableAutoLinking(),l=n.doesAutoLinkingInContentEditable();a&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink&&((!l||l&&a)&&(this.parent.on("newword:composer",function(){e.getTextContent(s.element).match(e.autoLink.URL_REG_EXP)&&s.selection.executeAndRestore(function(n,i){var r,o=s.element.querySelectorAll("."+s.config.uneditableContainerClassname),a=!1;for(r=o.length;r--;)t.dom.contains(o[r],i)&&(a=!0);a||e.autoLink(i.parentNode,[s.config.uneditableContainerClassname])})}),e.observe(this.element,"blur",function(){e.autoLink(s.element,[s.config.uneditableContainerClassname])})),i=this.sandbox.getDocument().getElementsByTagName("a"),r=e.autoLink.URL_REG_EXP,o=function(n){var i=t.lang.string(e.getTextContent(n)).trim();return"www."===i.substr(0,4)&&(i="http://"+i),i},e.observe(this.element,"keydown",function(t){if(i.length){var n,a=s.selection.getSelectedNode(t.target.ownerDocument),l=e.getParentElement(a,{nodeName:"A"},4);l&&(n=o(l),setTimeout(function(){var t=o(l);t!==n&&t.match(r)&&l.setAttribute("href",t)},0))}}))},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),n.supportsEvent("resizeend")){var i=["width","height"],r=i.length,o=this.element;e.observe(o,"resizeend",function(e){var n,s=e.target||e.srcElement,a=s.style,l=0;if("IMG"===s.nodeName){for(;r>l;l++)n=i[l],a[n]&&(s.setAttribute(n,parseInt(a[n],10)),a[n]="");t.quirks.redraw(o)}})}},_initUndoManager:function(){this.undoManager=new t.UndoManager(this.parent)},_initLineBreaking:function(){function i(t){var n=e.getParentElement(t,{nodeName:["P","DIV"]},2);n&&e.contains(r.element,n)&&r.selection.executeAndRestore(function(){r.config.useLineBreaks?e.replaceWithChildNodes(n):"P"!==n.nodeName&&e.renameElement(n,"p")})}var r=this,o=["LI","P","H1","H2","H3","H4","H5","H6"],s=["UL","OL","MENU"];this.config.useLineBreaks||e.observe(this.element,["focus","keydown"],function(){if(r.isEmpty()){var t=r.doc.createElement("P");r.element.innerHTML="",r.element.appendChild(t),n.displaysCaretInEmptyContentEditableCorrectly()?r.selection.selectNode(t,!0):(t.innerHTML="<br>",r.selection.setBefore(t.firstChild))}}),e.observe(this.element,"keydown",function(n){var a,l=n.keyCode;if(!n.shiftKey&&(l===t.ENTER_KEY||l===t.BACKSPACE_KEY))return a=e.getParentElement(r.selection.getSelectedNode(),{nodeName:o},4),a?void setTimeout(function(){var n=r.selection.getSelectedNode();if("LI"===a.nodeName){if(!n)return;e.getParentElement(n,{nodeName:s},2)||i(n)}l===t.ENTER_KEY&&a.nodeName.match(/^H[1-6]$/)&&i(n)},0):void(r.config.useLineBreaks&&l===t.ENTER_KEY&&!t.browser.insertsLineBreaksOnReturn()&&(n.preventDefault(),r.commands.exec("insertLineBreak")))})}})}(wysihtml5),function(t){var e=t.dom,n=document,i=window,r=n.createElement("div"),o=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],s=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],a=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",t.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(t){if(t.setActive)try{t.setActive()}catch(t){}else{var r=t.style,o=n.documentElement.scrollTop||n.body.scrollTop,s=n.documentElement.scrollLeft||n.body.scrollLeft,a={position:r.position,top:r.top,left:r.left,WebkitUserSelect:r.WebkitUserSelect};e.setStyles({
position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(t),t.focus(),e.setStyles(a).on(t),i.scrollTo&&i.scrollTo(s,o)}};t.views.Composer.prototype.style=function(){var i,c,h=this,u=n.querySelector(":focus"),d=this.textarea.element,f=d.hasAttribute("placeholder"),p=f&&d.getAttribute("placeholder"),m=d.style.display,g=d.disabled;return this.focusStylesHost=r.cloneNode(!1),this.blurStylesHost=r.cloneNode(!1),this.disabledStylesHost=r.cloneNode(!1),f&&d.removeAttribute("placeholder"),d===u&&d.blur(),d.disabled=!1,d.style.display=i="none",(d.getAttribute("rows")&&"auto"===e.getStyle("height").from(d)||d.getAttribute("cols")&&"auto"===e.getStyle("width").from(d))&&(d.style.display=i=m),e.copyStyles(s).from(d).to(this.editableArea).andTo(this.blurStylesHost),e.copyStyles(o).from(d).to(this.element).andTo(this.blurStylesHost),e.insertCSS(a).into(this.element.ownerDocument),d.disabled=!0,e.copyStyles(s).from(d).to(this.disabledStylesHost),e.copyStyles(o).from(d).to(this.disabledStylesHost),d.disabled=g,d.style.display=m,l(d),d.style.display=i,e.copyStyles(s).from(d).to(this.focusStylesHost),e.copyStyles(o).from(d).to(this.focusStylesHost),d.style.display=m,e.copyStyles(["display"]).from(d).to(this.editableArea),c=t.lang.array(s).without(["display"]),u?u.focus():d.blur(),f&&d.setAttribute("placeholder",p),this.parent.on("focus:composer",function(){e.copyStyles(c).from(h.focusStylesHost).to(h.editableArea),e.copyStyles(o).from(h.focusStylesHost).to(h.element)}),this.parent.on("blur:composer",function(){e.copyStyles(c).from(h.blurStylesHost).to(h.editableArea),e.copyStyles(o).from(h.blurStylesHost).to(h.element)}),this.parent.observe("disable:composer",function(){e.copyStyles(c).from(h.disabledStylesHost).to(h.editableArea),e.copyStyles(o).from(h.disabledStylesHost).to(h.element)}),this.parent.observe("enable:composer",function(){e.copyStyles(c).from(h.blurStylesHost).to(h.editableArea),e.copyStyles(o).from(h.blurStylesHost).to(h.element)}),this}}(wysihtml5),function(t){var e=t.dom,n=t.browser,i={66:"bold",73:"italic",85:"underline"},r=function(t,e,n){var i,r=t.getPreviousNode(e,!0),o=t.getSelectedNode();if(1!==o.nodeType&&o.parentNode!==n&&(o=o.parentNode),r)if(1==o.nodeType){if(i=o.firstChild,1==r.nodeType)for(;o.firstChild;)r.appendChild(o.firstChild);else for(;o.firstChild;)e.parentNode.insertBefore(o.firstChild,e);o.parentNode&&o.parentNode.removeChild(o),t.setBefore(i)}else 1==r.nodeType?r.appendChild(o):e.parentNode.insertBefore(o,e),t.setBefore(o)},o=function(t,e,n,i){var o,s,a;e.isCollapsed()?e.caretIsInTheBeginnig("LI")?(t.preventDefault(),i.commands.exec("outdentList")):e.caretIsInTheBeginnig()?t.preventDefault():(e.caretIsFirstInSelection()&&e.getPreviousNode()&&e.getPreviousNode().nodeName&&/^H\d$/gi.test(e.getPreviousNode().nodeName)&&(o=e.getPreviousNode(),t.preventDefault(),/^\s*$/.test(o.textContent||o.innerText)?o.parentNode.removeChild(o):(s=o.ownerDocument.createRange(),s.selectNodeContents(o),s.collapse(!1),e.setSelection(s))),(a=e.caretIsBeforeUneditable())&&(t.preventDefault(),r(e,a,n))):e.containsUneditable()&&(t.preventDefault(),e.deleteContents())},s=function(t){if(t.selection.isCollapsed()){if(t.selection.caretIsInTheBeginnig("LI")&&t.commands.exec("indentList"))return}else t.selection.deleteContents();t.commands.exec("insertHTML","&emsp;")};t.views.Composer.prototype.observe=function(){var r,a,l=this,c=this.getValue(!1,!1),h=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),u=this.element,d=n.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?u:this.sandbox.getWindow(),f=["drop","paste","beforepaste"],p=["drop","paste","mouseup","focus","keyup"];e.observe(h,"DOMNodeRemoved",function(){clearInterval(r),l.parent.fire("destroy:composer")}),n.supportsMutationEvents()||(r=setInterval(function(){e.contains(document.documentElement,h)||(clearInterval(r),l.parent.fire("destroy:composer"))},250)),e.observe(d,p,function(){setTimeout(function(){l.parent.fire("interaction").fire("interaction:composer")},0)}),this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&t.browser.supportsCommand(this.doc,"enableObjectResizing")&&t.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=e.observe(h,["focus","mouseup","mouseover"],function(){l.doc.execCommand("enableObjectResizing",!1,"false"),l.doc.execCommand("enableInlineTableEditing",!1,"false"),l.tableClickHandle.stop()}):setTimeout(function(){l.doc.execCommand("enableObjectResizing",!1,"false"),l.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=t.quirks.tableCellsSelection(u,l.parent)),e.observe(d,"focus",function(t){l.parent.fire("focus",t).fire("focus:composer",t),setTimeout(function(){c=l.getValue(!1,!1)},0)}),e.observe(d,"blur",function(t){if(c!==l.getValue(!1,!1)){var e=t;"function"==typeof Object.create&&(e=Object.create(t,{type:{value:"change"}})),l.parent.fire("change",e).fire("change:composer",e)}l.parent.fire("blur",t).fire("blur:composer",t)}),e.observe(u,"dragenter",function(){l.parent.fire("unset_placeholder")}),e.observe(u,f,function(t){l.parent.fire(t.type,t).fire(t.type+":composer",t)}),this.config.copyedFromMarking&&e.observe(u,"copy",function(t){t.clipboardData&&(t.clipboardData.setData("text/html",l.config.copyedFromMarking+l.selection.getHtml()),t.preventDefault()),l.parent.fire(t.type,t).fire(t.type+":composer",t)}),e.observe(u,"keyup",function(e){var n=e.keyCode;(n===t.SPACE_KEY||n===t.ENTER_KEY)&&l.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){l.parent.fire("newword:composer")},0)}),n.canSelectImagesInContentEditable()||e.observe(u,"mousedown",function(e){var n=e.target,i=u.querySelectorAll("img"),r=u.querySelectorAll("."+l.config.uneditableContainerClassname+" img"),o=t.lang.array(i).without(r);"IMG"===n.nodeName&&t.lang.array(o).contains(n)&&l.selection.selectNode(n)}),n.canSelectImagesInContentEditable()||e.observe(u,"drop",function(){setTimeout(function(){l.selection.getSelection().removeAllRanges()},0)}),n.hasHistoryIssue()&&n.supportsSelectionModify()&&e.observe(u,"keydown",function(t){if(t.metaKey||t.ctrlKey){var e=t.keyCode,n=u.ownerDocument.defaultView,i=n.getSelection();(37===e||39===e)&&(37===e&&(i.modify("extend","left","lineboundary"),t.shiftKey||i.collapseToStart()),39===e&&(i.modify("extend","right","lineboundary"),t.shiftKey||i.collapseToEnd()),t.preventDefault())}}),e.observe(u,"keydown",function(t){var e=t.keyCode,n=i[e];(t.ctrlKey||t.metaKey)&&!t.altKey&&n&&(l.commands.exec(n),t.preventDefault()),8===e?o(t,l.selection,u,l):l.config.handleTabKey&&9===e&&(t.preventDefault(),s(l))}),e.observe(u,"keydown",function(e){var n,i=l.selection.getSelectedNode(!0),r=e.keyCode;!i||"IMG"!==i.nodeName||r!==t.BACKSPACE_KEY&&r!==t.DELETE_KEY||(n=i.parentNode,n.removeChild(i),"A"!==n.nodeName||n.firstChild||n.parentNode.removeChild(n),setTimeout(function(){t.quirks.redraw(u)},0),e.preventDefault())}),!this.config.contentEditableMode&&n.hasIframeFocusIssue()&&(e.observe(h,"focus",function(){setTimeout(function(){l.doc.querySelector(":focus")!==l.element&&l.focus()},0)}),e.observe(this.element,"blur",function(){setTimeout(function(){l.selection.getSelection().removeAllRanges()},0)})),a={IMG:"Image: ",A:"Link: "},e.observe(u,"mouseover",function(t){var e,n=t.target,i=n.nodeName;("A"===i||"IMG"===i)&&(n.hasAttribute("title")||(e=a[i]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",e)))})}}(wysihtml5),function(t){t.views.Synchronizer=Base.extend({constructor:function(t,e,n){this.editor=t,this.textarea=e,this.composer=n,this._observe()},fromComposerToTextarea:function(e){this.textarea.setValue(t.lang.string(this.composer.getValue(!1,!1)).trim(),e)},fromTextareaToComposer:function(t){var e=this.textarea.getValue(!1,!1);e?this.composer.setValue(e,t):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(t){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(t):this.fromComposerToTextarea(t)},_observe:function(){var e,n=this,i=this.textarea.element.form,r=function(){e=setInterval(function(){n.fromComposerToTextarea()},400)},o=function(){clearInterval(e),e=null};r(),i&&(t.dom.observe(i,"submit",function(){n.sync(!0)}),t.dom.observe(i,"reset",function(){setTimeout(function(){n.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(t){"composer"!==t||e?"textarea"===t&&(n.fromComposerToTextarea(!0),o()):(n.fromTextareaToComposer(!0),r())}),this.editor.on("destroy:composer",o)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(t,e,n){this.base(t,e,n),this._observe()},clear:function(){this.element.value=""},getValue:function(t){var e=this.isEmpty()?"":this.element.value;return!1!==t&&(e=this.parent.parse(e)),e},setValue:function(t,e){e&&(t=this.parent.parse(t)),this.element.value=t},cleanUp:function(){var t=this.parent.parse(this.element.value);this.element.value=t},hasPlaceholderSet:function(){var t=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),e=this.element.getAttribute("placeholder")||null,n=this.element.value,i=!n;return t&&i||n===e},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var t=this.element,e=this.parent,n={focusin:"focus",focusout:"blur"},i=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];e.on("beforeload",function(){wysihtml5.dom.observe(t,i,function(t){var i=n[t.type]||t.type;e.fire(i).fire(i+":textarea")}),wysihtml5.dom.observe(t,["paste","drop"],function(){setTimeout(function(){e.fire("paste").fire("paste:textarea")},0)})})}}),function(t){var e,n={name:e,style:!0,toolbar:e,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:t.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:e,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container",copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};t.Editor=t.lang.Dispatcher.extend({constructor:function(e,i){if(this.editableElement="string"==typeof e?document.getElementById(e):e,this.config=t.lang.object({}).merge(n).merge(i).get(),this._isCompatible=t.browser.supported(),"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0),this.config.noTextarea||(this.textarea=new t.views.Textarea(this,this.editableElement,this.config),this.currentView=this.textarea),!this._isCompatible||!this.config.supportTouchDevices&&t.browser.isTouchDevice()){var r=this;return void setTimeout(function(){r.fire("beforeload").fire("load")},0)}t.dom.addClass(document.body,this.config.bodyClassName),this.composer=new t.views.Composer(this,this.editableElement,this.config),this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new t.views.Synchronizer(this,this.textarea,this.composer)),this.config.toolbar&&(this.toolbar=new t.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(t,e){return this.currentView.getValue(t,e)},setValue:function(t,e){return this.fire("unset_placeholder"),t?(this.currentView.setValue(t,e),this):this.clear()},cleanUp:function(){this.currentView.cleanUp()},focus:function(t){return this.currentView.focus(t),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(e,n){var i=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,r=this.config.parser(e,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:i,uneditableClass:this.config.uneditableContainerClassname,clearInternals:n});return"object"==typeof e&&t.quirks.redraw(e),r},_initParser:function(){var e,n=this;t.browser.supportsModenPaste()?this.on("paste:composer",function(i){i.preventDefault(),(e=t.dom.getPastedHtml(i))&&n._cleanAndPaste(e)}):this.on("beforepaste:composer",function(e){e.preventDefault(),t.dom.getPastedHtmlWithDiv(n.composer,function(t){t&&n._cleanAndPaste(t)})})},_cleanAndPaste:function(e){var n=t.quirks.cleanPastedHTML(e,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.uneditableContainerClassname});this.composer.selection.deleteContents(),this.composer.selection.insertHTML(n)}})}(wysihtml5),function(t){var e=t.dom,n="wysihtml5-command-dialog-opened",i="input, select, textarea",r="[data-wysihtml5-dialog-field]",o="data-wysihtml5-dialog-field";t.toolbar.Dialog=t.lang.Dispatcher.extend({constructor:function(t,e){this.link=t,this.container=e},_observe:function(){var r,o,s,a,l,c;if(!this._observed){for(r=this,o=function(t){var e=r._serialize();e==r.elementToChange?r.fire("edit",e):r.fire("save",e),r.hide(),t.preventDefault(),t.stopPropagation()},e.observe(r.link,"click",function(){e.hasClass(r.link,n)&&setTimeout(function(){r.hide()},0)}),e.observe(this.container,"keydown",function(e){var n=e.keyCode;n===t.ENTER_KEY&&o(e),n===t.ESCAPE_KEY&&(r.fire("cancel"),r.hide())}),e.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",o),e.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(t){r.fire("cancel"),r.hide(),t.preventDefault(),t.stopPropagation()}),s=this.container.querySelectorAll(i),a=0,l=s.length,c=function(){clearInterval(r.interval)};l>a;a++)e.observe(s[a],"change",c);this._observed=!0}},_serialize:function(){for(var t=this.elementToChange||{},e=this.container.querySelectorAll(r),n=e.length,i=0;n>i;i++)t[e[i].getAttribute(o)]=e[i].value;return t},_interpolate:function(t){for(var e,n,i,s=document.querySelector(":focus"),a=this.container.querySelectorAll(r),l=a.length,c=0;l>c;c++)(e=a[c])!==s&&(t&&"hidden"===e.type||(n=e.getAttribute(o),i=this.elementToChange&&"boolean"!=typeof this.elementToChange?this.elementToChange.getAttribute(n)||"":e.defaultValue,e.value=i))},show:function(t){if(!e.hasClass(this.link,n)){var r=this,o=this.container.querySelector(i);if(this.elementToChange=t,this._observe(),this._interpolate(),t&&(this.interval=setInterval(function(){r._interpolate(!0)},500)),e.addClass(this.link,n),this.container.style.display="",this.fire("show"),o&&!t)try{o.focus()}catch(t){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,e.removeClass(this.link,n),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(t){var e=t.dom,n={position:"relative"},i={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},r={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},o={"x-webkit-speech":"",speech:""};t.toolbar.Speech=function(s,a){var l,c,h,u=document.createElement("input");return t.browser.supportsSpeechApiOn(u)?(l=s.editor.textarea.element.getAttribute("lang"),l&&(o.lang=l),c=document.createElement("div"),t.lang.object(i).merge({width:a.offsetWidth+"px",height:a.offsetHeight+"px"}),e.insert(u).into(c),e.insert(c).into(a),e.setStyles(r).on(u),e.setAttributes(o).on(u),e.setStyles(i).on(c),e.setStyles(n).on(a),h="onwebkitspeechchange"in u?"webkitspeechchange":"speechchange",e.observe(u,h,function(){s.execCommand("insertText",u.value),u.value=""}),void e.observe(u,"click",function(t){e.hasClass(a,"wysihtml5-command-disabled")&&t.preventDefault(),t.stopPropagation()})):void(a.style.display="none")}}(wysihtml5),function(t){var e="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",i="wysihtml5-command-active",r="wysihtml5-action-active",o=t.dom;t.toolbar.Toolbar=Base.extend({constructor:function(o,s,a){this.editor=o,this.container="string"==typeof s?document.getElementById(s):s,this.composer=o.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),a&&this.show(),null!=o.config.classNameCommandDisabled&&(e=o.config.classNameCommandDisabled),null!=o.config.classNameCommandsDisabled&&(n=o.config.classNameCommandsDisabled),null!=o.config.classNameCommandActive&&(i=o.config.classNameCommandActive),null!=o.config.classNameActionActive&&(r=o.config.classNameActionActive);for(var l=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),c=l.length,h=0;c>h;h++)new t.toolbar.Speech(this,l[h])},_getLinks:function(e){for(var n,i,r,o,s,a=this[e+"Links"]=t.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+e+"]")).get(),l=a.length,c=0,h=this[e+"Mapping"]={};l>c;c++)n=a[c],r=n.getAttribute("data-wysihtml5-"+e),o=n.getAttribute("data-wysihtml5-"+e+"-value"),i=this.container.querySelector("[data-wysihtml5-"+e+"-group='"+r+"']"),s=this._getDialog(n,r),h[r+":"+o]={link:n,group:i,name:r,value:o,dialog:s,state:!1}},_getDialog:function(e,n){var i,r,o=this,s=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return s&&(i=t.toolbar["Dialog_"+n]?new t.toolbar["Dialog_"+n](e,s):new t.toolbar.Dialog(e,s),i.on("show",function(){r=o.composer.selection.getBookmark(),o.editor.fire("show:dialog",{command:n,dialogContainer:s,commandLink:e})}),i.on("save",function(t){r&&o.composer.selection.setBookmark(r),o._execCommand(n,t),o.editor.fire("save:dialog",{command:n,dialogContainer:s,commandLink:e})}),i.on("cancel",function(){o.editor.focus(!1),o.editor.fire("cancel:dialog",{command:n,dialogContainer:s,commandLink:e})})),i},execCommand:function(t,e){if(!this.commandsDisabled){var n=this.commandMapping[t+":"+e];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(t,e)}},_execCommand:function(t,e){this.editor.focus(!1),this.composer.commands.exec(t,e),this._updateLinkStates()},execAction:function(t){var e=this.editor;"change_view"===t&&e.textarea&&(e.currentView===e.textarea?e.fire("change_view","composer"):e.fire("change_view","textarea")),"showSource"==t&&e.fire("showSource")},_observe:function(){for(var t=this,e=this.editor,i=this.container,r=this.commandLinks.concat(this.actionLinks),s=r.length,a=0;s>a;a++)"A"===r[a].nodeName?o.setAttributes({href:"javascript:;",unselectable:"on"}).on(r[a]):o.setAttributes({unselectable:"on"}).on(r[a]);o.delegate(i,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(t){t.preventDefault()}),o.delegate(i,"[data-wysihtml5-command]","click",function(e){var n=this,i=n.getAttribute("data-wysihtml5-command"),r=n.getAttribute("data-wysihtml5-command-value");t.execCommand(i,r),e.preventDefault()}),o.delegate(i,"[data-wysihtml5-action]","click",function(e){var n=this.getAttribute("data-wysihtml5-action");t.execAction(n),e.preventDefault()}),e.on("interaction:composer",function(){t._updateLinkStates()}),e.on("focus:composer",function(){t.bookmark=null}),this.editor.config.handleTables&&(e.on("tableselect:composer",function(){t.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),e.on("tableunselect:composer",function(){t.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})),e.on("change_view",function(r){e.textarea&&setTimeout(function(){t.commandsDisabled="composer"!==r,t._updateLinkStates(),t.commandsDisabled?o.addClass(i,n):o.removeClass(i,n)},0)})},_updateLinkStates:function(){var n,s,a,l,c=this.commandMapping,h=this.actionMapping;for(n in c)l=c[n],this.commandsDisabled?(s=!1,o.removeClass(l.link,i),l.group&&o.removeClass(l.group,i),l.dialog&&l.dialog.hide()):(s=this.composer.commands.state(l.name,l.value),o.removeClass(l.link,e),l.group&&o.removeClass(l.group,e)),l.state!==s&&(l.state=s,s?(o.addClass(l.link,i),l.group&&o.addClass(l.group,i),l.dialog&&("object"==typeof s||t.lang.object(s).isArray()?(!l.dialog.multiselect&&t.lang.object(s).isArray()&&(s=1!==s.length||s[0],l.state=s),l.dialog.show(s)):l.dialog.hide())):(o.removeClass(l.link,i),l.group&&o.removeClass(l.group,i),l.dialog&&l.dialog.hide()));for(n in h)a=h[n],"change_view"===a.name&&(a.state=this.editor.currentView===this.editor.textarea,a.state?o.addClass(a.link,r):o.removeClass(a.link,r))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(t){t.toolbar.Dialog_createTable=t.toolbar.Dialog.extend({show:function(t){this.base(t)}})}(wysihtml5),function(t){var e=(t.dom,"[data-wysihtml5-dialog-field]"),n="data-wysihtml5-dialog-field";t.toolbar.Dialog_foreColorStyle=t.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var t={},i=this.container.querySelectorAll(e),r=i.length,o=0;r>o;o++)t[i[o].getAttribute(n)]=i[o].value;return t},_interpolate:function(i){for(var r,o=document.querySelector(":focus"),s=this.container.querySelectorAll(e),a=s.length,l=0,c=this.elementToChange?t.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,h=c?c.getAttribute("style"):null,u=h?t.quirks.styleParser.parseColor(h,"color"):null;a>l;l++)(r=s[l])!==o&&(i&&"hidden"===r.type||"color"===r.getAttribute(n)&&(r.value=u?u[3]&&1!=u[3]?"rgba("+u[0]+","+u[1]+","+u[2]+","+u[3]+");":"rgb("+u[0]+","+u[1]+","+u[2]+");":"rgb(0,0,0);"))}})}(wysihtml5),function(t){t.dom,t.toolbar.Dialog_fontSizeStyle=t.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(){var e=document.querySelector(":focus"),n=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),i=this.elementToChange?t.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,r=i?i.getAttribute("style"):null,o=r?t.quirks.styleParser.parseFontSize(r):null;n&&n!==e&&o&&!/^\s*$/.test(o)&&(n.value=o)}})}(wysihtml5),Handlebars=function(){var t=function(){"use strict";function t(t){this.string=t}return t.prototype.toString=function(){return""+this.string},t}(),e=function(t){"use strict";function e(t){return h[t]||"&amp;"}function n(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function i(t){return t instanceof c?""+t:t||0===t?(t=""+t,d.test(t)?t.replace(u,e):t):""}function r(t){return!t&&0!==t||!(!a(t)||0!==t.length)}var o,s,a,l={},c=t,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,d=/[&<>"'`]/;return l.extend=n,o=Object.prototype.toString,l.toString=o,s=function(t){return"function"==typeof t},s(/x/)&&(s=function(t){return"function"==typeof t&&"[object Function]"===o.call(t)}),l.isFunction=s,a=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===o.call(t)},l.isArray=a,l.escapeExpression=i,l.isEmpty=r,l}(t),n=function(){"use strict";function t(t,n){var i,r,o;for(n&&n.firstLine&&(i=n.firstLine,t+=" - "+i+":"+n.firstColumn),r=Error.prototype.constructor.call(this,t),o=0;o<e.length;o++)this[e[o]]=r[e[o]];i&&(this.lineNumber=i,this.column=n.firstColumn)}var e=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=Error(),t}(),i=function(t,e){"use strict";function n(t,e){this.helpers=t||{},this.partials=e||{},i(this)}function i(t){t.registerHelper("helperMissing",function(t){if(2!==arguments.length)throw new m("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,n){var i=n.inverse||function(){},r=n.fn;return l(e)&&(e=e.call(this)),!0===e?r(this):!1===e||null==e?i(this):a(e)?e.length>0?t.helpers.each(e,n):i(this):r(e)}),t.registerHelper("each",function(t,e){var n,i,r,o=e.fn,s=e.inverse,c=0,h="";if(l(t)&&(t=t.call(this)),e.data&&(n=d(e.data)),t&&"object"==typeof t)if(a(t))for(i=t.length;i>c;c++)n&&(n.index=c,n.first=0===c,n.last=c===t.length-1),h+=o(t[c],{data:n});else for(r in t)t.hasOwnProperty(r)&&(n&&(n.key=r,n.index=c,n.first=0===c),h+=o(t[r],{data:n}),c++);return 0===c&&(h=s(this)),h}),t.registerHelper("if",function(t,e){return l(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||p.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers.if.call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){return l(t)&&(t=t.call(this)),p.isEmpty(t)?void 0:e.fn(t)}),t.registerHelper("log",function(e,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(i,e)})}function r(t,e){u.log(t,e)}var o,s,a,l,c,h,u,d,f={},p=t,m=e;return f.VERSION="1.3.0",o=4,f.COMPILER_REVISION=o,s={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},f.REVISION_CHANGES=s,a=p.isArray,l=p.isFunction,c=p.toString,h="[object Object]",f.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:u,log:r,registerHelper:function(t,e,n){if(c.call(t)===h){if(n||e)throw new m("Arg not supported with multiple helpers");p.extend(this.helpers,t)}else n&&(e.not=n),this.helpers[t]=e},registerPartial:function(t,e){c.call(t)===h?p.extend(this.partials,t):this.partials[t]=e}},u={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(u.level<=t){var n=u.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,e)}}},f.logger=u,f.log=r,d=function(t){var e={};return p.extend(e,t),e},f.createFrame=d,f}(e,n),r=function(t,e,n){"use strict";function i(t){var e,n,i=t&&t[0]||1,r=d;if(i!==r){if(r>i)throw e=f[r],n=f[i],new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+e+") or downgrade your runtime to an older version ("+n+").");throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){if(!e)throw new u("No environment passed to template");var n=function(t,n,i,r,o,s){var a,l=e.VM.invokePartial.apply(this,arguments);if(null!=l)return l;if(e.compile)return a={helpers:r,partials:o,data:s},o[n]=e.compile(t,{data:void 0!==s},e),o[n](i,a);throw new u("The partial "+n+" could not be compiled when running in runtime-only mode")},i={escapeExpression:h.escapeExpression,invokePartial:n,programs:[],program:function(t,e,n){var i=this.programs[t];return n?i=s(t,e,n):i||(i=this.programs[t]=s(t,e)),i},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n={},h.extend(n,e),h.extend(n,t)),n},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(n,r){var o,s,a,l;return r=r||{},a=r.partial?r:e,r.partial||(o=r.helpers,s=r.partials),l=t.call(i,a,n,o,s,r.data),r.partial||e.VM.checkRevision(i.compilerInfo),l}}function o(t,e,n){var i=Array.prototype.slice.call(arguments,3),r=function(t,r){return r=r||{},e.apply(this,[t,r.data||n].concat(i))};return r.program=t,r.depth=i.length,r}function s(t,e,n){var i=function(t,i){return i=i||{},e(t,i.data||n)};return i.program=t,i.depth=0,i}function a(t,e,n,i,r,o){var s={partial:!0,helpers:i,partials:r,data:o};if(void 0===t)throw new u("The partial "+e+" could not be found");return t instanceof Function?t(n,s):void 0}function l(){return""}var c={},h=t,u=e,d=n.COMPILER_REVISION,f=n.REVISION_CHANGES;return c.checkRevision=i,c.template=r,c.programWithDepth=o,c.program=s,c.invokePartial=a,c.noop=l,c}(e,n,i);return function(t,e,n,i,r){"use strict";var o=t,s=e,a=n,l=i,c=r,h=function(){var t=new o.HandlebarsEnvironment;return l.extend(t,o),t.SafeString=s,t.Exception=a,t.Utils=l,t.VM=c,t.template=function(e){return c.template(e,t)},t},u=h();return u.create=h,u}(i,t,n,e,r)}(),this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.blockquote=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return' \n      <span class="fa fa-quote-left"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li>\n  <a class="btn ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.color=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+c((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===l?e.apply(t):e))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var s,a="",l="function",c=this.escapeExpression,h=this;return a+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',s=n.if.call(e,(s=e&&e.options,s=null==s||!1===s?s:s.toolbar,null==s||!1===s?s:s.size),{hash:{},inverse:h.noop,fn:h.program(1,o,r),data:r}),(s||0===s)&&(a+=s),a+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.black,typeof s===l?s.apply(e):s))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.black,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.silver,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.gray,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.maroon,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.red,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.purple,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.green,
typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.olive,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.navy,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.blue,typeof s===l?s.apply(e):s))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+c((s=e&&e.locale,s=null==s||!1===s?s:s.colours,s=null==s||!1===s?s:s.orange,typeof s===l?s.apply(e):s))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.emphasis=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+h((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===c?e.apply(t):e))}function s(t,e){var i,r="";return r+='\n    <a class="btn ',i=n.if.call(t,(i=t&&t.options,i=null==i||!1===i?i:i.toolbar,null==i||!1===i?i:i.size),{hash:{},inverse:u.noop,fn:u.program(1,o,e),data:e}),(i||0===i)&&(r+=i),r+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+h((i=t&&t.locale,i=null==i||!1===i?i:i.emphasis,i=null==i||!1===i?i:i.small,typeof i===c?i.apply(t):i))+"</a>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var a,l="",c="function",h=this.escapeExpression,u=this;return l+='<li>\n  <div class="btn-group">\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.bold,typeof a===c?a.apply(e):a))+'</a>\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.italic,typeof a===c?a.apply(e):a))+'</a>\n    <a class="btn ',a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,null==a||!1===a?a:a.size),{hash:{},inverse:u.noop,fn:u.program(1,o,r),data:r}),(a||0===a)&&(l+=a),l+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+h((a=e&&e.locale,a=null==a||!1===a?a:a.emphasis,a=null==a||!1===a?a:a.underline,typeof a===c?a.apply(e):a))+"</a>\n    ",a=n.if.call(e,(a=e&&e.options,a=null==a||!1===a?a:a.toolbar,a=null==a||!1===a?a:a.emphasis,null==a||!1===a?a:a.small),{hash:{},inverse:u.noop,fn:u.program(3,s,r),data:r}),(a||0===a)&&(l+=a),l+="\n  </div>\n</li>\n"}),this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return'\n      <span class="fa fa-font"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+='" data-toggle="dropdown">\n    ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+='\n    <span class="current-font">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.normal,typeof l===h?l.apply(e):l))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.normal,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h1,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h2,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h3,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h4,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h5,typeof l===h?l.apply(e):l))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+u((l=e&&e.locale,l=null==l||!1===l?l:l.font_styles,l=null==l||!1===l?l:l.h6,typeof l===h?l.apply(e):l))+"</a></li>\n  </ul>\n</li>\n"}),this.wysihtml5.tpl.html=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+u((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===h?e.apply(t):e))}function s(){return'\n        <span class="fa fa-pencil"></span>\n      '}function a(){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var l,c="",h="function",u=this.escapeExpression,d=this;return c+='<li>\n  <div class="btn-group">\n    <a class="btn ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.size),{hash:{},inverse:d.noop,fn:d.program(1,o,r),data:r}),(l||0===l)&&(c+=l),c+=' btn-default" data-wysihtml5-action="change_view" title="'+u((l=e&&e.locale,l=null==l||!1===l?l:l.html,l=null==l||!1===l?l:l.edit,typeof l===h?l.apply(e):l))+'" tabindex="-1">\n      ',l=n.if.call(e,(l=e&&e.options,l=null==l||!1===l?l:l.toolbar,null==l||!1===l?l:l.fa),{hash:{},inverse:d.program(5,a,r),fn:d.program(3,s,r),data:r}),(l||0===l)&&(c+=l),c+="\n    </a>\n  </div>\n</li>\n"}),this.wysihtml5.tpl.image=Handlebars.template(function(t,e,n,i,r){function o(){return"modal-sm"}function s(t){var e,n="";return n+="btn-"+d((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===u?e.apply(t):e))}function a(){return'\n      <span class="fa fa-file-image-o"></span>\n    '}function l(){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var c,h="",u="function",d=this.escapeExpression,f=this;return h+='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,o,r),data:r}),(c||0===c)&&(h+=c),h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.cancel,typeof c===u?c.apply(e):c))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,r),data:r}),(c||0===c)&&(h+=c),h+=' btn-default" data-wysihtml5-command="insertImage" title="'+d((c=e&&e.locale,c=null==c||!1===c?c:c.image,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'" tabindex="-1">\n    ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.fa),{hash:{},inverse:f.program(7,l,r),fn:f.program(5,a,r),data:r}),(c||0===c)&&(h+=c),h+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.link=Handlebars.template(function(t,e,n,i,r){function o(){return"modal-sm"}function s(t){var e,n="";return n+="btn-"+d((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===u?e.apply(t):e))}function a(){return'\n      <span class="fa fa-share-square-o"></span>\n    '}function l(){return'\n      <span class="glyphicon glyphicon-share"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var c,h="",u="function",d=this.escapeExpression,f=this;return h+='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.smallmodals),{hash:{},inverse:f.noop,fn:f.program(1,o,r),data:r}),(c||0===c)&&(h+=c),h+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.target,typeof c===u?c.apply(e):c))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.cancel,typeof c===u?c.apply(e):c))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.size),{hash:{},inverse:f.noop,fn:f.program(3,s,r),data:r}),(c||0===c)&&(h+=c),h+=' btn-default" data-wysihtml5-command="createLink" title="'+d((c=e&&e.locale,c=null==c||!1===c?c:c.link,c=null==c||!1===c?c:c.insert,typeof c===u?c.apply(e):c))+'" tabindex="-1">\n    ',c=n.if.call(e,(c=e&&e.options,c=null==c||!1===c?c:c.toolbar,null==c||!1===c?c:c.fa),{hash:{},inverse:f.program(7,l,r),fn:f.program(5,a,r),data:r}),(c||0===c)&&(h+=c),h+="\n  </a>\n</li>\n"}),this.wysihtml5.tpl.lists=Handlebars.template(function(t,e,n,i,r){function o(t){var e,n="";return n+="btn-"+y((e=t&&t.options,e=null==e||!1===e?e:e.toolbar,e=null==e||!1===e?e:e.size,typeof e===g?e.apply(t):e))}function s(){return'\n      <span class="fa fa-list-ul"></span>\n    '}function a(){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '}function l(){return'\n      <span class="fa fa-list-ol"></span>\n    '}function c(){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '}function h(){return'\n      <span class="fa fa-outdent"></span>\n    '}function u(){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '}function d(){return'\n      <span class="fa fa-indent"></span>\n    '}function f(){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers),r=r||{};var p,m="",g="function",y=this.escapeExpression,v=this;return m+='<li>\n  <div class="btn-group">\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.unordered,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(5,a,r),fn:v.program(3,s,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.ordered,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(9,c,r),fn:v.program(7,l,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Outdent" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.outdent,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(13,u,r),fn:v.program(11,h,r),data:r}),(p||0===p)&&(m+=p),m+='\n    </a>\n    <a class="btn ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.size),{hash:{},inverse:v.noop,fn:v.program(1,o,r),data:r}),(p||0===p)&&(m+=p),m+=' btn-default" data-wysihtml5-command="Indent" title="'+y((p=e&&e.locale,p=null==p||!1===p?p:p.lists,p=null==p||!1===p?p:p.indent,typeof p===g?p.apply(e):p))+'" tabindex="-1">\n    ',p=n.if.call(e,(p=e&&e.options,p=null==p||!1===p?p:p.toolbar,null==p||!1===p?p:p.fa),{hash:{},inverse:v.program(17,f,r),fn:v.program(15,d,r),data:r}),(p||0===p)&&(m+=p),m+="\n    </a>\n  </div>\n</li>\n"}),function(t){"use strict";"function"==typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],t):t(jQuery,wysihtml5)}(function(t,e){"use strict";!function(t,e){var n,i,r,o=function(t,n,i){return e.tpl[t]?e.tpl[t]({locale:n,options:i}):void 0},s=function(n,r){var o,s;this.el=n,o=t.extend(!0,{},i,r);for(s in o.customTemplates)o.customTemplates.hasOwnProperty(s)&&(e.tpl[s]=o.customTemplates[s]);this.toolbar=this.createToolbar(n,o),this.editor=this.createEditor(o)};s.prototype={constructor:s,createEditor:function(e){e=e||{},e=t.extend(!0,{},e),e.toolbar=this.toolbar[0],this.initializeEditor(this.el[0],e)},initializeEditor:function(t,n){var i,r=new e.Editor(this.el[0],n);if(r.on("beforeload",this.syncBootstrapDialogEvents),r.on("beforeload",this.loadParserRules),r.composer.editableArea.contentDocument?this.addMoreShortcuts(r,r.composer.editableArea.contentDocument.body||r.composer.editableArea.contentDocument,n.shortcuts):this.addMoreShortcuts(r,r.composer.editableArea,n.shortcuts),n&&n.events)for(i in n.events)n.events.hasOwnProperty(i)&&r.on(i,n.events[i]);return r},loadParserRules:function(){"string"===t.type(this.config.parserRules)&&t.ajax({dataType:"json",url:this.config.parserRules,context:this,error:function(t,e,n){},success:function(t){this.config.parserRules=t}}),this.config.pasteParserRulesets&&"string"===t.type(this.config.pasteParserRulesets)&&t.ajax({dataType:"json",url:this.config.pasteParserRulesets,context:this,error:function(t,e,n){},success:function(t){this.config.pasteParserRulesets=t}})},syncBootstrapDialogEvents:function(){var e=this;t.map(this.toolbar.commandMapping,function(t){return[t]}).filter(function(t){return t.dialog}).map(function(t){return t.dialog}).forEach(function(n){n.on("show",function(){t(this.container).modal("show")}),n.on("hide",function(){t(this.container).modal("hide"),setTimeout(e.composer.focus,0)}),t(n.container).on("shown.bs.modal",function(){t(this).find("input, select, textarea").first().focus()})}),this.on("change_view",function(){t(this.toolbar.container.children).find("a.btn").not('[data-wysihtml5-action="change_view"]').toggleClass("disabled")})},createToolbar:function(e,n){var s,a,l=this,c=t("<ul/>",{class:"wysihtml5-toolbar",style:"display:none"}),h=n.locale||i.locale||"en";r.hasOwnProperty(h)||(h="en"),s=t.extend(!0,{},r.en,r[h]);for(a in n.toolbar)n.toolbar[a]&&c.append(o(a,s,n));return c.find('a[data-wysihtml5-command="formatBlock"]').click(function(e){var n=e.delegateTarget||e.target||e.srcElement,i=t(n),r=i.data("wysihtml5-display-format-name"),o=i.data("wysihtml5-format-name")||i.html();(void 0===r||"true"===r)&&l.toolbar.find(".current-font").text(o)}),c.find('a[data-wysihtml5-command="foreColor"]').click(function(e){var n=e.target||e.srcElement,i=t(n);l.toolbar.find(".current-color").text(i.html())}),this.el.before(c),c},addMoreShortcuts:function(t,n,i){e.dom.observe(n,"keydown",function(n){var r,o=n.keyCode,s=i[o];(n.ctrlKey||n.metaKey||n.altKey)&&s&&e.commands[s]&&(r=t.toolbar.commandMapping[s+":null"],r&&r.dialog&&!r.state?r.dialog.show():e.commands[s].exec(t.composer,s),n.preventDefault())})}},n={resetDefaults:function(){t.fn.wysihtml5.defaultOptions=t.extend(!0,{},t.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(e){return this.each(function(){var n=t(this);n.data("wysihtml5",new s(n,e))})},shallowExtend:function(e){var i=t.extend({},t.fn.wysihtml5.defaultOptions,e||{},t(this).data()),r=this;return n.bypassDefaults.apply(r,[i])},deepExtend:function(e){var i=t.extend(!0,{},t.fn.wysihtml5.defaultOptions,e||{}),r=this;return n.bypassDefaults.apply(r,[i])},init:function(t){var e=this;return n.shallowExtend.apply(e,[t])}},t.fn.wysihtml5=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.wysihtml5"):n.init.apply(this,arguments)},t.fn.wysihtml5.Constructor=s,i=t.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},useLineBreaks:!1,parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small",75:"createLink"}},void 0===t.fn.wysihtml5.defaultOptionsCache&&(t.fn.wysihtml5.defaultOptionsCache=t.extend(!0,{},t.fn.wysihtml5.defaultOptions)),r=t.fn.wysihtml5.locale={}}(t,e)}),function(t){t.commands.small={exec:function(e,n){return t.commands.formatInline.exec(e,n,"small")},state:function(e,n){return t.commands.formatInline.state(e,n,"small")}}}(wysihtml5),function(t){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],t):t(jQuery)}(function(t){t.fn.wysihtml5.locale.en=t.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}),function(){"use strict";function t(e,i){var r;if(i=i||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=i.touchBoundary||10,this.layer=e,this.tapDelay=i.tapDelay||200,this.tapTimeout=i.tapTimeout||700,!t.notNeeded(e)){for(var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],s=this,a=0,l=o.length;a<l;a++)s[o[a]]=function(t,e){return function(){return t.apply(e,arguments)}}(s[o[a]],s);n&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,i){var r=Node.prototype.removeEventListener;"click"===t?r.call(e,t,n.hijacked||n,i):r.call(e,t,n,i)},e.addEventListener=function(t,n,i){var r=Node.prototype.addEventListener;"click"===t?r.call(e,t,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):r.call(e,t,n,i)}),"function"==typeof e.onclick&&(r=e.onclick,e.addEventListener("click",function(t){r(t)},!1),e.onclick=null)}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!e,i=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,r=i&&/OS 4_\d(_\d)?/.test(navigator.userAgent),o=i&&/OS [6-7]_\d/.test(navigator.userAgent),s=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(i&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},t.prototype.determineEventType=function(t){return n&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;i&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,n;if(!(e=t.fastClickScrollParent)||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,n,o;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],i){if(o=window.getSelection(),o.rangeCount&&!o.isCollapsed)return!0;if(!r){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n},t.prototype.onTouchMove=function(t){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,s,a,l,c,h=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,s=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,o&&(c=t.changedTouches[0],h=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||h,h.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(a=h.tagName.toLowerCase())){if(e=this.findControl(h)){if(this.focus(h),n)return!1;h=e}}else if(this.needsFocus(h))return t.timeStamp-s>100||i&&window.top!==window&&"input"===a?(this.targetElement=null,!1):(this.focus(h),this.sendClick(h,t),i&&"select"===a||(this.targetElement=null,t.preventDefault()),!1);return!(!i||r||!(l=h.fastClickScrollParent)||l.fastClickLastScrollTop===l.scrollTop)||(this.needsClick(h)||(t.preventDefault(),this.sendClick(h,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||(e=this.onMouse(t),e||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;n&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,i,r;if(void 0===window.ontouchstart)return!0;if(i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(i>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(s&&(r=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),r[1]>=10&&r[2]>=3&&(e=document.querySelector("meta[name=viewport]")))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(e=document.querySelector("meta[name=viewport]"))&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===t.style.touchAction||"manipulation"===t.style.touchAction))},t.attach=function(e,n){return new t(e,n)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}(),function(t){"object"==typeof exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";var e={},n=Math.max,i=Math.min;e.c={},e.c.d=t(document),e.c.t=function(t){return t.originalEvent.touches.length-1},e.o=function(){var n=this;this.o=null,this.$=null,this.i=null,this.g=null,this.v=null,this.cv=null,this.x=0,this.y=0,this.w=0,this.h=0,this.$c=null,this.c=null,this.t=0,this.isInit=!1,this.fgColor=null,this.pColor=null,this.dH=null,this.cH=null,this.eH=null,this.rH=null,this.scale=1,this.relative=!1,this.relativeWidth=!1,this.relativeHeight=!1,this.$div=null,this.run=function(){var e=function(t,e){var i;for(i in e)n.o[i]=e[i];n._carve().init(),n._configure()._draw()};if(!this.$.data("kontroled")){if(this.$.data("kontroled",!0),this.extend(),this.o=t.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:!0===this.$.data("cursor")&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(t){return t},parse:function(t){return parseFloat(t)}},this.o),this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation,this.o.inputColor||(this.o.inputColor=this.o.fgColor),this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(e){var i=t(this);n.i[e]=i,n.v[e]=n.o.parse(i.val()),i.bind("change blur",function(){var t={};t[e]=i.val(),n.val(n._validate(t))})}),this.$.find("legend").remove()):(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){n.val(n._validate(n.o.parse(n.$.val())))})),!this.o.displayInput&&this.$.hide(),this.$c=t(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height}),this.$div=t('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>'),
this.$.wrap(this.$div).before(this.$c),this.$div=this.$.parent(),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]),this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null,!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};return this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1),this.relativeWidth=this.o.width%1!=0&&this.o.width.indexOf("%"),this.relativeHeight=this.o.height%1!=0&&this.o.height.indexOf("%"),this.relative=this.relativeWidth||this.relativeHeight,this._carve(),this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v,this.$.bind("configure",e).parent().bind("configure",e),this._listen()._configure()._xy().init(),this.isInit=!0,this.$.val(this.o.format(this.v)),this._draw(),this}},this._carve=function(){if(this.relative){var t=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),e=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(t,e)}else this.w=this.o.width,this.h=this.o.height;return this.$div.css({width:this.w+"px",height:this.h+"px"}),this.$c.attr({width:this.w,height:this.h}),1!==this.scale&&(this.$c[0].width=this.$c[0].width*this.scale,this.$c[0].height=this.$c[0].height*this.scale,this.$c.width(this.w),this.$c.height(this.h)),this},this._draw=function(){var t=!0;n.g=n.c,n.clear(),n.dH&&(t=n.dH()),!1!==t&&n.draw()},this._touch=function(t){var i=function(t){var e=n.xy2val(t.originalEvent.touches[n.t].pageX,t.originalEvent.touches[n.t].pageY);e!=n.cv&&(n.cH&&!1===n.cH(e)||(n.change(n._validate(e)),n._draw()))};return this.t=e.c.t(t),i(t),e.c.d.bind("touchmove.k",i).bind("touchend.k",function(){e.c.d.unbind("touchmove.k touchend.k"),n.val(n.cv)}),this},this._mouse=function(t){var i=function(t){var e=n.xy2val(t.pageX,t.pageY);e!=n.cv&&(n.cH&&!1===n.cH(e)||(n.change(n._validate(e)),n._draw()))};return i(t),e.c.d.bind("mousemove.k",i).bind("keyup.k",function(t){if(27===t.keyCode){if(e.c.d.unbind("mouseup.k mousemove.k keyup.k"),n.eH&&!1===n.eH())return;n.cancel()}}).bind("mouseup.k",function(t){e.c.d.unbind("mousemove.k mouseup.k keyup.k"),n.val(n.cv)}),this},this._xy=function(){var t=this.$c.offset();return this.x=t.left,this.y=t.top,this},this._listen=function(){return this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(t){t.preventDefault(),n._xy()._mouse(t)}).bind("touchstart",function(t){t.preventDefault(),n._xy()._touch(t)}),this.listen()),this.relative&&t(window).resize(function(){n._carve().init(),n._draw()}),this},this._configure=function(){return this.o.draw&&(this.dH=this.o.draw),this.o.change&&(this.cH=this.o.change),this.o.cancel&&(this.eH=this.o.cancel),this.o.release&&(this.rH=this.o.release),this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor,this},this._clear=function(){this.$c[0].width=this.$c[0].width},this._validate=function(t){var e=~~((t<0?-.5:.5)+t/this.o.step)*this.o.step;return Math.round(100*e)/100},this.listen=function(){},this.extend=function(){},this.init=function(){},this.change=function(t){},this.val=function(t){},this.xy2val=function(t,e){},this.draw=function(){},this.clear=function(){this._clear()},this.h2rgba=function(t,e){var n;return t=t.substring(1,7),n=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)],"rgba("+n[0]+","+n[1]+","+n[2]+","+e+")"},this.copy=function(t,e){for(var n in t)e[n]=t[n]}},e.Dial=function(){e.o.call(this),this.startAngle=null,this.xy=null,this.radius=null,this.lineWidth=null,this.cursorExt=null,this.w2=null,this.PI2=2*Math.PI,this.extend=function(){this.o=t.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)},this.val=function(t,e){if(null==t)return this.v;t=this.o.parse(t),!1!==e&&t!=this.v&&this.rH&&!1===this.rH(t)||(this.cv=this.o.stopper?n(i(t,this.o.max),this.o.min):t,this.v=this.cv,this.$.val(this.o.format(this.v)),this._draw())},this.xy2val=function(t,e){var r,o;return r=Math.atan2(t-(this.x+this.w2),-(e-this.y-this.w2))-this.angleOffset,this.o.flip&&(r=this.angleArc-r-this.PI2),this.angleArc!=this.PI2&&r<0&&r>-.5?r=0:r<0&&(r+=this.PI2),o=r*(this.o.max-this.o.min)/this.angleArc+this.o.min,this.o.stopper&&(o=n(i(o,this.o.max),this.o.min)),o},this.listen=function(){var e,r,o,s,a=this,l=function(t){t.preventDefault();var o=t.originalEvent,s=o.detail||o.wheelDeltaX,l=o.detail||o.wheelDeltaY,c=a._validate(a.o.parse(a.$.val()))+(s>0||l>0?a.o.step:s<0||l<0?-a.o.step:0);c=n(i(c,a.o.max),a.o.min),a.val(c,!1),a.rH&&(clearTimeout(e),e=setTimeout(function(){a.rH(c),e=null},100),r||(r=setTimeout(function(){e&&a.rH(c),r=null},200)))},c=1,h={37:-a.o.step,38:a.o.step,39:a.o.step,40:-a.o.step};this.$.bind("keydown",function(e){var r=e.keyCode;if(r>=96&&r<=105&&(r=e.keyCode=r-48),o=parseInt(String.fromCharCode(r)),isNaN(o)&&(13!==r&&8!==r&&9!==r&&189!==r&&(190!==r||a.$.val().match(/\./))&&e.preventDefault(),t.inArray(r,[37,38,39,40])>-1)){e.preventDefault();var l=a.o.parse(a.$.val())+h[r]*c;a.o.stopper&&(l=n(i(l,a.o.max),a.o.min)),a.change(a._validate(l)),a._draw(),s=window.setTimeout(function(){c*=2},30)}}).bind("keyup",function(t){isNaN(o)?s&&(window.clearTimeout(s),s=null,c=1,a.val(a.$.val())):a.$.val()>a.o.max&&a.$.val(a.o.max)||a.$.val()<a.o.min&&a.$.val(a.o.min)}),this.$c.bind("mousewheel DOMMouseScroll",l),this.$.bind("mousewheel DOMMouseScroll",l)},this.init=function(){(this.v<this.o.min||this.v>this.o.max)&&(this.v=this.o.min),this.$.val(this.v),this.w2=this.w/2,this.cursorExt=this.o.cursor/100,this.xy=this.w2*this.scale,this.lineWidth=this.xy*this.o.thickness,this.lineCap=this.o.lineCap,this.radius=this.xy-this.lineWidth/2,this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset),this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc),this.angleOffset=this.o.angleOffset*Math.PI/180,this.angleArc=this.o.angleArc*Math.PI/180,this.startAngle=1.5*Math.PI+this.angleOffset,this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var t=n(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/t>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})},this.change=function(t){this.cv=t,this.$.val(this.o.format(t))},this.angle=function(t){return(t-this.o.min)*this.angleArc/(this.o.max-this.o.min)},this.arc=function(t){var e,n;return t=this.angle(t),this.o.flip?(e=this.endAngle+1e-5,n=e-t-1e-5):(e=this.startAngle-1e-5,n=e+t+1e-5),this.o.cursor&&(e=n-this.cursorExt)&&(n+=this.cursorExt),{s:e,e:n,d:this.o.flip&&!this.o.cursor}},this.draw=function(){var t,e=this.g,n=this.arc(this.cv),i=1;e.lineWidth=this.lineWidth,e.lineCap=this.lineCap,"none"!==this.o.bgColor&&(e.beginPath(),e.strokeStyle=this.o.bgColor,e.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,!0),e.stroke()),this.o.displayPrevious&&(t=this.arc(this.v),e.beginPath(),e.strokeStyle=this.pColor,e.arc(this.xy,this.xy,this.radius,t.s,t.e,t.d),e.stroke(),i=this.cv==this.v),e.beginPath(),e.strokeStyle=i?this.o.fgColor:this.fgColor,e.arc(this.xy,this.xy,this.radius,n.s,n.e,n.d),e.stroke()},this.cancel=function(){this.val(this.v)}},t.fn.dial=t.fn.knob=function(n){return this.each(function(){var i=new e.Dial;i.o=n,i.$=t(this),i.run()}).parent()}}),function(e){e.fn.extend({slimScroll:function(n){var i=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function r(t){if(c){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3),e(t.target||t.srcTarget||t.srcElement).closest("."+i.wrapperClass).is(v.parent())&&o(n,!0),t.preventDefault&&!y&&t.preventDefault(),y||(t.returnValue=!1)}}function o(t,e,n){y=!1;var r=v.outerHeight()-w.outerHeight();e&&(e=parseInt(w.css("top"))+t*parseInt(i.wheelStep)/100*w.outerHeight(),e=Math.min(Math.max(e,0),r),e=0<t?Math.ceil(e):Math.floor(e),w.css({top:e+"px"})),m=parseInt(w.css("top"))/(v.outerHeight()-w.outerHeight()),e=m*(v[0].scrollHeight-v.outerHeight()),n&&(e=t,t=e/v[0].scrollHeight*v.outerHeight(),t=Math.min(Math.max(t,0),r),w.css({top:t+"px"})),v.scrollTop(e),v.trigger("slimscrolling",~~e),a(),l()}function s(){p=Math.max(v.outerHeight()/v[0].scrollHeight*v.outerHeight(),30),w.css({height:p+"px"});var t=p==v.outerHeight()?"none":"block";w.css({display:t})}function a(){s(),clearTimeout(d),m==~~m?(y=i.allowPageScroll,g!=m&&v.trigger("slimscroll",0==~~m?"top":"bottom")):y=!1,g=m,p>=v.outerHeight()?y=!0:(w.stop(!0,!0).fadeIn("fast"),i.railVisible&&x.stop(!0,!0).fadeIn("fast"))}function l(){i.alwaysVisible||(d=setTimeout(function(){i.disableFadeOut&&c||h||u||(w.fadeOut("slow"),x.fadeOut("slow"))},1e3))}var c,h,u,d,f,p,m,g,y=!1,v=e(this);if(v.parent().hasClass(i.wrapperClass)){var b=v.scrollTop(),w=v.siblings("."+i.barClass),x=v.siblings("."+i.railClass);if(s(),e.isPlainObject(n)){if("height"in n&&"auto"==n.height){v.parent().css("height","auto"),v.css("height","auto");var C=v.parent().parent().height();v.parent().css("height",C),v.css("height",C)}else"height"in n&&(C=n.height,v.parent().css("height",C),v.css("height",C));if("scrollTo"in n)b=parseInt(i.scrollTo);else if("scrollBy"in n)b+=parseInt(i.scrollBy);else if("destroy"in n)return w.remove(),x.remove(),void v.unwrap();o(b,!1,!0)}}else if(!(e.isPlainObject(n)&&"destroy"in n)){i.height="auto"==i.height?v.parent().height():i.height,b=e("<div></div>").addClass(i.wrapperClass).css({position:"relative",overflow:"hidden",width:i.width,height:i.height}),v.css({overflow:"hidden",width:i.width,height:i.height});var x=e("<div></div>").addClass(i.railClass).css({width:i.size,height:"100%",position:"absolute",top:0,display:i.alwaysVisible&&i.railVisible?"block":"none","border-radius":i.railBorderRadius,background:i.railColor,opacity:i.railOpacity,zIndex:90}),w=e("<div></div>").addClass(i.barClass).css({background:i.color,width:i.size,position:"absolute",top:0,opacity:i.opacity,display:i.alwaysVisible?"block":"none","border-radius":i.borderRadius,BorderRadius:i.borderRadius,MozBorderRadius:i.borderRadius,WebkitBorderRadius:i.borderRadius,zIndex:99}),C="right"==i.position?{right:i.distance}:{left:i.distance};x.css(C),w.css(C),v.wrap(b),v.parent().append(w),v.parent().append(x),i.railDraggable&&w.bind("mousedown",function(n){var i=e(document);return u=!0,t=parseFloat(w.css("top")),pageY=n.pageY,i.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,w.css("top",currTop),o(0,w.position().top,!1)}),i.bind("mouseup.slimscroll",function(t){u=!1,l(),i.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(t){return t.stopPropagation(),t.preventDefault(),!1}),x.hover(function(){a()},function(){l()}),w.hover(function(){h=!0},function(){h=!1}),v.hover(function(){c=!0,a(),l()},function(){c=!1,l()}),v.bind("touchstart",function(t,e){t.originalEvent.touches.length&&(f=t.originalEvent.touches[0].pageY)}),v.bind("touchmove",function(t){y||t.originalEvent.preventDefault(),t.originalEvent.touches.length&&(o((f-t.originalEvent.touches[0].pageY)/i.touchScrollStep,!0),f=t.originalEvent.touches[0].pageY)}),s(),"bottom"===i.start?(w.css({top:v.outerHeight()-w.outerHeight()}),o(0,!0)):"top"!==i.start&&(o(e(i.start).position().top,null,!0),i.alwaysVisible||w.hide()),window.addEventListener?(this.addEventListener("DOMMouseScroll",r,!1),this.addEventListener("mousewheel",r,!1)):document.attachEvent("onmousewheel",r)}}),this}}),e.fn.extend({slimscroll:e.fn.slimScroll})}(jQuery),function(t,e,n){!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):jQuery&&!jQuery.fn.sparkline&&t(jQuery)}(function(i){"use strict";var r,o,s,a,l,c,h,u,d,f,p,m,g,y,v,b,w,x,C,_,S,N,E,T,R,k,A,O,D,I,M,L={},B=0;r=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:n,normalRangeMax:n,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:n,chartRangeMax:n,chartRangeMinX:n,chartRangeMaxX:n,tooltipFormat:new s('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:n,nullColor:n,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:n,chartRangeMin:n,chartRangeClip:!1,colorMap:n,tooltipFormat:new s('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new s('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:n,thresholdValue:0,chartRangeMax:n,chartRangeMin:n,chartRangeClip:!1,tooltipFormat:new s("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:n,tooltipFormat:new s("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new s('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:n,targetColor:"#4a2",chartRangeMax:n,chartRangeMin:n,tooltipFormat:new s("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},R='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',o=function(){var t,e;return t=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(t.prototype=i.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],arguments.length>2&&(e=Array.prototype.slice.call(arguments,1,-1),e.unshift(t.prototype),i.extend.apply(i,e))):t.prototype=arguments[0],t.prototype.cls=t,t},i.SPFormatClass=s=o({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,e){this.format=t,this.fclass=e},render:function(t,e,i){var r,o,s,a,l,c=this,h=t;return this.format.replace(this.fre,function(){var t;return o=arguments[1],s=arguments[3],r=c.precre.exec(o),r?(l=r[2],o=r[1]):l=!1,a=h[o],a===n?"":s&&e&&e[s]?(t=e[s],t.get?e[s].get(a)||a:e[s][a]||a):(d(a)&&(a=i.get("numberFormatter")?i.get("numberFormatter")(a):g(a,l,i.get("numberDigitGroupCount"),i.get("numberDigitGroupSep"),i.get("numberDecimalMark"))),a)})}}),i.spformat=function(t,e){return new s(t,e)},a=function(t,e,n){return t<e?e:t>n?n:t},l=function(t,n){var i;return 2===n?(i=e.floor(t.length/2),t.length%2?t[i]:(t[i-1]+t[i])/2):t.length%2?(i=(t.length*n+n)/4,i%1?(t[e.floor(i)]+t[e.floor(i)-1])/2:t[i-1]):(i=(t.length*n+2)/4,i%1?(t[e.floor(i)]+t[e.floor(i)-1])/2:t[i-1])},c=function(t){var e;switch(t){case"undefined":t=n;break;case"null":t=null;break;case"true":t=!0;break;case"false":t=!1;break;default:e=parseFloat(t),t==e&&(t=e)}return t},h=function(t){var e,n=[];for(e=t.length;e--;)n[e]=c(t[e]);return n},u=function(t,e){var n,i,r=[];for(n=0,i=t.length;n<i;n++)t[n]!==e&&r.push(t[n]);return r},d=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g=function(t,e,n,r,o){var s,a;for(t=(!1===e?parseFloat(t).toString():t.toFixed(e)).split(""),(s=(s=i.inArray(".",t))<0?t.length:s)<t.length&&(t[s]=o),a=s-n;a>0;a-=n)t.splice(a,0,r);return t.join("")},f=function(t,e,n){var i;for(i=e.length;i--;)if((!n||null!==e[i])&&e[i]!==t)return!1;return!0},function(t){var e,n=0;for(e=t.length;e--;)n+="number"==typeof t[e]?t[e]:0;return n},m=function(t){return i.isArray(t)?t:[t]},p=function(e){var n;t.createStyleSheet?t.createStyleSheet().cssText=e:(n=t.createElement("style"),n.type="text/css",t.getElementsByTagName("head")[0].appendChild(n),n["string"==typeof t.body.style.WebkitAppearance?"innerText":"innerHTML"]=e)},i.fn.simpledraw=function(e,r,o,s){var a,l;if(o&&(a=this.data("_jqs_vcanvas")))return a;if(!1===i.fn.sparkline.canvas)return!1;if(i.fn.sparkline.canvas===n){var c=t.createElement("canvas");if(c.getContext&&c.getContext("2d"))i.fn.sparkline.canvas=function(t,e,n,i){return new D(t,e,n,i)};else{if(!t.namespaces||t.namespaces.v)return i.fn.sparkline.canvas=!1,!1;t.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),i.fn.sparkline.canvas=function(t,e,n,i){return new I(t,e,n)}}}return e===n&&(e=i(this).innerWidth()),r===n&&(r=i(this).innerHeight()),a=i.fn.sparkline.canvas(e,r,this,s),l=i(this).data("_jqs_mhandler"),l&&l.registerCanvas(a),a},i.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");t&&t.reset()},i.RangeMapClass=y=o({init:function(t){var e,n,i=[];for(e in t)t.hasOwnProperty(e)&&"string"==typeof e&&e.indexOf(":")>-1&&(n=e.split(":"),n[0]=0===n[0].length?-1/0:parseFloat(n[0]),n[1]=0===n[1].length?1/0:parseFloat(n[1]),n[2]=t[e],i.push(n));this.map=t,this.rangelist=i||!1},get:function(t){var e,i,r,o=this.rangelist;if((r=this.map[t])!==n)return r;if(o)for(e=o.length;e--;)if(i=o[e],i[0]<=t&&i[1]>=t)return i[2];return n}}),i.range_map=function(t){return new y(t)},v=o({init:function(t,e){var n=i(t);this.$el=n,this.options=e,this.currentPageX=0,this.currentPageY=0,this.el=t,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!e.get("disableTooltips"),this.highlightEnabled=!e.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t),this.over&&this.updateDisplay()},registerCanvas:function(t){var e=i(t.canvas);this.canvas=t,this.$canvas=e,e.mouseenter(i.proxy(this.mouseenter,this)),e.mouseleave(i.proxy(this.mouseleave,this)),e.click(i.proxy(this.mouseclick,this))},reset:function(t){this.splist=[],this.tooltip&&t&&(this.tooltip.remove(),this.tooltip=n)},mouseclick:function(t){var e=i.Event("sparklineClick");e.originalEvent=t,e.sparklines=this.splist,this.$el.trigger(e)},mouseenter:function(e){i(t.body).unbind("mousemove.jqs"),i(t.body).bind("mousemove.jqs",i.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=e.pageX,this.currentPageY=e.pageY,this.currentEl=e.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new b(this.options),this.tooltip.updatePosition(e.pageX,e.pageY)),this.updateDisplay()},mouseleave:function(){i(t.body).unbind("mousemove.jqs");var e,n,r=this.splist,o=r.length,s=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),n=0;n<o;n++)e=r[n],e.clearRegionHighlight()&&(s=!0);s&&this.canvas.render()},mousemove:function(t){this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,this.tooltip&&this.tooltip.updatePosition(t.pageX,t.pageY),this.updateDisplay()},updateDisplay:function(){var t,e,n,r,o,s=this.splist,a=s.length,l=!1,c=this.$canvas.offset(),h=this.currentPageX-c.left,u=this.currentPageY-c.top;if(this.over){for(n=0;n<a;n++)e=s[n],(r=e.setRegionHighlight(this.currentEl,h,u))&&(l=!0);if(l){if(o=i.Event("sparklineRegionChange"),o.sparklines=this.splist,this.$el.trigger(o),this.tooltip){for(t="",n=0;n<a;n++)e=s[n],t+=e.getCurrentRegionTooltip();this.tooltip.setContent(t)}this.disableHighlight||this.canvas.render()}null===r&&this.mouseleave()}}}),b=o({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(e){var n,r=e.get("tooltipClassname","jqstooltip"),o=this.sizeStyle;this.container=e.get("tooltipContainer")||t.body,this.tooltipOffsetX=e.get("tooltipOffsetX",10),this.tooltipOffsetY=e.get("tooltipOffsetY",12),i("#jqssizetip").remove(),i("#jqstooltip").remove(),this.sizetip=i("<div/>",{id:"jqssizetip",style:o,class:r}),this.tooltip=i("<div/>",{id:"jqstooltip",class:r}).appendTo(this.container),n=this.tooltip.offset(),this.offsetLeft=n.left,this.offsetTop=n.top,this.hidden=!0,i(window).unbind("resize.jqs scroll.jqs"),i(window).bind("resize.jqs scroll.jqs",i.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=i(window).scrollTop(),this.scrollLeft=i(window).scrollLeft(),this.scrollRight=this.scrollLeft+i(window).width(),this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(t){if(!t)return this.tooltip.css("visibility","hidden"),void(this.hidden=!0);this.getSize(t),this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(t,e){if(t===n){if(this.mousex===n)return;t=this.mousex-this.offsetLeft,e=this.mousey-this.offsetTop}else this.mousex=t-=this.offsetLeft,this.mousey=e-=this.offsetTop;this.height&&this.width&&!this.hidden&&(e-=this.height+this.tooltipOffsetY,t+=this.tooltipOffsetX,e<this.scrollTop&&(e=this.scrollTop),t<this.scrollLeft?t=this.scrollLeft:t+this.width>this.scrollRight&&(t=this.scrollRight-this.width),this.tooltip.css({left:t,top:e}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=n,i(window).unbind("resize.jqs scroll.jqs")}}),k=function(){p(R)},i(k),M=[],i.fn.sparkline=function(e,r){return this.each(function(){var o,s,a=new i.fn.sparkline.options(this,r),l=i(this);if(o=function(){var r,o,s,c,h,u,d;if("html"===e||e===n?(d=this.getAttribute(a.get("tagValuesAttribute")),d!==n&&null!==d||(d=l.html()),r=d.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):r=e,o="auto"===a.get("width")?r.length*a.get("defaultPixelsPerValue"):a.get("width"),"auto"===a.get("height")?a.get("composite")&&i.data(this,"_jqs_vcanvas")||(c=t.createElement("span"),c.innerHTML="a",l.html(c),s=i(c).innerHeight()||i(c).height(),i(c).remove(),c=null):s=a.get("height"),a.get("disableInteraction")?h=!1:(h=i.data(this,"_jqs_mhandler"),h?a.get("composite")||h.reset():(h=new v(this,a),i.data(this,"_jqs_mhandler",h))),a.get("composite")&&!i.data(this,"_jqs_vcanvas"))return void(i.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),i.data(this,"_jqs_errnotify",!0)));u=new(i.fn.sparkline[a.get("type")])(this,r,a,o,s),u.render(),h&&h.registerSparkline(u)},i(this).html()&&!a.get("disableHiddenCheck")&&i(this).is(":hidden")||!i(this).parents("body").length){if(!a.get("composite")&&i.data(this,"_jqs_pending"))for(s=M.length;s;s--)M[s-1][0]==this&&M.splice(s-1,1);M.push([this,o]),i.data(this,"_jqs_pending",!0)}else o.call(this)})},i.fn.sparkline.defaults=r(),i.sparkline_display_visible=function(){var t,e,n,r=[];for(e=0,n=M.length;e<n;e++)t=M[e][0],i(t).is(":visible")&&!i(t).parents().is(":hidden")?(M[e][1].call(t),i.data(M[e][0],"_jqs_pending",!1),r.push(e)):!i(t).closest("html").length&&!i.data(t,"_jqs_pending")&&(i.data(M[e][0],"_jqs_pending",!1),r.push(e));for(e=r.length;e;e--)M.splice(r[e-1],1)},i.fn.sparkline.options=o({init:function(t,e){var n,r,o,s;this.userOptions=e=e||{},this.tag=t,this.tagValCache={},r=i.fn.sparkline.defaults,o=r.common,this.tagOptionsPrefix=e.enableTagOptions&&(e.tagOptionsPrefix||o.tagOptionsPrefix),s=this.getTagSetting("type"),n=s===L?r[e.type||o.type]:r[s],this.mergedOptions=i.extend({},o,n,e)},getTagSetting:function(t){var e,i,r,o,s=this.tagOptionsPrefix;if(!1===s||s===n)return L;if(this.tagValCache.hasOwnProperty(t))e=this.tagValCache.key;else{if((e=this.tag.getAttribute(s+t))===n||null===e)e=L;else if("["===e.substr(0,1))for(e=e.substr(1,e.length-2).split(","),i=e.length;i--;)e[i]=c(e[i].replace(/(^\s*)|(\s*$)/g,""));else if("{"===e.substr(0,1))for(r=e.substr(1,e.length-2).split(","),e={},i=r.length;i--;)o=r[i].split(":",2),e[o[0].replace(/(^\s*)|(\s*$)/g,"")]=c(o[1].replace(/(^\s*)|(\s*$)/g,""));else e=c(e);this.tagValCache.key=e}return e},get:function(t,e){var i,r=this.getTagSetting(t);return r!==L?r:(i=this.mergedOptions[t])===n?e:i}}),i.fn.sparkline._base=o({disabled:!1,init:function(t,e,r,o,s){this.el=t,this.$el=i(t),this.values=e,this.options=r,this.width=o,this.height=s,this.currentRegion=n},initTarget:function(){var t=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return!this.disabled||(this.el.innerHTML="",!1)},getRegion:function(t,e){},setRegionHighlight:function(t,e,i){var r,o=this.currentRegion,s=!this.options.get("disableHighlight");return e>this.canvasWidth||i>this.canvasHeight||e<0||i<0?null:(r=this.getRegion(t,e,i),o!==r&&(o!==n&&s&&this.removeHighlight(),this.currentRegion=r,r!==n&&s&&this.renderHighlight(),!0))},clearRegionHighlight:function(){return this.currentRegion!==n&&(this.removeHighlight(),this.currentRegion=n,!0)},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(t){},getCurrentRegionTooltip:function(){var t,e,r,o,a,l,c,h,u,d,f,p,m,g,y=this.options,v="",b=[];if(this.currentRegion===n)return"";if(t=this.getCurrentRegionFields(),f=y.get("tooltipFormatter"))return f(this,y,t);if(y.get("tooltipChartTitle")&&(v+='<div class="jqs jqstitle">'+y.get("tooltipChartTitle")+"</div>\n"),!(e=this.options.get("tooltipFormat")))return"";if(i.isArray(e)||(e=[e]),i.isArray(t)||(t=[t]),c=this.options.get("tooltipFormatFieldlist"),h=this.options.get("tooltipFormatFieldlistKey"),c&&h){for(u=[],l=t.length;l--;)d=t[l][h],-1!=(g=i.inArray(d,c))&&(u[g]=t[l]);t=u}for(r=e.length,m=t.length,l=0;l<r;l++)for(p=e[l],"string"==typeof p&&(p=new s(p)),o=p.fclass||"jqsfield",g=0;g<m;g++)t[g].isNull&&y.get("tooltipSkipNull")||(i.extend(t[g],{prefix:y.get("tooltipPrefix"),suffix:y.get("tooltipSuffix")}),a=p.render(t[g],y.get("tooltipValueLookups"),y),b.push('<div class="'+o+'">'+a+"</div>"));return b.length?v+b.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,n){var i,r,o,s,l=n.get("highlightColor"),c=n.get("highlightLighten");if(l)return l;if(c&&(i=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t))){for(o=[],r=4===t.length?16:1,s=0;s<3;s++)o[s]=a(e.round(parseInt(i[s+1],16)*r*c),0,255);return"rgb("+o.join(",")+")"}return t}}),w={changeHighlight:function(t){var e,n=this.currentRegion,r=this.target,o=this.regionShapes[n];o&&(e=this.renderRegion(n,t),i.isArray(e)||i.isArray(o)?(r.replaceWithShapes(o,e),this.regionShapes[n]=i.map(e,function(t){return t.id})):(r.replaceWithShape(o,e),this.regionShapes[n]=e.id))},render:function(){var t,e,n,r,o=this.values,s=this.target,a=this.regionShapes;if(this.cls._super.render.call(this)){for(n=o.length;n--;)if(t=this.renderRegion(n))if(i.isArray(t)){for(e=[],r=t.length;r--;)t[r].append(),e.push(t[r].id);a[n]=e}else t.append(),a[n]=t.id;else a[n]=null;s.render()}}},i.fn.sparkline.line=x=o(i.fn.sparkline._base,{type:"line",init:function(t,e,n,i,r){x._super.init.call(this,t,e,n,i,r),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(t,e,i){var r,o=this.regionMap;for(r=o.length;r--;)if(null!==o[r]&&e>=o[r][0]&&e<=o[r][1])return o[r][2];return n},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:null===this.yvalues[t],x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t,e,i=this.currentRegion,r=this.target,o=this.vertices[i],s=this.options,a=s.get("spotRadius"),l=s.get("highlightSpotColor"),c=s.get("highlightLineColor");o&&(a&&l&&(t=r.drawCircle(o[0],o[1],a,n,l),this.highlightSpotId=t.id,r.insertAfterShape(this.lastShapeId,t)),c&&(e=r.drawLine(o[0],this.canvasTop,o[0],this.canvasTop+this.canvasHeight,c),this.highlightLineId=e.id,r.insertAfterShape(this.lastShapeId,e)))},removeHighlight:function(){var t=this.target;this.highlightSpotId&&(t.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(t.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var t,n,i,r,o,s=this.values,a=s.length,l=this.xvalues,c=this.yvalues,h=this.yminmax;for(t=0;t<a;t++)n=s[t],i="string"==typeof s[t],r="object"==typeof s[t]&&s[t]instanceof Array,o=i&&s[t].split(":"),i&&2===o.length?(l.push(Number(o[0])),c.push(Number(o[1])),h.push(Number(o[1]))):r?(l.push(n[0]),c.push(n[1]),h.push(n[1])):(l.push(t),null===s[t]||"null"===s[t]?c.push(null):(c.push(Number(n)),h.push(Number(n))));this.options.get("xvalues")&&(l=this.options.get("xvalues")),this.maxy=this.maxyorg=e.max.apply(e,h),this.miny=this.minyorg=e.min.apply(e,h),this.maxx=e.max.apply(e,l),this.minx=e.min.apply(e,l),this.xvalues=l,this.yvalues=c,this.yminmax=h},processRangeOptions:function(){var t=this.options,e=t.get("normalRangeMin"),i=t.get("normalRangeMax");e!==n&&(e<this.miny&&(this.miny=e),i>this.maxy&&(this.maxy=i)),t.get("chartRangeMin")!==n&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)&&(this.miny=t.get("chartRangeMin")),t.get("chartRangeMax")!==n&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)&&(this.maxy=t.get("chartRangeMax")),t.get("chartRangeMinX")!==n&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)&&(this.minx=t.get("chartRangeMinX")),t.get("chartRangeMaxX")!==n&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)&&(this.maxx=t.get("chartRangeMaxX"))},drawNormalRange:function(t,i,r,o,s){var a=this.options.get("normalRangeMin"),l=this.options.get("normalRangeMax"),c=i+e.round(r-r*((l-this.miny)/s)),h=e.round(r*(l-a)/s);this.target.drawRect(t,c,o,h,n,this.options.get("normalRangeColor")).append()},
render:function(){var t,r,o,s,a,l,c,h,u,d,f,p,m,g,v,b,w,C,_,S,N,E,T,R,k,A=this.options,O=this.target,D=this.canvasWidth,I=this.canvasHeight,M=this.vertices,L=A.get("spotRadius"),B=this.regionMap;if(x._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),T=this.xvalues,R=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(s=a=0,t=this.maxx-this.minx==0?1:this.maxx-this.minx,r=this.maxy-this.miny==0?1:this.maxy-this.miny,o=this.yvalues.length-1,L&&(D<4*L||I<4*L)&&(L=0),L&&(N=A.get("highlightSpotColor")&&!A.get("disableInteraction"),(N||A.get("minSpotColor")||A.get("spotColor")&&R[o]===this.miny)&&(I-=e.ceil(L)),(N||A.get("maxSpotColor")||A.get("spotColor")&&R[o]===this.maxy)&&(I-=e.ceil(L),s+=e.ceil(L)),(N||(A.get("minSpotColor")||A.get("maxSpotColor"))&&(R[0]===this.miny||R[0]===this.maxy))&&(a+=e.ceil(L),D-=e.ceil(L)),(N||A.get("spotColor")||A.get("minSpotColor")||A.get("maxSpotColor")&&(R[o]===this.miny||R[o]===this.maxy))&&(D-=e.ceil(L))),I--,A.get("normalRangeMin")!==n&&!A.get("drawNormalOnTop")&&this.drawNormalRange(a,s,I,D,r),c=[],h=[c],g=v=null,b=R.length,k=0;k<b;k++)u=T[k],f=T[k+1],d=R[k],p=a+e.round((u-this.minx)*(D/t)),m=k<b-1?a+e.round((f-this.minx)*(D/t)):D,v=p+(m-p)/2,B[k]=[g||0,v,k],g=v,null===d?k&&(null!==R[k-1]&&(c=[],h.push(c)),M.push(null)):(d<this.miny&&(d=this.miny),d>this.maxy&&(d=this.maxy),c.length||c.push([p,s+I]),l=[p,s+e.round(I-I*((d-this.miny)/r))],c.push(l),M.push(l));for(w=[],C=[],_=h.length,k=0;k<_;k++)c=h[k],c.length&&(A.get("fillColor")&&(c.push([c[c.length-1][0],s+I]),C.push(c.slice(0)),c.pop()),c.length>2&&(c[0]=[c[0][0],c[1][1]]),w.push(c));for(_=C.length,k=0;k<_;k++)O.drawShape(C[k],A.get("fillColor"),A.get("fillColor")).append();for(A.get("normalRangeMin")!==n&&A.get("drawNormalOnTop")&&this.drawNormalRange(a,s,I,D,r),_=w.length,k=0;k<_;k++)O.drawShape(w[k],A.get("lineColor"),n,A.get("lineWidth")).append();if(L&&A.get("valueSpots"))for(S=A.get("valueSpots"),S.get===n&&(S=new y(S)),k=0;k<b;k++)(E=S.get(R[k]))&&O.drawCircle(a+e.round((T[k]-this.minx)*(D/t)),s+e.round(I-I*((R[k]-this.miny)/r)),L,n,E).append();L&&A.get("spotColor")&&null!==R[o]&&O.drawCircle(a+e.round((T[T.length-1]-this.minx)*(D/t)),s+e.round(I-I*((R[o]-this.miny)/r)),L,n,A.get("spotColor")).append(),this.maxy!==this.minyorg&&(L&&A.get("minSpotColor")&&(u=T[i.inArray(this.minyorg,R)],O.drawCircle(a+e.round((u-this.minx)*(D/t)),s+e.round(I-I*((this.minyorg-this.miny)/r)),L,n,A.get("minSpotColor")).append()),L&&A.get("maxSpotColor")&&(u=T[i.inArray(this.maxyorg,R)],O.drawCircle(a+e.round((u-this.minx)*(D/t)),s+e.round(I-I*((this.maxyorg-this.miny)/r)),L,n,A.get("maxSpotColor")).append())),this.lastShapeId=O.getLastShapeId(),this.canvasTop=s,O.render()}}}),i.fn.sparkline.bar=C=o(i.fn.sparkline._base,w,{type:"bar",init:function(t,r,o,s,l){var d,f,p,m,g,v,b,w,x,_,S,N,E,T,R,k,A,O,D,I,M,L,B=parseInt(o.get("barWidth"),10),P=parseInt(o.get("barSpacing"),10),H=o.get("chartRangeMin"),z=o.get("chartRangeMax"),W=o.get("chartRangeClip"),j=1/0,F=-1/0;for(C._super.init.call(this,t,r,o,s,l),v=0,b=r.length;v<b;v++)I=r[v],d="string"==typeof I&&I.indexOf(":")>-1,(d||i.isArray(I))&&(R=!0,d&&(I=r[v]=h(I.split(":"))),I=u(I,null),f=e.min.apply(e,I),p=e.max.apply(e,I),f<j&&(j=f),p>F&&(F=p));this.stacked=R,this.regionShapes={},this.barWidth=B,this.barSpacing=P,this.totalBarWidth=B+P,this.width=s=r.length*B+(r.length-1)*P,this.initTarget(),W&&(E=H===n?-1/0:H,T=z===n?1/0:z),g=[],m=R?[]:g;var q=[],V=[];for(v=0,b=r.length;v<b;v++)if(R)for(k=r[v],r[v]=D=[],q[v]=0,m[v]=V[v]=0,A=0,O=k.length;A<O;A++)null!==(I=D[A]=W?a(k[A],E,T):k[A])&&(I>0&&(q[v]+=I),j<0&&F>0?I<0?V[v]+=e.abs(I):m[v]+=I:m[v]+=e.abs(I-(I<0?F:j)),g.push(I));else I=W?a(r[v],E,T):r[v],null!==(I=r[v]=c(I))&&g.push(I);this.max=N=e.max.apply(e,g),this.min=S=e.min.apply(e,g),this.stackMax=F=R?e.max.apply(e,q):N,this.stackMin=j=R?e.min.apply(e,g):S,o.get("chartRangeMin")!==n&&(o.get("chartRangeClip")||o.get("chartRangeMin")<S)&&(S=o.get("chartRangeMin")),o.get("chartRangeMax")!==n&&(o.get("chartRangeClip")||o.get("chartRangeMax")>N)&&(N=o.get("chartRangeMax")),this.zeroAxis=x=o.get("zeroAxis",!0),_=S<=0&&N>=0&&x?0:0==x?S:S>0?S:N,this.xaxisOffset=_,w=R?e.max.apply(e,m)+e.max.apply(e,V):N-S,this.canvasHeightEf=x&&S<0?this.canvasHeight-2:this.canvasHeight-1,S<_?(L=R&&N>=0?F:N,(M=(L-_)/w*this.canvasHeight)!==e.ceil(M)&&(this.canvasHeightEf-=2,M=e.ceil(M))):M=this.canvasHeight,this.yoffset=M,i.isArray(o.get("colorMap"))?(this.colorMapByIndex=o.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=o.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===n&&(this.colorMapByValue=new y(this.colorMapByValue))),this.range=w},getRegion:function(t,i,r){var o=e.floor(i/this.totalBarWidth);return o<0||o>=this.values.length?n:o},getCurrentRegionFields:function(){var t,e,n=this.currentRegion,i=m(this.values[n]),r=[];for(e=i.length;e--;)t=i[e],r.push({isNull:null===t,value:t,color:this.calcColor(e,t,n),offset:n});return r},calcColor:function(t,e,r){var o,s,a=this.colorMapByIndex,l=this.colorMapByValue,c=this.options;return o=this.stacked?c.get("stackedBarColor"):e<0?c.get("negBarColor"):c.get("barColor"),0===e&&c.get("zeroColor")!==n&&(o=c.get("zeroColor")),l&&(s=l.get(e))?o=s:a&&a.length>r&&(o=a[r]),i.isArray(o)?o[t%o.length]:o},renderRegion:function(t,r){var o,s,a,l,c,h,u,d,p,m,g=this.values[t],y=this.options,v=this.xaxisOffset,b=[],w=this.range,x=this.stacked,C=this.target,_=t*this.totalBarWidth,S=this.canvasHeightEf,N=this.yoffset;if(g=i.isArray(g)?g:[g],u=g.length,d=g[0],l=f(null,g),m=f(v,g,!0),l)return y.get("nullColor")?(a=r?y.get("nullColor"):this.calcHighlightColor(y.get("nullColor"),y),o=N>0?N-1:N,C.drawRect(_,o,this.barWidth-1,0,a,a)):n;for(c=N,h=0;h<u;h++){if(d=g[h],x&&d===v){if(!m||p)continue;p=!0}s=w>0?e.floor(S*(e.abs(d-v)/w))+1:1,d<v||d===v&&0===N?(o=c,c+=s):(o=N-s,N-=s),a=this.calcColor(h,d,t),r&&(a=this.calcHighlightColor(a,y)),b.push(C.drawRect(_,o,this.barWidth-1,s-1,a,a))}return 1===b.length?b[0]:b}}),i.fn.sparkline.tristate=_=o(i.fn.sparkline._base,w,{type:"tristate",init:function(t,e,r,o,s){var a=parseInt(r.get("barWidth"),10),l=parseInt(r.get("barSpacing"),10);_._super.init.call(this,t,e,r,o,s),this.regionShapes={},this.barWidth=a,this.barSpacing=l,this.totalBarWidth=a+l,this.values=i.map(e,Number),this.width=o=e.length*a+(e.length-1)*l,i.isArray(r.get("colorMap"))?(this.colorMapByIndex=r.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=r.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===n&&(this.colorMapByValue=new y(this.colorMapByValue))),this.initTarget()},getRegion:function(t,n,i){return e.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,e){var n,i=this.values,r=this.options,o=this.colorMapByIndex,s=this.colorMapByValue;return s&&(n=s.get(t))?n:o&&o.length>e?o[e]:i[e]<0?r.get("negBarColor"):i[e]>0?r.get("posBarColor"):r.get("zeroBarColor")},renderRegion:function(t,n){var i,r,o,s,a,l,c=this.values,h=this.options,u=this.target;if(i=u.pixelHeight,o=e.round(i/2),s=t*this.totalBarWidth,c[t]<0?(a=o,r=o-1):c[t]>0?(a=0,r=o-1):(a=o-1,r=2),l=this.calcColor(c[t],t),null!==l)return n&&(l=this.calcHighlightColor(l,h)),u.drawRect(s,a,this.barWidth-1,r-1,l,l)}}),i.fn.sparkline.discrete=S=o(i.fn.sparkline._base,w,{type:"discrete",init:function(t,r,o,s,a){S._super.init.call(this,t,r,o,s,a),this.regionShapes={},this.values=r=i.map(r,Number),this.min=e.min.apply(e,r),this.max=e.max.apply(e,r),this.range=this.max-this.min,this.width=s="auto"===o.get("width")?2*r.length:this.width,this.interval=e.floor(s/r.length),this.itemWidth=s/r.length,o.get("chartRangeMin")!==n&&(o.get("chartRangeClip")||o.get("chartRangeMin")<this.min)&&(this.min=o.get("chartRangeMin")),o.get("chartRangeMax")!==n&&(o.get("chartRangeClip")||o.get("chartRangeMax")>this.max)&&(this.max=o.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===o.get("lineHeight")?e.round(.3*this.canvasHeight):o.get("lineHeight"))},getRegion:function(t,n,i){return e.floor(n/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],offset:t}},renderRegion:function(t,n){var i,r,o,s,l=this.values,c=this.options,h=this.min,u=this.max,d=this.range,f=this.interval,p=this.target,m=this.canvasHeight,g=this.lineHeight,y=m-g;return r=a(l[t],h,u),s=t*f,i=e.round(y-y*((r-h)/d)),o=c.get("thresholdColor")&&r<c.get("thresholdValue")?c.get("thresholdColor"):c.get("lineColor"),n&&(o=this.calcHighlightColor(o,c)),p.drawLine(s,i,s,i+g,o)}}),i.fn.sparkline.bullet=N=o(i.fn.sparkline._base,{type:"bullet",init:function(t,i,r,o,s){var a,l,c;N._super.init.call(this,t,i,r,o,s),this.values=i=h(i),c=i.slice(),c[0]=null===c[0]?c[2]:c[0],c[1]=null===i[1]?c[2]:c[1],a=e.min.apply(e,i),l=e.max.apply(e,i),a=r.get("base")===n?a<0?a:0:r.get("base"),this.min=a,this.max=l,this.range=l-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=o="auto"===r.get("width")?"4.0em":o,this.target=this.$el.simpledraw(o,s,r.get("composite")),i.length||(this.disabled=!0),this.initTarget()},getRegion:function(t,e,i){var r=this.target.getShapeAt(t,e,i);return r!==n&&this.shapes[r]!==n?this.shapes[r]:n},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var e,n=this.currentRegion,i=this.valueShapes[n];switch(delete this.shapes[i],n.substr(0,1)){case"r":e=this.renderRange(n.substr(1),t);break;case"p":e=this.renderPerformance(t);break;case"t":e=this.renderTarget(t)}this.valueShapes[n]=e.id,this.shapes[e.id]=n,this.target.replaceWithShape(i,e)},renderRange:function(t,n){var i=this.values[t],r=e.round(this.canvasWidth*((i-this.min)/this.range)),o=this.options.get("rangeColors")[t-2];return n&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(0,0,r-1,this.canvasHeight-1,o,o)},renderPerformance:function(t){var n=this.values[1],i=e.round(this.canvasWidth*((n-this.min)/this.range)),r=this.options.get("performanceColor");return t&&(r=this.calcHighlightColor(r,this.options)),this.target.drawRect(0,e.round(.3*this.canvasHeight),i-1,e.round(.4*this.canvasHeight)-1,r,r)},renderTarget:function(t){var n=this.values[0],i=e.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),r=e.round(.1*this.canvasHeight),o=this.canvasHeight-2*r,s=this.options.get("targetColor");return t&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(i,r,this.options.get("targetWidth")-1,o-1,s,s)},render:function(){var t,e,n=this.values.length,i=this.target;if(N._super.render.call(this)){for(t=2;t<n;t++)e=this.renderRange(t).append(),this.shapes[e.id]="r"+t,this.valueShapes["r"+t]=e.id;null!==this.values[1]&&(e=this.renderPerformance().append(),this.shapes[e.id]="p1",this.valueShapes.p1=e.id),null!==this.values[0]&&(e=this.renderTarget().append(),this.shapes[e.id]="t0",this.valueShapes.t0=e.id),i.render()}}}),i.fn.sparkline.pie=E=o(i.fn.sparkline._base,{type:"pie",init:function(t,n,r,o,s){var a,l=0;if(E._super.init.call(this,t,n,r,o,s),this.shapes={},this.valueShapes={},this.values=n=i.map(n,Number),"auto"===r.get("width")&&(this.width=this.height),n.length>0)for(a=n.length;a--;)l+=n[a];this.total=l,this.initTarget(),this.radius=e.floor(e.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,e,i){var r=this.target.getShapeAt(t,e,i);return r!==n&&this.shapes[r]!==n?this.shapes[r]:n},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],percent:this.values[t]/this.total*100,color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var e=this.currentRegion,n=this.renderSlice(e,t),i=this.valueShapes[e];delete this.shapes[i],this.target.replaceWithShape(i,n),this.valueShapes[e]=n.id,this.shapes[n.id]=e},renderSlice:function(t,i){var r,o,s,a,l,c=this.target,h=this.options,u=this.radius,d=h.get("borderWidth"),f=h.get("offset"),p=2*e.PI,m=this.values,g=this.total,y=f?2*e.PI*(f/360):0;for(a=m.length,s=0;s<a;s++){if(r=y,o=y,g>0&&(o=y+p*(m[s]/g)),t===s)return l=h.get("sliceColors")[s%h.get("sliceColors").length],i&&(l=this.calcHighlightColor(l,h)),c.drawPieSlice(u,u,u-d,r,o,n,l);y=o}},render:function(){var t,i,r=this.target,o=this.values,s=this.options,a=this.radius,l=s.get("borderWidth");if(E._super.render.call(this)){for(l&&r.drawCircle(a,a,e.floor(a-l/2),s.get("borderColor"),n,l).append(),i=o.length;i--;)o[i]&&(t=this.renderSlice(i).append(),this.valueShapes[i]=t.id,this.shapes[t.id]=i);r.render()}}}),i.fn.sparkline.box=T=o(i.fn.sparkline._base,{type:"box",init:function(t,e,n,r,o){T._super.init.call(this,t,e,n,r,o),this.values=i.map(e,Number),this.width="auto"===n.get("width")?"4.0em":r,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==n&&t.push({field:"lo",value:this.loutlier}),this.routlier!==n&&t.push({field:"ro",value:this.routlier}),this.lwhisker!==n&&t.push({field:"lw",value:this.lwhisker}),this.rwhisker!==n&&t.push({field:"rw",value:this.rwhisker}),t},render:function(){var t,i,r,o,s,a,c,h,u,d,f,p=this.target,m=this.values,g=m.length,y=this.options,v=this.canvasWidth,b=this.canvasHeight,w=y.get("chartRangeMin")===n?e.min.apply(e,m):y.get("chartRangeMin"),x=y.get("chartRangeMax")===n?e.max.apply(e,m):y.get("chartRangeMax"),C=0;if(T._super.render.call(this)){if(y.get("raw"))y.get("showOutliers")&&m.length>5?(i=m[0],t=m[1],o=m[2],s=m[3],a=m[4],c=m[5],h=m[6]):(t=m[0],o=m[1],s=m[2],a=m[3],c=m[4]);else if(m.sort(function(t,e){return t-e}),o=l(m,1),s=l(m,2),a=l(m,3),r=a-o,y.get("showOutliers")){for(t=c=n,u=0;u<g;u++)t===n&&m[u]>o-r*y.get("outlierIQR")&&(t=m[u]),m[u]<a+r*y.get("outlierIQR")&&(c=m[u]);i=m[0],h=m[g-1]}else t=m[0],c=m[g-1];this.quartiles=[o,s,a],this.lwhisker=t,this.rwhisker=c,this.loutlier=i,this.routlier=h,f=v/(x-w+1),y.get("showOutliers")&&(C=e.ceil(y.get("spotRadius")),v-=2*e.ceil(y.get("spotRadius")),f=v/(x-w+1),i<t&&p.drawCircle((i-w)*f+C,b/2,y.get("spotRadius"),y.get("outlierLineColor"),y.get("outlierFillColor")).append(),h>c&&p.drawCircle((h-w)*f+C,b/2,y.get("spotRadius"),y.get("outlierLineColor"),y.get("outlierFillColor")).append()),p.drawRect(e.round((o-w)*f+C),e.round(.1*b),e.round((a-o)*f),e.round(.8*b),y.get("boxLineColor"),y.get("boxFillColor")).append(),p.drawLine(e.round((t-w)*f+C),e.round(b/2),e.round((o-w)*f+C),e.round(b/2),y.get("lineColor")).append(),p.drawLine(e.round((t-w)*f+C),e.round(b/4),e.round((t-w)*f+C),e.round(b-b/4),y.get("whiskerColor")).append(),p.drawLine(e.round((c-w)*f+C),e.round(b/2),e.round((a-w)*f+C),e.round(b/2),y.get("lineColor")).append(),p.drawLine(e.round((c-w)*f+C),e.round(b/4),e.round((c-w)*f+C),e.round(b-b/4),y.get("whiskerColor")).append(),p.drawLine(e.round((s-w)*f+C),e.round(.1*b),e.round((s-w)*f+C),e.round(.9*b),y.get("medianColor")).append(),y.get("target")&&(d=e.ceil(y.get("spotRadius")),p.drawLine(e.round((y.get("target")-w)*f+C),e.round(b/2-d),e.round((y.get("target")-w)*f+C),e.round(b/2+d),y.get("targetColor")).append(),p.drawLine(e.round((y.get("target")-w)*f+C-d),e.round(b/2),e.round((y.get("target")-w)*f+C+d),e.round(b/2),y.get("targetColor")).append()),p.render()}}}),A=o({init:function(t,e,n,i){this.target=t,this.id=e,this.type=n,this.args=i},append:function(){return this.target.appendShape(this),this}}),O=o({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,e,n){t&&(this.width=t,this.height=e,this.target=n,this.lastShapeId=null,n[0]&&(n=n[0]),i.data(n,"_jqs_vcanvas",this))},drawLine:function(t,e,n,i,r,o){return this.drawShape([[t,e],[n,i]],r,o)},drawShape:function(t,e,n,i){return this._genShape("Shape",[t,e,n,i])},drawCircle:function(t,e,n,i,r,o){return this._genShape("Circle",[t,e,n,i,r,o])},drawPieSlice:function(t,e,n,i,r,o,s){return this._genShape("PieSlice",[t,e,n,i,r,o,s])},drawRect:function(t,e,n,i,r,o){return this._genShape("Rect",[t,e,n,i,r,o])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,e){i(e).html(t)},_calculatePixelDims:function(t,e,n){var r;r=this._pxregex.exec(e),this.pixelHeight=r?r[1]:i(n).height(),r=this._pxregex.exec(t),this.pixelWidth=r?r[1]:i(n).width()},_genShape:function(t,e){var n=B++;return e.unshift(n),new A(this,n,t,e)},appendShape:function(t){alert("appendShape not implemented")},replaceWithShape:function(t,e){alert("replaceWithShape not implemented")},insertAfterShape:function(t,e){alert("insertAfterShape not implemented")},removeShapeId:function(t){alert("removeShapeId not implemented")},getShapeAt:function(t,e,n){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),D=o(O,{init:function(e,r,o,s){D._super.init.call(this,e,r,o),this.canvas=t.createElement("canvas"),o[0]&&(o=o[0]),i.data(o,"_jqs_vcanvas",this),i(this.canvas).css({display:"inline-block",width:e,height:r,verticalAlign:"top"}),this._insert(this.canvas,o),this._calculatePixelDims(e,r,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=s,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=n,i(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,e,i){var r=this.canvas.getContext("2d");return t!==n&&(r.strokeStyle=t),r.lineWidth=i===n?1:i,e!==n&&(r.fillStyle=e),r},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=n},_drawShape:function(t,e,i,r,o){var s,a,l=this._getContext(i,r,o);for(l.beginPath(),l.moveTo(e[0][0]+.5,e[0][1]+.5),s=1,a=e.length;s<a;s++)l.lineTo(e[s][0]+.5,e[s][1]+.5);i!==n&&l.stroke(),r!==n&&l.fill(),this.targetX!==n&&this.targetY!==n&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawCircle:function(t,i,r,o,s,a,l){var c=this._getContext(s,a,l);c.beginPath(),c.arc(i,r,o,0,2*e.PI,!1),this.targetX!==n&&this.targetY!==n&&c.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t),s!==n&&c.stroke(),a!==n&&c.fill()},_drawPieSlice:function(t,e,i,r,o,s,a,l){var c=this._getContext(a,l);c.beginPath(),c.moveTo(e,i),c.arc(e,i,r,o,s,!1),c.lineTo(e,i),c.closePath(),a!==n&&c.stroke(),l&&c.fill(),this.targetX!==n&&this.targetY!==n&&c.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawRect:function(t,e,n,i,r,o,s){return this._drawShape(t,[[e,n],[e+i,n],[e+i,n+r],[e,n+r],[e,n]],o,s)},appendShape:function(t){return this.shapes[t.id]=t,this.shapeseq.push(t.id),this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var n,i=this.shapeseq;for(this.shapes[e.id]=e,n=i.length;n--;)i[n]==t&&(i[n]=e.id);delete this.shapes[t]},replaceWithShapes:function(t,e){var n,i,r,o=this.shapeseq,s={};for(i=t.length;i--;)s[t[i]]=!0;for(i=o.length;i--;)n=o[i],s[n]&&(o.splice(i,1),delete this.shapes[n],r=i);for(i=e.length;i--;)o.splice(r,0,e[i].id),this.shapes[e[i].id]=e[i]},insertAfterShape:function(t,e){var n,i=this.shapeseq;for(n=i.length;n--;)if(i[n]===t)return i.splice(n+1,0,e.id),void(this.shapes[e.id]=e)},removeShapeId:function(t){var e,n=this.shapeseq;for(e=n.length;e--;)if(n[e]===t){n.splice(e,1);break}delete this.shapes[t]},getShapeAt:function(t,e,n){return this.targetX=e,this.targetY=n,this.render(),this.currentTargetShapeId},render:function(){var t,e,n,i=this.shapeseq,r=this.shapes,o=i.length,s=this._getContext();for(s.clearRect(0,0,this.pixelWidth,this.pixelHeight),n=0;n<o;n++)t=i[n],e=r[t],this["_draw"+e.type].apply(this,e.args);this.interact||(this.shapes={},this.shapeseq=[])}}),I=o(O,{init:function(e,n,r){var o;I._super.init.call(this,e,n,r),r[0]&&(r=r[0]),i.data(r,"_jqs_vcanvas",this),this.canvas=t.createElement("span"),i(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:e,height:n,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,r),this._calculatePixelDims(e,n,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,o='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",o),this.group=i(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(t,e,i,r,o){var s,a,l,c,h,u,d=[];for(u=0,h=e.length;u<h;u++)d[u]=e[u][0]+","+e[u][1];return s=d.splice(0,1),o=o===n?1:o,a=i===n?' stroked="false" ':' strokeWeight="'+o+'px" strokeColor="'+i+'" ',l=r===n?' filled="false"':' fillColor="'+r+'" filled="true" ',c=d[0]===d[d.length-1]?"x ":"",'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+a+l+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+s+" l "+d.join(", ")+" "+c+'e"> </v:shape>'},_drawCircle:function(t,e,i,r,o,s,a){var l,c;return e-=r,i-=r,l=o===n?' stroked="false" ':' strokeWeight="'+a+'px" strokeColor="'+o+'" ',c=s===n?' filled="false"':' fillColor="'+s+'" filled="true" ','<v:oval  id="jqsshape'+t+'" '+l+c+' style="position:absolute;top:'+i+"px; left:"+e+"px; width:"+2*r+"px; height:"+2*r+'px"></v:oval>'},_drawPieSlice:function(t,i,r,o,s,a,l,c){var h,u,d,f,p,m,g;if(s===a)return"";if(a-s==2*e.PI&&(s=0,a=2*e.PI),u=i+e.round(e.cos(s)*o),d=r+e.round(e.sin(s)*o),f=i+e.round(e.cos(a)*o),p=r+e.round(e.sin(a)*o),u===f&&d===p){if(a-s<e.PI)return"";u=f=i+o,d=p=r}return u===f&&d===p&&a-s<e.PI?"":(h=[i-o,r-o,i+o,r+o,u,d,f,p],m=l===n?' stroked="false" ':' strokeWeight="1px" strokeColor="'+l+'" ',g=c===n?' filled="false"':' fillColor="'+c+'" filled="true" ','<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+m+g+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+i+","+r+" wa "+h.join(", ")+' x e"> </v:shape>')},_drawRect:function(t,e,n,i,r,o,s){return this._drawShape(t,[[e,n],[e,n+r],[e+i,n+r],[e+i,n],[e,n]],o,s)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var e=this["_draw"+t.type].apply(this,t.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",e):this.prerender+=e,this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var n=i("#jqsshape"+t),r=this["_draw"+e.type].apply(this,e.args);n[0].outerHTML=r},replaceWithShapes:function(t,e){var n,r=i("#jqsshape"+t[0]),o="",s=e.length;for(n=0;n<s;n++)o+=this["_draw"+e[n].type].apply(this,e[n].args);for(r[0].outerHTML=o,n=1;n<t.length;n++)i("#jqsshape"+t[n]).remove()},insertAfterShape:function(t,e){var n=i("#jqsshape"+t),r=this["_draw"+e.type].apply(this,e.args);n[0].insertAdjacentHTML("afterEnd",r)},removeShapeId:function(t){var e=i("#jqsshape"+t);this.group.removeChild(e[0])},getShapeAt:function(t,e,n){return t.id.substr(8)},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})}(document,Math),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){"use strict";function t(){return Un.apply(null,arguments)}function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function i(t,e){var n,i=[];for(n=0;n<t.length;++n)i.push(e(t[n],n));return i}function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function o(t,e){for(var n in e)r(e,n)&&(t[n]=e[n]);return r(e,"toString")&&(t.toString=e.toString),r(e,"valueOf")&&(t.valueOf=e.valueOf),t}function s(t,e,n,i){return Rt(t,e,n,i,!0).utc()}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function l(t){return null==t._pf&&(t._pf=a()),t._pf}function c(t){if(null==t._isValid){var e=l(t);t._isValid=!(isNaN(t._d.getTime())||!(e.overflow<0)||e.empty||e.invalidMonth||e.invalidWeekday||e.nullInput||e.invalidFormat||e.userInvalidated),t._strict&&(t._isValid=t._isValid&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour)}return t._isValid}function h(t){var e=s(NaN);return null!=t?o(l(e),t):l(e).userInvalidated=!0,e}function u(t){return void 0===t}function d(t,e){var n,i,r;if(u(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),u(e._i)||(t._i=e._i),u(e._f)||(t._f=e._f),u(e._l)||(t._l=e._l),u(e._strict)||(t._strict=e._strict),u(e._tzm)||(t._tzm=e._tzm),u(e._isUTC)||(t._isUTC=e._isUTC),u(e._offset)||(t._offset=e._offset),u(e._pf)||(t._pf=l(e)),u(e._locale)||(t._locale=e._locale),Gn.length>0)for(n in Gn)i=Gn[n],r=e[i],u(r)||(t[i]=r);return t}function f(e){d(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),!1===Xn&&(Xn=!0,t.updateOffset(this),Xn=!1)}function p(t){return t instanceof f||null!=t&&null!=t._isAMomentObject}function m(t){return 0>t?Math.ceil(t):Math.floor(t)}function g(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=m(e)),n}function y(t,e,n){var i,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),s=0;for(i=0;r>i;i++)(n&&t[i]!==e[i]||!n&&g(t[i])!==g(e[i]))&&s++;return s+o}function v(){}function b(t){return t?t.toLowerCase().replace("_","-"):t}function w(t){for(var e,n,i,r,o=0;o<t.length;){for(r=b(t[o]).split("-"),e=r.length,n=b(t[o+1]),n=n?n.split("-"):null;e>0;){if(i=x(r.slice(0,e).join("-")))return i;if(n&&n.length>=e&&y(r,n,!0)>=e-1)break;e--}o++}return null}function x(t){var e=null;if(!Kn[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=Yn._abbr,require("./locale/"+t),C(e)}catch(t){}return Kn[t]}function C(t,e){var n;return t&&(n=u(e)?S(t):_(t,e))&&(Yn=n),Yn._abbr}function _(t,e){return null!==e?(e.abbr=t,Kn[t]=Kn[t]||new v,Kn[t].set(e),C(t),Kn[t]):(delete Kn[t],null)}function S(t){var n;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Yn;if(!e(t)){if(n=x(t))return n;t=[t]}return w(t)}function N(t,e){var n=t.toLowerCase();Qn[n]=Qn[n+"s"]=Qn[e]=t}function E(t){return"string"==typeof t?Qn[t]||Qn[t.toLowerCase()]:void 0}function T(t){var e,n,i={};for(n in t)r(t,n)&&(e=E(n))&&(i[e]=t[n]);return i}function R(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function k(e,n){return function(i){return null!=i?(O(this,e,i),t.updateOffset(this,n),this):A(this,e)}}function A(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function O(t,e,n){t.isValid()&&t._d["set"+(t._isUTC?"UTC":"")+e](n)}function D(t,e){var n;if("object"==typeof t)for(n in t)this.set(n,t[n]);else if(t=E(t),R(this[t]))return this[t](e);return this}function I(t,e,n){var i=""+Math.abs(t),r=e-i.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function M(t,e,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),t&&(ei[t]=r),e&&(ei[e[0]]=function(){return I(r.apply(this,arguments),e[1],e[2])}),n&&(ei[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function L(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function B(t){var e,n,i=t.match(Zn);for(e=0,n=i.length;n>e;e++)ei[i[e]]?i[e]=ei[i[e]]:i[e]=L(i[e]);return function(r){var o="";for(e=0;n>e;e++)o+=i[e]instanceof Function?i[e].call(r,t):i[e];return o}}function P(t,e){return t.isValid()?(e=H(e,t.localeData()),ti[e]=ti[e]||B(e),ti[e](t)):t.localeData().invalidDate()}function H(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(Jn.lastIndex=0;i>=0&&Jn.test(t);)t=t.replace(Jn,n),Jn.lastIndex=0,i-=1;return t}function z(t,e,n){bi[t]=R(e)?e:function(t,i){return t&&n?n:e}}function W(t,e){return r(bi,t)?bi[t](e._strict,e._locale):new RegExp(j(t))}function j(t){return F(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r}))}function F(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function q(t,e){var n,i=e;for("string"==typeof t&&(t=[t]),"number"==typeof e&&(i=function(t,n){n[e]=g(t)}),n=0;n<t.length;n++)wi[t[n]]=i}function V(t,e){q(t,function(t,n,i,r){i._w=i._w||{},e(t,i._w,i,r)})}function $(t,e,n){null!=e&&r(wi,t)&&wi[t](e,n._a,n,t)}function U(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function Y(t,n){return e(this._months)?this._months[t.month()]:this._months[Ai.test(n)?"format":"standalone"][t.month()]}function G(t,n){return e(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Ai.test(n)?"format":"standalone"][t.month()]}function X(t,e,n){var i,r,o;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(r=s([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(n&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function K(t,e){var n;return t.isValid()?"string"==typeof e&&"number"!=typeof(e=t.localeData().monthsParse(e))?t:(n=Math.min(t.date(),U(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t):t}function Q(e){return null!=e?(K(this,e),t.updateOffset(this,!0),this):A(this,"Month")}function Z(){return U(this.year(),this.month())}function J(t){return this._monthsParseExact?(r(this,"_monthsRegex")||et.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex}function tt(t){return this._monthsParseExact?(r(this,"_monthsRegex")||et.call(this),t?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex}function et(){function t(t,e){return e.length-t.length}var e,n,i=[],r=[],o=[];for(e=0;12>e;e++)n=s([2e3,e]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(i.sort(t),r.sort(t),o.sort(t),e=0;12>e;e++)i[e]=F(i[e]),r[e]=F(r[e]),o[e]=F(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")$","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")$","i")}function nt(t){var e,n=t._a;return n&&-2===l(t).overflow&&(e=n[Ci]<0||n[Ci]>11?Ci:n[_i]<1||n[_i]>U(n[xi],n[Ci])?_i:n[Si]<0||n[Si]>24||24===n[Si]&&(0!==n[Ni]||0!==n[Ei]||0!==n[Ti])?Si:n[Ni]<0||n[Ni]>59?Ni:n[Ei]<0||n[Ei]>59?Ei:n[Ti]<0||n[Ti]>999?Ti:-1,l(t)._overflowDayOfYear&&(xi>e||e>_i)&&(e=_i),l(t)._overflowWeeks&&-1===e&&(e=Ri),l(t)._overflowWeekday&&-1===e&&(e=ki),l(t).overflow=e),t}function it(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function rt(t,e){var n=!0;return o(function(){return n&&(it(t+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),n=!1),e.apply(this,arguments)},e)}function ot(t,e){Li[t]||(it(e),Li[t]=!0)}function st(t){var e,n,i,r,o,s,a=t._i,c=Bi.exec(a)||Pi.exec(a);if(c){for(l(t).iso=!0,e=0,n=zi.length;n>e;e++)if(zi[e][1].exec(c[1])){r=zi[e][0],i=!1!==zi[e][2];break}if(null==r)return void(t._isValid=!1);if(c[3]){for(e=0,n=Wi.length;n>e;e++)if(Wi[e][1].exec(c[3])){o=(c[2]||" ")+Wi[e][0];break}if(null==o)return void(t._isValid=!1)}if(!i&&null!=o)return void(t._isValid=!1);if(c[4]){
if(!Hi.exec(c[4]))return void(t._isValid=!1);s="Z"}t._f=r+(o||"")+(s||""),xt(t)}else t._isValid=!1}function at(e){var n=ji.exec(e._i);return null!==n?void(e._d=new Date(+n[1])):(st(e),void(!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e))))}function lt(t,e,n,i,r,o,s){var a=new Date(t,e,n,i,r,o,s);return 100>t&&t>=0&&isFinite(a.getFullYear())&&a.setFullYear(t),a}function ct(t){var e=new Date(Date.UTC.apply(null,arguments));return 100>t&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function ht(t){return ut(t)?366:365}function ut(t){return t%4==0&&t%100!=0||t%400==0}function dt(){return ut(this.year())}function ft(t,e,n){var i=7+e-n;return-(7+ct(t,0,i).getUTCDay()-e)%7+i-1}function pt(t,e,n,i,r){var o,s,a=(7+n-i)%7,l=ft(t,i,r),c=1+7*(e-1)+a+l;return 0>=c?(o=t-1,s=ht(o)+c):c>ht(t)?(o=t+1,s=c-ht(t)):(o=t,s=c),{year:o,dayOfYear:s}}function mt(t,e,n){var i,r,o=ft(t.year(),e,n),s=Math.floor((t.dayOfYear()-o-1)/7)+1;return 1>s?(r=t.year()-1,i=s+gt(r,e,n)):s>gt(t.year(),e,n)?(i=s-gt(t.year(),e,n),r=t.year()+1):(r=t.year(),i=s),{week:i,year:r}}function gt(t,e,n){var i=ft(t,e,n),r=ft(t+1,e,n);return(ht(t)-i+r)/7}function yt(t,e,n){return null!=t?t:null!=e?e:n}function vt(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function bt(t){var e,n,i,r,o=[];if(!t._d){for(i=vt(t),t._w&&null==t._a[_i]&&null==t._a[Ci]&&wt(t),t._dayOfYear&&(r=yt(t._a[xi],i[xi]),t._dayOfYear>ht(r)&&(l(t)._overflowDayOfYear=!0),n=ct(r,0,t._dayOfYear),t._a[Ci]=n.getUTCMonth(),t._a[_i]=n.getUTCDate()),e=0;3>e&&null==t._a[e];++e)t._a[e]=o[e]=i[e];for(;7>e;e++)t._a[e]=o[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[Si]&&0===t._a[Ni]&&0===t._a[Ei]&&0===t._a[Ti]&&(t._nextDay=!0,t._a[Si]=0),t._d=(t._useUTC?ct:lt).apply(null,o),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Si]=24)}}function wt(t){var e,n,i,r,o,s,a,c;e=t._w,null!=e.GG||null!=e.W||null!=e.E?(o=1,s=4,n=yt(e.GG,t._a[xi],mt(kt(),1,4).year),i=yt(e.W,1),(1>(r=yt(e.E,1))||r>7)&&(c=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,n=yt(e.gg,t._a[xi],mt(kt(),o,s).year),i=yt(e.w,1),null!=e.d?(0>(r=e.d)||r>6)&&(c=!0):null!=e.e?(r=e.e+o,(e.e<0||e.e>6)&&(c=!0)):r=o),1>i||i>gt(n,o,s)?l(t)._overflowWeeks=!0:null!=c?l(t)._overflowWeekday=!0:(a=pt(n,i,r,o,s),t._a[xi]=a.year,t._dayOfYear=a.dayOfYear)}function xt(e){if(e._f===t.ISO_8601)return void st(e);e._a=[],l(e).empty=!0;var n,i,r,o,s,a=""+e._i,c=a.length,h=0;for(r=H(e._f,e._locale).match(Zn)||[],n=0;n<r.length;n++)o=r[n],i=(a.match(W(o,e))||[])[0],i&&(s=a.substr(0,a.indexOf(i)),s.length>0&&l(e).unusedInput.push(s),a=a.slice(a.indexOf(i)+i.length),h+=i.length),ei[o]?(i?l(e).empty=!1:l(e).unusedTokens.push(o),$(o,i,e)):e._strict&&!i&&l(e).unusedTokens.push(o);l(e).charsLeftOver=c-h,a.length>0&&l(e).unusedInput.push(a),!0===l(e).bigHour&&e._a[Si]<=12&&e._a[Si]>0&&(l(e).bigHour=void 0),e._a[Si]=Ct(e._locale,e._a[Si],e._meridiem),bt(e),nt(e)}function Ct(t,e,n){var i;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?(i=t.isPM(n),i&&12>e&&(e+=12),i||12!==e||(e=0),e):e}function _t(t){var e,n,i,r,s;if(0===t._f.length)return l(t).invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)s=0,e=d({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],xt(e),c(e)&&(s+=l(e).charsLeftOver,s+=10*l(e).unusedTokens.length,l(e).score=s,(null==i||i>s)&&(i=s,n=e));o(t,n||e)}function St(t){if(!t._d){var e=T(t._i);t._a=i([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),bt(t)}}function Nt(t){var e=new f(nt(Et(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Et(t){var i=t._i,r=t._f;return t._locale=t._locale||S(t._l),null===i||void 0===r&&""===i?h({nullInput:!0}):("string"==typeof i&&(t._i=i=t._locale.preparse(i)),p(i)?new f(nt(i)):(e(r)?_t(t):r?xt(t):n(i)?t._d=i:Tt(t),c(t)||(t._d=null),t))}function Tt(r){var o=r._i;void 0===o?r._d=new Date(t.now()):n(o)?r._d=new Date(+o):"string"==typeof o?at(r):e(o)?(r._a=i(o.slice(0),function(t){return parseInt(t,10)}),bt(r)):"object"==typeof o?St(r):"number"==typeof o?r._d=new Date(o):t.createFromInputFallback(r)}function Rt(t,e,n,i,r){var o={};return"boolean"==typeof n&&(i=n,n=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,Nt(o)}function kt(t,e,n,i){return Rt(t,e,n,i,!1)}function At(t,n){var i,r;if(1===n.length&&e(n[0])&&(n=n[0]),!n.length)return kt();for(i=n[0],r=1;r<n.length;++r)(!n[r].isValid()||n[r][t](i))&&(i=n[r]);return i}function Ot(){return At("isBefore",[].slice.call(arguments,0))}function Dt(){return At("isAfter",[].slice.call(arguments,0))}function It(t){var e=T(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||0,s=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,h=e.millisecond||0;this._milliseconds=+h+1e3*c+6e4*l+36e5*a,this._days=+s+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=S(),this._bubble()}function Mt(t){return t instanceof It}function Lt(t,e){M(t,0,0,function(){var t=this.utcOffset(),n="+";return 0>t&&(t=-t,n="-"),n+I(~~(t/60),2)+e+I(~~t%60,2)})}function Bt(t,e){var n=(e||"").match(t)||[],i=n[n.length-1]||[],r=(i+"").match(Ui)||["-",0,0],o=60*r[1]+g(r[2]);return"+"===r[0]?o:-o}function Pt(e,i){var r,o;return i._isUTC?(r=i.clone(),o=(p(e)||n(e)?+e:+kt(e))-+r,r._d.setTime(+r._d+o),t.updateOffset(r,!1),r):kt(e).local()}function Ht(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function zt(e,n){var i,r=this._offset||0;return this.isValid()?null!=e?("string"==typeof e?e=Bt(gi,e):Math.abs(e)<16&&(e*=60),!this._isUTC&&n&&(i=Ht(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?ee(this,Kt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Ht(this):null!=e?this:NaN}function Wt(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jt(t){return this.utcOffset(0,t)}function Ft(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Ht(this),"m")),this}function qt(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Bt(mi,this._i)),this}function Vt(t){return!!this.isValid()&&(t=t?kt(t).utcOffset():0,(this.utcOffset()-t)%60==0)}function $t(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ut(){if(!u(this._isDSTShifted))return this._isDSTShifted;var t={};if(d(t,this),t=Et(t),t._a){var e=t._isUTC?s(t._a):kt(t._a);this._isDSTShifted=this.isValid()&&y(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Yt(){return!!this.isValid()&&!this._isUTC}function Gt(){return!!this.isValid()&&this._isUTC}function Xt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Kt(t,e){var n,i,o,s=t,a=null;return Mt(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(s={},e?s[e]=t:s.milliseconds=t):(a=Yi.exec(t))?(n="-"===a[1]?-1:1,s={y:0,d:g(a[_i])*n,h:g(a[Si])*n,m:g(a[Ni])*n,s:g(a[Ei])*n,ms:g(a[Ti])*n}):(a=Gi.exec(t))?(n="-"===a[1]?-1:1,s={y:Qt(a[2],n),M:Qt(a[3],n),d:Qt(a[4],n),h:Qt(a[5],n),m:Qt(a[6],n),s:Qt(a[7],n),w:Qt(a[8],n)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(o=Jt(kt(s.from),kt(s.to)),s={},s.ms=o.milliseconds,s.M=o.months),i=new It(s),Mt(t)&&r(t,"_locale")&&(i._locale=t._locale),i}function Qt(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Zt(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Jt(t,e){var n;return t.isValid()&&e.isValid()?(e=Pt(e,t),t.isBefore(e)?n=Zt(t,e):(n=Zt(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function te(t,e){return function(n,i){var r,o;return null===i||isNaN(+i)||(ot(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),o=n,n=i,i=o),n="string"==typeof n?+n:n,r=Kt(n,i),ee(this,r,t),this}}function ee(e,n,i,r){var o=n._milliseconds,s=n._days,a=n._months;e.isValid()&&(r=null==r||r,o&&e._d.setTime(+e._d+o*i),s&&O(e,"Date",A(e,"Date")+s*i),a&&K(e,A(e,"Month")+a*i),r&&t.updateOffset(e,s||a))}function ne(t,e){var n=t||kt(),i=Pt(n,this).startOf("day"),r=this.diff(i,"days",!0),o=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse",s=e&&(R(e[o])?e[o]():e[o]);return this.format(s||this.localeData().calendar(o,this,kt(n)))}function ie(){return new f(this)}function re(t,e){var n=p(t)?t:kt(t);return!(!this.isValid()||!n.isValid())&&(e=E(u(e)?"millisecond":e),"millisecond"===e?+this>+n:+n<+this.clone().startOf(e))}function oe(t,e){var n=p(t)?t:kt(t);return!(!this.isValid()||!n.isValid())&&(e=E(u(e)?"millisecond":e),"millisecond"===e?+n>+this:+this.clone().endOf(e)<+n)}function se(t,e,n){return this.isAfter(t,n)&&this.isBefore(e,n)}function ae(t,e){var n,i=p(t)?t:kt(t);return!(!this.isValid()||!i.isValid())&&(e=E(e||"millisecond"),"millisecond"===e?+this==+i:(n=+i,+this.clone().startOf(e)<=n&&n<=+this.clone().endOf(e)))}function le(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function ce(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function he(t,e,n){var i,r,o,s;return this.isValid()?(i=Pt(t,this),i.isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),e=E(e),"year"===e||"month"===e||"quarter"===e?(s=ue(this,i),"quarter"===e?s/=3:"year"===e&&(s/=12)):(o=this-i,s="second"===e?o/1e3:"minute"===e?o/6e4:"hour"===e?o/36e5:"day"===e?(o-r)/864e5:"week"===e?(o-r)/6048e5:o),n?s:m(s)):NaN):NaN}function ue(t,e){var n,i,r=12*(e.year()-t.year())+(e.month()-t.month()),o=t.clone().add(r,"months");return 0>e-o?(n=t.clone().add(r-1,"months"),i=(e-o)/(o-n)):(n=t.clone().add(r+1,"months"),i=(e-o)/(n-o)),-(r+i)}function de(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function fe(){var t=this.clone().utc();return 0<t.year()&&t.year()<=9999?R(Date.prototype.toISOString)?this.toDate().toISOString():P(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):P(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function pe(e){var n=P(this,e||t.defaultFormat);return this.localeData().postformat(n)}function me(t,e){return this.isValid()&&(p(t)&&t.isValid()||kt(t).isValid())?Kt({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ge(t){return this.from(kt(),t)}function ye(t,e){return this.isValid()&&(p(t)&&t.isValid()||kt(t).isValid())?Kt({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ve(t){return this.to(kt(),t)}function be(t){var e;return void 0===t?this._locale._abbr:(e=S(t),null!=e&&(this._locale=e),this)}function we(){return this._locale}function xe(t){switch(t=E(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this}function Ce(t){return t=E(t),void 0===t||"millisecond"===t?this:this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")}function _e(){return+this._d-6e4*(this._offset||0)}function Se(){return Math.floor(+this/1e3)}function Ne(){return this._offset?new Date(+this):this._d}function Ee(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Te(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Re(){return this.isValid()?this.toISOString():"null"}function ke(){return c(this)}function Ae(){return o({},l(this))}function Oe(){return l(this).overflow}function De(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ie(t,e){M(0,[t,t.length],0,e)}function Me(t){return He.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Le(t){return He.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Be(){return gt(this.year(),1,4)}function Pe(){var t=this.localeData()._week;return gt(this.year(),t.dow,t.doy)}function He(t,e,n,i,r){var o;return null==t?mt(this,i,r).year:(o=gt(t,i,r),e>o&&(e=o),ze.call(this,t,e,n,i,r))}function ze(t,e,n,i,r){var o=pt(t,e,n,i,r),s=ct(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function We(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}function je(t){return mt(t,this._week.dow,this._week.doy).week}function Fe(){return this._week.dow}function qe(){return this._week.doy}function Ve(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function $e(t){var e=mt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function Ue(t,e){return"string"!=typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"==typeof t?t:null):parseInt(t,10)}function Ye(t,n){return e(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(n)?"format":"standalone"][t.day()]}function Ge(t){return this._weekdaysShort[t.day()]}function Xe(t){return this._weekdaysMin[t.day()]}function Ke(t,e,n){var i,r,o;for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;7>i;i++){if(r=kt([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[i].test(t))return i;if(n&&"ddd"===e&&this._shortWeekdaysParse[i].test(t))return i;if(n&&"dd"===e&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function Qe(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=Ue(t,this.localeData()),this.add(t-e,"d")):e}function Ze(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function Je(t){return this.isValid()?null==t?this.day()||7:this.day(this.day()%7?t:t-7):null!=t?this:NaN}function tn(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}function en(){return this.hours()%12||12}function nn(t,e){M(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function rn(t,e){return e._meridiemParse}function on(t){return"p"===(t+"").toLowerCase().charAt(0)}function sn(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}function an(t,e){e[Ti]=g(1e3*("0."+t))}function ln(){return this._isUTC?"UTC":""}function cn(){return this._isUTC?"Coordinated Universal Time":""}function hn(t){return kt(1e3*t)}function un(){return kt.apply(null,arguments).parseZone()}function dn(t,e,n){var i=this._calendar[t];return R(i)?i.call(e,n):i}function fn(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])}function pn(){return this._invalidDate}function mn(t){return this._ordinal.replace("%d",t)}function gn(t){return t}function yn(t,e,n,i){var r=this._relativeTime[n];return R(r)?r(t,e,n,i):r.replace(/%d/i,t)}function vn(t,e){var n=this._relativeTime[t>0?"future":"past"];return R(n)?n(e):n.replace(/%s/i,e)}function bn(t){var e,n;for(n in t)e=t[n],R(e)?this[n]=e:this["_"+n]=e;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function wn(t,e,n,i){var r=S(),o=s().set(i,e);return r[n](o,t)}function xn(t,e,n,i,r){if("number"==typeof t&&(e=t,t=void 0),t=t||"",null!=e)return wn(t,e,n,r);var o,s=[];for(o=0;i>o;o++)s[o]=wn(t,o,n,r);return s}function Cn(t,e){return xn(t,e,"months",12,"month")}function _n(t,e){return xn(t,e,"monthsShort",12,"month")}function Sn(t,e){return xn(t,e,"weekdays",7,"day")}function Nn(t,e){return xn(t,e,"weekdaysShort",7,"day")}function En(t,e){return xn(t,e,"weekdaysMin",7,"day")}function Tn(){var t=this._data;return this._milliseconds=gr(this._milliseconds),this._days=gr(this._days),this._months=gr(this._months),t.milliseconds=gr(t.milliseconds),t.seconds=gr(t.seconds),t.minutes=gr(t.minutes),t.hours=gr(t.hours),t.months=gr(t.months),t.years=gr(t.years),this}function Rn(t,e,n,i){var r=Kt(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function kn(t,e){return Rn(this,t,e,1)}function An(t,e){return Rn(this,t,e,-1)}function On(t){return 0>t?Math.floor(t):Math.ceil(t)}function Dn(){var t,e,n,i,r,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||0>=o&&0>=s&&0>=a||(o+=864e5*On(Mn(a)+s),s=0,a=0),l.milliseconds=o%1e3,t=m(o/1e3),l.seconds=t%60,e=m(t/60),l.minutes=e%60,n=m(e/60),l.hours=n%24,s+=m(n/24),r=m(In(s)),a+=r,s-=On(Mn(r)),i=m(a/12),a%=12,l.days=s,l.months=a,l.years=i,this}function In(t){return 4800*t/146097}function Mn(t){return 146097*t/4800}function Ln(t){var e,n,i=this._milliseconds;if("month"===(t=E(t))||"year"===t)return e=this._days+i/864e5,n=this._months+In(e),"month"===t?n:n/12;switch(e=this._days+Math.round(Mn(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}}function Bn(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)}function Pn(t){return function(){return this.as(t)}}function Hn(t){return t=E(t),this[t+"s"]()}function zn(t){return function(){return this._data[t]}}function Wn(){return m(this.days()/7)}function jn(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function Fn(t,e,n){var i=Kt(t).abs(),r=Dr(i.as("s")),o=Dr(i.as("m")),s=Dr(i.as("h")),a=Dr(i.as("d")),l=Dr(i.as("M")),c=Dr(i.as("y")),h=r<Ir.s&&["s",r]||1>=o&&["m"]||o<Ir.m&&["mm",o]||1>=s&&["h"]||s<Ir.h&&["hh",s]||1>=a&&["d"]||a<Ir.d&&["dd",a]||1>=l&&["M"]||l<Ir.M&&["MM",l]||1>=c&&["y"]||["yy",c];return h[2]=e,h[3]=+t>0,h[4]=n,jn.apply(null,h)}function qn(t,e){return void 0!==Ir[t]&&(void 0===e?Ir[t]:(Ir[t]=e,!0))}function Vn(t){var e=this.localeData(),n=Fn(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)}function $n(){var t,e,n,i=Mr(this._milliseconds)/1e3,r=Mr(this._days),o=Mr(this._months);t=m(i/60),e=m(t/60),i%=60,t%=60,n=m(o/12),o%=12;var s=n,a=o,l=r,c=e,h=t,u=i,d=this.asSeconds();return d?(0>d?"-":"")+"P"+(s?s+"Y":"")+(a?a+"M":"")+(l?l+"D":"")+(c||h||u?"T":"")+(c?c+"H":"")+(h?h+"M":"")+(u?u+"S":""):"P0D"}var Un,Yn,Gn=t.momentProperties=[],Xn=!1,Kn={},Qn={},Zn=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Jn=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ti={},ei={},ni=/\d/,ii=/\d\d/,ri=/\d{3}/,oi=/\d{4}/,si=/[+-]?\d{6}/,ai=/\d\d?/,li=/\d\d\d\d?/,ci=/\d\d\d\d\d\d?/,hi=/\d{1,3}/,ui=/\d{1,4}/,di=/[+-]?\d{1,6}/,fi=/\d+/,pi=/[+-]?\d+/,mi=/Z|[+-]\d\d:?\d\d/gi,gi=/Z|[+-]\d\d(?::?\d\d)?/gi,yi=/[+-]?\d+(\.\d{1,3})?/,vi=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,bi={},wi={},xi=0,Ci=1,_i=2,Si=3,Ni=4,Ei=5,Ti=6,Ri=7,ki=8;M("M",["MM",2],"Mo",function(){return this.month()+1}),M("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),M("MMMM",0,0,function(t){return this.localeData().months(this,t)}),N("month","M"),z("M",ai),z("MM",ai,ii),z("MMM",function(t,e){return e.monthsShortRegex(t)}),z("MMMM",function(t,e){return e.monthsRegex(t)}),q(["M","MM"],function(t,e){e[Ci]=g(t)-1}),q(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);null!=r?e[Ci]=r:l(n).invalidMonth=t});var Ai=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Oi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Di="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ii=vi,Mi=vi,Li={};t.suppressDeprecationWarnings=!1;var Bi=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Pi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Hi=/Z|[+-]\d\d(?::?\d\d)?/,zi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Wi=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ji=/^\/?Date\((\-?\d+)/i;t.createFromInputFallback=rt("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),M("Y",0,0,function(){var t=this.year();return 9999>=t?""+t:"+"+t}),M(0,["YY",2],0,function(){return this.year()%100}),M(0,["YYYY",4],0,"year"),M(0,["YYYYY",5],0,"year"),M(0,["YYYYYY",6,!0],0,"year"),N("year","y"),z("Y",pi),z("YY",ai,ii),z("YYYY",ui,oi),z("YYYYY",di,si),z("YYYYYY",di,si),q(["YYYYY","YYYYYY"],xi),q("YYYY",function(e,n){n[xi]=2===e.length?t.parseTwoDigitYear(e):g(e)}),q("YY",function(e,n){n[xi]=t.parseTwoDigitYear(e)}),q("Y",function(t,e){e[xi]=parseInt(t,10)}),t.parseTwoDigitYear=function(t){return g(t)+(g(t)>68?1900:2e3)};var Fi=k("FullYear",!1);t.ISO_8601=function(){};var qi=rt("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var t=kt.apply(null,arguments);return this.isValid()&&t.isValid()?this>t?this:t:h()}),Vi=rt("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var t=kt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:h()}),$i=function(){return Date.now?Date.now():+new Date};Lt("Z",":"),Lt("ZZ",""),z("Z",gi),z("ZZ",gi),q(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Bt(gi,t)});var Ui=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Yi=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,Gi=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Kt.fn=It.prototype;var Xi=te(1,"add"),Ki=te(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Qi=rt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});M(0,["gg",2],0,function(){return this.weekYear()%100}),M(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ie("gggg","weekYear"),Ie("ggggg","weekYear"),Ie("GGGG","isoWeekYear"),Ie("GGGGG","isoWeekYear"),N("weekYear","gg"),N("isoWeekYear","GG"),z("G",pi),z("g",pi),z("GG",ai,ii),z("gg",ai,ii),z("GGGG",ui,oi),z("gggg",ui,oi),z("GGGGG",di,si),z("ggggg",di,si),V(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=g(t)}),V(["gg","GG"],function(e,n,i,r){n[r]=t.parseTwoDigitYear(e)}),M("Q",0,"Qo","quarter"),N("quarter","Q"),z("Q",ni),q("Q",function(t,e){e[Ci]=3*(g(t)-1)}),M("w",["ww",2],"wo","week"),M("W",["WW",2],"Wo","isoWeek"),N("week","w"),N("isoWeek","W"),z("w",ai),z("ww",ai,ii),z("W",ai),z("WW",ai,ii),V(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=g(t)});var Zi={dow:0,doy:6};M("D",["DD",2],"Do","date"),N("date","D"),z("D",ai),z("DD",ai,ii),z("Do",function(t,e){return t?e._ordinalParse:e._ordinalParseLenient}),q(["D","DD"],_i),q("Do",function(t,e){e[_i]=g(t.match(ai)[0],10)});var Ji=k("Date",!0);M("d",0,"do","day"),M("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),M("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),M("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),M("e",0,0,"weekday"),M("E",0,0,"isoWeekday"),N("day","d"),N("weekday","e"),N("isoWeekday","E"),z("d",ai),z("e",ai),z("E",ai),z("dd",vi),z("ddd",vi),z("dddd",vi),V(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);null!=r?e.d=r:l(n).invalidWeekday=t}),V(["d","e","E"],function(t,e,n,i){e[i]=g(t)});var tr="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),er="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),nr="Su_Mo_Tu_We_Th_Fr_Sa".split("_");M("DDD",["DDDD",3],"DDDo","dayOfYear"),N("dayOfYear","DDD"),z("DDD",hi),z("DDDD",ri),q(["DDD","DDDD"],function(t,e,n){n._dayOfYear=g(t)}),M("H",["HH",2],0,"hour"),M("h",["hh",2],0,en),M("hmm",0,0,function(){return""+en.apply(this)+I(this.minutes(),2)}),M("hmmss",0,0,function(){return""+en.apply(this)+I(this.minutes(),2)+I(this.seconds(),2)}),M("Hmm",0,0,function(){return""+this.hours()+I(this.minutes(),2)}),M("Hmmss",0,0,function(){return""+this.hours()+I(this.minutes(),2)+I(this.seconds(),2)}),nn("a",!0),nn("A",!1),N("hour","h"),z("a",rn),z("A",rn),z("H",ai),z("h",ai),z("HH",ai,ii),z("hh",ai,ii),z("hmm",li),z("hmmss",ci),z("Hmm",li),z("Hmmss",ci),q(["H","HH"],Si),q(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),q(["h","hh"],function(t,e,n){e[Si]=g(t),l(n).bigHour=!0}),q("hmm",function(t,e,n){var i=t.length-2;e[Si]=g(t.substr(0,i)),e[Ni]=g(t.substr(i)),l(n).bigHour=!0}),q("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Si]=g(t.substr(0,i)),e[Ni]=g(t.substr(i,2)),e[Ei]=g(t.substr(r)),l(n).bigHour=!0}),q("Hmm",function(t,e,n){var i=t.length-2;e[Si]=g(t.substr(0,i)),e[Ni]=g(t.substr(i))}),q("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Si]=g(t.substr(0,i)),e[Ni]=g(t.substr(i,2)),e[Ei]=g(t.substr(r))});var ir=/[ap]\.?m?\.?/i,rr=k("Hours",!0);M("m",["mm",2],0,"minute"),N("minute","m"),z("m",ai),z("mm",ai,ii),q(["m","mm"],Ni);var or=k("Minutes",!1);M("s",["ss",2],0,"second"),N("second","s"),z("s",ai),z("ss",ai,ii),q(["s","ss"],Ei);var sr=k("Seconds",!1);M("S",0,0,function(){return~~(this.millisecond()/100)}),M(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),M(0,["SSS",3],0,"millisecond"),M(0,["SSSS",4],0,function(){return 10*this.millisecond()}),M(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),M(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),M(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),M(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),M(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),N("millisecond","ms"),z("S",hi,ni),z("SS",hi,ii),z("SSS",hi,ri);var ar;for(ar="SSSS";ar.length<=9;ar+="S")z(ar,fi);for(ar="S";ar.length<=9;ar+="S")q(ar,an);var lr=k("Milliseconds",!1);M("z",0,0,"zoneAbbr"),M("zz",0,0,"zoneName");var cr=f.prototype;cr.add=Xi,cr.calendar=ne,cr.clone=ie,cr.diff=he,cr.endOf=Ce,cr.format=pe,cr.from=me,cr.fromNow=ge,cr.to=ye,cr.toNow=ve,cr.get=D,cr.invalidAt=Oe,cr.isAfter=re,cr.isBefore=oe,cr.isBetween=se,cr.isSame=ae,cr.isSameOrAfter=le,cr.isSameOrBefore=ce,cr.isValid=ke,cr.lang=Qi,cr.locale=be,cr.localeData=we,cr.max=Vi,cr.min=qi,cr.parsingFlags=Ae,cr.set=D,cr.startOf=xe,cr.subtract=Ki,cr.toArray=Ee,cr.toObject=Te,cr.toDate=Ne,cr.toISOString=fe,cr.toJSON=Re,cr.toString=de,cr.unix=Se,cr.valueOf=_e,cr.creationData=De,cr.year=Fi,cr.isLeapYear=dt,cr.weekYear=Me,cr.isoWeekYear=Le,cr.quarter=cr.quarters=We,cr.month=Q,cr.daysInMonth=Z,cr.week=cr.weeks=Ve,cr.isoWeek=cr.isoWeeks=$e,cr.weeksInYear=Pe,cr.isoWeeksInYear=Be,cr.date=Ji,cr.day=cr.days=Qe,cr.weekday=Ze,cr.isoWeekday=Je,cr.dayOfYear=tn,cr.hour=cr.hours=rr,cr.minute=cr.minutes=or,cr.second=cr.seconds=sr,cr.millisecond=cr.milliseconds=lr,cr.utcOffset=zt,cr.utc=jt,cr.local=Ft,cr.parseZone=qt,cr.hasAlignedHourOffset=Vt,cr.isDST=$t,cr.isDSTShifted=Ut,cr.isLocal=Yt,cr.isUtcOffset=Gt,cr.isUtc=Xt,cr.isUTC=Xt,cr.zoneAbbr=ln,cr.zoneName=cn,cr.dates=rt("dates accessor is deprecated. Use date instead.",Ji),cr.months=rt("months accessor is deprecated. Use month instead",Q),cr.years=rt("years accessor is deprecated. Use year instead",Fi),cr.zone=rt("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Wt);var hr=cr,ur={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},dr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},fr=/\d{1,2}/,pr={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},mr=v.prototype;mr._calendar=ur,mr.calendar=dn,mr._longDateFormat=dr,mr.longDateFormat=fn,mr._invalidDate="Invalid date",mr.invalidDate=pn,mr._ordinal="%d",mr.ordinal=mn,mr._ordinalParse=fr,mr.preparse=gn,mr.postformat=gn,mr._relativeTime=pr,mr.relativeTime=yn,mr.pastFuture=vn,mr.set=bn,mr.months=Y,mr._months=Oi,mr.monthsShort=G,mr._monthsShort=Di,mr.monthsParse=X,mr._monthsRegex=Mi,mr.monthsRegex=tt,mr._monthsShortRegex=Ii,mr.monthsShortRegex=J,mr.week=je,mr._week=Zi,mr.firstDayOfYear=qe,mr.firstDayOfWeek=Fe,mr.weekdays=Ye,mr._weekdays=tr,mr.weekdaysMin=Xe,mr._weekdaysMin=nr,mr.weekdaysShort=Ge,mr._weekdaysShort=er,mr.weekdaysParse=Ke,mr.isPM=on,mr._meridiemParse=ir,mr.meridiem=sn,C("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===g(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),t.lang=rt("moment.lang is deprecated. Use moment.locale instead.",C),t.langData=rt("moment.langData is deprecated. Use moment.localeData instead.",S);var gr=Math.abs,yr=Pn("ms"),vr=Pn("s"),br=Pn("m"),wr=Pn("h"),xr=Pn("d"),Cr=Pn("w"),_r=Pn("M"),Sr=Pn("y"),Nr=zn("milliseconds"),Er=zn("seconds"),Tr=zn("minutes"),Rr=zn("hours"),kr=zn("days"),Ar=zn("months"),Or=zn("years"),Dr=Math.round,Ir={s:45,m:45,h:22,d:26,M:11},Mr=Math.abs,Lr=It.prototype;return Lr.abs=Tn,Lr.add=kn,Lr.subtract=An,Lr.as=Ln,Lr.asMilliseconds=yr,Lr.asSeconds=vr,Lr.asMinutes=br,Lr.asHours=wr,Lr.asDays=xr,Lr.asWeeks=Cr,Lr.asMonths=_r,Lr.asYears=Sr,Lr.valueOf=Bn,Lr._bubble=Dn,Lr.get=Hn,Lr.milliseconds=Nr,Lr.seconds=Er,Lr.minutes=Tr,Lr.hours=Rr,Lr.days=kr,Lr.weeks=Wn,Lr.months=Ar,Lr.years=Or,Lr.humanize=Vn,Lr.toISOString=$n,Lr.toString=$n,Lr.toJSON=$n,Lr.locale=be,Lr.localeData=we,Lr.toIsoString=rt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$n),Lr.lang=Qi,M("X",0,0,"unix"),M("x",0,0,"valueOf"),z("x",pi),z("X",yi),q("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),q("x",function(t,e,n){n._d=new Date(g(t))}),t.version="2.11.2",function(t){Un=t}(kt),t.fn=hr,t.min=Ot,t.max=Dt,t.now=$i,t.utc=s,t.unix=hn,t.months=Cn,t.isDate=n,t.locale=C,t.invalid=h,t.duration=Kt,t.isMoment=p,t.weekdays=Sn,t.parseZone=un,t.localeData=S,t.isDuration=Mt,t.monthsShort=_n,t.weekdaysMin=En,t.defineLocale=_,t.weekdaysShort=Nn,t.normalizeUnits=E,t.relativeTimeThreshold=qn,t.prototype=hr,t}),function(t){
var e,n,i="0.3.4",r="hasOwnProperty",o=/[\.\/]/,s=function(){},a=function(t,e){return t-e},l={n:{}},c=function(t,i){var r,o=n,s=Array.prototype.slice.call(arguments,2),l=c.listeners(t),h=0,u=[],d={},f=[],p=e;e=t,n=0;for(var m=0,g=l.length;m<g;m++)"zIndex"in l[m]&&(u.push(l[m].zIndex),l[m].zIndex<0&&(d[l[m].zIndex]=l[m]));for(u.sort(a);u[h]<0;)if(r=d[u[h++]],f.push(r.apply(i,s)),n)return n=o,f;for(m=0;m<g;m++)if("zIndex"in(r=l[m]))if(r.zIndex==u[h]){if(f.push(r.apply(i,s)),n)break;do{if(h++,(r=d[u[h]])&&f.push(r.apply(i,s)),n)break}while(r)}else d[r.zIndex]=r;else if(f.push(r.apply(i,s)),n)break;return n=o,e=p,f.length?f:null};c.listeners=function(t){var e,n,i,r,s,a,c,h,u=t.split(o),d=l,f=[d],p=[];for(r=0,s=u.length;r<s;r++){for(h=[],a=0,c=f.length;a<c;a++)for(d=f[a].n,n=[d[u[r]],d["*"]],i=2;i--;)(e=n[i])&&(h.push(e),p=p.concat(e.f||[]));f=h}return p},c.on=function(t,e){for(var n=t.split(o),i=l,r=0,a=n.length;r<a;r++)i=i.n,!i[n[r]]&&(i[n[r]]={n:{}}),i=i[n[r]];for(i.f=i.f||[],r=0,a=i.f.length;r<a;r++)if(i.f[r]==e)return s;return i.f.push(e),function(t){+t==+t&&(e.zIndex=+t)}},c.stop=function(){n=1},c.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},c.off=c.unbind=function(t,e){var n,i,s,a,c,h,u,d=t.split(o),f=[l];for(a=0,c=d.length;a<c;a++)for(h=0;h<f.length;h+=s.length-2){if(s=[h,1],n=f[h].n,"*"!=d[a])n[d[a]]&&s.push(n[d[a]]);else for(i in n)n[r](i)&&s.push(n[i]);f.splice.apply(f,s)}for(a=0,c=f.length;a<c;a++)for(n=f[a];n.n;){if(e){if(n.f){for(h=0,u=n.f.length;h<u;h++)if(n.f[h]==e){n.f.splice(h,1);break}!n.f.length&&delete n.f}for(i in n.n)if(n.n[r](i)&&n.n[i].f){var p=n.n[i].f;for(h=0,u=p.length;h<u;h++)if(p[h]==e){p.splice(h,1);break}!p.length&&delete n.n[i].f}}else{delete n.f;for(i in n.n)n.n[r](i)&&n.n[i].f&&delete n.n[i].f}n=n.n}},c.once=function(t,e){var n=function(){var i=e.apply(this,arguments);return c.unbind(t,n),i};return c.on(t,n)},c.version=i,c.toString=function(){return"You are running Eve "+i},"undefined"!=typeof module&&module.exports?module.exports=c:"undefined"!=typeof define?define("eve",[],function(){return c}):t.eve=c}(this),function(){function t(t){for(var e=0;e<oe.length;e++)oe[e].el.paper==t&&oe.splice(e--,1)}function e(t,e,n,r,s,a){n=Q(n);var l,c,h,u,d,f,p=t.ms,m={},g={},v={};if(r)for(x=0,C=oe.length;x<C;x++){var b=oe[x];if(b.el.id==e.id&&b.anim==t){b.percent!=n?(oe.splice(x,1),h=1):c=b,e.attr(b.totalOrigin);break}}else r=+g;for(var x=0,C=t.percents.length;x<C;x++){if(t.percents[x]==n||t.percents[x]>r*t.top){n=t.percents[x],d=t.percents[x-1]||0,p=p/t.top*(n-d),u=t.percents[x+1],l=t.anim[n];break}r&&e.attr(t.anim[t.percents[x]])}if(l){if(c)c.initstatus=r,c.start=new Date-c.ms*r;else{for(var S in l)if(l[_](S)&&(et[_](S)||e.paper.customAttributes[_](S)))switch(m[S]=e.attr(S),null==m[S]&&(m[S]=tt[S]),g[S]=l[S],et[S]){case q:v[S]=(g[S]-m[S])/p;break;case"colour":m[S]=y.getRGB(m[S]);var N=y.getRGB(g[S]);v[S]={r:(N.r-m[S].r)/p,g:(N.g-m[S].g)/p,b:(N.b-m[S].b)/p};break;case"path":var E=Mt(m[S],g[S]),T=E[1];for(m[S]=E[0],v[S]=[],x=0,C=m[S].length;x<C;x++){v[S][x]=[0];for(var k=1,A=m[S][x].length;k<A;k++)v[S][x][k]=(T[x][k]-m[S][x][k])/p}break;case"transform":var O=e._,M=zt(O[S],g[S]);if(M)for(m[S]=M.from,g[S]=M.to,v[S]=[],v[S].real=!0,x=0,C=m[S].length;x<C;x++)for(v[S][x]=[m[S][x][0]],k=1,A=m[S][x].length;k<A;k++)v[S][x][k]=(g[S][x][k]-m[S][x][k])/p;else{var L=e.matrix||new o,B={_:{transform:O.transform},getBBox:function(){return e.getBBox(1)}};m[S]=[L.a,L.b,L.c,L.d,L.e,L.f],Pt(B,g[S]),g[S]=B._.transform,v[S]=[(B.matrix.a-L.a)/p,(B.matrix.b-L.b)/p,(B.matrix.c-L.c)/p,(B.matrix.d-L.d)/p,(B.matrix.e-L.e)/p,(B.matrix.f-L.f)/p]}break;case"csv":var P=D(l[S])[I](w),H=D(m[S])[I](w);if("clip-rect"==S)for(m[S]=H,v[S]=[],x=H.length;x--;)v[S][x]=(P[x]-m[S][x])/p;g[S]=P;break;default:for(P=[][R](l[S]),H=[][R](m[S]),v[S]=[],x=e.paper.customAttributes[S].length;x--;)v[S][x]=((P[x]||0)-(H[x]||0))/p}var z=l.easing,W=y.easing_formulas[z];if(!W)if((W=D(z).match(X))&&5==W.length){var j=W;W=function(t){return i(t,+j[1],+j[2],+j[3],+j[4],p)}}else W=ut;if(f=l.start||t.start||+new Date,b={anim:t,percent:n,timestamp:f,start:f+(t.del||0),status:0,initstatus:r||0,stop:!1,ms:p,easing:W,from:m,diff:v,to:g,el:e,callback:l.callback,prev:d,next:u,repeat:a||t.times,origin:e.attr(),totalOrigin:s},oe.push(b),r&&!c&&!h&&(b.stop=!0,b.start=new Date-p*r,1==oe.length))return ae();h&&(b.start=new Date-b.ms*r),1==oe.length&&se(ae)}eve("raphael.anim.start."+e.id,e,t)}}function n(t,e){var n=[],i={};if(this.ms=e,this.times=1,t){for(var r in t)t[_](r)&&(i[Q(r)]=t[r],n.push(Q(r)));n.sort(ct)}this.anim=i,this.top=n[n.length-1],this.percents=n}function i(t,e,n,i,r,o){function s(t,e){var n,i,r,o,s,u;for(r=t,u=0;u<8;u++){if(o=a(r)-t,W(o)<e)return r;if(s=(3*h*r+2*c)*r+l,W(s)<1e-6)break;r-=o/s}if(n=0,i=1,r=t,r<n)return n;if(r>i)return i;for(;n<i;){if(o=a(r),W(o-t)<e)return r;t>o?n=r:i=r,r=(i-n)/2+n}return r}function a(t){return((h*t+c)*t+l)*t}var l=3*e,c=3*(i-e)-l,h=1-l-c,u=3*n,d=3*(r-n)-u,f=1-u-d;return function(t,e){var n=s(t,e);return((f*n+d)*n+u)*n}(t,1/(200*o))}function r(){return this.x+O+this.y+O+this.width+" × "+this.height}function o(t,e,n,i,r,o){null!=t?(this.a=+t,this.b=+e,this.c=+n,this.d=+i,this.e=+r,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function s(t,e,n){t=y._path2curve(t),e=y._path2curve(e);for(var i,r,o,s,l,c,h,u,d,f,p=n?0:[],m=0,g=t.length;m<g;m++){var v=t[m];if("M"==v[0])i=l=v[1],r=c=v[2];else{"C"==v[0]?(d=[i,r].concat(v.slice(1)),i=d[6],r=d[7]):(d=[i,r,i,r,l,c,l,c],i=l,r=c);for(var b=0,w=e.length;b<w;b++){var x=e[b];if("M"==x[0])o=h=x[1],s=u=x[2];else{"C"==x[0]?(f=[o,s].concat(x.slice(1)),o=f[6],s=f[7]):(f=[o,s,o,s,h,u,h,u],o=h,s=u);var C=a(d,f,n);if(n)p+=C;else{for(var _=0,S=C.length;_<S;_++)C[_].segment1=m,C[_].segment2=b,C[_].bez1=d,C[_].bez2=f;p=p.concat(C)}}}}}return p}function a(t,e,n){var i=y.bezierBBox(t),r=y.bezierBBox(e);if(!y.isBBoxIntersect(i,r))return n?0:[];for(var o=h.apply(0,t),s=h.apply(0,e),a=~~(o/5),c=~~(s/5),u=[],d=[],f={},p=n?0:[],m=0;m<a+1;m++){var g=y.findDotsAtSegment.apply(y,t.concat(m/a));u.push({x:g.x,y:g.y,t:m/a})}for(m=0;m<c+1;m++)g=y.findDotsAtSegment.apply(y,e.concat(m/c)),d.push({x:g.x,y:g.y,t:m/c});for(m=0;m<a;m++)for(var v=0;v<c;v++){var b=u[m],w=u[m+1],x=d[v],C=d[v+1],_=W(w.x-b.x)<.001?"y":"x",S=W(C.x-x.x)<.001?"y":"x",N=l(b.x,b.y,w.x,w.y,x.x,x.y,C.x,C.y);if(N){if(f[N.x.toFixed(4)]==N.y.toFixed(4))continue;f[N.x.toFixed(4)]=N.y.toFixed(4);var E=b.t+W((N[_]-b[_])/(w[_]-b[_]))*(w.t-b.t),T=x.t+W((N[S]-x[S])/(C[S]-x[S]))*(C.t-x.t);E>=0&&E<=1&&T>=0&&T<=1&&(n?p++:p.push({x:N.x,y:N.y,t1:E,t2:T}))}}return p}function l(t,e,n,i,r,o,s,a){if(!(H(t,n)<z(r,s)||z(t,n)>H(r,s)||H(e,i)<z(o,a)||z(e,i)>H(o,a))){var l=(t*i-e*n)*(r-s)-(t-n)*(r*a-o*s),c=(t*i-e*n)*(o-a)-(e-i)*(r*a-o*s),h=(t-n)*(o-a)-(e-i)*(r-s);if(!h)return;var u=l/h,d=c/h,f=+u.toFixed(2),p=+d.toFixed(2);if(f<+z(t,n).toFixed(2)||f>+H(t,n).toFixed(2)||f<+z(r,s).toFixed(2)||f>+H(r,s).toFixed(2)||p<+z(e,i).toFixed(2)||p>+H(e,i).toFixed(2)||p<+z(o,a).toFixed(2)||p>+H(o,a).toFixed(2))return;return{x:u,y:d}}}function c(t,e,n,i,r,o,s,a,l){if(!(l<0||h(t,e,n,i,r,o,s,a)<l)){var c,u=.5,d=1-u;for(c=h(t,e,n,i,r,o,s,a,d);W(c-l)>.01;)u/=2,d+=(c<l?1:-1)*u,c=h(t,e,n,i,r,o,s,a,d);return d}}function h(t,e,n,i,r,o,s,a,l){null==l&&(l=1),l=l>1?1:l<0?0:l;for(var c=l/2,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,p=0;p<12;p++){var m=c*h[p]+c,g=u(m,t,n,r,s),y=u(m,e,i,o,a),v=g*g+y*y;f+=d[p]*P.sqrt(v)}return c*f}function u(t,e,n,i,r){return t*(t*(-3*e+9*n-9*i+3*r)+6*e-12*n+6*i)-3*e+3*n}function d(t,e){for(var n=[],i=0,r=t.length;r-2*!e>i;i+=2){var o=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?r-4==i?o[3]={x:+t[0],y:+t[1]}:r-2==i&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[r-2],y:+t[r-1]}:r-4==i?o[3]=o[2]:i||(o[0]={x:+t[i],y:+t[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}function f(){return this.hex}function p(t,e,n){function i(){var r=Array.prototype.slice.call(arguments,0),o=r.join("␀"),s=i.cache=i.cache||{},a=i.count=i.count||[];return s[_](o)?(m(a,o),n?n(s[o]):s[o]):(a.length>=1e3&&delete s[a.shift()],a.push(o),s[o]=t[T](e,r),n?n(s[o]):s[o])}return i}function m(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function g(t){if(Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[_](n)&&(e[n]=g(t[n]));return e}function y(t){if(y.is(t,"function"))return v?t():eve.on("raphael.DOMload",t);if(y.is(t,$))return y._engine.create[T](y,t.splice(0,3+y.is(t[0],q))).add(t);var e=Array.prototype.slice.call(arguments,0);if(y.is(e[e.length-1],"function")){var n=e.pop();return v?n.call(y._engine.create[T](y,e)):eve.on("raphael.DOMload",function(){n.call(y._engine.create[T](y,e))})}return y._engine.create[T](y,arguments)}y.version="2.1.0",y.eve=eve;var v,b,w=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},C=/\{(\d+)\}/g,_="hasOwnProperty",S={doc:document,win:window},N={was:Object.prototype[_].call(S.win,"Raphael"),is:S.win.Raphael},E=function(){this.ca=this.customAttributes={}},T="apply",R="concat",k="createTouch"in S.doc,A="",O=" ",D=String,I="split",M="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[I](O),L={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},B=D.prototype.toLowerCase,P=Math,H=P.max,z=P.min,W=P.abs,j=P.pow,F=P.PI,q="number",V="string",$="array",U=Object.prototype.toString,Y=(y._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),G={NaN:1,Infinity:1,"-Infinity":1},X=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,K=P.round,Q=parseFloat,Z=parseInt,J=D.prototype.toUpperCase,tt=y._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},et=y._availableAnimAttrs={blur:q,"clip-rect":"csv",cx:q,cy:q,fill:"colour","fill-opacity":q,"font-size":q,height:q,opacity:q,path:"path",r:q,rx:q,ry:q,stroke:"colour","stroke-opacity":q,"stroke-width":q,transform:"transform",width:q,x:q,y:q},nt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,it={hs:1,rg:1},rt=/,?([achlmqrstvxz]),?/gi,ot=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,st=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,at=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,lt=(y._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ct=function(t,e){return Q(t)-Q(e)},ht=function(){},ut=function(t){return t},dt=y._rectPath=function(t,e,n,i,r){return r?[["M",t+r,e],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]]:[["M",t,e],["l",n,0],["l",0,i],["l",-n,0],["z"]]},ft=function(t,e,n,i){return null==i&&(i=n),[["M",t,e],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]]},pt=y._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return ft(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return ft(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return dt(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return dt(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return dt(e.x,e.y,e.width,e.height)}},mt=y.mapPath=function(t,e){if(!e)return t;var n,i,r,o,s,a,l;for(t=Mt(t),r=0,s=t.length;r<s;r++)for(l=t[r],o=1,a=l.length;o<a;o+=2)n=e.x(l[o],l[o+1]),i=e.y(l[o],l[o+1]),l[o]=n,l[o+1]=i;return t};if(y._g=S,y.type=S.win.SVGAngle||S.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==y.type){var gt,yt=S.doc.createElement("div");if(yt.innerHTML='<v:shape adj="1"/>',gt=yt.firstChild,gt.style.behavior="url(#default#VML)",!gt||"object"!=typeof gt.adj)return y.type=A;yt=null}y.svg=!(y.vml="VML"==y.type),y._Paper=E,y.fn=b=E.prototype=y.prototype,y._id=0,y._oid=0,y.is=function(t,e){return e=B.call(e),"finite"==e?!G[_](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||U.call(t).slice(8,-1).toLowerCase()==e},y.angle=function(t,e,n,i,r,o){if(null==r){var s=t-n,a=e-i;return s||a?(180+180*P.atan2(-a,-s)/F+360)%360:0}return y.angle(t,e,r,o)-y.angle(n,i,r,o)},y.rad=function(t){return t%360*F/180},y.deg=function(t){return 180*t/F%360},y.snapTo=function(t,e,n){if(n=y.is(n,"finite")?n:10,y.is(t,$)){for(var i=t.length;i--;)if(W(t[i]-e)<=n)return t[i]}else{t=+t;var r=e%t;if(r<n)return e-r;if(r>t-n)return e-r+t}return e};y.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=16*P.random()|0;return("x"==t?e:3&e|8).toString(16)});y.setWindow=function(t){eve("raphael.setWindow",y,S.win,t),S.win=t,S.doc=S.win.document,y._engine.initWin&&y._engine.initWin(S.win)};var vt=function(t){if(y.vml){var e,n=/^\s+|\s+$/g;try{var i=new ActiveXObject("htmlfile");i.write("<body>"),i.close(),e=i.body}catch(t){e=createPopup().document.body}var r=e.createTextRange();vt=p(function(t){try{e.style.color=D(t).replace(n,A);var i=r.queryCommandValue("ForeColor");return i=(255&i)<<16|65280&i|(16711680&i)>>>16,"#"+("000000"+i.toString(16)).slice(-6)}catch(t){return"none"}})}else{var o=S.doc.createElement("i");o.title="Raphaël Colour Picker",o.style.display="none",S.doc.body.appendChild(o),vt=p(function(t){return o.style.color=t,S.doc.defaultView.getComputedStyle(o,A).getPropertyValue("color")})}return vt(t)},bt=function(){return"hsb("+[this.h,this.s,this.b]+")"},wt=function(){return"hsl("+[this.h,this.s,this.l]+")"},xt=function(){return this.hex},Ct=function(t,e,n){if(null==e&&y.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(n=t.b,e=t.g,t=t.r),null==e&&y.is(t,V)){var i=y.getRGB(t);t=i.r,e=i.g,n=i.b}return(t>1||e>1||n>1)&&(t/=255,e/=255,n/=255),[t,e,n]},_t=function(t,e,n,i){t*=255,e*=255,n*=255;var r={r:t,g:e,b:n,hex:y.rgb(t,e,n),toString:xt};return y.is(i,"finite")&&(r.opacity=i),r};y.color=function(t){var e;return y.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=y.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):y.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=y.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):(y.is(t,"string")&&(t=y.getRGB(t)),y.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(e=y.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=y.rgb2hsb(t),t.v=e.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=xt,t},y.hsb2rgb=function(t,e,n,i){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,t=t.h,i=t.o),t*=360;var r,o,s,a,l;return t=t%360/60,l=n*e,a=l*(1-W(t%2-1)),r=o=s=n-l,t=~~t,r+=[l,a,0,0,a,l][t],o+=[a,l,l,a,0,0][t],s+=[0,0,a,l,l,a][t],_t(r,o,s,i)},y.hsl2rgb=function(t,e,n,i){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var r,o,s,a,l;return t=t%360/60,l=2*e*(n<.5?n:1-n),a=l*(1-W(t%2-1)),r=o=s=n-l/2,t=~~t,r+=[l,a,0,0,a,l][t],o+=[a,l,l,a,0,0][t],s+=[0,0,a,l,l,a][t],_t(r,o,s,i)},y.rgb2hsb=function(t,e,n){n=Ct(t,e,n),t=n[0],e=n[1],n=n[2];var i,r,o,s;return o=H(t,e,n),s=o-z(t,e,n),i=0==s?null:o==t?(e-n)/s:o==e?(n-t)/s+2:(t-e)/s+4,i=(i+360)%6*60/360,r=0==s?0:s/o,{h:i,s:r,b:o,toString:bt}},y.rgb2hsl=function(t,e,n){n=Ct(t,e,n),t=n[0],e=n[1],n=n[2];var i,r,o,s,a,l;return s=H(t,e,n),a=z(t,e,n),l=s-a,i=0==l?null:s==t?(e-n)/l:s==e?(n-t)/l+2:(t-e)/l+4,i=(i+360)%6*60/360,o=(s+a)/2,r=0==l?0:o<.5?l/(2*o):l/(2-2*o),{h:i,s:r,l:o,toString:wt}},y._path2string=function(){return this.join(",").replace(rt,"$1")};y._preload=function(t,e){var n=S.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){e.call(this),this.onload=null,S.doc.body.removeChild(this)},n.onerror=function(){S.doc.body.removeChild(this)},S.doc.body.appendChild(n),n.src=t};y.getRGB=p(function(t){if(!t||(t=D(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:f};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:f};!it[_](t.toLowerCase().substring(0,2))&&"#"!=t.charAt()&&(t=vt(t));var e,n,i,r,o,s,a=t.match(Y);return a?(a[2]&&(i=Z(a[2].substring(5),16),n=Z(a[2].substring(3,5),16),e=Z(a[2].substring(1,3),16)),a[3]&&(i=Z((o=a[3].charAt(3))+o,16),n=Z((o=a[3].charAt(2))+o,16),e=Z((o=a[3].charAt(1))+o,16)),a[4]&&(s=a[4][I](nt),e=Q(s[0]),"%"==s[0].slice(-1)&&(e*=2.55),n=Q(s[1]),"%"==s[1].slice(-1)&&(n*=2.55),i=Q(s[2]),"%"==s[2].slice(-1)&&(i*=2.55),"rgba"==a[1].toLowerCase().slice(0,4)&&(r=Q(s[3])),s[3]&&"%"==s[3].slice(-1)&&(r/=100)),a[5]?(s=a[5][I](nt),e=Q(s[0]),"%"==s[0].slice(-1)&&(e*=2.55),n=Q(s[1]),"%"==s[1].slice(-1)&&(n*=2.55),i=Q(s[2]),"%"==s[2].slice(-1)&&(i*=2.55),("deg"==s[0].slice(-3)||"°"==s[0].slice(-1))&&(e/=360),"hsba"==a[1].toLowerCase().slice(0,4)&&(r=Q(s[3])),s[3]&&"%"==s[3].slice(-1)&&(r/=100),y.hsb2rgb(e,n,i,r)):a[6]?(s=a[6][I](nt),e=Q(s[0]),"%"==s[0].slice(-1)&&(e*=2.55),n=Q(s[1]),"%"==s[1].slice(-1)&&(n*=2.55),i=Q(s[2]),"%"==s[2].slice(-1)&&(i*=2.55),("deg"==s[0].slice(-3)||"°"==s[0].slice(-1))&&(e/=360),"hsla"==a[1].toLowerCase().slice(0,4)&&(r=Q(s[3])),s[3]&&"%"==s[3].slice(-1)&&(r/=100),y.hsl2rgb(e,n,i,r)):(a={r:e,g:n,b:i,toString:f},a.hex="#"+(16777216|i|n<<8|e<<16).toString(16).slice(1),y.is(r,"finite")&&(a.opacity=r),a)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:f}},y),y.hsb=p(function(t,e,n){return y.hsb2rgb(t,e,n).hex}),y.hsl=p(function(t,e,n){return y.hsl2rgb(t,e,n).hex}),y.rgb=p(function(t,e,n){return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)}),y.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},n=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),n.hex},y.getColor.reset=function(){delete this.start},y.parsePathString=function(t){if(!t)return null;var e=St(t);if(e.arr)return Et(e.arr);var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];return y.is(t,$)&&y.is(t[0],$)&&(i=Et(t)),i.length||D(t).replace(ot,function(t,e,r){var o=[],s=e.toLowerCase();if(r.replace(at,function(t,e){e&&o.push(+e)}),"m"==s&&o.length>2&&(i.push([e][R](o.splice(0,2))),s="l",e="m"==e?"l":"L"),"r"==s)i.push([e][R](o));else for(;o.length>=n[s]&&(i.push([e][R](o.splice(0,n[s]))),n[s]););}),i.toString=y._path2string,e.arr=Et(i),i},y.parseTransformString=p(function(t){if(!t)return null;var e=[];return y.is(t,$)&&y.is(t[0],$)&&(e=Et(t)),e.length||D(t).replace(st,function(t,n,i){var r=[];B.call(n);i.replace(at,function(t,e){e&&r.push(+e)}),e.push([n][R](r))}),e.toString=y._path2string,e});var St=function(t){var e=St.ps=St.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[_](n)&&n!=t&&!--e[n].sleep&&delete e[n]}),e[t]};y.findDotsAtSegment=function(t,e,n,i,r,o,s,a,l){var c=1-l,h=j(c,3),u=j(c,2),d=l*l,f=d*l,p=h*t+3*u*l*n+3*c*l*l*r+f*s,m=h*e+3*u*l*i+3*c*l*l*o+f*a,g=t+2*l*(n-t)+d*(r-2*n+t),y=e+2*l*(i-e)+d*(o-2*i+e),v=n+2*l*(r-n)+d*(s-2*r+n),b=i+2*l*(o-i)+d*(a-2*o+i),w=c*t+l*n,x=c*e+l*i,C=c*r+l*s,_=c*o+l*a,S=90-180*P.atan2(g-v,y-b)/F;return(g>v||y<b)&&(S+=180),{x:p,y:m,m:{x:g,y:y},n:{x:v,y:b},start:{x:w,y:x},end:{x:C,y:_},alpha:S}},y.bezierBBox=function(t,e,n,i,r,o,s,a){y.is(t,"array")||(t=[t,e,n,i,r,o,s,a]);var l=It.apply(null,t);return{x:l.min.x,y:l.min.y,x2:l.max.x,y2:l.max.y,width:l.max.x-l.min.x,height:l.max.y-l.min.y}},y.isPointInsideBBox=function(t,e,n){return e>=t.x&&e<=t.x2&&n>=t.y&&n<=t.y2},y.isBBoxIntersect=function(t,e){var n=y.isPointInsideBBox;return n(e,t.x,t.y)||n(e,t.x2,t.y)||n(e,t.x,t.y2)||n(e,t.x2,t.y2)||n(t,e.x,e.y)||n(t,e.x2,e.y)||n(t,e.x,e.y2)||n(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)},y.pathIntersection=function(t,e){return s(t,e)},y.pathIntersectionNumber=function(t,e){return s(t,e,1)},y.isPointInsidePath=function(t,e,n){var i=y.pathBBox(t);return y.isPointInsideBBox(i,e,n)&&s(t,[["M",e,n],["H",i.x2+10]],1)%2==1},y._removedFactory=function(t){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var Nt=y.pathBBox=function(t){var e=St(t);if(e.bbox)return e.bbox;if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Mt(t);for(var n,i=0,r=0,o=[],s=[],a=0,l=t.length;a<l;a++)if(n=t[a],"M"==n[0])i=n[1],r=n[2],o.push(i),s.push(r);else{var c=It(i,r,n[1],n[2],n[3],n[4],n[5],n[6]);o=o[R](c.min.x,c.max.x),s=s[R](c.min.y,c.max.y),i=n[5],r=n[6]}var h=z[T](0,o),u=z[T](0,s),d=H[T](0,o),f=H[T](0,s),p={x:h,y:u,x2:d,y2:f,width:d-h,height:f-u};return e.bbox=g(p),p},Et=function(t){var e=g(t);return e.toString=y._path2string,e},Tt=y._pathToRelative=function(t){var e=St(t);if(e.rel)return Et(e.rel);y.is(t,$)&&y.is(t&&t[0],$)||(t=y.parsePathString(t));var n=[],i=0,r=0,o=0,s=0,a=0;"M"==t[0][0]&&(i=t[0][1],r=t[0][2],o=i,s=r,a++,n.push(["M",i,r]));for(var l=a,c=t.length;l<c;l++){var h=n[l]=[],u=t[l];if(u[0]!=B.call(u[0]))switch(h[0]=B.call(u[0]),h[0]){case"a":h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5],h[6]=+(u[6]-i).toFixed(3),h[7]=+(u[7]-r).toFixed(3);break;case"v":h[1]=+(u[1]-r).toFixed(3);break;case"m":o=u[1],s=u[2];default:for(var d=1,f=u.length;d<f;d++)h[d]=+(u[d]-(d%2?i:r)).toFixed(3)}else{h=n[l]=[],"m"==u[0]&&(o=u[1]+i,s=u[2]+r);for(var p=0,m=u.length;p<m;p++)n[l][p]=u[p]}var g=n[l].length;switch(n[l][0]){case"z":i=o,r=s;break;case"h":i+=+n[l][g-1];break;case"v":r+=+n[l][g-1];break;default:i+=+n[l][g-2],r+=+n[l][g-1]}}return n.toString=y._path2string,e.rel=Et(n),n},Rt=y._pathToAbsolute=function(t){var e=St(t);if(e.abs)return Et(e.abs);if(y.is(t,$)&&y.is(t&&t[0],$)||(t=y.parsePathString(t)),!t||!t.length)return[["M",0,0]];var n=[],i=0,r=0,o=0,s=0,a=0;"M"==t[0][0]&&(i=+t[0][1],r=+t[0][2],o=i,s=r,a++,n[0]=["M",i,r]);for(var l,c,h=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),u=a,f=t.length;u<f;u++){if(n.push(l=[]),c=t[u],c[0]!=J.call(c[0]))switch(l[0]=J.call(c[0]),l[0]){case"A":l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=+(c[6]+i),l[7]=+(c[7]+r);break;case"V":l[1]=+c[1]+r;break;case"H":l[1]=+c[1]+i;break;case"R":for(var p=[i,r][R](c.slice(1)),m=2,g=p.length;m<g;m++)p[m]=+p[m]+i,p[++m]=+p[m]+r;n.pop(),n=n[R](d(p,h));break;case"M":o=+c[1]+i,s=+c[2]+r;default:for(m=1,g=c.length;m<g;m++)l[m]=+c[m]+(m%2?i:r)}else if("R"==c[0])p=[i,r][R](c.slice(1)),n.pop(),n=n[R](d(p,h)),l=["R"][R](c.slice(-2));else for(var v=0,b=c.length;v<b;v++)l[v]=c[v];switch(l[0]){case"Z":i=o,r=s;break;case"H":i=l[1];break;case"V":r=l[1];break;case"M":o=l[l.length-2],s=l[l.length-1];default:i=l[l.length-2],r=l[l.length-1]}}return n.toString=y._path2string,e.abs=Et(n),n},kt=function(t,e,n,i){return[t,e,n,i,n,i]},At=function(t,e,n,i,r,o){var s=1/3,a=2/3;return[s*t+a*n,s*e+a*i,s*r+a*n,s*o+a*i,r,o]},Ot=function(t,e,n,i,r,o,s,a,l,c){var h,u=120*F/180,d=F/180*(+r||0),f=[],m=p(function(t,e,n){return{x:t*P.cos(n)-e*P.sin(n),y:t*P.sin(n)+e*P.cos(n)}});if(c)S=c[0],N=c[1],C=c[2],_=c[3];else{h=m(t,e,-d),t=h.x,e=h.y,h=m(a,l,-d),a=h.x,l=h.y;var g=(P.cos(F/180*r),P.sin(F/180*r),(t-a)/2),y=(e-l)/2,v=g*g/(n*n)+y*y/(i*i);v>1&&(v=P.sqrt(v),n*=v,i*=v);var b=n*n,w=i*i,x=(o==s?-1:1)*P.sqrt(W((b*w-b*y*y-w*g*g)/(b*y*y+w*g*g))),C=x*n*y/i+(t+a)/2,_=x*-i*g/n+(e+l)/2,S=P.asin(((e-_)/i).toFixed(9)),N=P.asin(((l-_)/i).toFixed(9));S=t<C?F-S:S,N=a<C?F-N:N,S<0&&(S=2*F+S),N<0&&(N=2*F+N),s&&S>N&&(S-=2*F),!s&&N>S&&(N-=2*F)}var E=N-S;if(W(E)>u){var T=N,k=a,A=l;N=S+u*(s&&N>S?1:-1),a=C+n*P.cos(N),l=_+i*P.sin(N),f=Ot(a,l,n,i,r,0,s,k,A,[N,T,C,_])}E=N-S;var O=P.cos(S),D=P.sin(S),M=P.cos(N),L=P.sin(N),B=P.tan(E/4),H=4/3*n*B,z=4/3*i*B,j=[t,e],q=[t+H*D,e-z*O],V=[a+H*L,l-z*M],$=[a,l];if(q[0]=2*j[0]-q[0],q[1]=2*j[1]-q[1],c)return[q,V,$][R](f);f=[q,V,$][R](f).join()[I](",");for(var U=[],Y=0,G=f.length;Y<G;Y++)U[Y]=Y%2?m(f[Y-1],f[Y],d).y:m(f[Y],f[Y+1],d).x;return U},Dt=function(t,e,n,i,r,o,s,a,l){var c=1-l;return{x:j(c,3)*t+3*j(c,2)*l*n+3*c*l*l*r+j(l,3)*s,y:j(c,3)*e+3*j(c,2)*l*i+3*c*l*l*o+j(l,3)*a}},It=p(function(t,e,n,i,r,o,s,a){var l,c=r-2*n+t-(s-2*r+n),h=2*(n-t)-2*(r-n),u=t-n,d=(-h+P.sqrt(h*h-4*c*u))/2/c,f=(-h-P.sqrt(h*h-4*c*u))/2/c,p=[e,a],m=[t,s];return W(d)>"1e12"&&(d=.5),W(f)>"1e12"&&(f=.5),d>0&&d<1&&(l=Dt(t,e,n,i,r,o,s,a,d),m.push(l.x),p.push(l.y)),f>0&&f<1&&(l=Dt(t,e,n,i,r,o,s,a,f),m.push(l.x),p.push(l.y)),c=o-2*i+e-(a-2*o+i),h=2*(i-e)-2*(o-i),u=e-i,d=(-h+P.sqrt(h*h-4*c*u))/2/c,f=(-h-P.sqrt(h*h-4*c*u))/2/c,W(d)>"1e12"&&(d=.5),W(f)>"1e12"&&(f=.5),d>0&&d<1&&(l=Dt(t,e,n,i,r,o,s,a,d),m.push(l.x),p.push(l.y)),f>0&&f<1&&(l=Dt(t,e,n,i,r,o,s,a,f),m.push(l.x),p.push(l.y)),{min:{x:z[T](0,m),y:z[T](0,p)},max:{x:H[T](0,m),y:H[T](0,p)}}}),Mt=y._path2curve=p(function(t,e){var n=!e&&St(t);if(!e&&n.curve)return Et(n.curve);for(var i=Rt(t),r=e&&Rt(e),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var n,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][R](Ot[T](0,[e.x,e.y][R](t.slice(1))));break;case"S":n=e.x+(e.x-(e.bx||e.x)),i=e.y+(e.y-(e.by||e.y)),t=["C",n,i][R](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][R](At(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][R](At(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][R](kt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][R](kt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][R](kt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][R](kt(e.x,e.y,e.X,e.Y))}return t}),l=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)t.splice(e++,0,["C"][R](n.splice(0,6)));t.splice(e,1),u=H(i.length,r&&r.length||0)}},c=function(t,e,n,o,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=t[s][1],n.y=t[s][2],u=H(i.length,r&&r.length||0))},h=0,u=H(i.length,r&&r.length||0);h<u;h++){i[h]=a(i[h],o),l(i,h),r&&(r[h]=a(r[h],s)),r&&l(r,h),c(i,r,o,s,h),c(r,i,s,o,h);var d=i[h],f=r&&r[h],p=d.length,m=r&&f.length;o.x=d[p-2],o.y=d[p-1],o.bx=Q(d[p-4])||o.x,o.by=Q(d[p-3])||o.y,s.bx=r&&(Q(f[m-4])||s.x),s.by=r&&(Q(f[m-3])||s.y),s.x=r&&f[m-2],s.y=r&&f[m-1]}return r||(n.curve=Et(i)),r?[i,r]:i},null,Et),Lt=(y._parseDots=p(function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r={},o=t[n].match(/^([^:]*):?([\d\.]*)/);if(r.color=y.getRGB(o[1]),r.color.error)return null;r.color=r.color.hex,o[2]&&(r.offset=o[2]+"%"),e.push(r)}for(n=1,i=e.length-1;n<i;n++)if(!e[n].offset){for(var s=Q(e[n-1].offset||0),a=0,l=n+1;l<i;l++)if(e[l].offset){a=e[l].offset;break}a||(a=100,l=i),a=Q(a);for(var c=(a-s)/(l-n+1);n<l;n++)s+=c,e[n].offset=s+"%"}return e}),y._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),Bt=(y._tofront=function(t,e){e.top!==t&&(Lt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},y._toback=function(t,e){e.bottom!==t&&(Lt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},y._insertafter=function(t,e,n){Lt(t,n),e==n.top&&(n.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},y._insertbefore=function(t,e,n){Lt(t,n),e==n.bottom&&(n.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},y.toMatrix=function(t,e){var n=Nt(t),i={_:{transform:A},getBBox:function(){return n}};return Pt(i,e),i.matrix}),Pt=(y.transformPath=function(t,e){return mt(t,Bt(t,e))},y._extractTransform=function(t,e){if(null==e)return t._.transform;e=D(e).replace(/\.{3}|\u2026/g,t._.transform||A);var n=y.parseTransformString(e),i=0,r=0,s=0,a=1,l=1,c=t._,h=new o;if(c.transform=n||[],n)for(var u=0,d=n.length;u<d;u++){var f,p,m,g,v,b=n[u],w=b.length,x=D(b[0]).toLowerCase(),C=b[0]!=x,_=C?h.invert():0;"t"==x&&3==w?C?(f=_.x(0,0),p=_.y(0,0),m=_.x(b[1],b[2]),g=_.y(b[1],b[2]),h.translate(m-f,g-p)):h.translate(b[1],b[2]):"r"==x?2==w?(v=v||t.getBBox(1),h.rotate(b[1],v.x+v.width/2,v.y+v.height/2),i+=b[1]):4==w&&(C?(m=_.x(b[2],b[3]),g=_.y(b[2],b[3]),h.rotate(b[1],m,g)):h.rotate(b[1],b[2],b[3]),i+=b[1]):"s"==x?2==w||3==w?(v=v||t.getBBox(1),h.scale(b[1],b[w-1],v.x+v.width/2,v.y+v.height/2),a*=b[1],l*=b[w-1]):5==w&&(C?(m=_.x(b[3],b[4]),g=_.y(b[3],b[4]),h.scale(b[1],b[2],m,g)):h.scale(b[1],b[2],b[3],b[4]),a*=b[1],l*=b[2]):"m"==x&&7==w&&h.add(b[1],b[2],b[3],b[4],b[5],b[6]),c.dirtyT=1,t.matrix=h}t.matrix=h,c.sx=a,c.sy=l,c.deg=i,c.dx=r=h.e,c.dy=s=h.f,1==a&&1==l&&!i&&c.bbox?(c.bbox.x+=+r,c.bbox.y+=+s):c.dirtyT=1}),Ht=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},zt=y._equaliseTransform=function(t,e){e=D(e).replace(/\.{3}|\u2026/g,t),t=y.parseTransformString(t)||[],e=y.parseTransformString(e)||[];for(var n,i,r,o,s=H(t.length,e.length),a=[],l=[],c=0;c<s;c++){if(r=t[c]||Ht(e[c]),o=e[c]||Ht(r),r[0]!=o[0]||"r"==r[0].toLowerCase()&&(r[2]!=o[2]||r[3]!=o[3])||"s"==r[0].toLowerCase()&&(r[3]!=o[3]||r[4]!=o[4]))return;for(a[c]=[],l[c]=[],n=0,i=H(r.length,o.length);n<i;n++)n in r&&(a[c][n]=r[n]),n in o&&(l[c][n]=o[n])}return{from:a,to:l}};y._getContainer=function(t,e,n,i){var r;if(null!=(r=null!=i||y.is(t,"object")?t:S.doc.getElementById(t)))return r.tagName?null==e?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:e,height:n}:{container:1,x:t,y:e,width:n,height:i}},y.pathToRelative=Tt,y._engine={},y.path2curve=Mt,y.matrix=function(t,e,n,i,r,s){return new o(t,e,n,i,r,s)},function(t){function e(t){var e=P.sqrt(n(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}function n(t){return t[0]*t[0]+t[1]*t[1]}t.add=function(t,e,n,i,r,s){
var a,l,c,h,u=[[],[],[]],d=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],f=[[t,n,r],[e,i,s],[0,0,1]];for(t&&t instanceof o&&(f=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;a<3;a++)for(l=0;l<3;l++){for(h=0,c=0;c<3;c++)h+=d[a][c]*f[c][l];u[a][l]=h}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},t.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new o(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},t.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(t,e){this.add(1,0,0,1,t,e)},t.scale=function(t,e,n,i){null==e&&(e=t),(n||i)&&this.add(1,0,0,1,n,i),this.add(t,0,0,e,0,0),(n||i)&&this.add(1,0,0,1,-n,-i)},t.rotate=function(t,e,n){t=y.rad(t),e=e||0,n=n||0;var i=+P.cos(t).toFixed(9),r=+P.sin(t).toFixed(9);this.add(i,r,-r,i,e,n),this.add(1,0,0,1,-e,-n)},t.x=function(t,e){return t*this.a+e*this.c+this.e},t.y=function(t,e){return t*this.b+e*this.d+this.f},t.get=function(t){return+this[D.fromCharCode(97+t)].toFixed(4)},t.toString=function(){return y.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];t.scalex=P.sqrt(n(i[0])),e(i[0]),t.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*t.shear,i[1][1]-i[0][1]*t.shear],t.scaley=P.sqrt(n(i[1])),e(i[1]),t.shear/=t.scaley;var r=-i[0][1],o=i[1][1];return o<0?(t.rotate=y.deg(P.acos(o)),r<0&&(t.rotate=360-t.rotate)):t.rotate=y.deg(P.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(t){var e=t||this[I]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:A)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:A)+(e.rotate?"r"+[e.rotate,0,0]:A)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(o.prototype);var Wt=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);"Apple Computer, Inc."==navigator.vendor&&(Wt&&Wt[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Wt&&Wt[1]<8?b.safari=function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){t.remove()})}:b.safari=ht;for(var jt=function(){this.returnValue=!1},Ft=function(){return this.originalEvent.preventDefault()},qt=function(){this.cancelBubble=!0},Vt=function(){return this.originalEvent.stopPropagation()},$t=function(){return S.doc.addEventListener?function(t,e,n,i){var r=k&&L[e]?L[e]:e,o=function(r){var o=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,s=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,a=r.clientX+s,l=r.clientY+o;if(k&&L[_](e))for(var c=0,h=r.targetTouches&&r.targetTouches.length;c<h;c++)if(r.targetTouches[c].target==t){var u=r;r=r.targetTouches[c],r.originalEvent=u,r.preventDefault=Ft,r.stopPropagation=Vt;break}return n.call(i,r,a,l)};return t.addEventListener(r,o,!1),function(){return t.removeEventListener(r,o,!1),!0}}:S.doc.attachEvent?function(t,e,n,i){var r=function(t){t=t||S.win.event;var e=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,r=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,o=t.clientX+r,s=t.clientY+e;return t.preventDefault=t.preventDefault||jt,t.stopPropagation=t.stopPropagation||qt,n.call(i,t,o,s)};return t.attachEvent("on"+e,r),function(){return t.detachEvent("on"+e,r),!0}}:void 0}(),Ut=[],Yt=function(t){for(var e,n=t.clientX,i=t.clientY,r=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,o=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,s=Ut.length;s--;){if(e=Ut[s],k){for(var a,l=t.touches.length;l--;)if(a=t.touches[l],a.identifier==e.el._drag.id){n=a.clientX,i=a.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var c,h=e.el.node,u=h.nextSibling,d=h.parentNode,f=h.style.display;S.win.opera&&d.removeChild(h),h.style.display="none",c=e.el.paper.getElementByPoint(n,i),h.style.display=f,S.win.opera&&(u?d.insertBefore(h,u):d.appendChild(h)),c&&eve("raphael.drag.over."+e.el.id,e.el,c),n+=o,i+=r,eve("raphael.drag.move."+e.el.id,e.move_scope||e.el,n-e.el._drag.x,i-e.el._drag.y,n,i,t)}},Gt=function(t){y.unmousemove(Yt).unmouseup(Gt);for(var e,n=Ut.length;n--;)e=Ut[n],e.el._drag={},eve("raphael.drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,t);Ut=[]},Xt=y.el={},Kt=M.length;Kt--;)!function(t){y[t]=Xt[t]=function(e,n){return y.is(e,"function")&&(this.events=this.events||[],this.events.push({name:t,f:e,unbind:$t(this.shape||this.node||S.doc,t,e,n||this)})),this},y["un"+t]=Xt["un"+t]=function(e){for(var n=this.events||[],i=n.length;i--;)if(n[i].name==t&&n[i].f==e)return n[i].unbind(),n.splice(i,1),!n.length&&delete this.events,this;return this}}(M[Kt]);Xt.data=function(t,e){var n=lt[this.id]=lt[this.id]||{};if(1==arguments.length){if(y.is(t,"object")){for(var i in t)t[_](i)&&this.data(i,t[i]);return this}return eve("raphael.data.get."+this.id,this,n[t],t),n[t]}return n[t]=e,eve("raphael.data.set."+this.id,this,e,t),this},Xt.removeData=function(t){return null==t?lt[this.id]={}:lt[this.id]&&delete lt[this.id][t],this},Xt.hover=function(t,e,n,i){return this.mouseover(t,n).mouseout(e,i||n)},Xt.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Qt=[];Xt.drag=function(t,e,n,i,r,o){function s(s){(s.originalEvent||s).preventDefault();var a=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,l=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft;this._drag.x=s.clientX+l,this._drag.y=s.clientY+a,this._drag.id=s.identifier,!Ut.length&&y.mousemove(Yt).mouseup(Gt),Ut.push({el:this,move_scope:i,start_scope:r,end_scope:o}),e&&eve.on("raphael.drag.start."+this.id,e),t&&eve.on("raphael.drag.move."+this.id,t),n&&eve.on("raphael.drag.end."+this.id,n),eve("raphael.drag.start."+this.id,r||i||this,s.clientX+l,s.clientY+a,s)}return this._drag={},Qt.push({el:this,start:s}),this.mousedown(s),this},Xt.onDragOver=function(t){t?eve.on("raphael.drag.over."+this.id,t):eve.unbind("raphael.drag.over."+this.id)},Xt.undrag=function(){for(var t=Qt.length;t--;)Qt[t].el==this&&(this.unmousedown(Qt[t].start),Qt.splice(t,1),eve.unbind("raphael.drag.*."+this.id));!Qt.length&&y.unmousemove(Yt).unmouseup(Gt)},b.circle=function(t,e,n){var i=y._engine.circle(this,t||0,e||0,n||0);return this.__set__&&this.__set__.push(i),i},b.rect=function(t,e,n,i,r){var o=y._engine.rect(this,t||0,e||0,n||0,i||0,r||0);return this.__set__&&this.__set__.push(o),o},b.ellipse=function(t,e,n,i){var r=y._engine.ellipse(this,t||0,e||0,n||0,i||0);return this.__set__&&this.__set__.push(r),r},b.path=function(t){t&&!y.is(t,V)&&!y.is(t[0],$)&&(t+=A);var e=y._engine.path(y.format[T](y,arguments),this);return this.__set__&&this.__set__.push(e),e},b.image=function(t,e,n,i,r){var o=y._engine.image(this,t||"about:blank",e||0,n||0,i||0,r||0);return this.__set__&&this.__set__.push(o),o},b.text=function(t,e,n){var i=y._engine.text(this,t||0,e||0,D(n));return this.__set__&&this.__set__.push(i),i},b.set=function(t){!y.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var e=new ce(t);return this.__set__&&this.__set__.push(e),e},b.setStart=function(t){this.__set__=t||this.set()},b.setFinish=function(t){var e=this.__set__;return delete this.__set__,e},b.setSize=function(t,e){return y._engine.setSize.call(this,t,e)},b.setViewBox=function(t,e,n,i,r){return y._engine.setViewBox.call(this,t,e,n,i,r)},b.top=b.bottom=null,b.raphael=y;var Zt=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,r=n.documentElement,o=r.clientTop||i.clientTop||0,s=r.clientLeft||i.clientLeft||0;return{y:e.top+(S.win.pageYOffset||r.scrollTop||i.scrollTop)-o,x:e.left+(S.win.pageXOffset||r.scrollLeft||i.scrollLeft)-s}};b.getElementByPoint=function(t,e){var n=this,i=n.canvas,r=S.doc.elementFromPoint(t,e);if(S.win.opera&&"svg"==r.tagName){var o=Zt(i),s=i.createSVGRect();s.x=t-o.x,s.y=e-o.y,s.width=s.height=1;var a=i.getIntersectionList(s,null);a.length&&(r=a[a.length-1])}if(!r)return null;for(;r.parentNode&&r!=i.parentNode&&!r.raphael;)r=r.parentNode;return r==n.canvas.parentNode&&(r=i),r=r&&r.raphael?n.getById(r.raphaelid):null},b.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},b.forEach=function(t,e){for(var n=this.bottom;n;){if(!1===t.call(e,n))return this;n=n.next}return this},b.getElementsByPoint=function(t,e){var n=this.set();return this.forEach(function(i){i.isPointInside(t,e)&&n.push(i)}),n},Xt.isPointInside=function(t,e){var n=this.realPath=this.realPath||pt[this.type](this);return y.isPointInsidePath(n,t,e)},Xt.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=pt[this.type](this),e.bboxwt=Nt(this.realPath),e.bboxwt.toString=r,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=pt[this.type](this)),e.bbox=Nt(mt(this.realPath,this.matrix)),e.bbox.toString=r,e.dirty=e.dirtyT=0),e.bbox)},Xt.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},Xt.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity||.5,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},n=e.width/2,i=this.paper,r=i.set(),o=this.realPath||pt[this.type](this);o=this.matrix?mt(o,this.matrix):o;for(var s=1;s<n+1;s++)r.push(i.path(o).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/n*s).toFixed(3),opacity:+(e.opacity/n).toFixed(3)}));return r.insertBefore(this).translate(e.offsetx,e.offsety)};var Jt=function(t,e,n,i,r,o,s,a,l){return null==l?h(t,e,n,i,r,o,s,a):y.findDotsAtSegment(t,e,n,i,r,o,s,a,c(t,e,n,i,r,o,s,a,l))},te=function(t,e){return function(n,i,r){n=Mt(n);for(var o,s,a,l,c,h="",u={},d=0,f=0,p=n.length;f<p;f++){if(a=n[f],"M"==a[0])o=+a[1],s=+a[2];else{if(l=Jt(o,s,a[1],a[2],a[3],a[4],a[5],a[6]),d+l>i){if(e&&!u.start){if(c=Jt(o,s,a[1],a[2],a[3],a[4],a[5],a[6],i-d),h+=["C"+c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y],r)return h;u.start=h,h=["M"+c.x,c.y+"C"+c.n.x,c.n.y,c.end.x,c.end.y,a[5],a[6]].join(),d+=l,o=+a[5],s=+a[6];continue}if(!t&&!e)return c=Jt(o,s,a[1],a[2],a[3],a[4],a[5],a[6],i-d),{x:c.x,y:c.y,alpha:c.alpha}}d+=l,o=+a[5],s=+a[6]}h+=a.shift()+a}return u.end=h,c=t?d:e?u:y.findDotsAtSegment(o,s,a[0],a[1],a[2],a[3],a[4],a[5],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},ee=te(1),ne=te(),ie=te(0,1);y.getTotalLength=ee,y.getPointAtLength=ne,y.getSubpath=function(t,e,n){if(this.getTotalLength(t)-n<1e-6)return ie(t,e).end;var i=ie(t,n,1);return e?ie(i,e).end:i},Xt.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():ee(this.attrs.path)},Xt.getPointAtLength=function(t){if("path"==this.type)return ne(this.attrs.path,t)},Xt.getSubpath=function(t,e){if("path"==this.type)return y.getSubpath(this.attrs.path,t,e)};var re=y.easing_formulas={linear:function(t){return t},"<":function(t){return j(t,1.7)},">":function(t){return j(t,.48)},"<>":function(t){var e=.48-t/1.04,n=P.sqrt(.1734+e*e),i=n-e,r=j(W(i),1/3)*(i<0?-1:1),o=-n-e,s=j(W(o),1/3)*(o<0?-1:1),a=r+s+.5;return 3*(1-a)*a*a+a*a*a},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:j(2,-10*t)*P.sin(2*(t-.075)*F/.3)+1},bounce:function(t){var e,n=7.5625,i=2.75;return t<1/i?e=n*t*t:t<2/i?(t-=1.5/i,e=n*t*t+.75):t<2.5/i?(t-=2.25/i,e=n*t*t+.9375):(t-=2.625/i,e=n*t*t+.984375),e}};re.easeIn=re["ease-in"]=re["<"],re.easeOut=re["ease-out"]=re[">"],re.easeInOut=re["ease-in-out"]=re["<>"],re["back-in"]=re.backIn,re["back-out"]=re.backOut;var oe=[],se=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},ae=function(){for(var t=+new Date,n=0;n<oe.length;n++){var i=oe[n];if(!i.el.removed&&!i.paused){var r,o,s=t-i.start,a=i.ms,l=i.easing,c=i.from,h=i.diff,u=i.to,d=(i.t,i.el),f={},p={};if(i.initstatus?(s=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*a,i.status=i.initstatus,delete i.initstatus,i.stop&&oe.splice(n--,1)):i.status=(i.prev+(i.percent-i.prev)*(s/a))/i.anim.top,!(s<0))if(s<a){var m=l(s/a);for(var g in c)if(c[_](g)){switch(et[g]){case q:r=+c[g]+m*a*h[g];break;case"colour":r="rgb("+[le(K(c[g].r+m*a*h[g].r)),le(K(c[g].g+m*a*h[g].g)),le(K(c[g].b+m*a*h[g].b))].join(",")+")";break;case"path":r=[];for(var v=0,b=c[g].length;v<b;v++){r[v]=[c[g][v][0]];for(var w=1,x=c[g][v].length;w<x;w++)r[v][w]=+c[g][v][w]+m*a*h[g][v][w];r[v]=r[v].join(O)}r=r.join(O);break;case"transform":if(h[g].real)for(r=[],v=0,b=c[g].length;v<b;v++)for(r[v]=[c[g][v][0]],w=1,x=c[g][v].length;w<x;w++)r[v][w]=c[g][v][w]+m*a*h[g][v][w];else{var C=function(t){return+c[g][t]+m*a*h[g][t]};r=[["m",C(0),C(1),C(2),C(3),C(4),C(5)]]}break;case"csv":if("clip-rect"==g)for(r=[],v=4;v--;)r[v]=+c[g][v]+m*a*h[g][v];break;default:var S=[][R](c[g]);for(r=[],v=d.paper.customAttributes[g].length;v--;)r[v]=+S[v]+m*a*h[g][v]}f[g]=r}d.attr(f),function(t,e,n){setTimeout(function(){eve("raphael.anim.frame."+t,e,n)})}(d.id,d,i.anim)}else{if(function(t,e,n){setTimeout(function(){eve("raphael.anim.frame."+e.id,e,n),eve("raphael.anim.finish."+e.id,e,n),y.is(t,"function")&&t.call(e)})}(i.callback,d,i.anim),d.attr(u),oe.splice(n--,1),i.repeat>1&&!i.next){for(o in u)u[_](o)&&(p[o]=i.totalOrigin[o]);i.el.attr(p),e(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&e(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}y.svg&&d&&d.paper&&d.paper.safari(),oe.length&&se(ae)},le=function(t){return t>255?255:t<0?0:t};Xt.animateWith=function(t,i,r,o,s,a){var l=this;if(l.removed)return a&&a.call(l),l;var c=r instanceof n?r:y.animation(r,o,s,a);e(c,l,c.percents[0],null,l.attr());for(var h=0,u=oe.length;h<u;h++)if(oe[h].anim==i&&oe[h].el==t){oe[u-1].start=oe[h].start;break}return l},Xt.onAnimation=function(t){return t?eve.on("raphael.anim.frame."+this.id,t):eve.unbind("raphael.anim.frame."+this.id),this},n.prototype.delay=function(t){var e=new n(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},n.prototype.repeat=function(t){var e=new n(this.anim,this.ms);return e.del=this.del,e.times=P.floor(H(t,0))||1,e},y.animation=function(t,e,i,r){if(t instanceof n)return t;!y.is(i,"function")&&i||(r=r||i||null,i=null),t=Object(t),e=+e||0;var o,s,a={};for(s in t)t[_](s)&&Q(s)!=s&&Q(s)+"%"!=s&&(o=!0,a[s]=t[s]);return o?(i&&(a.easing=i),r&&(a.callback=r),new n({100:a},e)):new n(t,e)},Xt.animate=function(t,i,r,o){var s=this;if(s.removed)return o&&o.call(s),s;var a=t instanceof n?t:y.animation(t,i,r,o);return e(a,s,a.percents[0],null,s.attr()),s},Xt.setTime=function(t,e){return t&&null!=e&&this.status(t,z(e,t.ms)/t.ms),this},Xt.status=function(t,n){var i,r,o=[],s=0;if(null!=n)return e(t,this,-1,z(n,1)),this;for(i=oe.length;s<i;s++)if(r=oe[s],r.el.id==this.id&&(!t||r.anim==t)){if(t)return r.status;o.push({anim:r.anim,status:r.status})}return t?0:o},Xt.pause=function(t){for(var e=0;e<oe.length;e++)oe[e].el.id==this.id&&(!t||oe[e].anim==t)&&!1!==eve("raphael.anim.pause."+this.id,this,oe[e].anim)&&(oe[e].paused=!0);return this},Xt.resume=function(t){for(var e=0;e<oe.length;e++)if(oe[e].el.id==this.id&&(!t||oe[e].anim==t)){var n=oe[e];!1!==eve("raphael.anim.resume."+this.id,this,n.anim)&&(delete n.paused,this.status(n.anim,n.status))}return this},Xt.stop=function(t){for(var e=0;e<oe.length;e++)oe[e].el.id==this.id&&(!t||oe[e].anim==t)&&!1!==eve("raphael.anim.stop."+this.id,this,oe[e].anim)&&oe.splice(e--,1);return this},eve.on("raphael.remove",t),eve.on("raphael.clear",t),Xt.toString=function(){return"Raphaël’s object"};var ce=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,n=t.length;e<n;e++)t[e]&&(t[e].constructor==Xt.constructor||t[e].constructor==ce)&&(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},he=ce.prototype;he.push=function(){for(var t,e,n=0,i=arguments.length;n<i;n++)(t=arguments[n])&&(t.constructor==Xt.constructor||t.constructor==ce)&&(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},he.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},he.forEach=function(t,e){for(var n=0,i=this.items.length;n<i;n++)if(!1===t.call(e,this.items[n],n))return this;return this};for(var ue in Xt)Xt[_](ue)&&(he[ue]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t][T](n,e)})}}(ue));he.attr=function(t,e){if(t&&y.is(t,$)&&y.is(t[0],"object"))for(var n=0,i=t.length;n<i;n++)this.items[n].attr(t[n]);else for(var r=0,o=this.items.length;r<o;r++)this.items[r].attr(t,e);return this},he.clear=function(){for(;this.length;)this.pop()},he.splice=function(t,e,n){t=t<0?H(this.length+t,0):t,e=H(0,z(this.length-t,e));var i,r=[],o=[],s=[];for(i=2;i<arguments.length;i++)s.push(arguments[i]);for(i=0;i<e;i++)o.push(this[t+i]);for(;i<this.length-t;i++)r.push(this[t+i]);var a=s.length;for(i=0;i<a+r.length;i++)this.items[t+i]=this[t+i]=i<a?s[i]:r[i-a];for(i=this.items.length=this.length-=e-a;this[i];)delete this[i++];return new ce(o)},he.exclude=function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]==t)return this.splice(e,1),!0},he.animate=function(t,e,n,i){(y.is(n,"function")||!n)&&(i=n||null);var r,o,s=this.items.length,a=s,l=this;if(!s)return this;i&&(o=function(){!--s&&i.call(l)}),n=y.is(n,V)?n:o;var c=y.animation(t,e,n,o);for(r=this.items[--a].animate(c);a--;)this.items[a]&&!this.items[a].removed&&this.items[a].animateWith(r,c,c);return this},he.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},he.getBBox=function(){for(var t=[],e=[],n=[],i=[],r=this.items.length;r--;)if(!this.items[r].removed){var o=this.items[r].getBBox();t.push(o.x),e.push(o.y),n.push(o.x+o.width),i.push(o.y+o.height)}return t=z[T](0,t),e=z[T](0,e),n=H[T](0,n),i=H[T](0,i),{x:t,y:e,x2:n,y2:i,width:n-t,height:i-e}},he.clone=function(t){t=new ce;for(var e=0,n=this.items.length;e<n;e++)t.push(this.items[e].clone());return t},he.toString=function(){return"Raphaël‘s set"},y.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},n=t.face["font-family"];for(var i in t.face)t.face[_](i)&&(e.face[i]=t.face[i]);if(this.fonts[n]?this.fonts[n].push(e):this.fonts[n]=[e],!t.svg){e.face["units-per-em"]=Z(t.face["units-per-em"],10);for(var r in t.glyphs)if(t.glyphs[_](r)){var o=t.glyphs[r];if(e.glyphs[r]={w:o.w,k:{},d:o.d&&"M"+o.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},o.k)for(var s in o.k)o[_](s)&&(e.glyphs[r].k[s]=o.k[s])}}return t},b.getFont=function(t,e,n,i){if(i=i||"normal",n=n||"normal",e=+e||{normal:400,bold:700,lighter:300,bolder:800}[e]||400,y.fonts){var r=y.fonts[t];if(!r){var o=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,A)+"(\\s|$)","i");for(var s in y.fonts)if(y.fonts[_](s)&&o.test(s)){r=y.fonts[s];break}}var a;if(r)for(var l=0,c=r.length;l<c&&(a=r[l],a.face["font-weight"]!=e||a.face["font-style"]!=n&&a.face["font-style"]||a.face["font-stretch"]!=i);l++);return a}},b.print=function(t,e,n,i,r,o,s){o=o||"middle",s=H(z(s||0,1),-1);var a,l=D(n)[I](A),c=0,h=0,u=A;if(y.is(i,n)&&(i=this.getFont(i)),i){a=(r||16)/i.face["units-per-em"];for(var d=i.face.bbox[I](w),f=+d[0],p=d[3]-d[1],m=0,g=+d[1]+("baseline"==o?p+ +i.face.descent:p/2),v=0,b=l.length;v<b;v++){if("\n"==l[v])c=0,C=0,h=0,m+=p;else{var x=h&&i.glyphs[l[v-1]]||{},C=i.glyphs[l[v]];c+=h?(x.w||i.w)+(x.k&&x.k[l[v]]||0)+i.w*s:0,h=1}C&&C.d&&(u+=y.transformPath(C.d,["t",c*a,m*a,"s",a,a,f,g,"t",(t-f)/a,(e-g)/a]))}}return this.path(u).attr({fill:"#000",stroke:"none"})},b.add=function(t){if(y.is(t,"array"))for(var e,n=this.set(),i=0,r=t.length;i<r;i++)e=t[i]||{},x[_](e.type)&&n.push(this[e.type]().attr(e));return n},y.format=function(t,e){var n=y.is(e,$)?[0][R](e):arguments;return t&&y.is(t,V)&&n.length-1&&(t=t.replace(C,function(t,e){return null==n[++e]?A:n[e]})),t||A},y.fullfill=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,i){var r=i;return n.replace(e,function(t,e,n,i,o){e=e||i,r&&(e in r&&(r=r[e]),"function"==typeof r&&o&&(r=r()))}),r=(null==r||r==i?t:r)+""};return function(e,i){return String(e).replace(t,function(t,e){return n(t,e,i)})}}(),y.ninja=function(){return N.was?S.win.Raphael=N.is:delete Raphael,y},y.st=he,function(t,e,n){function i(){/in/.test(t.readyState)?setTimeout(i,9):y.eve("raphael.DOMload")}null==t.readyState&&t.addEventListener&&(t.addEventListener(e,n=function(){t.removeEventListener(e,n,!1),t.readyState="complete"},!1),t.readyState="loading"),i()}(document,"DOMContentLoaded"),N.was?S.win.Raphael=y:Raphael=y,eve.on("raphael.DOMload",function(){v=!0})}(),window.Raphael.svg&&function(t){var e="hasOwnProperty",n=String,i=parseFloat,r=parseInt,o=Math,s=o.max,a=o.abs,l=o.pow,c=/[, ]+/,h=t.eve,u="",d=" ",f="http://www.w3.org/1999/xlink",p={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},m={};t.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var g=function(i,r){if(r){"string"==typeof i&&(i=g(i));for(var o in r)r[e](o)&&("xlink:"==o.substring(0,6)?i.setAttributeNS(f,o.substring(6),n(r[o])):i.setAttribute(o,n(r[o])))}else i=t._g.doc.createElementNS("http://www.w3.org/2000/svg",i),i.style&&(i.style.webkitTapHighlightColor="rgba(0,0,0,0)");return i},y=function(e,r){var c="linear",h=e.id+r,d=.5,f=.5,p=e.node,m=e.paper,y=p.style,v=t._g.doc.getElementById(h);if(!v){if(r=n(r).replace(t._radial_gradient,function(t,e,n){if(c="radial",e&&n){d=i(e),f=i(n);var r=2*(f>.5)-1;l(d-.5,2)+l(f-.5,2)>.25&&(f=o.sqrt(.25-l(d-.5,2))*r+.5)&&.5!=f&&(f=f.toFixed(5)-1e-5*r)}return u}),r=r.split(/\s*\-\s*/),"linear"==c){var b=r.shift();if(b=-i(b),isNaN(b))return null;var w=[0,0,o.cos(t.rad(b)),o.sin(t.rad(b))],x=1/(s(a(w[2]),a(w[3]))||1);w[2]*=x,w[3]*=x,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}var C=t._parseDots(r);if(!C)return null;if(h=h.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&h!=e.gradient.id&&(m.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){v=g(c+"Gradient",{id:h}),e.gradient=v,g(v,"radial"==c?{fx:d,fy:f}:{x1:w[0],y1:w[1],x2:w[2],y2:w[3],gradientTransform:e.matrix.invert()}),m.defs.appendChild(v);for(var _=0,S=C.length;_<S;_++)v.appendChild(g("stop",{offset:C[_].offset?C[_].offset:_?"100%":"0%","stop-color":C[_].color||"#fff"}))}}return g(p,{fill:"url(#"+h+")",opacity:1,"fill-opacity":1}),y.fill=u,y.opacity=1,y.fillOpacity=1,1},v=function(t){var e=t.getBBox(1);g(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},b=function(i,r,o){if("path"==i.type){for(var s,a,l,c,h,d=n(r).toLowerCase().split("-"),f=i.paper,y=o?"end":"start",v=i.node,b=i.attrs,w=b["stroke-width"],x=d.length,C="classic",_=3,S=3,N=5;x--;)switch(d[x]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":C=d[x];break;case"wide":S=5;break;case"narrow":S=2;break;case"long":_=5;break;case"short":_=2}if("open"==C?(_+=2,S+=2,N+=2,l=1,c=o?4:1,h={fill:"none",stroke:b.stroke}):(c=l=_/2,h={fill:b.stroke,stroke:"none"}),i._.arrows?o?(i._.arrows.endPath&&m[i._.arrows.endPath]--,i._.arrows.endMarker&&m[i._.arrows.endMarker]--):(i._.arrows.startPath&&m[i._.arrows.startPath]--,i._.arrows.startMarker&&m[i._.arrows.startMarker]--):i._.arrows={},"none"!=C){var E="raphael-marker-"+C,T="raphael-marker-"+y+C+_+S;t._g.doc.getElementById(E)?m[E]++:(f.defs.appendChild(g(g("path"),{"stroke-linecap":"round",d:p[C],id:E})),m[E]=1);var R,k=t._g.doc.getElementById(T);k?(m[T]++,R=k.getElementsByTagName("use")[0]):(k=g(g("marker"),{id:T,markerHeight:S,markerWidth:_,orient:"auto",refX:c,refY:S/2}),R=g(g("use"),{"xlink:href":"#"+E,transform:(o?"rotate(180 "+_/2+" "+S/2+") ":u)+"scale("+_/N+","+S/N+")","stroke-width":(1/((_/N+S/N)/2)).toFixed(4)}),k.appendChild(R),f.defs.appendChild(k),m[T]=1),g(R,h);var A=l*("diamond"!=C&&"oval"!=C);o?(s=i._.arrows.startdx*w||0,a=t.getTotalLength(b.path)-A*w):(s=A*w,a=t.getTotalLength(b.path)-(i._.arrows.enddx*w||0)),h={},h["marker-"+y]="url(#"+T+")",(a||s)&&(h.d=Raphael.getSubpath(b.path,s,a)),g(v,h),i._.arrows[y+"Path"]=E,i._.arrows[y+"Marker"]=T,i._.arrows[y+"dx"]=A,i._.arrows[y+"Type"]=C,i._.arrows[y+"String"]=r}else o?(s=i._.arrows.startdx*w||0,a=t.getTotalLength(b.path)-s):(s=0,a=t.getTotalLength(b.path)-(i._.arrows.enddx*w||0)),i._.arrows[y+"Path"]&&g(v,{d:Raphael.getSubpath(b.path,s,a)}),delete i._.arrows[y+"Path"],delete i._.arrows[y+"Marker"],delete i._.arrows[y+"dx"],delete i._.arrows[y+"Type"],delete i._.arrows[y+"String"];for(h in m)if(m[e](h)&&!m[h]){var O=t._g.doc.getElementById(h);O&&O.parentNode.removeChild(O)}}},w={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},x=function(t,e,i){if(e=w[n(e).toLowerCase()]){for(var r=t.attrs["stroke-width"]||"1",o={round:r,square:r,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,s=[],a=e.length;a--;)s[a]=e[a]*r+(a%2?1:-1)*o;g(t.node,{"stroke-dasharray":s.join(",")})}},C=function(i,o){var l=i.node,h=i.attrs,d=l.style.visibility;l.style.visibility="hidden";for(var p in o)if(o[e](p)){if(!t._availableAttrs[e](p))continue;var m=o[p];switch(h[p]=m,p){case"blur":i.blur(m);break;case"href":case"title":case"target":var w=l.parentNode;if("a"!=w.tagName.toLowerCase()){var C=g("a");w.insertBefore(C,l),C.appendChild(l),w=C}"target"==p?w.setAttributeNS(f,"show","blank"==m?"new":m):w.setAttributeNS(f,p,m);break;case"cursor":l.style.cursor=m;break;case"transform":i.transform(m);break;case"arrow-start":b(i,m);break;case"arrow-end":b(i,m,1);break;case"clip-rect":var S=n(m).split(c);if(4==S.length){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var N=g("clipPath"),E=g("rect");N.id=t.createUUID(),g(E,{x:S[0],y:S[1],width:S[2],height:S[3]}),N.appendChild(E),i.paper.defs.appendChild(N),g(l,{"clip-path":"url(#"+N.id+")"}),i.clip=E}if(!m){var T=l.getAttribute("clip-path");if(T){var R=t._g.doc.getElementById(T.replace(/(^url\(#|\)$)/g,u));R&&R.parentNode.removeChild(R),g(l,{"clip-path":u}),delete i.clip}}break;case"path":"path"==i.type&&(g(l,{d:m?h.path=t._pathToAbsolute(m):"M0,0"}),i._.dirty=1,i._.arrows&&("startString"in i._.arrows&&b(i,i._.arrows.startString),"endString"in i._.arrows&&b(i,i._.arrows.endString,1)));break;case"width":if(l.setAttribute(p,m),i._.dirty=1,!h.fx)break;p="x",m=h.x;case"x":h.fx&&(m=-h.x-(h.width||0));case"rx":if("rx"==p&&"rect"==i.type)break;case"cx":l.setAttribute(p,m),i.pattern&&v(i),i._.dirty=1;break;case"height":if(l.setAttribute(p,m),i._.dirty=1,!h.fy)break;p="y",m=h.y;case"y":h.fy&&(m=-h.y-(h.height||0));case"ry":if("ry"==p&&"rect"==i.type)break;case"cy":l.setAttribute(p,m),i.pattern&&v(i),i._.dirty=1;break;case"r":"rect"==i.type?g(l,{rx:m,ry:m}):l.setAttribute(p,m),i._.dirty=1;break;case"src":"image"==i.type&&l.setAttributeNS(f,"href",m);break;case"stroke-width":1==i._.sx&&1==i._.sy||(m/=s(a(i._.sx),a(i._.sy))||1),i.paper._vbSize&&(m*=i.paper._vbSize),l.setAttribute(p,m),h["stroke-dasharray"]&&x(i,h["stroke-dasharray"],o),i._.arrows&&("startString"in i._.arrows&&b(i,i._.arrows.startString),"endString"in i._.arrows&&b(i,i._.arrows.endString,1));break;case"stroke-dasharray":x(i,m,o);break;case"fill":var k=n(m).match(t._ISURL);if(k){N=g("pattern");var A=g("image");N.id=t.createUUID(),g(N,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),g(A,{x:0,y:0,"xlink:href":k[1]}),N.appendChild(A),function(e){t._preload(k[1],function(){var t=this.offsetWidth,n=this.offsetHeight;g(e,{width:t,height:n}),g(A,{width:t,height:n}),i.paper.safari()})}(N),i.paper.defs.appendChild(N),g(l,{fill:"url(#"+N.id+")"}),i.pattern=N,i.pattern&&v(i);break}var O=t.getRGB(m);if(O.error){if(("circle"==i.type||"ellipse"==i.type||"r"!=n(m).charAt())&&y(i,m)){if("opacity"in h||"fill-opacity"in h){var D=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(D){var I=D.getElementsByTagName("stop");g(I[I.length-1],{"stop-opacity":("opacity"in h?h.opacity:1)*("fill-opacity"in h?h["fill-opacity"]:1)})}}h.gradient=m,h.fill="none";break}}else delete o.gradient,delete h.gradient,!t.is(h.opacity,"undefined")&&t.is(o.opacity,"undefined")&&g(l,{opacity:h.opacity}),!t.is(h["fill-opacity"],"undefined")&&t.is(o["fill-opacity"],"undefined")&&g(l,{"fill-opacity":h["fill-opacity"]});O[e]("opacity")&&g(l,{"fill-opacity":O.opacity>1?O.opacity/100:O.opacity});case"stroke":O=t.getRGB(m),l.setAttribute(p,O.hex),"stroke"==p&&O[e]("opacity")&&g(l,{"stroke-opacity":O.opacity>1?O.opacity/100:O.opacity}),"stroke"==p&&i._.arrows&&("startString"in i._.arrows&&b(i,i._.arrows.startString),"endString"in i._.arrows&&b(i,i._.arrows.endString,1));break;case"gradient":("circle"==i.type||"ellipse"==i.type||"r"!=n(m).charAt())&&y(i,m);break;case"opacity":h.gradient&&!h[e]("stroke-opacity")&&g(l,{"stroke-opacity":m>1?m/100:m});case"fill-opacity":if(h.gradient){(D=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,u)))&&(I=D.getElementsByTagName("stop"),g(I[I.length-1],{"stop-opacity":m}));break}default:"font-size"==p&&(m=r(m,10)+"px");var M=p.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});l.style[M]=m,i._.dirty=1,l.setAttribute(p,m)}}_(i,o),l.style.visibility=d},_=function(i,o){if("text"==i.type&&(o[e]("text")||o[e]("font")||o[e]("font-size")||o[e]("x")||o[e]("y"))){var s=i.attrs,a=i.node,l=a.firstChild?r(t._g.doc.defaultView.getComputedStyle(a.firstChild,u).getPropertyValue("font-size"),10):10;if(o[e]("text")){for(s.text=o.text;a.firstChild;)a.removeChild(a.firstChild);for(var c,h=n(o.text).split("\n"),d=[],f=0,p=h.length;f<p;f++)c=g("tspan"),f&&g(c,{dy:1.2*l,x:s.x}),c.appendChild(t._g.doc.createTextNode(h[f])),a.appendChild(c),d[f]=c}else for(d=a.getElementsByTagName("tspan"),f=0,p=d.length;f<p;f++)f?g(d[f],{dy:1.2*l,x:s.x}):g(d[0],{dy:0});g(a,{x:s.x,y:s.y}),i._.dirty=1;var m=i._getBBox(),y=s.y-(m.y+m.height/2);y&&t.is(y,"finite")&&g(d[0],{dy:y})}},S=function(e,n){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.matrix=t.matrix(),this.realPath=null,this.paper=n,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},N=t.el;S.prototype=N,N.constructor=S,t._engine.path=function(t,e){var n=g("path");e.canvas&&e.canvas.appendChild(n);var i=new S(n,e);return i.type="path",C(i,{fill:"none",stroke:"#000",path:t}),i},N.rotate=function(t,e,r){if(this.removed)return this;if(t=n(t).split(c),t.length-1&&(e=i(t[1]),r=i(t[2])),t=i(t[0]),null==r&&(e=r),null==e||null==r){var o=this.getBBox(1);e=o.x+o.width/2,r=o.y+o.height/2}return this.transform(this._.transform.concat([["r",t,e,r]])),this},N.scale=function(t,e,r,o){if(this.removed)return this;if(t=n(t).split(c),t.length-1&&(e=i(t[1]),r=i(t[2]),o=i(t[3])),t=i(t[0]),null==e&&(e=t),null==o&&(r=o),null==r||null==o)var s=this.getBBox(1);return r=null==r?s.x+s.width/2:r,o=null==o?s.y+s.height/2:o,
this.transform(this._.transform.concat([["s",t,e,r,o]])),this},N.translate=function(t,e){return this.removed?this:(t=n(t).split(c),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},N.transform=function(n){var i=this._;if(null==n)return i.transform;if(t._extractTransform(this,n),this.clip&&g(this.clip,{transform:this.matrix.invert()}),this.pattern&&v(this),this.node&&g(this.node,{transform:this.matrix}),1!=i.sx||1!=i.sy){var r=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":r})}return this},N.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},N.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},N.remove=function(){if(!this.removed&&this.node.parentNode){var e=this.paper;e.__set__&&e.__set__.exclude(this),h.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),t._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var n in this)this[n]="function"==typeof this[n]?t._removedFactory(n):null;this.removed=!0}},N._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}return t&&this.hide(),e},N.attr=function(n,i){if(this.removed)return this;if(null==n){var r={};for(var o in this.attrs)this.attrs[e](o)&&(r[o]=this.attrs[o]);return r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r.transform=this._.transform,r}if(null==i&&t.is(n,"string")){if("fill"==n&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==n)return this._.transform;for(var s=n.split(c),a={},l=0,u=s.length;l<u;l++)n=s[l],n in this.attrs?a[n]=this.attrs[n]:t.is(this.paper.customAttributes[n],"function")?a[n]=this.paper.customAttributes[n].def:a[n]=t._availableAttrs[n];return u-1?a:a[s[0]]}if(null==i&&t.is(n,"array")){for(a={},l=0,u=n.length;l<u;l++)a[n[l]]=this.attr(n[l]);return a}if(null!=i){var d={};d[n]=i}else null!=n&&t.is(n,"object")&&(d=n);for(var f in d)h("raphael.attr."+f+"."+this.id,this,d[f]);for(f in this.paper.customAttributes)if(this.paper.customAttributes[e](f)&&d[e](f)&&t.is(this.paper.customAttributes[f],"function")){var p=this.paper.customAttributes[f].apply(this,[].concat(d[f]));this.attrs[f]=d[f];for(var m in p)p[e](m)&&(d[m]=p[m])}return C(this,d),this},N.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var e=this.paper;return e.top!=this&&t._tofront(this,e),this},N.toBack=function(){if(this.removed)return this;var e=this.node.parentNode;"a"==e.tagName.toLowerCase()?e.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):e.firstChild!=this.node&&e.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper);this.paper;return this},N.insertAfter=function(e){if(this.removed)return this;var n=e.node||e[e.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this},N.insertBefore=function(e){if(this.removed)return this;var n=e.node||e[0].node;return n.parentNode.insertBefore(this.node,n),t._insertbefore(this,e,this.paper),this},N.blur=function(e){var n=this;if(0!=+e){var i=g("filter"),r=g("feGaussianBlur");n.attrs.blur=e,i.id=t.createUUID(),g(r,{stdDeviation:+e||1.5}),i.appendChild(r),n.paper.defs.appendChild(i),n._blur=i,g(n.node,{filter:"url(#"+i.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")},t._engine.circle=function(t,e,n,i){var r=g("circle");t.canvas&&t.canvas.appendChild(r);var o=new S(r,t);return o.attrs={cx:e,cy:n,r:i,fill:"none",stroke:"#000"},o.type="circle",g(r,o.attrs),o},t._engine.rect=function(t,e,n,i,r,o){var s=g("rect");t.canvas&&t.canvas.appendChild(s);var a=new S(s,t);return a.attrs={x:e,y:n,width:i,height:r,r:o||0,rx:o||0,ry:o||0,fill:"none",stroke:"#000"},a.type="rect",g(s,a.attrs),a},t._engine.ellipse=function(t,e,n,i,r){var o=g("ellipse");t.canvas&&t.canvas.appendChild(o);var s=new S(o,t);return s.attrs={cx:e,cy:n,rx:i,ry:r,fill:"none",stroke:"#000"},s.type="ellipse",g(o,s.attrs),s},t._engine.image=function(t,e,n,i,r,o){var s=g("image");g(s,{x:n,y:i,width:r,height:o,preserveAspectRatio:"none"}),s.setAttributeNS(f,"href",e),t.canvas&&t.canvas.appendChild(s);var a=new S(s,t);return a.attrs={x:n,y:i,width:r,height:o,src:e},a.type="image",a},t._engine.text=function(e,n,i,r){var o=g("text");e.canvas&&e.canvas.appendChild(o);var s=new S(o,e);return s.attrs={x:n,y:i,"text-anchor":"middle",text:r,font:t._availableAttrs.font,stroke:"none",fill:"#000"},s.type="text",C(s,s.attrs),s},t._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},t._engine.create=function(){var e=t._getContainer.apply(0,arguments),n=e&&e.container,i=e.x,r=e.y,o=e.width,s=e.height;if(!n)throw new Error("SVG container not found.");var a,l=g("svg"),c="overflow:hidden;";return i=i||0,r=r||0,o=o||512,s=s||342,g(l,{height:s,version:1.1,width:o,xmlns:"http://www.w3.org/2000/svg"}),1==n?(l.style.cssText=c+"position:absolute;left:"+i+"px;top:"+r+"px",t._g.doc.body.appendChild(l),a=1):(l.style.cssText=c+"position:relative",n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l)),n=new t._Paper,n.width=o,n.height=s,n.canvas=l,n.clear(),n._left=n._top=0,a&&(n.renderfix=function(){}),n.renderfix(),n},t._engine.setViewBox=function(t,e,n,i,r){h("raphael.setViewBox",this,this._viewBox,[t,e,n,i,r]);var o,a,l=s(n/this.width,i/this.height),c=this.top,u=r?"meet":"xMinYMin";for(null==t?(this._vbSize&&(l=1),delete this._vbSize,o="0 0 "+this.width+d+this.height):(this._vbSize=l,o=t+d+e+d+n+d+i),g(this.canvas,{viewBox:o,preserveAspectRatio:u});l&&c;)a="stroke-width"in c.attrs?c.attrs["stroke-width"]:1,c.attr({"stroke-width":a}),c._.dirty=1,c._.dirtyT=1,c=c.prev;return this._viewBox=[t,e,n,i,!!r],this},t.prototype.renderfix=function(){var t,e=this.canvas,n=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(n){t=e.createSVGMatrix()}var i=-t.e%1,r=-t.f%1;(i||r)&&(i&&(this._left=(this._left+i)%1,n.left=this._left+"px"),r&&(this._top=(this._top+r)%1,n.top=this._top+"px"))},t.prototype.clear=function(){t.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=g("desc")).appendChild(t._g.doc.createTextNode("Created with Raphaël "+t.version)),e.appendChild(this.desc),e.appendChild(this.defs=g("defs"))},t.prototype.remove=function(){h("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null};var E=t.st;for(var T in N)N[e](T)&&!E[e](T)&&(E[T]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t].apply(n,e)})}}(T))}(window.Raphael),window.Raphael.vml&&function(t){var e="hasOwnProperty",n=String,i=parseFloat,r=Math,o=r.round,s=r.max,a=r.min,l=r.abs,c="fill",h=/[, ]+/,u=t.eve,d=" ",f="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,g=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,v="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,w={path:1,rect:1,image:1},x={circle:1,ellipse:1},C=function(e){var i=/[ahqstv]/gi,r=t._pathToAbsolute;if(n(e).match(i)&&(r=t._path2curve),i=/[clmz]/g,r==t._pathToAbsolute&&!n(e).match(i)){var s=n(e).replace(m,function(t,e,n){var i=[],r="m"==e.toLowerCase(),s=p[e];return n.replace(y,function(t){r&&2==i.length&&(s+=i+p["m"==e?"l":"L"],i=[]),i.push(o(t*b))}),s+i});return s}var a,l,c=r(e);s=[];for(var h=0,u=c.length;h<u;h++){a=c[h],"z"==(l=c[h][0].toLowerCase())&&(l="x");for(var g=1,v=a.length;g<v;g++)l+=o(a[g]*b)+(g!=v-1?",":f);s.push(l)}return s.join(d)},_=function(e,n,i){var r=t.matrix();return r.rotate(-e,.5,.5),{dx:r.x(n,i),dy:r.y(n,i)}},S=function(t,e,n,i,r,o){var s=t._,a=t.matrix,h=s.fillpos,u=t.node,f=u.style,p=1,m="",g=b/e,y=b/n;if(f.visibility="hidden",e&&n){if(u.coordsize=l(g)+d+l(y),f.rotation=o*(e*n<0?-1:1),o){var v=_(o,i,r);i=v.dx,r=v.dy}if(e<0&&(m+="x"),n<0&&(m+=" y")&&(p=-1),f.flip=m,u.coordorigin=i*-g+d+r*-y,h||s.fillsize){var w=u.getElementsByTagName(c);w=w&&w[0],u.removeChild(w),h&&(v=_(o,a.x(h[0],h[1]),a.y(h[0],h[1])),w.position=v.dx*p+d+v.dy*p),s.fillsize&&(w.size=s.fillsize[0]*l(e)+d+s.fillsize[1]*l(n)),u.appendChild(w)}f.visibility="visible"}};t.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var N=function(t,e,i){for(var r=n(e).toLowerCase().split("-"),o=i?"end":"start",s=r.length,a="classic",l="medium",c="medium";s--;)switch(r[s]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":a=r[s];break;case"wide":case"narrow":c=r[s];break;case"long":case"short":l=r[s]}var h=t.node.getElementsByTagName("stroke")[0];h[o+"arrow"]=a,h[o+"arrowlength"]=l,h[o+"arrowwidth"]=c},E=function(r,l){r.attrs=r.attrs||{};var u=r.node,p=r.attrs,m=u.style,g=w[r.type]&&(l.x!=p.x||l.y!=p.y||l.width!=p.width||l.height!=p.height||l.cx!=p.cx||l.cy!=p.cy||l.rx!=p.rx||l.ry!=p.ry||l.r!=p.r),y=x[r.type]&&(p.cx!=l.cx||p.cy!=l.cy||p.r!=l.r||p.rx!=l.rx||p.ry!=l.ry),v=r;for(var _ in l)l[e](_)&&(p[_]=l[_]);if(g&&(p.path=t._getPath[r.type](r),r._.dirty=1),l.href&&(u.href=l.href),l.title&&(u.title=l.title),l.target&&(u.target=l.target),l.cursor&&(m.cursor=l.cursor),"blur"in l&&r.blur(l.blur),(l.path&&"path"==r.type||g)&&(u.path=C(~n(p.path).toLowerCase().indexOf("r")?t._pathToAbsolute(p.path):p.path),"image"==r.type&&(r._.fillpos=[p.x,p.y],r._.fillsize=[p.width,p.height],S(r,1,1,0,0,0))),"transform"in l&&r.transform(l.transform),y){var E=+p.cx,R=+p.cy,k=+p.rx||+p.r||0,O=+p.ry||+p.r||0;u.path=t.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",o((E-k)*b),o((R-O)*b),o((E+k)*b),o((R+O)*b),o(E*b))}if("clip-rect"in l){var D=n(l["clip-rect"]).split(h);if(4==D.length){D[2]=+D[2]+ +D[0],D[3]=+D[3]+ +D[1];var I=u.clipRect||t._g.doc.createElement("div"),M=I.style;M.clip=t.format("rect({1}px {2}px {3}px {0}px)",D),u.clipRect||(M.position="absolute",M.top=0,M.left=0,M.width=r.paper.width+"px",M.height=r.paper.height+"px",u.parentNode.insertBefore(I,u),I.appendChild(u),u.clipRect=I)}l["clip-rect"]||u.clipRect&&(u.clipRect.style.clip="auto")}if(r.textpath){var L=r.textpath.style;l.font&&(L.font=l.font),l["font-family"]&&(L.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,f)+'"'),l["font-size"]&&(L.fontSize=l["font-size"]),l["font-weight"]&&(L.fontWeight=l["font-weight"]),l["font-style"]&&(L.fontStyle=l["font-style"])}if("arrow-start"in l&&N(v,l["arrow-start"]),"arrow-end"in l&&N(v,l["arrow-end"],1),null!=l.opacity||null!=l["stroke-width"]||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var B=u.getElementsByTagName(c);if(B=B&&B[0],!B&&(B=A(c)),"image"==r.type&&l.src&&(B.src=l.src),l.fill&&(B.on=!0),null!=B.on&&"none"!=l.fill&&null!==l.fill||(B.on=!1),B.on&&l.fill){var P=n(l.fill).match(t._ISURL);if(P){B.parentNode==u&&u.removeChild(B),B.rotate=!0,B.src=P[1],B.type="tile";var H=r.getBBox(1);B.position=H.x+d+H.y,r._.fillpos=[H.x,H.y],t._preload(P[1],function(){r._.fillsize=[this.offsetWidth,this.offsetHeight]})}else B.color=t.getRGB(l.fill).hex,B.src=f,B.type="solid",t.getRGB(l.fill).error&&(v.type in{circle:1,ellipse:1}||"r"!=n(l.fill).charAt())&&T(v,l.fill,B)&&(p.fill="none",p.gradient=l.fill,B.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var z=((+p["fill-opacity"]+1||2)-1)*((+p.opacity+1||2)-1)*((+t.getRGB(l.fill).o+1||2)-1);z=a(s(z,0),1),B.opacity=z,B.src&&(B.color="none")}u.appendChild(B);var W=u.getElementsByTagName("stroke")&&u.getElementsByTagName("stroke")[0],j=!1;!W&&(j=W=A("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(W.on=!0),("none"==l.stroke||null===l.stroke||null==W.on||0==l.stroke||0==l["stroke-width"])&&(W.on=!1);var F=t.getRGB(l.stroke);W.on&&l.stroke&&(W.color=F.hex),z=((+p["stroke-opacity"]+1||2)-1)*((+p.opacity+1||2)-1)*((+F.o+1||2)-1);var q=.75*(i(l["stroke-width"])||1);if(z=a(s(z,0),1),null==l["stroke-width"]&&(q=p["stroke-width"]),l["stroke-width"]&&(W.weight=q),q&&q<1&&(z*=q)&&(W.weight=1),W.opacity=z,l["stroke-linejoin"]&&(W.joinstyle=l["stroke-linejoin"]||"miter"),W.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(W.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),l["stroke-dasharray"]){var V={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};W.dashstyle=V[e](l["stroke-dasharray"])?V[l["stroke-dasharray"]]:f}j&&u.appendChild(W)}if("text"==v.type){v.paper.canvas.style.display=f;var $=v.paper.span,U=p.font&&p.font.match(/\d+(?:\.\d*)?(?=px)/);m=$.style,p.font&&(m.font=p.font),p["font-family"]&&(m.fontFamily=p["font-family"]),p["font-weight"]&&(m.fontWeight=p["font-weight"]),p["font-style"]&&(m.fontStyle=p["font-style"]),U=i(p["font-size"]||U&&U[0])||10,m.fontSize=100*U+"px",v.textpath.string&&($.innerHTML=n(v.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Y=$.getBoundingClientRect();v.W=p.w=(Y.right-Y.left)/100,v.H=p.h=(Y.bottom-Y.top)/100,v.X=p.x,v.Y=p.y+v.H/2,("x"in l||"y"in l)&&(v.path.v=t.format("m{0},{1}l{2},{1}",o(p.x*b),o(p.y*b),o(p.x*b)+1));for(var G=["x","y","text","font","font-family","font-weight","font-style","font-size"],X=0,K=G.length;X<K;X++)if(G[X]in l){v._.dirty=1;break}switch(p["text-anchor"]){case"start":v.textpath.style["v-text-align"]="left",v.bbx=v.W/2;break;case"end":v.textpath.style["v-text-align"]="right",v.bbx=-v.W/2;break;default:v.textpath.style["v-text-align"]="center",v.bbx=0}v.textpath.style["v-text-kern"]=!0}},T=function(e,o,s){e.attrs=e.attrs||{};var a=(e.attrs,Math.pow),l="linear",c=".5 .5";if(e.attrs.gradient=o,o=n(o).replace(t._radial_gradient,function(t,e,n){return l="radial",e&&n&&(e=i(e),n=i(n),a(e-.5,2)+a(n-.5,2)>.25&&(n=r.sqrt(.25-a(e-.5,2))*(2*(n>.5)-1)+.5),c=e+d+n),f}),o=o.split(/\s*\-\s*/),"linear"==l){var h=o.shift();if(h=-i(h),isNaN(h))return null}var u=t._parseDots(o);if(!u)return null;if(e=e.shape||e.node,u.length){e.removeChild(s),s.on=!0,s.method="none",s.color=u[0].color,s.color2=u[u.length-1].color;for(var p=[],m=0,g=u.length;m<g;m++)u[m].offset&&p.push(u[m].offset+d+u[m].color);s.colors=p.length?p.join():"0% "+s.color,"radial"==l?(s.type="gradientTitle",s.focus="100%",s.focussize="0 0",s.focusposition=c,s.angle=0):(s.type="gradient",s.angle=(270-h)%360),e.appendChild(s)}return 1},R=function(e,n){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=n,this.matrix=t.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},k=t.el;R.prototype=k,k.constructor=R,k.transform=function(e){if(null==e)return this._.transform;var i,r=this.paper._viewBoxShift,o=r?"s"+[r.scale,r.scale]+"-1-1t"+[r.dx,r.dy]:f;r&&(i=e=n(e).replace(/\.{3}|\u2026/g,this._.transform||f)),t._extractTransform(this,o+e);var s,a=this.matrix.clone(),l=this.skew,c=this.node,h=~n(this.attrs.fill).indexOf("-"),u=!n(this.attrs.fill).indexOf("url(");if(a.translate(-.5,-.5),u||h||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",s=a.split(),h&&s.noRotation||!s.isSimple){c.style.filter=a.toFilter();var p=this.getBBox(),m=this.getBBox(1),g=p.x-m.x,y=p.y-m.y;c.coordorigin=g*-b+d+y*-b,S(this,1,1,g,y,0)}else c.style.filter=f,S(this,s.scalex,s.scaley,s.dx,s.dy,s.rotate);else c.style.filter=f,l.matrix=n(a),l.offset=a.offset();return i&&(this._.transform=i),this},k.rotate=function(t,e,r){if(this.removed)return this;if(null!=t){if(t=n(t).split(h),t.length-1&&(e=i(t[1]),r=i(t[2])),t=i(t[0]),null==r&&(e=r),null==e||null==r){var o=this.getBBox(1);e=o.x+o.width/2,r=o.y+o.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,r]])),this}},k.translate=function(t,e){return this.removed?this:(t=n(t).split(h),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},k.scale=function(t,e,r,o){if(this.removed)return this;if(t=n(t).split(h),t.length-1&&(e=i(t[1]),r=i(t[2]),o=i(t[3]),isNaN(r)&&(r=null),isNaN(o)&&(o=null)),t=i(t[0]),null==e&&(e=t),null==o&&(r=o),null==r||null==o)var s=this.getBBox(1);return r=null==r?s.x+s.width/2:r,o=null==o?s.y+s.height/2:o,this.transform(this._.transform.concat([["s",t,e,r,o]])),this._.dirtyT=1,this},k.hide=function(){return!this.removed&&(this.node.style.display="none"),this},k.show=function(){return!this.removed&&(this.node.style.display=f),this},k._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},k.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),t.eve.unbind("raphael.*.*."+this.id),t._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;this.removed=!0}},k.attr=function(n,i){if(this.removed)return this;if(null==n){var r={};for(var o in this.attrs)this.attrs[e](o)&&(r[o]=this.attrs[o]);return r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r.transform=this._.transform,r}if(null==i&&t.is(n,"string")){if(n==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var s=n.split(h),a={},l=0,d=s.length;l<d;l++)n=s[l],n in this.attrs?a[n]=this.attrs[n]:t.is(this.paper.customAttributes[n],"function")?a[n]=this.paper.customAttributes[n].def:a[n]=t._availableAttrs[n];return d-1?a:a[s[0]]}if(this.attrs&&null==i&&t.is(n,"array")){for(a={},l=0,d=n.length;l<d;l++)a[n[l]]=this.attr(n[l]);return a}var f;null!=i&&(f={},f[n]=i),null==i&&t.is(n,"object")&&(f=n);for(var p in f)u("raphael.attr."+p+"."+this.id,this,f[p]);if(f){for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&f[e](p)&&t.is(this.paper.customAttributes[p],"function")){var m=this.paper.customAttributes[p].apply(this,[].concat(f[p]));this.attrs[p]=f[p];for(var g in m)m[e](g)&&(f[g]=m[g])}f.text&&"text"==this.type&&(this.textpath.string=f.text),E(this,f)}return this},k.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&t._tofront(this,this.paper),this},k.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper)),this)},k.insertAfter=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this)},k.insertBefore=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),t._insertbefore(this,e,this.paper),this)},k.blur=function(e){var n=this.node.runtimeStyle,i=n.filter;i=i.replace(g,f),0!=+e?(this.attrs.blur=e,n.filter=i+d+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+e||1.5)+")",n.margin=t.format("-{0}px 0 0 -{0}px",o(+e||1.5))):(n.filter=i,n.margin=0,delete this.attrs.blur)},t._engine.path=function(t,e){var n=A("shape");n.style.cssText=v,n.coordsize=b+d+b,n.coordorigin=e.coordorigin;var i=new R(n,e),r={fill:"none",stroke:"#000"};t&&(r.path=t),i.type="path",i.path=[],i.Path=f,E(i,r),e.canvas.appendChild(n);var o=A("skew");return o.on=!0,n.appendChild(o),i.skew=o,i.transform(f),i},t._engine.rect=function(e,n,i,r,o,s){var a=t._rectPath(n,i,r,o,s),l=e.path(a),c=l.attrs;return l.X=c.x=n,l.Y=c.y=i,l.W=c.width=r,l.H=c.height=o,c.r=s,c.path=a,l.type="rect",l},t._engine.ellipse=function(t,e,n,i,r){var o=t.path();o.attrs;return o.X=e-i,o.Y=n-r,o.W=2*i,o.H=2*r,o.type="ellipse",E(o,{cx:e,cy:n,rx:i,ry:r}),o},t._engine.circle=function(t,e,n,i){var r=t.path();r.attrs;return r.X=e-i,r.Y=n-i,r.W=r.H=2*i,r.type="circle",E(r,{cx:e,cy:n,r:i}),r},t._engine.image=function(e,n,i,r,o,s){var a=t._rectPath(i,r,o,s),l=e.path(a).attr({stroke:"none"}),h=l.attrs,u=l.node,d=u.getElementsByTagName(c)[0];return h.src=n,l.X=h.x=i,l.Y=h.y=r,l.W=h.width=o,l.H=h.height=s,h.path=a,l.type="image",d.parentNode==u&&u.removeChild(d),d.rotate=!0,d.src=n,d.type="tile",l._.fillpos=[i,r],l._.fillsize=[o,s],u.appendChild(d),S(l,1,1,0,0,0),l},t._engine.text=function(e,i,r,s){var a=A("shape"),l=A("path"),c=A("textpath");i=i||0,r=r||0,s=s||"",l.v=t.format("m{0},{1}l{2},{1}",o(i*b),o(r*b),o(i*b)+1),l.textpathok=!0,c.string=n(s),c.on=!0,a.style.cssText=v,a.coordsize=b+d+b,a.coordorigin="0 0";var h=new R(a,e),u={fill:"#000",stroke:"none",font:t._availableAttrs.font,text:s};h.shape=a,h.path=l,h.textpath=c,h.type="text",h.attrs.text=n(s),h.attrs.x=i,h.attrs.y=r,h.attrs.w=1,h.attrs.h=1,E(h,u),a.appendChild(c),a.appendChild(l),e.canvas.appendChild(a);var p=A("skew");return p.on=!0,a.appendChild(p),h.skew=p,h.transform(f),h},t._engine.setSize=function(e,n){var i=this.canvas.style;return this.width=e,this.height=n,e==+e&&(e+="px"),n==+n&&(n+="px"),i.width=e,i.height=n,i.clip="rect(0 "+e+" "+n+" 0)",this._viewBox&&t._engine.setViewBox.apply(this,this._viewBox),this},t._engine.setViewBox=function(e,n,i,r,o){t.eve("raphael.setViewBox",this,this._viewBox,[e,n,i,r,o]);var a,l,c=this.width,h=this.height,u=1/s(i/c,r/h);return o&&(a=h/r,l=c/i,i*a<c&&(e-=(c-i*a)/2/a),r*l<h&&(n-=(h-r*l)/2/l)),this._viewBox=[e,n,i,r,!!o],this._viewBoxShift={dx:-e,dy:-n,scale:u},this.forEach(function(t){t.transform("...")}),this};var A;t._engine.initWin=function(t){var e=t.document;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),A=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(t){A=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},t._engine.initWin(t._g.win),t._engine.create=function(){var e=t._getContainer.apply(0,arguments),n=e.container,i=e.height,r=e.width,o=e.x,s=e.y;if(!n)throw new Error("VML container not found.");var a=new t._Paper,l=a.canvas=t._g.doc.createElement("div"),c=l.style;return o=o||0,s=s||0,r=r||512,i=i||342,a.width=r,a.height=i,r==+r&&(r+="px"),i==+i&&(i+="px"),a.coordsize=216e5+d+216e5,a.coordorigin="0 0",a.span=t._g.doc.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(a.span),c.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",r,i),1==n?(t._g.doc.body.appendChild(l),c.left=o+"px",c.top=s+"px",c.position="absolute"):n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),a.renderfix=function(){},a},t.prototype.clear=function(){t.eve("raphael.clear",this),this.canvas.innerHTML=f,this.span=t._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},t.prototype.remove=function(){t.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;return!0};var O=t.st;for(var D in k)k[e](D)&&!O[e](D)&&(O[D]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t].apply(n,e)})}}(D))}(window.Raphael);
